!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=271)}([function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",function(){return r})},function(t,e,n){t.exports=n(480)()},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";var r=n(111),i=n(30);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.b.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),o=-1!==n.indexOf("Trident/");return r||o}var a=n(5),s={};function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";s[t]=s[t]||1;var e=s[t]++;return"".concat(t,"-").concat(e)}function c(t){return Object(a.a)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function l(t){var e=!0;for(var n in t){e=!1;break}return e}var f=n(44);function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.isInteger,r=void 0!==n&&n;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){for(var n=e.maxElts,r=void 0===n?16:n,i=e.size,o=void 0===i?1:i,a="[",s=0;s<t.length&&s<r;++s)s>0&&(a+=",".concat(s%o==0?" ":"")),a+=h(t[s],e);var u=t.length>r?"...":"]";return"".concat(a).concat(u)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return r?"0":"0.";if(r)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);var i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function p(t,e,n,r){var i="See luma.gl ".concat(n," Upgrade Guide at http://uber.github.io/luma.gl/#/documentation/overview/upgrade-guide"),o=Object.getPrototypeOf(t);r.forEach(function(t){o.methodName||(o[t]=function(){throw f.a.removed("Calling removed method ".concat(e,".").concat(t,": "),i),new Error(t)})})}n.d(e,"c",function(){return r.a}),n.d(e,"e",function(){return o}),n.d(e,"i",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"d",function(){return l}),n.d(e,"g",function(){return f.a}),n.d(e,"b",function(){return h}),n.d(e,"a",function(){return a.a}),n.d(e,"h",function(){return p})},function(t,e,n){var r=n(20),i=n(64),o=n(51),a=n(52),s=n(65),u=function(t,e,n){var c,l,f,h,p=t&u.F,d=t&u.G,v=t&u.S,g=t&u.P,m=t&u.B,y=d?r:v?r[e]||(r[e]={}):(r[e]||{}).prototype,_=d?i:i[e]||(i[e]={}),b=_.prototype||(_.prototype={});for(c in d&&(n=e),n)f=((l=!p&&y&&void 0!==y[c])?y:n)[c],h=m&&l?s(f,r):g&&"function"==typeof f?s(Function.call,f):f,y&&a(y,c,f,t&u.U),_[c]!=f&&o(_,c,h),g&&b[c]!=f&&(b[c]=f)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(29),i=n(3);function o(t,e){return!e||"object"!==Object(r.a)(e)&&"function"!=typeof e?Object(i.a)(t):e}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(145);function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(r.a)(t,e)}},function(t,e,n){"use strict";var r=n(86),i=n(39),o=n(12),a=n(38),s="Failed to create WebGL context in Node.js, headless gl not available",u="Failed to create WebGL context in Node.js, headless gl returned null";var c,l=n(6),f=l.c&&"undefined"!=typeof document,h=f&&"complete"===document.readyState;function p(){return c||(c=f?new Promise(function(t,e){if(f&&"complete"===document.readyState)return h=!0,void t(document);window.onload=function(){h=!0,t(document)}}):Promise.resolve({})),c}function d(t){var e=t.width,n=void 0===e?800:e,r=t.height,i=void 0===r?600:r,o=t.id,a=void 0===o?"gl-canvas":o,s=t.insert,u=void 0===s||s,c=document.createElement("canvas");if(c.id=a,c.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",c.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",u){var l=document.body;l.insertBefore(c,l.firstChild)}return c}var v=n(87),g=n(1),m=n(30);function y(t){return t.luma=t.luma||{},t.luma}function _(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).debug;return null===t?null:void 0===e||e?function(t){if(null===t)return null;if(!m.a.WebGLDebug)return l.g.warn('WebGL debug mode not activated. import "luma.gl/debug" to enable.')(),t;var e=y(t);if(e.realContext)return t;if(e.debugContext)return e.debugContext;var n=m.a.WebGLDebug.makeDebugContext(t,x,w);return Object.assign(function t(){Object(g.a)(this,t)}.prototype,n),e.debugContext=n,n.debug=!0,n.gl=t,l.g.info("debug context actived."),n}(t):function(t){if(null===t)return null;var e=y(t);return e.realContext?e.realContext:t}(t)}function b(t,e){var n=m.a.WebGLDebug.glFunctionArgsToString(t,e);return n="".concat(n.slice(0,100)).concat(n.length>100?"...":""),"gl.".concat(t,"(").concat(n,")")}function x(t,e,n){var r=m.a.WebGLDebug.glEnumToString(t),i=m.a.WebGLDebug.glFunctionArgsToString(e,n),o="".concat(r," in gl.").concat(e,"(").concat(i,")");if(l.g.throw)throw new Error(o);l.g.error(o)()}function w(t,e){var n;if(l.g.priority>=4&&(n=b(t,e),l.g.log(4,n)()),l.g.break){n=n||b(t,e);l.g.break&&l.g.break.every(function(t){return-1!==n.indexOf(t)})}var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){if(void 0===a.value){if(n=n||b(t,e),l.g.throw)throw new Error("Undefined argument: ".concat(n));l.g.error("Undefined argument: ".concat(n))}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}var E,S=n(0);E={},Object(S.a)(E,33902,{gl1:new Float32Array([1,1])}),Object(S.a)(E,33901,{gl1:new Float32Array([1,1])}),Object(S.a)(E,3379,{gl1:64,gl2:2048}),Object(S.a)(E,34076,{gl1:16}),Object(S.a)(E,34930,{gl1:8}),Object(S.a)(E,35661,{gl1:8}),Object(S.a)(E,35660,{gl1:0}),Object(S.a)(E,34024,{gl1:1}),Object(S.a)(E,36348,{gl1:8}),Object(S.a)(E,34921,{gl1:8}),Object(S.a)(E,36347,{gl1:128}),Object(S.a)(E,36349,{gl1:16}),Object(S.a)(E,3386,{gl1:new Int32Array([0,0])}),Object(S.a)(E,32883,{gl1:0,gl2:256}),Object(S.a)(E,35071,{gl1:0,gl2:256}),Object(S.a)(E,37447,{gl1:0,gl2:0}),Object(S.a)(E,36063,{gl1:0,gl2:4}),Object(S.a)(E,35379,{gl1:0,gl2:0}),Object(S.a)(E,35374,{gl1:0,gl2:0}),Object(S.a)(E,35377,{gl1:0,gl2:0}),Object(S.a)(E,34852,{gl1:0,gl2:4}),Object(S.a)(E,36203,{gl1:0,gl2:0}),Object(S.a)(E,33001,{gl1:0,gl2:0}),Object(S.a)(E,33e3,{gl1:0,gl2:0}),Object(S.a)(E,37157,{gl1:0,gl2:0}),Object(S.a)(E,35373,{gl1:0,gl2:0}),Object(S.a)(E,35657,{gl1:0,gl2:0}),Object(S.a)(E,36183,{gl1:0,gl2:0}),Object(S.a)(E,37137,{gl1:0,gl2:0}),Object(S.a)(E,34045,{gl1:0,gl2:0}),Object(S.a)(E,35978,{gl1:0,gl2:0}),Object(S.a)(E,35979,{gl1:0,gl2:0}),Object(S.a)(E,35968,{gl1:0,gl2:0}),Object(S.a)(E,35376,{gl1:0,gl2:0}),Object(S.a)(E,35375,{gl1:0,gl2:0}),Object(S.a)(E,35659,{gl1:0,gl2:0}),Object(S.a)(E,37154,{gl1:0,gl2:0}),Object(S.a)(E,35371,{gl1:0,gl2:0}),Object(S.a)(E,35658,{gl1:0,gl2:0}),Object(S.a)(E,35076,{gl1:0,gl2:-8,negative:!0}),Object(S.a)(E,35077,{gl1:0,gl2:7}),Object(S.a)(E,35380,{gl1:0,gl2:0});var P=n(2),T=function(t){return t},A=new(function(){function t(){Object(g.a)(this,t),this.pendingQueries=new Set,this.invalidQueryType=null,this.invalidErrorMessage="",this.checkInvalid=function(){return!1}}return Object(P.a)(t,[{key:"poll",value:function(t){this.cancelInvalidQueries(t);var e=!0,n=!1,r=void 0;try{for(var i,o=this.pendingQueries.values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(a.isResultAvailable()){var s=a.getResult();this.resolveQuery(a,s)}}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"setInvalidator",value:function(t){var e=t.queryType,n=t.errorMessage,r=t.checkInvalid;this.invalidQueryType=e,this.invalidErrorMessage=n,this.checkInvalid=r}},{key:"beginQuery",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T;this.cancelInvalidQueries(t.gl),this.cancelQuery(t);var r={};return t.promise=new Promise(function(t,e){r.resolve=t,r.reject=e}),Object.assign(t.promise,r),this.pendingQueries.add(t),t.promise.then(e).catch(n)}},{key:"resolveQuery",value:function(t,e){this.pendingQueries.delete(t),t.promise.resolve(e)}},{key:"rejectQuery",value:function(t,e){this.pendingQueries.delete(t),t.promise&&t.promise.reject(new Error(e))}},{key:"deleteQuery",value:function(t){return this.rejectQuery(t,"Query was deleted before result was available")}},{key:"cancelQuery",value:function(t){return this.rejectQuery(t,"Query was canceled before result was available")}},{key:"invalidateQuery",value:function(t){t instanceof this.invalidQueryType&&this.rejectQuery(t,this.invalidErrorMessage)}},{key:"cancelInvalidQueries",value:function(t){if(this.checkInvalid(t)){var e=!0,n=!1,r=void 0;try{for(var i,o=this.pendingQueries.values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.invalidateQuery(a)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}}]),t}()),k=n(5),C=32874;function O(t){return Boolean(t&&(t instanceof o.a||t.TEXTURE_BINDING_3D===C))}var M={webgl2:!0,webgl1:!0,throwOnFailure:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function I(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e=Object.assign({},M,e),r=n.canvas,i=n.width,o=n.height,c=n.throwOnError,f=n.manageState,p=n.debug;function g(t){if(c)throw new Error(t);return null}l.c?t=function(t){var e=t.canvas,n=t.opts,r=void 0===n?{}:n,i=t.onError,o=void 0===i?function(t){return null}:i;function a(t){o("WebGL context: ".concat(t.statusMessage||"Unknown error"))}e.addEventListener("webglcontextcreationerror",a,!1);var s=r.webgl1,u=void 0===s||s,c=r.webgl2,l=void 0===c||c,f=null;return l&&(f=(f=f||e.getContext("webgl2",r))||e.getContext("experimental-webgl2",r)),u&&(f=(f=f||e.getContext("webgl",r))||e.getContext("experimental-webgl",r)),e.removeEventListener("webglcontextcreationerror",a,!1),f||o("Failed to create ".concat(l&&!u?"WebGL2":"WebGL"," context"))}({canvas:function(t){var e,n=t.canvas,r=t.width,i=t.height,o=t.onError,a=void 0===o?function(){}:o;return"string"==typeof n?(h||a("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):e=n||d({id:"lumagl-canvas",width:r,height:i,onError:a}),e}({canvas:r,width:i,height:o,onError:g}),opts:e}):t=function(t){var e=t.width,n=t.height,r=t.opts,i=t.onError,o=r.webgl1;if(r.webgl2&&!o)return i("headless-gl does not support WebGL2");if(!a.d)return i(s);var c=Object(a.d)(e,n,r);return c||i(u)}({width:i,height:o,opts:e,onError:g});return t?(f&&Object(v.a)(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return l.g.log.apply(l.g,[1].concat(e))()}}),l.c&&p&&(t=_(t,{debug:p}),l.g.priority=Math.max(l.g.priority,1)),function(t){var e=O(t)?"WebGL2":"WebGL1",n=function(t){return function(t){var e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),o=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t)}(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";l.g.once(0,"".concat(e).concat(i," context ").concat(r))()}(t),t):null}var L=n(27),R={VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:["WEBGL_color_buffer_float","EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:[!1,"EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},j={};Object.keys(R).forEach(function(t){j[t]=t});function z(t,e){var n=R[e];Object(k.a)(n,e);var r=Object(o.n)(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return Object(k.a)(!1===i||!0===i),i}function D(t,e){return F(t,e)}function F(t,e){return(e=Array.isArray(e)?e:[e]).every(function(e){return z(t,e)})}var N,B=n(25),U=n(9),V=n(8),G=n(10),q=n(32),W="Shader: GLSL source code must be a JavaScript string",Z=35632,X=35633,H=function(t){function e(t,n){var r;Object(g.a)(this,e),Object(o.e)(t),Object(k.a)("string"==typeof n.source,W);var i=Object(o.k)(n.source,null)||n.id||Object(l.i)("unnamed ".concat(e.getTypeName(n.shaderType)));return(r=Object(U.a)(this,Object(V.a)(e).call(this,t,{id:i}))).shaderType=n.shaderType,r.source=n.source,r.initialize(n),r}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"getTypeName",value:function(t){switch(t){case X:return"vertex-shader";case Z:return"fragment-shader";default:return Object(k.a)(!1),"unknown"}}}]),Object(P.a)(e,[{key:"initialize",value:function(t){var e=t.source,n=Object(o.k)(e,null);n&&(this.id=Object(l.i)(n)),this._compile(e)}},{key:"getParameter",value:function(t){return this.gl.getShaderParameter(this.handle,t)}},{key:"toString",value:function(){return"".concat(this.getTypeName(this.shaderType),":").concat(this.id)}},{key:"getName",value:function(){return Object(o.k)(this.source)||"unnamed-shader"}},{key:"getSource",value:function(){return this.gl.getShaderSource(this.handle)}},{key:"getTranslatedSource",value:function(){var t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}},{key:"_compile",value:function(){if(this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){var t=this.gl.getShaderInfoLog(this.handle),e=Object(o.o)(t,this.source,this.shaderType,this.id),n=e.shaderName,r=e.errors,i=e.warnings;throw l.g.error("GLSL compilation errors in ".concat(n,"\n").concat(r))(),l.g.warn("GLSL compilation warnings in ".concat(n,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(n))}}},{key:"_deleteHandle",value:function(){this.gl.deleteShader(this.handle)}},{key:"_getOptsFromHandle",value:function(){return{type:this.getParameter(35663),source:this.getSource()}}}]),e}(q.a),Y=function(t){function e(t,n){return Object(g.a)(this,e),"string"==typeof n&&(l.g.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1"),n={source:n}),Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({},n,{shaderType:X})))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_createHandle",value:function(){return this.gl.createShader(X)}}]),e}(H),K=function(t){function e(t,n){return Object(g.a)(this,e),"string"==typeof n&&(l.g.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1"),n={source:n}),Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({},n,{shaderType:Z})))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_createHandle",value:function(){return this.gl.createShader(Z)}}]),e}(H),J=n(91),Q=n(3),$=n(54),tt=n(18),et=n(69),nt="EXT_color_buffer_float",rt=(N={},Object(S.a)(N,33189,{}),Object(S.a)(N,33190,{gl2:!0}),Object(S.a)(N,36012,{gl2:!0}),Object(S.a)(N,36168,{}),Object(S.a)(N,34041,{}),Object(S.a)(N,35056,{gl2:!0}),Object(S.a)(N,36013,{gl2:!0}),Object(S.a)(N,32854,{}),Object(S.a)(N,36194,{}),Object(S.a)(N,32855,{}),Object(S.a)(N,33321,{gl2:!0}),Object(S.a)(N,33330,{gl2:!0}),Object(S.a)(N,33329,{gl2:!0}),Object(S.a)(N,33332,{gl2:!0}),Object(S.a)(N,33331,{gl2:!0}),Object(S.a)(N,33334,{gl2:!0}),Object(S.a)(N,33333,{gl2:!0}),Object(S.a)(N,33323,{gl2:!0}),Object(S.a)(N,33336,{gl2:!0}),Object(S.a)(N,33335,{gl2:!0}),Object(S.a)(N,33338,{gl2:!0}),Object(S.a)(N,33337,{gl2:!0}),Object(S.a)(N,33340,{gl2:!0}),Object(S.a)(N,33339,{gl2:!0}),Object(S.a)(N,32849,{gl2:!0}),Object(S.a)(N,32856,{gl2:!0}),Object(S.a)(N,32857,{gl2:!0}),Object(S.a)(N,36220,{gl2:!0}),Object(S.a)(N,36238,{gl2:!0}),Object(S.a)(N,36975,{gl2:!0}),Object(S.a)(N,36214,{gl2:!0}),Object(S.a)(N,36232,{gl2:!0}),Object(S.a)(N,36226,{gl2:!0}),Object(S.a)(N,36208,{gl2:!0}),Object(S.a)(N,33325,{gl2:nt}),Object(S.a)(N,33327,{gl2:nt}),Object(S.a)(N,34842,{gl2:nt}),Object(S.a)(N,33326,{gl2:nt}),Object(S.a)(N,33328,{gl2:nt}),Object(S.a)(N,34836,{gl2:nt}),Object(S.a)(N,35898,{gl2:nt}),N);var it=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(V.a)(e).call(this,t,r))).initialize(r),Object.seal(Object(Q.a)(Object(Q.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).format;return!e||function(t,e,n){var r=n[e];if(!r)return!1;var i=Object(o.n)(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}(t,e,rt)}},{key:"getSamplesForFormat",value:function(t,e){var n=e.format;return t.getInternalformatParameter(36161,n,32937)}}]),Object(P.a)(e,[{key:"initialize",value:function(t){var e=t.format,n=t.width,r=void 0===n?1:n,i=t.height,a=void 0===i?1:i,s=t.samples,u=void 0===s?0:s;return Object(k.a)(e,"Needs format"),this.gl.bindRenderbuffer(36161,this.handle),0!==u&&Object(o.n)(this.gl)?this.gl.renderbufferStorageMultisample(36161,u,e,r,a):this.gl.renderbufferStorage(36161,e,r,a),this.format=e,this.width=r,this.height=a,this.samples=u,this}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindRenderbuffer(36161,t)}},{key:"_syncHandle",value:function(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}]),e}(q.a),ot=256,at=1024,st=16384,ut=6144,ct=6145,lt=6146,ft=34041,ht="clear: bad arguments";function pt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.color,o=void 0===i?null:i,a=e.depth,s=void 0===a?null:a,u=e.stencil,c=void 0===u?null:u,l={};r&&(l.framebuffer=r);var f=0;o&&(f|=st,!0!==o&&(l.clearColor=o)),s&&(f|=ot,!0!==s&&(l.clearDepth=s)),c&&(f|=at,!0!==s&&(l.clearStencil=s)),Object(k.a)(0!==f,ht),Object(L.c)(t,l,function(){t.clear(f)})}var dt=n(43);function vt(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Object(k.a)(!1),0}}var gt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(V.a)(e).call(this,t,r))).width=null,n.height=null,n.attachments={},n.readBuffer=36064,n.drawBuffers=[36064],n.initialize(r),Object.seal(Object(Q.a)(Object(Q.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"MAX_COLOR_ATTACHMENTS",get:function(){return this.gl.getParameter(this.gl.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){return this.gl.getParameter(this.gl.MAX_DRAW_BUFFERS)}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.colorBufferFloat,r=e.colorBufferHalfFloat;return n&&t.getExtension(Object(o.n)(t)?"EXT_color_buffer_float":"WEBGL.color_buffer_float"),r&&t.getExtension(Object(o.n)(t)?"EXT_color_buffer_float":"EXT_color_buffer_half_float")}},{key:"getDefaultFramebuffer",value:function(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new e(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}}]),Object(P.a)(e,[{key:"initialize",value:function(t){var e=t.width,n=void 0===e?1:e,r=t.height,i=void 0===r?1:r,o=t.attachments,a=void 0===o?null:o,s=t.color,u=void 0===s||s,c=t.depth,l=void 0===c||c,f=t.stencil,h=void 0!==f&&f,p=t.check,d=void 0===p||p,v=t.readBuffer,g=t.drawBuffers;if(Object(k.a)(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,a)for(var m in a){var y=a[m];(Array.isArray(y)?y[0]:y).resize({width:n,height:i})}else a=this._createDefaultAttachments({color:u,depth:l,stencil:h,width:n,height:i});this.update({clearAttachments:!0,attachments:a,readBuffer:v,drawBuffers:g}),a&&d&&this.checkStatus()}},{key:"update",value:function(t){var e=t.attachments,n=void 0===e?{}:e,r=t.readBuffer,i=t.drawBuffers,o=t.clearAttachments,a=void 0!==o&&o;this.attach(n,{clearAttachments:a});var s=this.gl,u=s.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,u||null),this}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,n=t.height;if(null===this.handle)return Object(k.a)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;for(var r in void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&l.g.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n)),this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}},{key:"attach",value:function(t){var e=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clearAttachments,r={};void 0!==n&&n&&Object.keys(this.attachments).forEach(function(t){r[t]=null}),Object.assign(r,t);var i=this.gl.bindFramebuffer(36160,this.handle);for(var o in r){Object(k.a)(void 0!==o,"Misspelled framebuffer binding point?");var a=Number(o),s=r[a],u=s;if(u)if(u instanceof it)this._attachRenderbuffer({attachment:a,renderbuffer:u});else if(Array.isArray(s)){var c=Object(tt.a)(s,3),l=c[0],f=c[1],h=void 0===f?0:f,p=c[2],d=void 0===p?0:p;u=l,this._attachTexture({attachment:a,texture:l,layer:h,level:d})}else this._attachTexture({attachment:a,texture:u,layer:0,level:0});else this._unattach({attachment:a});u&&u.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(function(t){return!e.attachments[t]}).forEach(function(t){delete e.attachments[t]})}},{key:"checkStatus",value:function(){var t=this.gl,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);if(t.bindFramebuffer(36160,e||null),36053!==n)throw new Error(function(t){return(gt.STATUS||{})[t]||"Framebuffer error ".concat(t)}(n));return this}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=t.depth,r=t.stencil,i=t.drawBuffers,a=void 0===i?[]:i,s=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&pt(this.gl,{color:e,depth:n,stencil:r}),a.forEach(function(t,e){!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.buffer,a=void 0===i?ut:i,s=e.drawBuffer,u=void 0===s?0:s,c=e.value,l=void 0===c?[0,0,0,0]:c;Object(o.d)(t),Object(L.c)(t,{framebuffer:r},function(){switch(a){case ut:switch(l.constructor){case Int32Array:t.clearBufferiv(a,u,l);break;case Uint32Array:t.clearBufferuiv(a,u,l);break;case Float32Array:default:t.clearBufferfv(a,u,l)}break;case ct:t.clearBufferfv(ct,0,[l]);break;case lt:t.clearBufferiv(lt,0,[l]);break;case ft:var e=Object(tt.a)(l,2),n=e[0],r=e[1];t.clearBufferfi(ft,0,n,r);break;default:Object(k.a)(!1,ht)}})}({drawBuffer:e,value:t})}),this.gl.bindFramebuffer(36160,s||null),this}},{key:"readPixels",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,o=t.width,a=void 0===o?this.width:o,s=t.height,u=void 0===s?this.height:s,c=t.format,l=void 0===c?6408:c,f=t.type,h=t.pixelArray,p=void 0===h?null:h,d=t.attachment,v=void 0===d?36064:d;this.gl;if(36064===v&&null===this.handle&&(v=1028),Object(k.a)(this.attachments[v]),f=f||this.attachments[v].type,!p){f=f||5121;var g=Object(dt.c)(f,{clamped:!1}),m=vt(l);p=p||new g(a*u*m)}f=f||Object(dt.b)(p);var y=this.gl.bindFramebuffer(36160,this.handle);return this.gl.readPixels(n,i,a,u,l,f,p),this.gl.bindFramebuffer(36160,y||null),p}},{key:"readPixelsToBuffer",value:function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,a=t.width,s=void 0===a?this.width:a,u=t.height,c=void 0===u?this.height:u,l=t.format,f=void 0===l?6408:l,h=t.type,p=t.buffer,d=void 0===p?null:p,v=t.byteOffset,g=void 0===v?0:v,m=this.gl;if(Object(o.d)(m),h=h||(d?d.type:5121),!d){var y=vt(f),_=function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Object(k.a)(!1),0}}(h),b=g+s*c*y*_;d=new B.a(m,{bytes:b,type:h,size:y})}return d.bind({target:35051}),Object(L.c)(m,{framebuffer:this},function(){m.readPixels(n,i,s,c,f,h,g)}),d.unbind({target:35051}),d}},{key:"copyToDataUrl",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.attachment,n=void 0===e?36064:e,r=t.maxHeight,i=void 0===r?Number.MAX_SAFE_INTEGER:r,a=this.readPixels({attachment:n}),s=this.width,u=this.height;u>i;){var c=Object(o.q)({data:a,width:s,height:u});a=c.data,s=c.width,u=c.height}Object(o.h)({data:a,width:s,height:u});var l=document.createElement("canvas");l.width=s,l.height=u;var f=l.getContext("2d"),h=f.createImageData(s,u);return h.data.set(a),f.putImageData(h,0,0),l.toDataURL()}},{key:"copyToImage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.image,n=void 0===e?null:e,r=t.attachment,i=void 0===r?36064:r,o=t.maxHeight,a=(void 0===o&&Number.MAX_SAFE_INTEGER,this.readDataUrl({attachment:i}));return(n=n||new Image).src=a,n}},{key:"copyToTexture",value:function(t){var e=t.texture,n=t.target,r=t.xoffset,i=void 0===r?0:r,o=t.yoffset,a=void 0===o?0:o,s=t.zoffset,u=void 0===s?0:s,c=t.mipmapLevel,l=void 0===c?0:c,f=t.attachment,h=void 0===f?36064:f,p=t.x,d=void 0===p?0:p,v=t.y,g=void 0===v?0:v,m=t.width,y=t.height,_=this.gl,b=_.bindFramebuffer(36160,this.handle),x=_.readBuffer(h);switch(m=Number.isFinite(m)?m:e.width,y=Number.isFinite(y)?y:e.height,e.target){case 3553:case 34067:_.copyTexSubImage2D(n||e.target,l,i,a,d,g,m,y);break;case 35866:case 32879:_.copyTexSubImage3D(n||e.target,l,i,a,u,d,g,m,y)}return _.readBuffer(x),_.bindFramebuffer(36160,b||null),e}},{key:"blit",value:function(t){var e=t.srcFramebuffer,n=t.attachment,r=void 0===n?36064:n,i=t.srcX0,a=void 0===i?0:i,s=t.srcY0,u=void 0===s?0:s,c=t.srcX1,l=t.srcY1,f=t.dstX0,h=void 0===f?0:f,p=t.dstY0,d=void 0===p?0:p,v=t.dstX1,g=t.dstY1,m=t.color,y=void 0===m||m,_=t.depth,b=void 0!==_&&_,x=t.stencil,w=void 0!==x&&x,E=t.mask,S=void 0===E?0:E,P=t.filter,T=void 0===P?9728:P,A=this.gl;Object(o.d)(A),e.handle||36064!==r||(r=1028),y&&(S|=16384),b&&(S|=256),w&&(S|=1024),Object(k.a)(S),c=void 0===c?e.width:c,l=void 0===l?e.height:l,v=void 0===v?this.width:v,g=void 0===g?this.height:g;var C=A.bindFramebuffer(36009,this.handle),O=A.bindFramebuffer(36008,e.handle);return A.readBuffer(r),A.blitFramebuffer(a,u,c,l,h,d,v,g,S,T),A.readBuffer(this.readBuffer),A.bindFramebuffer(36008,O||null),A.bindFramebuffer(36009,C||null),this}},{key:"invalidate",value:function(t){var e=t.attachments,n=void 0===e?[]:e,r=t.x,i=void 0===r?0:r,a=t.y,s=void 0===a?0:a,u=t.width,c=t.height,l=this.gl;Object(o.d)(l);var f=l.bindFramebuffer(36008,this.handle);return 0===i&&0===s&&void 0===u&&void 0===c?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,i,s,u,c),l.bindFramebuffer(36008,f),this}},{key:"getAttachmentParameter",value:function(t,e,n){var r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Object(i.c)(this.gl,r)),r}},{key:"getAttachmentParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],r={},o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[e?Object(i.c)(this.gl,l):l]=this.getAttachmentParameter(t,l,e)}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return r}},{key:"getParameters",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=Object.keys(this.attachments),n={},r=0;r<e.length;r++){var o=e[r],a=Number(o);n[t?Object(i.c)(this.gl,a):a]=this.getAttachmentParameters(a,t)}return n}},{key:"show",value:function(){return"undefined"!=typeof window&&window.open(this.copyToDataUrl(),"luma-debug-texture"),this}},{key:"log",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>l.g.priority||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);var n=this.copyToDataUrl({maxHeight:100});return l.g.image({priority:t,message:e,image:n},e)(),this}},{key:"bind",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,e=void 0===t?36160:t;return this.gl.bindFramebuffer(e,this.handle),this}},{key:"unbind",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,e=void 0===t?36160:t;return this.gl.bindFramebuffer(e,null),this}},{key:"_createDefaultAttachments",value:function(t){var e,n=t.color,r=t.depth,i=t.stencil,o=t.width,a=t.height,s=null;n&&((s=s||{})[36064]=new et.a(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:o,height:a,mipmaps:!1,parameters:(e={},Object(S.a)(e,10241,9728),Object(S.a)(e,10240,9728),Object(S.a)(e,10242,33071),Object(S.a)(e,10243,33071),e)}));return r&&i?(s=s||{})[33306]=new it(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:o,height:111}):r?(s=s||{})[36096]=new it(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:o,height:a}):i&&Object(k.a)(!1),s}},{key:"_unattach",value:function(t){var e=t.attachment;this.gl.bindRenderbuffer(36161,this.handle),this.gl.framebufferRenderbuffer(36160,e,36161,null),delete this.attachments[e]}},{key:"_attachRenderbuffer",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.renderbuffer;this.gl.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}},{key:"_attachTexture",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.texture,i=t.layer,o=t.level,a=this.gl;switch(a.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:a.framebufferTextureLayer(36160,n,r.target,o,i);break;case 34067:var s=function(t){return t<34069?t+34069:t}(i);a.framebufferTexture2D(36160,n,s,r.handle,o);break;case 3553:a.framebufferTexture2D(36160,n,3553,r.handle,o);break;default:Object(k.a)(!1,"Illegal texture type")}a.bindTexture(r.target,null),this.attachments[n]=r}},{key:"_setReadBuffer",value:function(t,e){Object(o.n)(t)?t.readBuffer(e):Object(k.a)(36064===e||1029===e,"Multiple render targets not supported"),this.readBuffer=e}},{key:"_setDrawBuffers",value:function(t,e){if(Object(o.n)(t))t.drawBuffers(e);else{var n=t.getExtension("WEBGL.draw_buffers");n?n.drawBuffersWEBGL(e):Object(k.a)(1===e.length&&(36064===e[0]||1029===e[0]),"Multiple render targets not supported")}this.drawBuffers=e}},{key:"_getAttachmentParameterFallback",value:function(t){var e=function(t){if(t.luma=t.luma||{},!t.luma.caps)for(var e in t.luma.caps={},t.luma.caps.webgl2=Object(o.n)(t),R)t.luma.caps[e]=z(t,e);return t.luma.caps}(this.gl);switch(t){case 36052:return e.webgl2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.webgl2?null:8;case 33297:return e.webgl2?null:5125;case 33296:return e.webgl2||e.EXT_sRGB?null:9729;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(t){return this.gl.bindFramebuffer(36160,t)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}}]),e}(q.a);gt.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];var mt,yt=function(t){function e(t,n){var r;return Object(g.a)(this,e),Object(o.d)(t),r=Object(U.a)(this,Object(V.a)(e).call(this,t,n)),Object.seal(Object(Q.a)(Object(Q.a)(r))),r}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){return Object(o.n)(t)}}]),Object(P.a)(e,[{key:"bind",value:function(t){return this.gl.bindSampler(t,this.handle),this}},{key:"unbind",value:function(t){return this.gl.bindSampler(t,null),this}},{key:"_createHandle",value:function(){return this.gl.createSampler()}},{key:"_deleteHandle",value:function(){this.gl.deleteSampler(this.handle)}},{key:"_getParameter",value:function(t){return this.gl.getSamplerParameter(this.handle,t)}},{key:"_setParameter",value:function(t,e){switch(t){case 33082:case 33083:this.gl.samplerParameterf(this.handle,t,e);break;default:this.gl.samplerParameteri(this.handle,t,e)}return this}}]),e}(q.a),_t=(mt={},Object(S.a)(mt,5126,function(t,e,n){return t.uniform1fv(e,Pt(n,1))}),Object(S.a)(mt,35664,function(t,e,n){return t.uniform2fv(e,Pt(n,2))}),Object(S.a)(mt,35665,function(t,e,n){return t.uniform3fv(e,Pt(n,3))}),Object(S.a)(mt,35666,function(t,e,n){return t.uniform4fv(e,Pt(n,4))}),Object(S.a)(mt,5124,function(t,e,n){return t.uniform1iv(e,Tt(n,1))}),Object(S.a)(mt,35667,function(t,e,n){return t.uniform2iv(e,Tt(n,2))}),Object(S.a)(mt,35668,function(t,e,n){return t.uniform3iv(e,Tt(n,3))}),Object(S.a)(mt,35669,function(t,e,n){return t.uniform4iv(e,Tt(n,4))}),Object(S.a)(mt,35670,function(t,e,n){return t.uniform1iv(e,Tt(n,1))}),Object(S.a)(mt,35671,function(t,e,n){return t.uniform2iv(e,Tt(n,2))}),Object(S.a)(mt,35672,function(t,e,n){return t.uniform3iv(e,Tt(n,3))}),Object(S.a)(mt,35673,function(t,e,n){return t.uniform4iv(e,Tt(n,4))}),Object(S.a)(mt,35674,function(t,e,n){return t.uniformMatrix2fv(e,!1,Pt(n,4))}),Object(S.a)(mt,35675,function(t,e,n){return t.uniformMatrix3fv(e,!1,Pt(n,9))}),Object(S.a)(mt,35676,function(t,e,n){return t.uniformMatrix4fv(e,!1,Pt(n,16))}),Object(S.a)(mt,35678,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,35680,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,5125,function(t,e,n){return t.uniform1uiv(e,At(n,1))}),Object(S.a)(mt,36294,function(t,e,n){return t.uniform2uiv(e,At(n,2))}),Object(S.a)(mt,36295,function(t,e,n){return t.uniform3uiv(e,At(n,3))}),Object(S.a)(mt,36296,function(t,e,n){return t.uniform4uiv(e,At(n,4))}),Object(S.a)(mt,35685,function(t,e,n){return t.uniformMatrix2x3fv(e,!1,Pt(n,6))}),Object(S.a)(mt,35686,function(t,e,n){return t.uniformMatrix2x4fv(e,!1,Pt(n,8))}),Object(S.a)(mt,35687,function(t,e,n){return t.uniformMatrix3x2fv(e,!1,Pt(n,6))}),Object(S.a)(mt,35688,function(t,e,n){return t.uniformMatrix3x4fv(e,!1,Pt(n,12))}),Object(S.a)(mt,35689,function(t,e,n){return t.uniformMatrix4x2fv(e,!1,Pt(n,8))}),Object(S.a)(mt,35690,function(t,e,n){return t.uniformMatrix4x3fv(e,!1,Pt(n,12))}),Object(S.a)(mt,35679,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,35682,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36289,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36292,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36293,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36298,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36299,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36300,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36303,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36306,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36307,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36308,function(t,e,n){return t.uniform1i(e,n)}),Object(S.a)(mt,36311,function(t,e,n){return t.uniform1i(e,n)}),mt),bt={},xt={},wt={},Et=[0];function St(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(Et[0]=t,t=Et);var i=t.length;if(i%e&&l.g.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;var o=r[i];o||(o=new n(i),r[i]=o);for(var a=0;a<i;a++)o[a]=t[a];return o}function Pt(t,e){return St(t,e,Float32Array,bt)}function Tt(t,e){return St(t,e,Int32Array,xt)}function At(t,e){return St(t,e,Uint32Array,wt)}function kt(t){var e=t.match(/([^\[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function Ct(t,e,n){var r=_t[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r.bind(null,t,e)}function Ot(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;for(var e=Math.min(t.length,16),n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof $.a||t instanceof yt||(t instanceof it||t instanceof gt&&Boolean(t.texture))))}function Mt(t,e){if(Array.isArray(t)||ArrayBuffer.isView(t)){if(!e)return!1;var n=t.length;if(e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return t===e}var It,Lt=n(50),Rt=5120,jt=5121,zt=5122,Dt=5123,Ft=0,Nt=1,Bt=2,Ut=3,Vt=4,Gt=5,qt=6,Wt=5126,Zt=(It={},Object(S.a)(It,Wt,[Wt,1,"float"]),Object(S.a)(It,35664,[Wt,2,"vec2"]),Object(S.a)(It,35665,[Wt,3,"vec3"]),Object(S.a)(It,35666,[Wt,4,"vec4"]),Object(S.a)(It,5124,[5124,1,"int"]),Object(S.a)(It,35667,[5124,2,"ivec2"]),Object(S.a)(It,35668,[5124,3,"ivec3"]),Object(S.a)(It,35669,[5124,4,"ivec4"]),Object(S.a)(It,5125,[5125,1,"uint"]),Object(S.a)(It,36294,[5125,2,"uvec2"]),Object(S.a)(It,36295,[5125,3,"uvec3"]),Object(S.a)(It,36296,[5125,4,"uvec4"]),Object(S.a)(It,35670,[Wt,1,"bool"]),Object(S.a)(It,35671,[Wt,2,"bvec2"]),Object(S.a)(It,35672,[Wt,3,"bvec3"]),Object(S.a)(It,35673,[Wt,4,"bvec4"]),Object(S.a)(It,35674,[Wt,8,"mat2"]),Object(S.a)(It,35685,[Wt,8,"mat2x3"]),Object(S.a)(It,35686,[Wt,8,"mat2x4"]),Object(S.a)(It,35675,[Wt,12,"mat3"]),Object(S.a)(It,35687,[Wt,12,"mat3x2"]),Object(S.a)(It,35688,[Wt,12,"mat3x4"]),Object(S.a)(It,35676,[Wt,16,"mat4"]),Object(S.a)(It,35689,[Wt,16,"mat4x2"]),Object(S.a)(It,35690,[Wt,16,"mat4x3"]),It);function Xt(t){switch(t){case Ft:return Ft;case Nt:case Ut:case Bt:return Nt;case Vt:case Gt:case qt:return Vt;default:return Object(k.a)(!1),0}}function Ht(t){var e=Zt[t];if(!e)return null;var n=Object(tt.a)(e,2);return{type:n[0],components:n[1]}}function Yt(t,e){switch(t){case Rt:case jt:case zt:case Dt:t=Wt}for(var n in Zt){var r=Object(tt.a)(Zt[n],3),i=r[0],o=r[1],a=r[2];if(i===t&&o===e)return{glType:n,name:a}}return null}var Kt=function(){function t(e){Object(g.a)(this,t),this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}return Object(P.a)(t,[{key:"getAttributeInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.attributeInfos[e]:this.attributeInfosByName[t]||null}},{key:"getAttributeLocation",value:function(t){var e=this.getAttributeInfo(t);return e?e.location:-1}},{key:"getAttributeAccessor",value:function(t){var e=this.getAttributeInfo(t);return e?e.accessor:null}},{key:"getVaryingInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}},{key:"getVaryingIndex",value:function(t){var e=this.getVaryingInfo();return e?e.location:-1}},{key:"getVaryingAccessor",value:function(t){var e=this.getVaryingInfo();return e?e.accessor:null}},{key:"_readAttributesFromProgram",value:function(t){for(var e=t.gl,n=e.getProgramParameter(t.handle,35721),r=0;r<n;r++){var i=e.getActiveAttrib(t.handle,r),o=i.name,a=i.type,s=i.size,u=e.getAttribLocation(t.handle,o);this._addAttribute(u,o,a,s)}this.attributeInfos.sort(function(t,e){return t.location-e.location})}},{key:"_readVaryingsFromProgram",value:function(t){var e=t.gl;if(Object(o.n)(e)){for(var n=e.getProgramParameter(t.handle,35971),r=0;r<n;r++){var i=e.getTransformFeedbackVarying(t.handle,r),a=i.name,s=i.type,u=i.size;this._addVarying(r,a,s,u)}this.varyingInfos.sort(function(t,e){return t.location-e.location})}}},{key:"_addAttribute",value:function(t,e,n,r){var i=Ht(n),o={type:i.type,size:r*i.components};this._inferProperties(t,e,o);var a={location:t,name:e,accessor:new Lt.a(o)};this.attributeInfos.push(a),this.attributeInfosByName[a.name]=a}},{key:"_inferProperties",value:function(t,e,n){/instance/i.test(e)&&(n.divisor=1)}},{key:"_addVarying",value:function(t,e,n,r){var i=Ht(n),o=i.type,a=i.components,s={location:t,name:e,accessor:new Lt.a({type:o,size:r*a})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}]),t}(),Jt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(V.a)(e).call(this,t,r))).stubRemovedMethods("Program","v6.0",["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"]),n._isCached=!1,n.initialize(r),Object.seal(Object(Q.a)(Object(Q.a)(n))),n._setId(r.id),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vs,n=t.fs,r=t.varyings,i=t.bufferMode,a=void 0===i?35981:i;return this.vs="string"==typeof e?new Y(this.gl,{id:"".concat(t.id,"-vs"),source:e}):e,this.fs="string"==typeof n?new K(this.gl,{id:"".concat(t.id,"-fs"),source:n}):n,Object(k.a)(this.vs instanceof Y),Object(k.a)(this.fs instanceof K),this.uniforms={},this.samplers={},r&&(Object(o.d)(this.gl),this.varyings=r,this.gl.transformFeedbackVaryings(this.handle,r,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Kt(this),this.setProps(t)}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:Object(J.a)(Object(V.a)(e.prototype),"delete",this).call(this,t)}},{key:"setProps",value:function(t){return"uniforms"in t&&this.setUniforms(t.uniforms,t.samplers),this}},{key:"draw",value:function(t){var e=this,n=t.logPriority,r=t.drawMode,a=void 0===r?4:r,s=t.vertexCount,u=t.offset,c=void 0===u?0:u,f=t.start,h=t.end,p=t.isIndexed,d=void 0!==p&&p,v=t.indexType,g=void 0===v?5123:v,m=t.isInstanced,y=void 0!==m&&m,_=t.instanceCount,b=void 0===_?0:_,x=t.vertexArray,w=void 0===x?null:x,E=t.transformFeedback,S=t.framebuffer,P=t.parameters,T=void 0===P?{}:P,A=t.uniforms,C=void 0===A?{}:A,O=t.samplers,M=void 0===O?{}:O;if(void 0!==n){var I=S?S.id:"default",R="mode=".concat(Object(i.a)(this.gl,a)," verts=").concat(s," ")+"instances=".concat(b," indexType=").concat(Object(i.a)(this.gl,g)," ")+"isInstanced=".concat(y," isIndexed=").concat(d," ")+"Framebuffer=".concat(I);l.g.log(n,R)()}return this.gl.useProgram(this.handle),Object(k.a)(w),w.bindForDraw(s,b,function(){if(C&&(l.g.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)"),e.setUniforms(C,M)),void 0!==S&&(T=Object.assign({},T,{framebuffer:S})),E){var t=Xt(a);E.begin(t)}Object(L.c)(e.gl,T,function(){d&&y?e.gl.drawElementsInstanced(a,s,g,c,b):d&&Object(o.n)(e.gl)&&!isNaN(f)&&!isNaN(h)?e.gl.drawRangeElements(a,f,h,s,g,c):d?e.gl.drawElements(a,s,g,c):y?e.gl.drawArraysInstanced(a,c,s,b):e.gl.drawArrays(a,c,s)}),E&&E.end()}),this}},{key:"setSamplers",value:function(t){Object.assign(this.samplers,t)}},{key:"setUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=!1;for(var i in t)if(!Mt(this.uniforms[i],t[i])){r=!0;break}return r&&(n(),function(t,e,n){for(var r in t){var i=t[r];if((!n||Boolean(n[r]))&&!Ot(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}}(t,this.id,this._uniformSetters),Object.assign(this.uniforms,t),Object.assign(this.samplers,e)),this._setUniforms(this.uniforms,this.samplers),this}},{key:"_setUniforms",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in this.gl.useProgram(this.handle),t){var r=t[n],i=this._uniformSetters[n],o=e[n];if(i)if(r instanceof gt&&(r=r.texture),r instanceof $.a){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);var a=r,s=i.textureIndex;a.bind(s),o&&o.bind(s),i(s)}else i(r)}return this}},{key:"_createHandle",value:function(){return this.gl.createProgram()}},{key:"_deleteHandle",value:function(){this.gl.deleteProgram(this.handle)}},{key:"_getOptionsFromHandle",value:function(t){var e=this.gl.getAttachedShaders(t),n={},r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Y({handle:u});break;case 35632:n.fs=new K({handle:u})}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"_getParameter",value:function(t){return this.gl.getProgramParameter(this.handle,t)}},{key:"_setId",value:function(t){if(!t){var e=this._getName();this.id=Object(l.i)(e)}}},{key:"_getName",value:function(){var t=this.vs.getName()||this.fs.getName();return t=(t=t.replace(/shader/i,""))?"".concat(t,"-program"):"program"}},{key:"_compileAndLink",value:function(){var t=this.gl;if((t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),l.g.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),l.g.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||l.g.priority>0)&&(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35714)))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)))}},{key:"_readUniformLocationsFromLinkedProgram",value:function(){var t=this.gl;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(var e=0;e<this._uniformCount;e++){var n=this.gl.getActiveUniform(this.handle,e),r=kt(n.name),i=r.name,o=(r.isArray,t.getUniformLocation(this.handle,i));this._uniformSetters[i]=Ct(t,o,n)}this._textureIndexCounter=0}},{key:"reset",value:function(){}},{key:"getActiveUniforms",value:function(t,e){return this.gl.getActiveUniforms(this.handle,t,e)}},{key:"getUniformBlockIndex",value:function(t){return this.gl.getUniformBlockIndex(this.handle,t)}},{key:"getActiveUniformBlockParameter",value:function(t,e){return this.gl.getActiveUniformBlockParameter(this.handle,t,e)}},{key:"uniformBlockBinding",value:function(t,e){this.gl.uniformBlockBinding(this.handle,t,e)}}]),e}(q.a),Qt=(n(110),q.a,function(t){return t}),$t=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,e),n=Object(U.a)(this,Object(V.a)(e).call(this,t,r));var i=r.onComplete,o=void 0===i?Qt:i,a=r.onError,s=void 0===a?Qt:a;return n.target=null,n.onComplete=o,n.onError=s,n.promise=null,Object.seal(Object(Q.a)(Object(Q.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(o.n)(t),r=F(t,j.TIMER_QUERY),i=n||r,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){switch(c.value){case"queries":i=i&&n;break;case"timers":i=i&&r;break;case"timestamps":var f=r?t.getQuery(36392,34916):0;i=i&&f>0;break;default:Object(k.a)(!1)}}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return i}}]),Object(P.a)(e,[{key:"beginTimeElapsedQuery",value:function(){return this.begin(35007)}},{key:"beginOcclusionQuery",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).conservative,e=void 0!==t&&t;return this.begin(e?36202:35887)}},{key:"beginTransformFeedbackQuery",value:function(){return this.begin(35976)}},{key:"getTimestamp",value:function(){A.beginQuery(this,this.onComplete,this.onError);try{this.gl.queryCounter(this.handle,36392)}catch(t){A.rejectQuery(this,'Timer queries require "EXT_disjoint_timer_query" extension')}return this}},{key:"begin",value:function(t){A.beginQuery(this,this.onComplete,this.onError),this.target=t;try{this.gl.beginQuery(this.target,this.handle)}catch(t){A.rejectQuery(this,"Query not supported")}return this}},{key:"end",value:function(){return this.target&&(this.ext.endQuery(this.target),this.target=null),this}},{key:"cancel",value:function(){return this.end(),A.cancelQuery(this),this}},{key:"isResultAvailable",value:function(){return this.gl.getQueryParameter(this.handle,34919)}},{key:"getResult",value:function(){var t=this.gl.getQueryParameter(this.handle,34918);return Number.isFinite(t)?t/1e6:0}},{key:"_createHandle",value:function(){return e.isSupported(this.gl)?this.gl.createQuery():null}},{key:"_deleteHandle",value:function(){A.deleteQuery(this),this.gl.deleteQuery(this.handle)}}],[{key:"poll",value:function(t){A.poll(t)}}]),e}(q.a);A.setInvalidator({queryType:$t,errorMessage:"Disjoint GPU operation invalidated timer queries",checkInvalid:function(t){return t.getParameter(36795)}});n(142),$.a;var te=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),Object(o.d)(t),(n=Object(U.a)(this,Object(V.a)(e).call(this,t,r))).initialize(r),n.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(Object(Q.a)(Object(Q.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){return Object(o.n)(t)}}]),Object(P.a)(e,[{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Object(l.d)(this.buffers)||this.bind(function(){return t._unbindBuffers()}),this.setProps(e),this}},{key:"setProps",value:function(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}},{key:"setBuffers",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(function(){for(var n in e)t.setBuffer(n,e[n])}),this}},{key:"setBuffer",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this._getVaryingIndex(t);return o<0?(this.unused[t]=e,l.g.warn(function(){return"".concat(r.id," unused varying buffer ").concat(t)})(),this):(this.buffers[o]=e,this.bindOnUse||this._bindBuffer(o,e,n,i),this)}},{key:"begin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}},{key:"end",value:function(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}},{key:"_getVaryingInfo",value:function(t){return this.configuration&&this.configuration.getVaryingInfo(t)}},{key:"_getVaryingIndex",value:function(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_bindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers)this._bindBuffer(t,this.buffers[t])}},{key:"_unbindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers)this._bindBuffer(t,null)}},{key:"_bindBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}},{key:"_createHandle",value:function(){return this.gl.createTransformFeedback()}},{key:"_deleteHandle",value:function(){this.gl.deleteTransformFeedback(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindTransformFeedback(36386,this.handle)}}]),e}(q.a),ee=null;function ne(t,e){return new t(function(t){return(!ee||ee.byteLength<t)&&(ee=new ArrayBuffer(t)),ee}(t.BYTES_PER_ELEMENT*e),0,e)}var re=n(47),ie=n(143),oe=n(144);var ae=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,e);var i=r.id||r.program&&r.program.id;return(n=Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({},r,{id:i})))).hasVertexArrays=e.isSupported(t),n.buffer=null,n.bufferValue=null,n.initialize(r),Object.seal(Object(Q.a)(Object(Q.a)(n))),n}return Object(G.a)(e,t),Object(P.a)(e,null,[{key:"isSupported",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero?Object(o.n)(t)||"Chrome"===function(t){if(!t&&!Object(ie.a)())return"Node";if(Object(oe.a)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i?"IE":re.b.chrome?"Chrome":re.b.safari?"Safari":re.b.mozInnerScreenX?"Firefox":"Unknown"}():Object(o.n)(t)||t.getExtension("OES_vertex_array_object")}},{key:"getDefaultArray",value:function(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new e(t,{handle:null})),t.luma.defaultVertexArray}},{key:"getMaxAttributes",value:function(t){return e.MAX_ATTRIBUTES=e.MAX_ATTRIBUTES||t.getParameter(34921),e.MAX_ATTRIBUTES}},{key:"setConstant",value:function(t,n,r){switch(r.constructor){case Float32Array:e._setConstantFloatArray(t,n,r);break;case Int32Array:e._setConstantIntArray(t,n,r);break;case Uint32Array:e._setConstantUintArray(t,n,r);break;default:Object(l.a)(!1)}}}]),Object(P.a)(e,[{key:"delete",value:function(){Object(J.a)(Object(V.a)(e.prototype),"delete",this).call(this),this.buffer&&this.buffer.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}},{key:"setProps",value:function(t){return this}},{key:"setElementBuffer",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l.a)(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(function(){t.gl.bindBuffer(34963,e?e.handle:null)}),this}},{key:"setBuffer",value:function(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);var r=n.size,i=n.type,a=n.stride,s=n.offset,u=n.normalized,c=n.integer,f=n.divisor,h=this.gl;return t=Number(t),this.bind(function(){h.bindBuffer(34962,e.handle),c?(Object(l.a)(Object(o.n)(h)),h.vertexAttribIPointer(t,r,i,a,s)):h.vertexAttribPointer(t,r,i,u,a,s),h.enableVertexAttribArray(t),h.vertexAttribDivisor(t,f||0)}),this}},{key:"enable",value:function(t){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!r&&0===t&&!e.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(function(){return r?n.gl.enableVertexAttribArray(t):n.gl.disableVertexAttribArray(t)})),this}},{key:"getConstantBuffer",value:function(t,e,n){var r=this._normalizeConstantArrayValue(e,n),i=r.byteLength*t,o=r.length*t,a=!this.buffer;if(this.buffer=this.buffer||new B.a(this.gl,i),a=(a=a||this.buffer.setByteLength(i))||!this._compareConstantArrayValues(r,this.bufferValue)){var s=ne(e.constructor,o);!function(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u)}({target:s,source:r,start:0,count:o}),this.buffer.subData(s),this.bufferValue=e}return this.buffer}},{key:"_normalizeConstantArrayValue",value:function(t,e){return Array.isArray(t)?new Float32Array(t):t}},{key:"_compareConstantArrayValues",value:function(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}},{key:"_createHandle",value:function(){return this.hasVertexArrays=e.isSupported(this.gl),this.hasVertexArrays?this.gl.createVertexArray():null}},{key:"_deleteHandle",value:function(t){return this.hasVertexArrays&&this.gl.deleteVertexArray(t),[this.elements]}},{key:"_bindHandle",value:function(t){this.hasVertexArrays&&this.gl.bindVertexArray(t)}},{key:"_getParameter",value:function(t,e){var n=this,r=e.location;return Object(l.a)(Number.isFinite(r)),this.bind(function(){switch(t){case 34373:return n.gl.getVertexAttribOffset(r,t);default:return n.gl.getVertexAttrib(r,t)}})}},{key:"MAX_ATTRIBUTES",get:function(){return e.getMaxAttributes(this.gl)}}],[{key:"_setConstantFloatArray",value:function(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Object(l.a)(!1)}}},{key:"_setConstantIntArray",value:function(t,e,n){switch(Object(l.a)(Object(o.n)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Object(l.a)(!1)}}},{key:"_setConstantUintArray",value:function(t,e,n){switch(Object(l.a)(Object(o.n)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Object(l.a)(!1)}}}]),e}(q.a),se=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,t);var r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.vertexArrayObject=ae.isSupported(e)?new ae(e):ae.getDefaultArray(e),Object(l.h)(this,"VertexArray","v6.0",["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"]),this.initialize(n),Object.seal(this)}return Object(P.a)(t,[{key:"delete",value:function(){this.buffer&&this.buffer.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}},{key:"reset",value:function(){this.elements=null;var t=this.vertexArrayObject.MAX_ATTRIBUTES;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}},{key:"setProps",value:function(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}},{key:"clearDrawParams",value:function(){this.drawParams=null}},{key:"getDrawParams",value:function(t){return this.drawParams=this.drawParams||this._updateDrawParams(),Object.assign({},this.drawParams,t)}},{key:"setAttributes",value:function(t){var e=this;return this.vertexArrayObject.bind(function(){for(var n in t){var r=t[n];if(r instanceof B.a)e.setBuffer(n,r);else if(Array.isArray(r)&&r.length&&r[0]instanceof B.a){var i=r[0],o=r[1];e.setBuffer(n,i,o)}else{if(!ArrayBuffer.isView(r)&&!Array.isArray(r))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");e.setConstant(n,r)}}e.gl.bindBuffer(34962,null)}),this}},{key:"setElementBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setElementBuffer(t,e),this}},{key:"setBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e);var r=this._resolveLocationAndAccessor(t,e,e.accessor,n),i=r.location,o=r.accessor;return i>=0&&(this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setBuffer(i,e,o)),this}},{key:"setConstant",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._resolveLocationAndAccessor(t,e,n),i=r.location,o=r.accessor;return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e,o),this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.enable(i,!1)),this}},{key:"unbindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind(function(){t.elements&&t.setElementBuffer(null),t.buffer=t.buffer||new B.a(t.gl,{size:4});for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++)t.values[e]instanceof B.a&&(t.gl.disableVertexAttribArray(e),t.gl.bindBuffer(34962,t.buffer.handle),t.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}},{key:"bindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind(function(){t.elements&&t.setElementBuffer(t.elements);for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++){var n=t.values[e];n instanceof B.a&&t.setBuffer(e,n)}}),this}},{key:"bindForDraw",value:function(t,e,n){var r,i=this;return this.vertexArrayObject.bind(function(){i._setConstantAttributes(t,e),i.vertexArrayObject.hasVertexArrays||i.bindBuffers(),r=n(),i.vertexArrayObject.hasVertexArrays||i.unbindBuffers()}),r}},{key:"_resolveLocationAndAccessor",value:function(t,e,n,r){var i=this,o=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,l.g.once(3,function(){return"unused value ".concat(t," in ").concat(i.id)})(),this;var a=this._getAttributeInfo(t),s=Lt.a.resolve(a.accessor,n,r),u=s.size,c=s.type;return Object(l.a)(Number.isFinite(u)&&Number.isFinite(c)),{location:o,accessor:s}}},{key:"_getAttributeInfo",value:function(t){return this.configuration&&this.configuration.getAttributeInfo(t)}},{key:"_getAttributeIndex",value:function(t){if(this.configuration)return this.configuration.getAttributeLocation(t);var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_setConstantAttributes",value:function(t,e){var n=Math.max(0|t,0|e),r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(var i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}},{key:"_setConstantAttributeZero",value:function(t,e){if(ae.isSupported(this.gl,{constantAttributeZero:!0}))this._setConstantAttribute(0,t);else{var n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}}},{key:"_setConstantAttribute",value:function(t,e){ae.setConstant(this.gl,t,e),this.vertexArrayObject.isDefault&&this.vertexArrayObject.enable(t,!1)}},{key:"_updateDrawParams",value:function(){for(var t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0},e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elements.accessor.type),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}},{key:"_updateDrawParamsForLocation",value:function(t,e){var n=this.values[e],r=this.accessors[e];if(n){var i=r.divisor>0;if(t.isInstanced=t.isInstanced||i,n instanceof B.a){var o=n;if(i){var a=o.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,a)}else{var s=o.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,s)}}}}},{key:"setElements",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.g.deprecated("setElements","setElementBuffer"),this.setElementBuffer(t,e)}}]),t}(),ue=n(221),ce=n(568),le=function(){function t(e){var n=e.id;e.display;Object(g.a)(this,t),this.id=n||Object(l.i)(this.constructor.name),this.display=!0,this.position=new ue.a,this.rotation=new ue.a,this.scale=new ue.a(1,1,1),this.matrix=new ce.a,this.userData={}}return Object(P.a)(t,[{key:"toString",value:function(){return"{id: ".concat(this.id,", children: ").concat(this.children,")}")}},{key:"setPosition",value:function(t){return Object(k.a)(3===t.length,"setPosition requires vector argument"),this.position=t,this}},{key:"setRotation",value:function(t){return Object(k.a)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}},{key:"setScale",value:function(t){return Object(k.a)(3===t.length,"setScale requires vector argument"),this.scale=t,this}},{key:"setMatrixComponents",value:function(t){var e=t.position,n=t.rotation,r=t.scale,i=t.update,o=void 0===i||i;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),o&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.position,n=t.rotation,r=t.scale;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(t,e){Object(k.a)(t),e=e||this.matrix;var n=new ce.a(t).multiplyRight(e),r=n.invert();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:r.transpose()}}},{key:"transform",value:function(){if(this.parent){var t=this.parent;this.endPosition.set(this.position.add(t.endPosition)),this.endRotation.set(this.rotation.add(t.endRotation)),this.endScale.set(this.scale.add(t.endScale))}else this.endPosition.set(this.position),this.endRotation.set(this.rotation),this.endScale.set(this.scale);for(var e=this.children,n=0;n<e.length;++n)e[n].transform();return this}}]),t}(),fe=(n(22),function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,t);var r=n.id,i=void 0===r?Object(l.i)("attribute"):r,o=n.type,a=n.isIndexed,s=void 0!==a&&a;this.gl=e,this.id=i,this.isIndexed=s,this.target=s?34963:34962,this.type=o,this.value=null,this.externalBuffer=null,this.buffer=null,this.userData={},this.update(n),Object.seal(this),this._validateAttributeDefinition()}return Object(P.a)(t,[{key:"delete",value:function(){this.buffer&&(this.buffer.delete(),this.buffer=null)}},{key:"update",value:function(t){var e=t.value,n=t.buffer,r=t.constant,i=void 0===r?this.constant||!1:r;this.constant=i,n?(this.externalBuffer=n,this.constant=!1,this.type=n.accessor.type,void 0!==n.accessor.divisor&&(this.divisor=n.accessor.divisor)):e&&(this.externalBuffer=null,this.value=e,i||(this.buffer=this.buffer||new B.a(this.gl,Object.assign({},t,{id:this.id,target:this.target,type:this.type})),this.buffer.setData({data:e}),this.type=this.buffer.accessor.type)),this._setAccessor(t)}},{key:"getBuffer",value:function(){return this.constant?null:this.externalBuffer||this.buffer}},{key:"getValue",value:function(){if(this.constant)return this.value;var t=this.externalBuffer||this.buffer;return t?[t,this]:null}},{key:"_setAccessor",value:function(t){var e=t.size,n=void 0===e?this.size:e,r=t.offset,i=void 0===r?this.offset||0:r,o=t.stride,a=void 0===o?this.stride||0:o,s=t.normalized,u=void 0===s?this.normalized||!1:s,c=t.integer,f=void 0===c?this.integer||!1:c,h=t.divisor,p=void 0===h?this.divisor||0:h,d=t.instanced,v=t.isInstanced;this.size=n,this.offset=i,this.stride=a,this.normalized=u,this.integer=f,this.divisor=p,void 0!==v&&(l.g.deprecated("Attribute.isInstanced"),this.divisor=v?1:0),void 0!==d&&(l.g.deprecated("Attribute.instanced"),this.divisor=d?1:0)}},{key:"_validateAttributeDefinition",value:function(){}}]),t}()),he={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};function pe(t){var e="string"==typeof t?he[t]||he.TRIANGLES:t;return Object(k.a)(e>=0&&e<=he.TRIANGLE_FAN,"Illegal drawMode"),e}var de=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,t);var n=e.id,r=e.drawMode,i=void 0===r?he.TRIANGLES:r,o=e.vertexCount,a=void 0===o?void 0:o,s=e.attributes;this.id=n||Object(l.i)(this.constructor.name),this.drawMode=pe(i),this.vertexCount=a,this.attributes={},this.needsRedraw=!0,this.userData={},Object.seal(this),s&&this.setAttributes(s)}return Object(P.a)(t,[{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=t,this}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t,n=!1;return n=n||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!e,n}},{key:"setVertexCount",value:function(t){this.vertexCount=t}},{key:"getVertexCount",value:function(){return void 0!==this.vertexCount?this.vertexCount:this.attributes.indices?this.attributes.indices.value.length:this.attributes.vertices?this.attributes.vertices.value.length/3:!!this.attributes.positions&&this.attributes.positions.value.length/3}},{key:"hasAttribute",value:function(t){return Boolean(this.attributes[t])}},{key:"getAttribute",value:function(t){var e=this.attributes[t];return Object(k.a)(e),e.value}},{key:"getArray",value:function(t){var e=this.attributes[t];return Object(k.a)(e),e.value}},{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(t){for(var e in t){var n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,Object(k.a)(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),this._autoDetectAttribute(e,n),this.attributes[e]=n}return this.setNeedsRedraw(),this}},{key:"_autoDetectAttribute",value:function(t,e){var n;switch(t){case"indices":n=n||"indices";break;case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break;case"indices":e.size=e.size||1,e.isIndexed=void 0===e.isIndexed||e.isIndexed,Object(k.a)(e.value instanceof Uint16Array||e.value instanceof Uint32Array,'attribute array for "indices" must be of integer type')}Object(k.a)(e.size,"attribute ".concat(t," needs size"))}},{key:"_print",value:function(t){return"Geometry ".concat(this.id," attribute ").concat(t)}}]),t}(),ve="#define SHADER_NAME luma_modular_vertex\n\n// object attributes\nattribute vec3 positions;\nattribute vec3 normals;\nattribute vec4 colors;\nattribute vec2 texCoords;\nattribute vec3 pickingColors;\n\nvoid main(void) {\n\n  // Set up position\n#ifdef MODULE_GEOMETRY\n  geometry_setPosition(positions);\n  geometry_setNormal(normals);\n#endif\n\n#ifdef MODULE_PROJECT\n  project_setPositionAndNormal_Model(positions, normals);\n  gl_Position = project_model_to_clipspace(positions);\n#endif\n\n  // Set up depth\n#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n\n#ifdef MODULE_DIFFUSE\n  diffuse_setTextureCoordinate(texCoords);\n#endif\n\n  // Set up color calculations\n#ifdef MODULE_MATERIAL\n  material_setDiffuseColor(colors);\n  material_setDiffuseTextureCoordinates(texCoords);\n#endif\n\n#ifdef MODULE_LIGHTING\n  lighting_setPositionAndNormal(positions, normals);\n  lighting_apply_light(positions);\n  lighting_apply_reflection(positions);\n#endif\n\n#ifdef MODULE_PICKING\n  picking_setPickingColor(pickingColors);\n#endif\n\n}\n",ge="#define SHADER_NAME luma-modular-fragment\n\nprecision highp float;\n\n// varyings\nvarying vec4 vColor;\n\nvoid main(){\n  gl_FragColor = vec4(1., 0., 1., 1.);\n\n#ifdef MODULE_DIFFUSE\n  gl_FragColor = diffuse_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth(gl_Position);\n#endif\n}\n",me="vs",ye="fs";function _e(t,e,n){switch(e){case 300:return n?function(t){return t.replace(/attribute\s+/g,"in ").replace(/varying\s+/g,"out ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(+/g,"texture(")}(t):function(t){return t.replace(/varying\s+/g,"in ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(/g,"texture(")}(t);case 100:return n?function(t){return t.replace(/^in\s+/gm,"attribute ").replace(/^out\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(t):function(t){return t.replace(/^in\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(t);default:throw new Error("unknown GLSL version ".concat(e))}}function be(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}var xe=function(){function t(e){var n=e.name,r=e.vs,i=e.fs,o=e.dependencies,a=void 0===o?[]:o,s=e.getUniforms,u=void 0===s?function(){return{}}:s,c=e.deprecations,l=void 0===c?[]:c,f=e.vertexShader,h=e.fragmentShader;Object(g.a)(this,t),be("string"==typeof n),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=u,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(l)}return Object(P.a)(t,[{key:"getModuleSource",value:function(t,e){var n;switch(t){case"vs":n=_e(this.vs||"",e,!0);break;case"fs":n=_e(this.fs||"",e,!1);break;default:be(!1)}return"string"!=typeof n?"":"#define MODULE_".concat(this.name.toUpperCase(),"\n").concat(n,"// END MODULE_").concat(this.name,"\n\n")}},{key:"getUniforms",value:function(t,e){return this.getModuleUniforms(t,e)}},{key:"checkDeprecations",value:function(t,e){this.deprecations.forEach(function(n){n.regex.test(t)&&(n.deprecated&&e?e.deprecated(n.old,n.new)():e&&e.removed(n.old,n.new)())})}},{key:"_parseDeprecationDefinitions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.forEach(function(t){switch(t.type){case"function":t.regex=new RegExp("\\b".concat(t.old,"\\("));break;default:t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))}}),t}}]),t}(),we=new(function(){function t(){Object(g.a)(this,t),this.shaderModules={},this.defaultShaderModules=[]}return Object(P.a)(t,[{key:"setDefaultShaderModules",value:function(t){this.defaultShaderModules=this.resolveModules(t)}},{key:"registerShaderModules",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreMultipleRegistrations,n=void 0!==e&&e,r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;this._registerShaderModule(u,n)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}},{key:"getShaderModule",value:function(t){if(t instanceof xe)return t;if("string"!=typeof t)return this._registerShaderModule(t,!0);var e=this.shaderModules[t];return e||be(!1,"Unknown shader module ".concat(t)),e}},{key:"resolveModules",value:function(t){var e=this;return t.map(function(t){return e.getShaderModule(t)})}},{key:"_registerShaderModule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t instanceof xe)return t;if(be(t.name,"shader module has no name"),this.shaderModules[t.name]&&!e)throw new Error("shader module ".concat(t.name," already registered"));return(t=new xe(t)).dependencies=this.resolveModules(t.dependencies),this.shaderModules[t.name]=t,this.shaderModules[t.name]}}]),t}());function Ee(t){we.setDefaultShaderModules(t)}function Se(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreMultipleRegistrations,n=void 0!==e&&e;we.registerShaderModules(t,{ignoreMultipleRegistrations:n})}function Pe(t){return we.getShaderModule(t)}function Te(t){var e={},n={};return Ae({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(function(t,e){return n[e]-n[t]}).map(function(t){return e[t]})}function Ae(t){var e=t.modules,n=t.level,r=t.moduleMap,i=t.moduleDepth;if(n>=5)throw new Error("Possible loop in shader dependency graph");var o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l.name]=l,(void 0===i[l.name]||i[l.name]<n)&&(i[l.name]=n)}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var f=!0,h=!1,p=void 0;try{for(var d,v=e[Symbol.iterator]();!(f=(d=v.next()).done);f=!0){var g=d.value;g.dependencies&&Ae({modules:g.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}}catch(t){h=!0,p=t}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}var ke=32874,Ce=7936,Oe=7937,Me=7938,Ie=35724,Le={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Re={};Object.keys(Le).forEach(function(t){Re[t]=t});var je={};function ze(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Le[e];if(be(r,e),!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(e in je)return je[e];var i=r[0],o="#extension GL_".concat(i," : enable\nvoid main(void) {}"),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);var s=t.getShaderParameter(a,35713);return t.deleteShader(a),je[e]=s,s}function De(t,e){var n=Le[e];be(n,e);var r=function(t){return Boolean(t&&("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||32874===ke))}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return be(!1===i||!0===i),i}function Fe(t,e){return(e=Array.isArray(e)?e:[e]).every(function(e){return De(t,e)})}function Ne(t){switch(function(t){var e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Ce),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Oe);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:t.getParameter(Me),shadingLanguageVersion:t.getParameter(Ie)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}var Be,Ue,Ve=n(37),Ge=n.n(Ve),qe=(Be={},Object(S.a)(Be,me,"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n"),Object(S.a)(Be,ye,"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"),Be),We=/^(#version[^\n]*\n)?/,Ze=/main\s*\([^\)]*\)\s*\{\n?/,Xe=/}\n?[^{}]*$/;function He(t){var e={};return Ge()(Array.isArray(t)&&t.length>1),t.forEach(function(t){for(var n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]}),e}var Ye=(Ue={},Object(S.a)(Ue,me,"vertex"),Object(S.a)(Ue,ye,"fragment"),Ue),Ke="precision highp float;\n\n";function Je(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.vs,r=e.fs,i=function(t){return t=t.concat(we.defaultShaderModules),Te(t=we.resolveModules(t))}(e.modules||[]);return{gl:t,vs:Qe(t,Object.assign({},e,{source:n,type:me,modules:i})),fs:Qe(t,Object.assign({},e,{source:r,type:ye,modules:i})),getUniforms:function(t){return function(e){var n={},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=u.getUniforms(e,n);Object.assign(n,c)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(i),modules:function(t){var e={},n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=Pe(s);e[s]=u}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}(i)}}function Qe(t,e){var n=e.id,r=e.source,i=e.type,o=e.modules,a=void 0===o?[]:o,s=e.defines,u=void 0===s?{}:s,c=e.inject,l=void 0===c?{}:c,f=e.prologue,h=void 0===f||f,p=e.log;be("string"==typeof r,"shader source must be a string");var d=i===me,v=r.split("\n"),g=100,m="",y=r;0===v[0].indexOf("#version ")&&(g=300,m=v[0],y=v.slice(1).join("\n"));var _=h?"".concat(m,"\n").concat(function(t){var e=t.id,n=t.source,r=t.type;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(Ye[r],"\n\n"):""}({id:n,source:r,type:i}),"\n").concat(Ne(t),"\n").concat(function(t,e,n){var r="#if (__VERSION__ > 120)\n\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Fe(t,Re.GLSL_FRAG_DEPTH)&&(r+="// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Fe(t,Re.GLSL_DERIVATIVES)&&ze(t,Re.GLSL_DERIVATIVES)&&(r+="// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define DERIVATIVES\n#endif\n"),Fe(t,Re.GLSL_FRAG_DATA)&&(r+="// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define DRAW_BUFFERS\n#endif\n"),Fe(t,Re.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n# define TEXTURE_LOD\n#define texture2DLod texture2DLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define textureCubeLod textureCubeLodEXT\n#define texture2DGrad texture2DGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define textureCubeGrad textureCubeGradEXT\n#endif\n"),r}(t),"\n").concat(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(var r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;var i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],"\n"))}0===e&&(n+="\n");return n}(u),"\n").concat(d?"":Ke,"\n"):"".concat(m,"\n"),b=!1,x=!0,w=!1,E=void 0;try{for(var S,P=a[Symbol.iterator]();!(x=(S=P.next()).done);x=!0){var T=S.value;switch(T.name){case"inject":b=!0;break;default:T.checkDeprecations(y,p),_+=T.getModuleSource(i,g)}}}catch(t){w=!0,E=t}finally{try{x||null==P.return||P.return()}finally{if(w)throw E}}return _=function(t,e,n,r){var i=e===me,o=function(e){var r=n[e];switch(e){case"vs:#decl":i&&(t=t.replace(We,function(t){return t+r}));break;case"vs:#main-start":i&&(t=t.replace(Ze,function(t){return t+r}));break;case"vs:#main-end":i&&(t=t.replace(Xe,function(t){return r+t}));break;case"fs:#decl":i||(t=t.replace(We,function(t){return t+r}));break;case"fs:#main-start":i||(t=t.replace(Ze,function(t){return t+r}));break;case"fs:#main-end":i||(t=t.replace(Xe,function(t){return r+t}));break;default:t=t.replace(e,function(t){return t+r})}};for(var a in n)o(a);return r&&(t=t.replace("}s*$",function(t){return t+qe[e]})),t}(_+=y,i,l,b)}var $e={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 0.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 0.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null};function tn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}var en="uniform float ONE;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' from.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",nn="".concat(en,"\n").concat("const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09); // 1/3!\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09); // 1/4!\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10); // 1/5!\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11); // 1/6!\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12); // 1/7!\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13); // 1/8!\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14); // 1/9!\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15); // 1/10!\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\n/* k_power controls how much range reduction we would like to have\nRange reduction uses the following method:\nassume a = k_power * r + m * log(2), k and m being integers.\nSet k_power = 4 (we can choose other k to trade accuracy with performance.\nwe only need to calculate exp(r) and using exp(a) = 2^m * exp(r)^k_power;\n*/\n\nvec2 exp_fp64(vec2 a) {\n  // We need to make sure these two numbers match\n  // as bit-wise shift is not available in GLSL 1.0\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n  // s = sum_fp64(s, t);\n  // p = mul_fp64(p, r);\n  // t = mul_fp64(p, INVERSE_FACTORIAL_6_FP64);\n\n  // s = sum_fp64(s, t);\n  // p = mul_fp64(p, r);\n  // t = mul_fp64(p, INVERSE_FACTORIAL_7_FP64);\n\n  s = sum_fp64(s, t);\n\n\n  // At this point, s = exp(r) - 1; but after following 4 recursions, we will get exp(r) ^ 512 - 1.\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n//   return r;\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n  /* keep the following commented code in case we need them\n  for extra accuracy from the Taylor expansion*/\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_7_FP64);\n  // s = sum_fp64(s, t);\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_9_FP64);\n  // s = sum_fp64(s, t);\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n  /* keep the following commented code in case we need them\n  for extra accuracy from the Taylor expansion*/\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_8_FP64);\n  // s = sum_fp64(s, t);\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_10_FP64);\n  // s = sum_fp64(s, t);\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    // We just can't get PI/16 * 3.0 very accurately.\n    // so let's just store it\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\n// Vector functions\n// vec2 functions\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\n\n// vec3 functions\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\n\n// vec4 functions\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n"),rn={ONE:1};var on={name:"fp64",vs:nn,fs:null,fp64ify:tn,fp64LowPart:function(t){return t-Math.fround(t)},fp64ifyMatrix4:function(t){for(var e=new Float32Array(32),n=0;n<4;++n)for(var r=0;r<4;++r){var i=4*n+r;tn(t[4*r+n],e,2*i)}return e},getUniforms:function(){return Object.assign({},rn)}},an=("".concat(en),[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),sn={modelMatrix:an,viewMatrix:an,projectionMatrix:an,cameraPositionWorld:[0,0,0]};var un="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n";"".concat(un,"\n\n// Unprefixed uniforms\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n"),"\n".concat(un);"".concat("  // empty\n","\n").concat("#define LIGHT_MAX 4\n\n/*\n// lighting configuration\nuniform bool enableLights;\nuniform vec3 ambientColor;\nuniform vec3 directionalColor;\nuniform vec3 lightingDirection;\n\n// point lights configuration\nuniform vec3 pointLocation[LIGHT_MAX];\nuniform vec3 pointColor[LIGHT_MAX];\nuniform int numberPoints;\n\n// reflection / refraction configuration\nuniform bool useReflection;\n*/\n\nuniform bool lighting_uEnableLights;\nuniform vec3 lighting_uAmbientColor;\nuniform vec3 lighting_uDirection;\nuniform vec3 lighting_uDirectionalColor;\n\n// point lights configuration\nuniform int  lighting_uPointCount;\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\n\n// reflection / refraction configuration\nuniform bool lighting_uEnableReflections;\n\n// varyings\nvarying vec4 lighting_vPosition;\nvarying vec4 lighting_vNormal;\nvarying vec3 lighting_vColor;\nvarying vec3 lighting_vLightWeighting;\nvarying vec3 lighting_vReflection;\n\nvoid lighting_setPositionAndNormal(vec3 position, vec3 normal) {\n  lighting_vPosition = worldMatrix * vec4(position, 1.);\n  lighting_vNormal = worldInverseTransposeMatrix * vec4(normal, 1.);;\n}\n\nvoid lighting__getLightWeigting() {\n  float directionalLightWeighting = max(dot(lighting_vNormal.xyz, lighting_uDirection), 0.);\n  vec3 pointWeight = vec3(0., 0., 0.);\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec4 mvLightPosition = viewMatrix * vec4(lighting_uPointLocation[i], 1.);\n      vec3 pointLightDirection = normalize(mvLightPosition.xyz - lighting_vPosition.xyz);\n      pointWeight += max(dot(lighting_vNormal.xyz, pointLightDirection), 0.) * pointColor[i];\n     } else {\n       break;\n     }\n   }\n   return ambientColor + (directionalColor * directionalLightWeighting) + pointWeight;\n}\n\nvoid lighting_apply(vec3 position, vec3 normal) {\n  lighting_setPositionAndNormal(position, normal);\n\n  // lighting code\n  if(!lighting_uEnableLights) {\n    lighting_vLightWeighting = vec3(1., 1., 1.);\n  } else {\n    lighting_vLightWeighting = lighting__getLightWeighting();\n  }\n}\n\nvoid lighting_set_reflection(vec3 position) {\n    // refraction / reflection code\n  if (lighting_uEnableReflections) {\n    lighting_vReflection = (viewInverseMatrix[3] - (worldMatrix * vec4(position, 1.))).xyz;\n  } else {\n    lighting_vReflection = vec3(1., 1., 1.);\n  }\n}\n","\n"),"".concat("  // empty\n","\n").concat("precision highp float;\n\n#define LIGHT_MAX 4\n\nvarying vec3 lighting_vLightWeighting;\n\nvec4 lighting_apply(vec4 color) {\n  // set color from texture\n  return vec4(color.rgb * lighting_vLightWeighting, color.a);\n}\n\n// spec-map.fs\n\nuniform mat4 viewMatrix;\n\n\nvarying vec4 lighting_vColor;\nvarying vec4 lighting_vTransformedNormal;\nvarying vec4 lighting_vPosition;\n\nuniform float shininess;\nuniform bool enableSpecularMap;\nuniform bool enableLights;\n\nuniform vec3 ambientColor;\nuniform vec3 directionalColor;\nuniform vec3 lightingDirection;\n\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform float lighting_uPointSpecularEnable[LIGHT_MAX];\nuniform vec3 lighting_uPointSpecularColor[LIGHT_MAX];\nuniform int numberPoints;\n\n\nvec3 lighting__calculate_light_weighting() {\n\treturn lighting__calculate_light_weighting(shininess);\n}\n\nvec3 lighting__calculate_light_weighting(shininess) {\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0., 0., 0.);\n  vec3 diffuseLight = vec3(0., 0., 0.);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(lighting_uPointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (lighting_uPointSpecularEnable > 0.) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininessVal);\n        specularLight += specularLightWeighting * lighting_uPointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * lighting_uPointColor[i];\n    } else {\n      break;\n    }\n  }\n\n  return ambientColor + diffuseLight + specularLight;\n}\n\nvoid lighting_filterColor(fragmentColor) {\n  if (!lighting_enable) {\n  \treturn fragmentColor;\n  } else {\n  \tvec3 lightWeighting = lighting__calculate_light_weighting();\n  \treturn vec4(fragmentColor.rgb * lightWeighting, fragmentColor.a);\n  }\n}\n\n// render-tex.fs\n\nuniform vec3 material_uAmbientColor;\nuniform vec3 material_uDiffuseColor;\nuniform vec3 material_uSpecularColor;\nuniform vec3 material_uEmissiveColor;\n\nuniform bool hasTexture1;\nuniform sampler2D sampler1;\n\nuniform mat4 viewMatrix;\n\nvoid apply_lighting(color) {\n  vec3 ambientLightWeighting = ambientColor;\n\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (enableSpecularHighlights) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n        specularLight += specularLightWeighting * pointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * pointColor[i];\n    } else {\n        break;\n    }\n  }\n\n  vec3 matAmbientColor = material_uAmbientColor * color.rgb;\n  vec3 matDiffuseColor = material_uDiffuseColor * color.rgb;\n  vec3 matSpecularColor = material_uSpecularColor * color.rgb;\n  vec3 matEmissiveColor = material_uEmissiveColor * color.rgb;\n  gl_FragColor = vec4(\n    matAmbientColor * ambientLightWeighting\n    + matDiffuseColor * diffuseLightWeighting\n    + matSpecularColor * specularLightWeighting\n    + matEmissiveColor,\n    color.a\n  );\n}\n\n/// frag-lighting\n\n  vec3 lightWeighting;\n  if (!enableLights) {\n    lightWeighting = vec3(1.0, 1.0, 1.0);\n  } else {\n    vec3 lightDirection;\n    float specularLightWeighting = 0.0;\n    float diffuseLightWeighting = 0.0;\n    vec3  specularLight = vec3(0.0, 0.0, 0.0);\n    vec3  diffuseLight = vec3(0.0, 0.0, 0.0);\n\n    vec3 transformedPointLocation;\n    vec3 normal = vTransformedNormal.xyz;\n\n    vec3 eyeDirection = normalize(-vPosition.xyz);\n    vec3 reflectionDirection;\n\n    vec3 pointWeight = vec3(0.0, 0.0, 0.0);\n\n    for (int i = 0; i < LIGHT_MAX; i++) {\n      if (i < numberPoints) {\n        transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n        lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n        if (enableSpecular[i] > 0.0) {\n          reflectionDirection = reflect(-lightDirection, normal);\n          specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n          specularLight += specularLightWeighting * pointSpecularColor[i];\n        }\n\n        diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n        diffuseLight += diffuseLightWeighting * pointColor[i];\n      } else {\n        break;\n      }\n    }\n\n    lightWeighting = ambientColor + diffuseLight + specularLight;\n  }\n\n// reflection / refraction configs\nuniform float reflection;\nuniform float refraction;\n\n///\n  // has cube texture then apply reflection\n  // if (hasTextureCube1) {\n  //   vec3 nReflection = normalize(vReflection);\n  //   vec3 reflectionValue;\n  //   if (refraction > 0.0) {\n  //    reflectionValue = refract(nReflection, vNormal.xyz, refraction);\n  //   } else {\n  //    reflectionValue = -reflect(nReflection, vNormal.xyz);\n  //   }\n\n  //   // TODO(nico): check whether this is right.\n  //   vec4 cubeColor = textureCube(samplerCube1,\n  //       vec3(-reflectionValue.x, -reflectionValue.y, reflectionValue.z));\n  //   gl_FragColor = vec4(mix(gl_FragColor.xyz, cubeColor.xyz, reflection), 1.0);\n  // }\n","\n"),new Float32Array([1,1,2]);var cn={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingThreshold:1,pickingActive:!1};var ln={name:"picking",vs:"uniform vec3 picking_uSelectedColor;\nuniform float picking_uThreshold;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    abs(vertexColor.r - picking_uSelectedColor.r) < picking_uThreshold &&\n    abs(vertexColor.g - picking_uSelectedColor.g) < picking_uThreshold &&\n    abs(vertexColor.b - picking_uSelectedColor.b) < picking_uThreshold;\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n  picking_vRGBcolor_Aselected.a =\n    float(isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  picking_vRGBcolor_Aselected.rgb = pickingColor * COLOR_SCALE;\n}\n",fs:"uniform bool picking_uActive; // true during rendering to offscreen picking buffer\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  bool selected = bool(picking_vRGBcolor_Aselected.a);\n  return selected ? (picking_uHighlightColor * COLOR_SCALE) : color;\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  vec3 pickingColor = picking_vRGBcolor_Aselected.rgb;\n  if (picking_uActive && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return picking_uActive ? vec4(pickingColor, 1.0) : color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn,e={};if(void 0!==t.pickingSelectedColor)if(null===t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{var n=[t.pickingSelectedColor[0],t.pickingSelectedColor[1],t.pickingSelectedColor[2]];e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}return void 0!==t.pickingHighlightColor&&(e.picking_uHighlightColor=t.pickingHighlightColor),void 0!==t.pickingThreshold&&(e.picking_uThreshold=t.pickingThreshold),void 0!==t.pickingActive&&(e.picking_uActive=t.pickingActive?1:0),e}};var fn="void main() {}",hn="#version 300 es\n".concat(fn);function pn(t,e){e=Array.isArray(e)?e:[e];var n=t.replace(/^\s+/,"").split(/\s+/),r=Object(tt.a)(n,3),i=r[0],o=r[1],a=r[2];return e.includes(i)&&o&&a?{qualifier:i,type:o,name:a.split(";")[0]}:null}function dn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.version,n=void 0===e?100:e,r=t.input,i=t.inputType,o=t.output;if(!r)return 300===n?hn:fn;var a=function(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ge()(!1),null}}(r,i);return 300===n?"#version 300 es\nin ".concat(i," ").concat(r,";\nout vec4 ").concat(o,";\nvoid main() {\n  ").concat(o," = ").concat(a,";\n}"):"varying ".concat(i," ").concat(r,";\nvoid main() {\n  gl_FragColor = ").concat(a,";\n}")}var vn={name:"transform",vs:"attribute float transform_elementID;\n\n// returns half of pixel size, used to move the pixel position to center of the pixel.\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\n// returns current elements pixel indeces [x, y],\n// where x ranges in [0 to texSize-1] and y ranges in [0 to texSize-1]\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  // Add safe offset (half of pixel height) before doing floor\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\n\n// returns current elementID's texture co-ordianate\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\n\n// returns current elementID's position\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  // Change from [0 1] range to [-1 1]\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\n\n// returns current elementID's pixel value\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},gn=n(31),mn=n.n(gn),yn={},_n=function t(e,n,r){e&&(n.length>1?t(e[n[0]],n.slice(1),r):e[n[0]]=r)},bn=new Map;function xn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.header,n=void 0===e?"Uniforms":e,r=t.program,i=t.uniforms,o=t.undefinedOnly,a=void 0!==o&&o;Object(k.a)(r);var s=r._uniformSetters,u={},c=Object.keys(s).sort(),f=0,h=!0,p=!1,d=void 0;try{for(var v,g=c[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var m=v.value;m.match(".*_.*")||m.match(".*Matrix")||wn({table:u,header:n,uniforms:i,uniformName:m,undefinedOnly:a})&&f++}}catch(t){p=!0,d=t}finally{try{h||null==g.return||g.return()}finally{if(p)throw d}}var y=!0,_=!1,b=void 0;try{for(var x,w=c[Symbol.iterator]();!(y=(x=w.next()).done);y=!0){var E=x.value;E.match(".*Matrix")&&wn({table:u,header:n,uniforms:i,uniformName:E,undefinedOnly:a})&&f++}}catch(t){_=!0,b=t}finally{try{y||null==w.return||w.return()}finally{if(_)throw b}}var P=!0,T=!1,A=void 0;try{for(var C,O=c[Symbol.iterator]();!(P=(C=O.next()).done);P=!0){var M=C.value;u[M]||wn({table:u,header:n,uniforms:i,uniformName:M,undefinedOnly:a})&&f++}}catch(t){T=!0,A=t}finally{try{P||null==O.return||O.return()}finally{if(T)throw A}}var I=0,L={};if(!a)for(var R in i){var j=i[R];u[R]||(I++,L[R]=Object(S.a)({Type:"NOT USED: ".concat(j)},n,Object(l.b)(j)))}return{table:u,count:f,unusedTable:L,unusedCount:I}}function wn(t){var e,n=t.table,r=t.header,i=t.uniforms,o=t.uniformName,a=t.undefinedOnly,s=i[o],u=function(t){return void 0!==t&&null!==t}(s);return(!a||!u)&&(n[o]=(e={},Object(S.a)(e,r,u?Object(l.b)(s):"N/A"),Object(S.a)(e,"Uniform Type",u?s:"NOT PROVIDED"),e),!0)}function En(t,e,n,r){var o,a,s,u,c=t.gl,f="NOT PROVIDED",h="N/A",p="N/A",d="N/A";if(n&&(f=n.type,h=n.size,a=-1!==(f=String(f).replace("Array","")).indexOf("nt")),e instanceof B.a){var v,g,m=e,y=m.getDebugData(),_=y.data;if(s=y.modified?"*":"",u=_,p=(d=m.byteLength)/_.BYTES_PER_ELEMENT/h,n){var b=n.divisor>0;g="".concat(b?"I ":"P "," ").concat(p," (x").concat(h,"=").concat(d," bytes ").concat(Object(i.c)(c,f),")")}else a=!0,g="".concat(d," bytes");return v={},Object(S.a)(v,r,"".concat(s).concat(Object(l.b)(u,{size:h,isInteger:a}))),Object(S.a)(v,"Format ",g),v}return u=e,h=e.length,a=-1!==(f=String(e.constructor.name).replace("Array","")).indexOf("nt"),o={},Object(S.a)(o,r,"".concat(Object(l.b)(u,{size:h,isInteger:a})," (constant)")),Object(S.a)(o,"Format ","".concat(h,"x").concat(f," (constant)")),o}function Sn(t,e){var n=Yt(e.type,e.size);return n?"".concat(t," (").concat(n.name,")"):t}function Pn(t){var e=t.accessor,n=Yt(e.type,e.size);return n?"".concat(n.name," ").concat(t.name):t.name}mn.a.listenFor("luma.gl",function(t){var e=yn[t.itemKey];if(e&&"edit"===t.type&&"uniforms"===t.valuePath[0]){var n=t.valuePath.slice(1);!function(t,e,n){m.b.__SEER_INITIALIZED__&&(bn.has(t)||bn.set(t,new Map),bn.get(t).set(e,n))}(t.itemKey,n,t.value);var r=e.getUniforms();_n(r,n,t.value),e.setUniforms(r)}});var Tn=["renderPickingBuffer","pickingEnabled"],An=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),n=Object(U.a)(this,Object(V.a)(e).call(this,r)),Object(k.a)(Object(o.m)(t)),n.gl=t,n.lastLogTime=0,n.initialize(r),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.props={},this.program=this._createProgram(t),this.vertexArray=new se(this.gl,{program:this.program}),this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.animatedUniforms={},this.animated=!1,this.animationLoop=null,this.timerQueryEnabled=!1,this.timeElapsedQuery=void 0,this.lastQueryReturned=!0,this.stats={accumulatedFrameTime:0,averageFrameTime:0,profileFrameCount:0},this.pickable=!0,this.setProps(t),this.setUniforms(Object.assign({},this.getModuleUniforms(),this.getModuleUniforms(t.moduleSettings))),this.isInstanced=t.isInstanced||t.instanced,this.onBeforeRender=t.onBeforeRender||function(){},this.onAfterRender=t.onAfterRender||function(){},Object(k.a)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}},{key:"setProps",value:function(t){Object.assign(this.props,t),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"uniforms"in t&&this.setUniforms(t.uniforms,t.samplers),"pickable"in t&&(this.pickable=t.pickable),"timerQueryEnabled"in t&&(this.timerQueryEnabled=t.timerQueryEnabled&&$t.isSupported(this.gl,["timers"]),t.timerQueryEnabled&&!this.timerQueryEnabled&&l.g.warn("GPU timer not supported")()),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers),"_animationProps"in t&&this._setAnimationProps(t._animationProps),"_animationLoop"in t&&(this.animationLoop=t._animationLoop)}},{key:"delete",value:function(){for(var t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this.program.delete(),this.vertexArray.delete(),function(t){delete yn[t],mn.a.deleteItem("luma.gl",t)}(this.id)}},{key:"destroy",value:function(){this.delete()}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t,n=!1;return n=n||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!e,this.geometry&&(n=n||this.geometry.getNeedsRedraw({clearRedrawFlags:e})),this.animated&&(n=n||"animated model ".concat(this.id)),n}},{key:"getDrawMode",value:function(){return this.drawMode}},{key:"getVertexCount",value:function(){return this.vertexCount}},{key:"getInstanceCount",value:function(){return this.instanceCount}},{key:"getProgram",value:function(){return this.program}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getUniforms",value:function(){return this.program.getUniforms}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=t,this}},{key:"setDrawMode",value:function(t){return this.props.drawMode=pe(t),this}},{key:"setVertexCount",value:function(t){return Object(k.a)(Number.isFinite(t)),this.props.vertexCount=t,this}},{key:"setInstanceCount",value:function(t){return Object(k.a)(Number.isFinite(t)),this.instanceCount=t,this}},{key:"setGeometry",value:function(t){this.geometry=t;var e=this._createBuffersFromAttributeDescriptors(this.geometry.getAttributes());return this.vertexArray.setAttributes(e),this.setNeedsRedraw(),this}},{key:"setAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(l.d)(t))return this;Object.assign(this.attributes,t);var e=this._createBuffersFromAttributeDescriptors(t);return this.vertexArray.setAttributes(e),this.setNeedsRedraw(),this}},{key:"setUniforms",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},e),function(t,e){if(m.b.__SEER_INITIALIZED__&&t){var n=bn.get(t);n&&n.forEach(function(t,n){_n(e,n,t)})}}(this.id,e),e=this._extractAnimatedUniforms(e),this.program.setUniforms(e,n,function(){t._checkForDeprecatedUniforms(e),t.setNeedsRedraw()})}},{key:"_setAnimationProps",value:function(t){var e=this;if(this.animated){Object(k.a)(t,"Model.draw(): animated uniforms but no animationProps");var n=this._evaluateAnimateUniforms(t);this.program.setUniforms(n,{},function(){e._checkForDeprecatedUniforms(n),e.setNeedsRedraw()})}}},{key:"updateModuleSettings",value:function(t){var e=this.getModuleUniforms(t||{});return this.setUniforms(e)}},{key:"clear",value:function(t){return pt(this.program.gl,t),this}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.moduleSettings,n=void 0===e?null:e,r=t.framebuffer,i=t.uniforms,o=void 0===i?{}:i,a=t.attributes,s=void 0===a?{}:a,u=t.samplers,c=void 0===u?{}:u,f=t.transformFeedback,h=void 0===f?this.transformFeedback:f,p=t.parameters,d=void 0===p?{}:p,v=t.vertexArray,g=void 0===v?this.vertexArray:v,m=t.animationProps;!function(t){yn[t.id]||(yn[t.id]=t,mn.a.listItem("luma.gl",t.id))}(this),this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(o,c),this._refreshAnimationProps(m);var y=this._logDrawCallStart(2),_=this.vertexArray.getDrawParams(this.props);_.isInstanced&&!this.isInstanced&&l.g.warn("Found instanced attributes on non-instanced model",this.id)();var b=_.isIndexed,x=_.indexType,w=this.isInstanced,E=this.instanceCount;return this.onBeforeRender(),this._timerQueryStart(),this.program.draw(Object.assign({},t,{logPriority:y,uniforms:null,framebuffer:r,parameters:d,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:g,transformFeedback:h,isIndexed:b,indexType:x,isInstanced:w,instanceCount:E})),this._timerQueryEnd(),this.onAfterRender(),this.setNeedsRedraw(!1),this._logDrawCallEnd(y,g,r),this}},{key:"transform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.discard,n=void 0===e||e,r=t.feedbackBuffers,i=t.unbindModels,o=void 0===i?[]:i,a=t.parameters;r&&this._setFeedbackBuffers(r),n&&(a=Object.assign({},a,Object(S.a)({},35977,n))),o.forEach(function(t){return t.vertexArray.unbindBuffers()});try{this.draw(Object.assign({},t,{parameters:a}))}finally{o.forEach(function(t){return t.vertexArray.bindBuffers()})}return this}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(k.a)(arguments.length<=1),this.draw({uniforms:t})}},{key:"_createProgram",value:function(t){var e=t.vs,n=void 0===e?null:e,r=t.fs,i=void 0===r?null:r,o=t.modules,a=void 0===o?null:o,s=t.defines,u=void 0===s?{}:s,c=t.inject,f=void 0===c?{}:c,h=t.shaderCache,p=void 0===h?null:h,d=t.varyings,v=void 0===d?null:d,g=t.bufferMode,m=void 0===g?35981:g,y=t.program,_=void 0===y?null:y;this.getModuleUniforms=function(t){};var b=this.id;if(!_){n=n||ve,i=i||ge;var x=Je(this.gl,{vs:n,fs:i,modules:a,inject:f,defines:u,log:l.g});n=x.vs,i=x.fs,_=p?p.getProgram(this.gl,{id:b,vs:n,fs:i}):new Jt(this.gl,{id:b,vs:n,fs:i,varyings:v,bufferMode:m}),this.getModuleUniforms=x.getUniforms||function(t){}}return Object(k.a)(_ instanceof Jt,"Model needs a program"),_}},{key:"_checkForDeprecatedUniforms",value:function(t){Tn.forEach(function(e){e in t&&l.g.deprecated(e,"use picking shader module and Model class updateModuleSettings()")()})}},{key:"_refreshAnimationProps",value:function(t){(t=t||this.animationLoop&&this.animationLoop.animationProps)&&this._setAnimationProps(t)}},{key:"_evaluateAnimateUniforms",value:function(t){if(!this.animated)return{};var e={};for(var n in this.animatedUniforms){var r=this.animatedUniforms[n];e[n]=r(t)}return e}},{key:"_extractAnimatedUniforms",value:function(t){var e=!1;for(var n in t){var r=t[n];"function"==typeof r?(this.animatedUniforms[n]=r,e=!0):delete this.animatedUniforms[n]}if(this.animated=!Object(l.d)(this.animatedUniforms),!e)return t;var i={};for(var o in t)this.animatedUniforms[o]||(i[o]=t[o]);return i}},{key:"_setFeedbackBuffers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(l.d)(t))return this;var e=this.program.gl;return this.transformFeedback=this.transformFeedback||new te(e,{program:this.program}),this.transformFeedback.setBuffers(t),this.setNeedsRedraw(),this}},{key:"_timerQueryStart",value:function(){!0===this.timerQueryEnabled&&(this.timeElapsedQuery||(this.timeElapsedQuery=new $t(this.gl)),this.lastQueryReturned&&(this.lastQueryReturned=!1,this.timeElapsedQuery.beginTimeElapsedQuery()))}},{key:"_timerQueryEnd",value:function(){if(!0===this.timerQueryEnabled&&(this.timeElapsedQuery.end(),this.timeElapsedQuery.isResultAvailable())){this.lastQueryReturned=!0;var t=this.timeElapsedQuery.getResult();this.stats.lastFrameTime=t,this.stats.accumulatedFrameTime+=t,this.stats.profileFrameCount++,this.stats.averageFrameTime=this.stats.accumulatedFrameTime/this.stats.profileFrameCount,l.g.log(2,"GPU time ".concat(this.program.id,": ").concat(this.stats.lastFrameTime,"ms average ").concat(this.stats.averageFrameTime,"ms accumulated: ").concat(this.stats.accumulatedFrameTime,"ms count: ").concat(this.stats.profileFrameCount))()}}},{key:"_createBuffersFromAttributeDescriptors",value:function(t){var e=this.program.gl,n={};for(var r in t){var i=t[r],o=this._attributes[r];i instanceof fe?o=i:i instanceof B.a?(o=o||new fe(e,Object.assign({},i,i.layout,{id:r}))).update({buffer:i}):o?o.update(i):o=new fe(e,Object.assign({},i,{id:r})),this._attributes[r]=o,n[r]=o.getValue()}return n}},{key:"_logDrawCallStart",value:function(t){var e=t>3?0:1e4;if(!(l.g.priority<t||Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),l.g.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:l.g.priority<=2})(),t}},{key:"_logDrawCallEnd",value:function(t,e,n,r){if(void 0!==t){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertexArray,n=t.header,r=void 0===n?"Attributes":n;if(!e.configuration)return{};var i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=En(e,e.elements,null,r));var o=e.values;for(var a in o){var s=e._getAttributeInfo(a);if(s){var u="".concat(a,": ").concat(s.name),c=e.accessors[s.location];c&&(u="".concat(a,": ").concat(Sn(s.name,c))),i[u]=En(e,o[a],c,r)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),o=xn({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),a=o.table,s=o.unusedTable,u=o.unusedCount,c=xn({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0}),f=c.table;c.count>0&&l.g.log("MISSING UNIFORMS",Object.keys(f))(),u>0&&l.g.log("UNUSED UNIFORMS",Object.keys(s))();var h=function(t){var e={},n="Accessors for ".concat(t.id),r=!0,i=!1,o=void 0;try{for(var a,s=t.attributeInfos[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u){var c=Pn(u);e["in ".concat(c)]=Object(S.a)({},n,JSON.stringify(u.accessor))}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var l=!0,f=!1,h=void 0;try{for(var p,d=t.varyingInfos[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var v=p.value;if(v){var g=Pn(v);e["out ".concat(g)]=Object(S.a)({},n,JSON.stringify(v.accessor))}}}catch(t){f=!0,h=t}finally{try{l||null==d.return||d.return()}finally{if(f)throw h}}return e}(this.vertexArray.configuration);l.g.table(t,i)(),l.g.table(t,a)(),l.g.table(t+1,h)(),function(t,e){if(mn.a.isReady()&&!mn.a.throttle("luma.gl:".concat(t.id),1e3)){var n=t.geometry?Object.assign({},t.geometry.attributes,t.attributes):t.attributes,r=Object.assign({},t.uniforms,e);mn.a.multiUpdate("luma.gl",t.id,[{path:"objects.uniforms",data:r},{path:"objects.attributes",data:n}])}}(this,n),r&&r.log({priority:2,message:"Rendered to ".concat(r.id)}),l.g.groupEnd(2,">>> DRAWING MODEL ".concat(this.id))()}}},{key:"vertexCount",get:function(){return Number.isFinite(this.props.vertexCount)?this.props.vertexCount:this.geometry&&this.geometry.getVertexCount()}},{key:"drawMode",get:function(){return Number.isFinite(this.props.drawMode)?this.props.drawMode:this.geometry&&this.geometry.drawMode}}]),e}(le),kn=n(29),Cn={preserveDrawingBuffer:!0},On=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,t);var n=e.onCreateContext,r=void 0===n?function(t){return I(t)}:n,i=e.onAddHTML,o=void 0===i?null:i,a=e.onInitialize,s=void 0===a?function(){}:a,u=e.onRender,c=void 0===u?function(){}:u,f=e.onFinalize,h=void 0===f?function(){}:f,p=e.offScreen,d=void 0!==p&&p,v=e.gl,m=void 0===v?null:v,y=e.glOptions,_=void 0===y?{}:y,b=e.debug,x=void 0!==b&&b,w=e.createFramebuffer,E=void 0!==w&&w,S=e.autoResizeViewport,P=void 0===S||S,T=e.autoResizeDrawingBuffer,A=void 0===T||T,k=e.useDevicePixels,C=void 0===k||k;return"useDevicePixelRatio"in e&&(l.g.deprecated("useDevicePixelRatio","useDevicePixels")(),C=e.useDevicePixelRatio),this.props={onCreateContext:r,onAddHTML:o,onInitialize:s,onRender:c,onFinalize:h,gl:m,glOptions:_,debug:x,createFramebuffer:E},this.gl=m,this.offScreen=d,this.needsRedraw=null,this.setProps({autoResizeViewport:P,autoResizeDrawingBuffer:A,useDevicePixels:C}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._renderFrame=this._renderFrame.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this),this}return Object(P.a)(t,[{key:"setNeedsRedraw",value:function(t){return Object(k.a)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}},{key:"setProps",value:function(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._stopped=!1,this._animationFrameId||(this._startPromise=p().then(function(){return t._stopped?null:(t._createWebGLContext(e),t._createFramebuffer(),t._startEventHandling(),t._initializeCallbackData(),t._updateCallbackData(),t._resizeCanvasDrawingBuffer(),t._resizeViewport(),t.onInitialize(t.animationProps))}).then(function(e){t._stopped||(t._addCallbackData(e||{}),!1===e||t._animationFrameId||(t._animationFrameId=Object(o.p)(t._renderFrame)))})),this}},{key:"stop",value:function(){return this._animationFrameId&&(this._finalizeCallbackData(),Object(o.f)(this._animationFrameId),this._animationFrameId=null,this._stopped=!0),this}},{key:"onCreateContext",value:function(){var t;return(t=this.props).onCreateContext.apply(t,arguments)}},{key:"onInitialize",value:function(){var t;return(t=this.props).onInitialize.apply(t,arguments)}},{key:"onRender",value:function(){var t;return(t=this.props).onRender.apply(t,arguments)}},{key:"onFinalize",value:function(){var t;return(t=this.props).onFinalize.apply(t,arguments)}},{key:"getHTMLControlValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=document.getElementById(t);return n?Number(n.value):e}},{key:"setViewParameters",value:function(){return l.g.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}},{key:"_setupFrame",value:function(){this._onSetupFrame?this._onSetupFrame(this.animationProps):(this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer())}},{key:"_renderFrame",value:function(){this._stopped||(this._setupFrame(),this._updateCallbackData(),this.onRender(this.animationProps),this.offScreen?this.gl.commit().then(this._renderFrame):this._animationFrameId=Object(o.p)(this._renderFrame))}},{key:"_initializeCallbackData",value:function(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),time:0,tick:0,tock:0,_loop:this,_animationLoop:this,_mousePosition:null}}},{key:"_updateCallbackData",value:function(){this.animationProps.needsRedraw=this.needsRedraw,this.needsRedraw=null;var t=this._getSizeAndAspect(),e=t.width,n=t.height,r=t.aspect;e===this.animationProps.width&&n===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.time=Date.now()-this.animationProps.startTime,this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps._offScreen=this.offScreen}},{key:"_finalizeCallbackData",value:function(){this.onFinalize(this.animationProps)}},{key:"_addCallbackData",value:function(t){"object"===Object(kn.a)(t)&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}},{key:"_createWebGLContext",value:function(t){if(t=Object.assign({},t,Cn,this.props.glOptions),this.gl=this.props.gl||this.onCreateContext(t),!Object(o.m)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");this.props.debug&&(this.gl=_(this.gl)),Object(L.a)(this.gl),this._createInfoDiv()}},{key:"_createInfoDiv",value:function(){if(this.gl.canvas&&this.props.onAddHTML){var t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";var e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);var n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}},{key:"_getSizeAndAspect",value:function(){var t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight,n=1,r=this.gl.canvas,i=r.clientWidth,o=r.clientHeight;return i>=0&&o>=0?n=e>0?i/o:1:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}},{key:"_resizeViewport",value:function(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}},{key:"_resizeCanvasDrawingBuffer",value:function(){this.autoResizeDrawingBuffer&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas){var n=e.useDevicePixels&&window.devicePixelRatio||1,r="width"in e?e.width:t.canvas.clientWidth,i="height"in e?e.height:t.canvas.clientHeight;return t.canvas.width=r*n,void(t.canvas.height=i*n)}var o=t.getExtension("STACKGL_resize_drawingbuffer");o&&"width"in e&&"height"in e&&o.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}},{key:"_createFramebuffer",value:function(){this.props.createFramebuffer&&(this.framebuffer=new gt(this.gl))}},{key:"_resizeFramebuffer",value:function(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}},{key:"_startEventHandling",value:function(){this.gl.canvas.addEventListener("mousemove",this._onMousemove),this.gl.canvas.addEventListener("mouseleave",this._onMouseleave)}},{key:"_onMousemove",value:function(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}},{key:"_onMouseleave",value:function(t){this.animationProps._mousePosition=null}}]),t}();new Uint8Array([0,0,0]);var Mn,In="transform_uSampler_",Ln="transform_uSize_",Rn="transform_position";function jn(t){var e=t.vs,n=t.sourceTextureMap,r=t.targetTextureVarying,i=t.targetTexture,o=Object.keys(n).length,a=null,s={},u={},c=e,l={};if(o>0||r){var f=c.split("\n"),h=f.slice();if(f.forEach(function(t,e,i){if(o>0){var c=function(t,e){var n={},r={},i=function(t){return pn(t,["attribute","in"])}(t);if(!i)return null;var o=i.type,a=i.name;if(a&&e[a]){var s="// ".concat(t," => Replaced by Transform with a sampler"),u=function(t){var e="".concat(In).concat(t),n="".concat(Ln).concat(t),r="  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}(a),c=u.samplerName,l=u.sizeName,f=u.uniformDeclerations,h=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ge()(!1),null}}(o),p="  ".concat(o," ").concat(a," = transform_getInput(").concat(c,", ").concat(l,").").concat(h,";\n"),d=e[a],v=d.width,g=d.height;r[c]=a,n[l]=[v,g];var m={"vs:#decl":f,"vs:#main-start":p};return{updatedLine:s,inject:m,uniforms:n,samplerTextureMap:r}}return null}(t,n);if(c){var f=c.updatedLine,p=c.inject;h[e]=f,l=He([l,p]),Object.assign(s,c.uniforms),Object.assign(u,c.samplerTextureMap),o--}}r&&!a&&(a=function(t,e){var n=pn(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,r))}),r){Ge()(i);var p="".concat(Ln).concat(r),d=i.width,v=i.height;s[p]=[d,v];var g="uniform vec2 ".concat(p,";\n"),m="     vec2 ".concat(Rn," = transform_getPos(").concat(p,");\n     gl_Position = vec4(").concat(Rn,", 0, 1.);\n");l=He([l,{"vs:#decl":g,"vs:#main-start":m}])}c=h.join("\n")}return{vs:c,uniforms:s,targetTextureType:a,inject:l,samplerTextureMap:u}}var zn=(Mn={},Object(S.a)(Mn,10241,9728),Object(S.a)(Mn,10240,9728),Object(S.a)(Mn,10242,33071),Object(S.a)(Mn,10243,33071),Mn),Dn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,t),Object(o.d)(e),this.gl=e,this.model=null,this.elementCount=0,this.currentIndex=0,this.sourceBuffers=new Array(2),this.sourceTextures=new Array(2),this.feedbackBuffers=new Array(2),this.targetTextures=new Array(2),this.transformFeedbacks=new Array(2),this.framebuffers=new Array(2),this._createdBuffers={},this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}return Object(P.a)(t,null,[{key:"isSupported",value:function(t){return Object(o.n)(t)}}]),Object(P.a)(t,[{key:"delete",value:function(){for(var t in this._createdBuffers)this._createdBuffers[t].delete();this.model.delete()}},{key:"getBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(k.a)(t&&this.feedbackBuffers[this.currentIndex][t]),this.feedbackBuffers[this.currentIndex][t]}},{key:"_getTargetTexture",value:function(){return this.framebuffers[this.currentIndex]?this.framebuffers[this.currentIndex].attachments[36064]:null}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.varyingName,n=void 0===e?null:e,r=t.packed,i=void 0!==r&&r;if(n&&this.feedbackBuffers[this.currentIndex][n])return this.feedbackBuffers[this.currentIndex][n].getData();Object(k.a)(!n||n===this.targetTextureVarying);var o=this.framebuffers[this.currentIndex].readPixels();if(!i)return o;for(var a=o.constructor,s=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ge()(!1),null}}(this.targetTextureType),u=new a(o.length*s/4),c=0,l=0;l<o.length;l+=4)for(var f=0;f<s;f++)u[c++]=o[l+f];return u}},{key:"_getInputs",value:function(){var t={},e=this.currentIndex,n=Object.assign({},this.sourceBuffers[e]);if(this.hasSourceTextures||this.targetTextureVarying){for(var r in n.transform_elementID=this.elementIDBuffer,this.samplerTextureMap){var i=this.samplerTextureMap[r];t[r]=this.sourceTextures[e][i]}this._setSourceTextureParameters()}return{attributes:n,samplerUniforms:t}}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._getInputs(),n=e.attributes,r=e.samplerUniforms,i=Object.assign({},r,t.uniforms),o=Object.assign({},t.parameters),a=t.clearRenderTarget,s=void 0===a||a,u=null,c=!0;this.renderingToTexture&&(c=!1,u=this.framebuffers[this.currentIndex],Object(k.a)(u),o.viewport=[0,0,u.width,u.height],s&&this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this.model.setAttributes(n),this.model.transform(Object.assign({},t,{transformFeedback:this.transformFeedbacks[this.currentIndex],uniforms:i,discard:c,framebuffer:u,parameters:o}))}},{key:"swapBuffers",value:function(){l.g.deprecated("swapBuffers()","swap()"),this.swap()}},{key:"swap",value:function(){Object(k.a)(this.feedbackMap||this._swapTexture),this.currentIndex=(this.currentIndex+1)%2}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.elementCount&&this._setElementCount(t.elementCount);var e=t.sourceBuffers,n=void 0===e?null:e,r=t.feedbackBuffers,i=void 0===r?null:r,o=this.currentIndex;if(n||i){for(var a in i)Object(k.a)(i[a]instanceof B.a);Object.assign(this.sourceBuffers[o],n),Object.assign(this.feedbackBuffers[o],i),this._createFeedbackBuffers({feedbackBuffers:i}),this.transformFeedbacks[o]&&this.transformFeedbacks[o].setBuffers(this.feedbackBuffers[o]),this._setupSwapBuffers()}var s=t._sourceTextures,u=t._targetTexture;(s||u)&&(Object.assign(this.sourceTextures[o],s),this._getDestinationTexture(u)&&(this.targetTextures[o]=this._getDestinationTexture(u),this.framebuffers[o].update(Object(S.a)({},36064,this.targetTextures[o]))),this._setupSwapTextures())}},{key:"_setSourceTextureParameters",value:function(){var t=this.currentIndex;for(var e in this.sourceTextures[t])this.sourceTextures[t][e].setParameters(zn)}},{key:"_setElementCount",value:function(t){this.elementCount!==t&&(this.elementCount<t&&this._updateElementIDBuffer(t),this.model.setVertexCount(t),this.elementCount=t)}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._validateProps(t),n=e.feedbackBuffers,r=e.feedbackMap,i=t.sourceBuffers,o=t.varyings,a=t._targetTexture,s=t._targetTextureVarying,u=t._swapTexture,c=o;r&&!Array.isArray(o)&&(c=Object.values(r)),this.varyingsArray=c,this.feedbackMap=r,this._swapTexture=u,a&&(this.targetTextureVarying=s,this.renderingToTexture=!0,Object(k.a)(this.targetTextureVarying)),this._setupBuffers({sourceBuffers:i,feedbackBuffers:n}),this._setupTextures(t),this._setupSwapBuffers(),this._setupSwapTextures(),this._buildModel(Object.assign({},t,{id:t.id||"transform-model",drawMode:t.drawMode||0,varyings:c}))}},{key:"_validateProps",value:function(t){var e=t.feedbackBuffers,n=t.feedbackMap,r=t.destinationBuffers,i=t.sourceDestinationMap;r&&(l.g.deprecated("destinationBuffers","feedbackBuffers")(),e=e||r),i&&(l.g.deprecated("sourceDestinationMap","feedbackMap")(),n=n||i);var o=t.vs,a=t.elementCount,s=t.varyings,u=t._sourceTextures,c=t._targetTexture,f=t._targetTextureVarying,h=t._swapTexture;for(var p in Object(k.a)(o&&(s||n||c)&&a),e||{})Object(k.a)(e[p]instanceof B.a);for(var d in u||{})Object(k.a)(u[d]instanceof et.a);return Object(k.a)(!c||f),Object(k.a)(!h||u[h]),{feedbackBuffers:e,feedbackMap:n}}},{key:"_setupBuffers",value:function(t){var e=t.sourceBuffers,n=void 0===e?null:e,r=t.feedbackBuffers,i=void 0===r?null:r;this.sourceBuffers[0]=Object.assign({},n),this.feedbackBuffers[0]=Object.assign({},i),this._createFeedbackBuffers({feedbackBuffers:i}),this.sourceBuffers[1]={},this.feedbackBuffers[1]={}}},{key:"_setupTextures",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t._sourceTextures,n=t._targetTexture;if(this.sourceTextures[0]=Object.assign({},e),this.sourceTextures[1]={},this.hasSourceTextures=Object.keys(this.sourceTextures[0]).length>0,this.targetTextureVarying){var r=this._getDestinationTexture(n);Object(k.a)(r),this.targetTextures[0]=r,this.targetTextures[1]=null}}},{key:"_getDestinationTexture",value:function(t){var e;if(t instanceof et.a)return t;var n=this.sourceTextures[0][t];return n?Object(o.g)(n,{parameters:(e={},Object(S.a)(e,10241,9728),Object(S.a)(e,10240,9728),Object(S.a)(e,10242,33071),Object(S.a)(e,10243,33071),e),pixelStore:Object(S.a)({},37440,!1)}):null}},{key:"_createFeedbackBuffers",value:function(t){var e=t.feedbackBuffers;if(this.feedbackMap){var n=this.currentIndex;for(var r in this.feedbackMap){var i=this.feedbackMap[r];if(!(i===this.targetTextureVarying||e&&e[i])){var o=this.sourceBuffers[n][r],a=o.bytes,s=o.type,u=o.usage,c=o.accessor,l=new B.a(this.gl,{bytes:a,type:s,usage:u,accessor:c});this._createdBuffers[i]&&this._createdBuffers[i].delete(),this._createdBuffers[i]=l,this.feedbackBuffers[n][i]=l}}}}},{key:"_createNewBuffer",value:function(t,e){var n=new B.a(this.gl,e);return this._createdBuffers[t]&&(this._createdBuffers[t].delete(),this._createdBuffers[t]=n),n}},{key:"_setupSwapBuffers",value:function(){if(this.feedbackMap){var t=this.currentIndex,e=(t+1)%2;for(var n in Object.assign(this.sourceBuffers[e],this.sourceBuffers[t]),Object.assign(this.feedbackBuffers[e],this.feedbackBuffers[t]),this.feedbackMap){var r=this.feedbackMap[n];r!==this.targetTextureVarying&&(this.sourceBuffers[e][n]=this.feedbackBuffers[t][r],this.feedbackBuffers[e][r]=this.sourceBuffers[t][n],Object(k.a)(this.feedbackBuffers[e][r]instanceof B.a))}this.transformFeedbacks[e]&&this.transformFeedbacks[e].setBuffers(this.feedbackBuffers[e])}}},{key:"_setupSwapTextures",value:function(){if(this._swapTexture&&this.targetTextureVarying){var t=this.currentIndex,e=(t+1)%2;Object.assign(this.sourceTextures[e],this.sourceTextures[t]),this.sourceTextures[e][this._swapTexture]=this.targetTextures[t],this.targetTextures[e]=this.sourceTextures[t][this._swapTexture],this.framebuffers[e]&&this.framebuffers[e].update(Object(S.a)({},36064,this.targetTextures[e]))}}},{key:"_buildModel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._getShaders(t),n=e.vs,r=e.fs,i=e.modules,o=e.uniforms,a=e.inject,s=e.samplerTextureMap;this.model=new An(this.gl,Object.assign({},t,{vs:n,fs:r,vertexCount:t.elementCount,modules:i,uniforms:o,inject:a})),this.samplerTextureMap=s,this._setupTransformFeedback(),this._setupFramebuffers(),this._setElementCount(t.elementCount)}},{key:"_setupTransformFeedback",value:function(){Object(l.d)(this.feedbackBuffers[0])||(this.transformFeedbacks[0]=new te(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[0]}),this.feedbackMap&&(this.transformFeedbacks[1]=new te(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[1]})))}},{key:"_setupFramebuffers",value:function(){if(this.renderingToTexture){var t=this.targetTextures[0],e=t.width,n=t.height;if(this.framebuffers[0]=new gt(this.gl,{id:"".concat(this.id||"transform","-framebuffer-0"),width:e,height:n,attachments:Object(S.a)({},36064,this.targetTextures[0])}),this._swapTexture){var r=this.targetTextures[1];e=r.width,n=r.height,this.framebuffers[1]=new gt(this.gl,{id:"".concat(this.id||"transform","-framebuffer-1"),width:e,height:n,attachments:Object(S.a)({},36064,this.targetTextures[1])})}}}},{key:"_updateElementIDBuffer",value:function(t){if(this.hasSourceTextures||this.targetTextureVarying){var e=new Float32Array(t);e.forEach(function(t,e,n){n[e]=e}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new B.a(this.gl,{data:e,size:1})}}},{key:"_getShaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._processVertexShader(t.vs),n=e.vs,r=e.uniforms,i=e.targetTextureType,a=e.inject,s=e.samplerTextureMap;return this.targetTextureType=i,{vs:n,fs:dn({version:Object(o.l)(n),input:this.targetTextureVarying,inputType:i,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[vn].concat(t.modules||[]):t.modules,uniforms:r,inject:a,samplerTextureMap:s}}},{key:"_processVertexShader",value:function(t){return jn({vs:t,sourceTextureMap:this.sourceTextures[this.currentIndex],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[this.currentIndex]})}}]),t}(),Fn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.gl,r=e._cachePrograms,i=void 0!==r&&r;Object(g.a)(this,t),Object(k.a)(n),this.gl=n,this.vertexShaders={},this.fragmentShaders={},this.programs={},this._cachePrograms=i}return Object(P.a)(t,[{key:"delete",value:function(){return this}},{key:"getVertexShader",value:function(t,e){Object(k.a)("string"==typeof e),Object(k.a)(this._compareContexts(t,this.gl));var n=this.vertexShaders[e];return n||(n=new Y(t,e),this.vertexShaders[e]=n),n}},{key:"getFragmentShader",value:function(t,e){Object(k.a)("string"==typeof e),Object(k.a)(this._compareContexts(t,this.gl));var n=this.fragmentShaders[e];return n||(n=new K(t,e),this.fragmentShaders[e]=n),n}},{key:"getProgram",value:function(t,e){Object(k.a)(this._compareContexts(t,this.gl)),Object(k.a)("string"==typeof e.vs),Object(k.a)("string"==typeof e.fs),Object(k.a)("string"==typeof e.id);var n=this._getProgramKey(e),r=this.programs[n];return r?(this._resetProgram(r),r):(r=this._createNewProgram(t,e),this._cachePrograms&&this._checkProgramProp(r)&&(r._isCached=!0,this.programs[n]=r),r)}},{key:"_getProgramKey",value:function(t){return"".concat(t.id,"-").concat(t.vs,"-").concat(t.fs)}},{key:"_checkProgramProp",value:function(t){return!t.varyings}},{key:"_createNewProgram",value:function(t,e){var n=e.vs,r=e.fs,i=this.getVertexShader(t,n),o=this.getFragmentShader(t,r);return new Jt(this.gl,Object.assign({},e,{vs:i,fs:o}))}},{key:"_resetProgram",value:function(t,e){t.reset()}},{key:"_compareContexts",value:function(t,e){return(t.gl||t)===(e.gl||e)}}]),t}(),Nn=function(){function t(e,n){Object(g.a)(this,t);var r=n.id,i=void 0===r?"pass":r;this.id=i,this.gl=e,this.props={enabled:!0,screen:!1,swap:!1},Object.assign(this.props,n)}return Object(P.a)(t,[{key:"setProps",value:function(t){Object.assign(this.props,t)}},{key:"render",value:function(t,e){var n=this;if(this.props.enabled){var r=this.gl,i={gl:r,outputBuffer:t.writeBuffer,inputBuffer:t.readBuffer,animationProps:e,swapBuffers:function(){return t._swapFramebuffers()}};this.props.screen?(i.inputBuffer=i.outputBuffer,i.outputBuffer=gt.getDefaultFramebuffer(r)):this.props.swap&&(i.inputBuffer=t.writeBuffer,i.outputBuffer=t.readBuffer),Object(L.c)(r,{framebuffer:i.outputBuffer},function(){return n._renderPass(i)}),this.props.debug&&i.outputBuffer.log(0,this.id),this.props.swap&&t._swapFramebuffers()}}},{key:"_renderPass",value:function(t){t.gl,t.inputBuffer,t.outputBuffer,t.animationProps}}]),t}(),Bn=function(t){function e(t,n){return Object(g.a)(this,e),n=Array.isArray(n)?{passes:n}:n,Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({id:"composite-pass"},n)))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"render",value:function(){var t=this.props.passes,e=void 0===t?[]:t,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.render.apply(s,arguments)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}]),e}(Nn),Un=function(){function t(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(g.a)(this,t),this.gl=e,this.framebuffer1=new gt(e,{id:"multi-pass-1",stencil:!0}),this.framebuffer2=new gt(e,{id:"multi-pass-2",stencil:!0}),this.reset()}return Object(P.a)(t,[{key:"reset",value:function(){this.framebuffer1.resize(),this.framebuffer2.resize(),this.writeBuffer=this.framebuffer1,this.readBuffer=this.framebuffer2,this.maskActive=!1}},{key:"_swapFramebuffers",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}}]),t}(),Vn=function(t){function e(t,n){var r;return Object(g.a)(this,e),n=Array.isArray(n)?{passes:n}:n,(r=Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({id:"multi-pass"},n)))).renderState=new Un(t,n),r}return Object(G.a)(e,t),Object(P.a)(e,[{key:"render",value:function(t){this.renderState.reset();var e=this.props.passes,n=void 0===e?[]:e,r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.render(this.renderState,t)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return this}}]),e}(Bn),Gn=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({id:"clear-pass"},n)))}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_renderPass",value:function(t){var e=t.gl,n=this.props.clearBits,r=void 0===n?16640:n;e.clear(r)}}]),e}(Nn),qn={x:[2,0,1],y:[0,1,2],z:[1,2,0]},Wn=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,e);for(var n=t.bottomRadius,r=void 0===n?0:n,i=t.topRadius,o=void 0===i?0:i,a=t.height,s=void 0===a?1:a,u=t.nradial,c=void 0===u?10:u,l=t.nvertical,f=void 0===l?10:l,h=t.verticalAxis,p=void 0===h?"y":h,d=t.topCap,v=void 0!==d&&d,m=t.bottomCap,y=void 0!==m&&m,_=(v?2:0)+(y?2:0),b=(c+1)*(f+1+_),x=Math.atan2(r-o,s),w=Math.sin,E=Math.cos,S=Math.PI,P=E(x),T=w(x),A=v?-2:0,k=f+(y?2:0),C=c+1,O=new Float32Array(3*b),M=new Float32Array(3*b),I=new Float32Array(2*b),L=new Uint16Array(c*(f+_)*6),R=qn[p],j=0,z=0,D=A;D<=k;D++){var F=D/f,N=s*F,B=void 0;D<0?(N=0,F=1,B=r):D>f?(N=s,F=1,B=o):B=r+D/f*(o-r),-2!==D&&D!==f+2||(B=0,F=0),N-=s/2;for(var G=0;G<C;G++){var q=w(G*S*2/c),W=E(G*S*2/c);O[j+R[0]]=q*B,O[j+R[1]]=N,O[j+R[2]]=W*B,M[j+R[0]]=D<0||D>f?0:q*P,M[j+R[1]]=D<0?-1:D>f?1:T,M[j+R[2]]=D<0||D>f?0:W*P,I[z+0]=G/c,I[z+1]=F,z+=2,j+=3}}for(var Z=0;Z<f+_;Z++)for(var X=0;X<c;X++){var H=6*(Z*c+X);L[H+0]=C*(Z+0)+0+X,L[H+1]=C*(Z+0)+1+X,L[H+2]=C*(Z+1)+1+X,L[H+3]=C*(Z+0)+0+X,L[H+4]=C*(Z+1)+1+X,L[H+5]=C*(Z+1)+0+X}return Object(U.a)(this,Object(V.a)(e).call(this,Object.assign({},t,{attributes:{positions:O,normals:M,texCoords:I,indices:L}})))}return Object(G.a)(e,t),e}(de),Zn=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,e);var n=t.id,r=void 0===n?Object(l.i)("cube-geometry"):n;return Object(U.a)(this,Object(V.a)(e).call(this,Object.assign({},t,{id:r,attributes:{indices:new Uint16Array(Xn),positions:new Float32Array(Hn),normals:new Float32Array(Yn),texCoords:new Float32Array(Kn)}})))}return Object(G.a)(e,t),e}(de),Xn=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Hn=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Yn=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Kn=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]);var Jn=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(g.a)(this,e);var n=t.radius,r=void 0===n?1:n;return Object(U.a)(this,Object(V.a)(e).call(this,Object.assign({},t,{bottomRadius:r,topRadius:r})))}return Object(G.a)(e,t),e}(Wn);var Qn="attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",$n=[-1,-1,1,-1,-1,1,1,1],tr=function(t){function e(t,n){var r;Object(g.a)(this,e);var i=$n.map(function(t){return-1===t?0:t});return(r=Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({},n,{vs:Qn,geometry:new de({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array($n)},aTexCoord:{size:2,value:new Float32Array(i)},aCoordinate:{size:2,value:new Float32Array(i)}}})})))).setVertexCount(4),r}return Object(G.a)(e,t),e}(An),er="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\n\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n",nr=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.a)(this,e),(n=Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({id:"copy-pass",swap:!0},r)))).clipspace=new tr(t,{id:"copy-pass",fs:er}),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_renderPass",value:function(t){var e=t.inputBuffer,n=this.props.opacity,r=void 0===n?1:n;this.clipspace.draw({uniforms:{uDiffuseSampler:e,uOpacity:r},parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Nn),rr="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n",ir=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(g.a)(this,e),n=Object(U.a)(this,Object(V.a)(e).call(this,t,Object.assign({id:"texture-pass"},r)));var i=r.texture,o=r.opacity,a=void 0===o?1:o;return n.clipspace=new tr(t,{id:"texture-pass",fs:rr,uniforms:{uDiffuseSampler:i,uOpacity:a}}),n}return Object(G.a)(e,t),Object(P.a)(e,[{key:"_renderPass",value:function(){this.clipspace.draw({parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Nn);n(501);var or="";function ar(){}function sr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.urls,n=t.onProgress,r=void 0===n?ar:n;Object(k.a)(e.every(function(t){return"string"==typeof t}),"loadImages: {urls} must be array of strings");var i=0;return Promise.all(e.map(function(n){var o=function(t,e){return t=or?or+t:t,new Promise(function(n,r){try{var i=new Image;i.onload=function(){return n(i)},i.onerror=function(){return r(new Error("Could not load image ".concat(t,".")))},i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(t){r(t)}})}(n,t);return o.then(function(t){return r({progress:++i/e.length,count:i,total:e.length,url:n})}),o}))}function ur(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.urls,r=e.onProgress,i=void 0===r?ar:r;return Object(k.a)(n.every(function(t){return"string"==typeof t}),"loadTextures: {urls} must be array of strings"),sr(Object.assign({urls:n,onProgress:i},e)).then(function(r){return r.map(function(r,i){var o=Array.isArray(e.parameters)?e.parameters[i]:e.parameters;return o=void 0===o?{}:o,new et.a(t,Object.assign({id:n[i]},o,{data:r}))})})}n.d(e,"w",function(){return r.d}),n.d(e,"r",function(){return I}),n.d(e,"C",function(){return v.a}),n.d(e,"B",function(){return L.b}),n.d(e,"D",function(){return L.c}),n.d(e,"e",function(){return j}),n.d(e,"u",function(){return D}),n.d(e,"v",function(){return F}),n.d(e,"b",function(){return B.a}),n.d(e,"f",function(){return gt}),n.d(e,"i",function(){return et.a}),n.d(e,"q",function(){return pt}),n.d(e,"h",function(){return An}),n.d(e,"a",function(){return On}),n.d(e,"j",function(){return Dn}),n.d(e,"k",function(){return fe}),n.d(e,"o",function(){return Fn}),n.d(e,"n",function(){return Vn}),n.d(e,"l",function(){return Gn}),n.d(e,"m",function(){return nr}),n.d(e,"p",function(){return ir}),n.d(e,"g",function(){return de}),n.d(e,"c",function(){return Zn}),n.d(e,"d",function(){return Jn}),n.d(e,"x",function(){return ur}),n.d(e,"A",function(){return Ee}),n.d(e,"z",function(){return Se}),n.d(e,"s",function(){return $e}),n.d(e,"t",function(){return on}),n.d(e,"y",function(){return ln}),n(149)},function(t,e,n){"use strict";var r=n(38),i=n(86);function o(t){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function a(t){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}var s=35632,u=35633;function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed",n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function l(t,e,n,r){for(var i=t.split(/\r?\n/),o={},a={},l=r||c(e)||"(unnamed)",p="".concat(function(t){switch(t){case s:return"fragment";case u:return"vertex";default:return"unknown type"}}(n)," shader ").concat(l),d=0;d<i.length;d++){var v=i[d];if(!(v.length<=1)){var g=v.split(":"),m=g[0],y=parseInt(g[2],10);if(isNaN(y))throw new Error("GLSL compilation error in ".concat(p,": ").concat(t));"WARNING"!==m?o[y]=v:a[y]=v}}var _=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ",r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map(function(t,r){var o=r+e,a=String(o).length,s=h(o,i-a);return s+n+t})}(e);return{shaderName:p,errors:f(o,_),warnings:f(a,_)}}function f(t,e){for(var n="",r=0;r<e.length;r++){var i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+="".concat(i,"\n"),t[r+1])){var o=t[r+1],a=o.split(":",3),s=a[0],u=parseInt(a[1],10)||0,c=o.substring(a.join(":").length+1).trim();n+=h("^^^ ".concat(s,": ").concat(c,"\n\n"),u)}}return n}function h(t,e){for(var n="",r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}var p=n(43),d=n(39);function v(t){var e=100,n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){var r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}var g=n(69),m=n(110),y=n(142),_=n(37),b=n.n(_);function x(t,e){b()(t instanceof g.a||t instanceof m.a||t instanceof y.a);var n=t.constructor,r=t.gl,i=t.width,o=t.height,a=t.format,s=t.type,u=t.dataFormat,c=t.border,l=t.mipmaps;return new n(r,Object.assign({width:i,height:o,format:a,type:s,dataFormat:u,border:c,mipmaps:l},e))}n.d(e,"c",function(){return r.c}),n.d(e,"a",function(){return r.a}),n.d(e,"b",function(){return r.b}),n.d(e,"m",function(){return i.c}),n.d(e,"n",function(){return i.d}),n.d(e,"e",function(){return i.b}),n.d(e,"d",function(){return i.a}),n.d(e,"p",function(){return o}),n.d(e,"f",function(){return a}),n.d(e,"o",function(){return l}),n.d(e,"k",function(){return c}),n.d(e,"h",function(){return p.a}),n.d(e,"q",function(){return p.d}),n.d(e,"j",function(){return d.b}),n.d(e,"i",function(){return d.a}),n.d(e,"l",function(){return v}),n.d(e,"g",function(){return x})},function(t,e,n){"use strict";n.r(e);var r=n(105),i=n(17);if(r.global.deck&&"6.2.4"!==r.global.deck.VERSION)throw new Error("deck.gl - multiple versions detected: ".concat(r.global.deck.VERSION," vs ").concat("6.2.4"));r.global.deck||(i.a.log(0,"deck.gl ".concat("6.2.4"," - ").concat("set deck.log.priority=1 (or higher) to trace attribute updates"))(),r.global.deck=r.global.deck||{VERSION:"6.2.4",version:"6.2.4",log:i.a}),console.table||(console.table=function(){}),n(240);n(240);var o=n(21),a=n(16),s=n(11),u=n(31),c=n.n(u),l=n(14),f=n.n(l);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m={isExternalBuffer:!1,needsUpdate:!0,needsRedraw:!1,allocedInstances:-1},y=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=d(this,v(e).call(this,t,r));var i=r.transition,o=void 0!==i&&i,a=r.noAlloc,s=void 0!==a&&a,u=r.update,c=void 0===u?null:u,l=r.accessor,f=void 0===l?null:l,h=r.bufferLayout,p=void 0===h?null:h,g=r.defaultValue,y=void 0===g?[0,0,0,0]:g;return y=Array.isArray(y)?y:[y],Object.assign(n.userData,m,r,{transition:o,noAlloc:s,update:c,accessor:f,defaultValue:y,bufferLayout:p}),Object.seal(n.userData),n._validateAttributeUpdaters(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,s["k"]),function(t,e,n){e&&p(t.prototype,e),n&&p(t,n)}(e,[{key:"needsUpdate",value:function(){return this.userData.needsUpdate}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearChangedFlags,e=void 0!==t&&t,n=this.userData.needsRedraw;return this.userData.needsRedraw=this.userData.needsRedraw&&!e,n}},{key:"getInstanceCount",value:function(){return null!==this.value?this.value.length/this.size:0}},{key:"getUpdateTriggers",value:function(){var t=this.userData.accessor;return[this.id].concat(t||[])}},{key:"getAccessor",value:function(){return this.userData.accessor}},{key:"supportsTransition",value:function(){return this.userData.transition}},{key:"getTransitionSetting",value:function(t){var e=this.userData,n=e.transition,r=e.accessor;if(!n)return null;var i=Array.isArray(r)?t[r.find(function(e){return t[e]})]:t[r];return Number.isFinite(i)&&(i={duration:i}),i&&i.duration>0?Object.assign({},n,i):null}},{key:"setNeedsUpdate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.userData.needsUpdate=this.userData.needsUpdate||t}},{key:"setNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.userData.needsRedraw=this.userData.needsRedraw||t}},{key:"allocate",value:function(t){var e=this.userData;if(e.isExternalBuffer||e.noAlloc)return!1;var n=this.getInstanceCount();if((0===n||n<t)&&(e.update||e.accessor)){Object(a.a)(Number.isFinite(t));var r=Math.max(t,1),i=_(this.type||f.a.FLOAT);return this.constant=!1,this.value=new i(this.size*r),e.needsUpdate=!0,e.allocedInstances=r,!0}return!1}},{key:"updateBuffer",value:function(t){var e=t.numInstances,n=t.data,r=t.props,i=t.context;if(!this.needsUpdate())return!1;var o=this.userData,a=o.update,s=o.accessor,u=!0;return a?(a.call(i,this,{data:n,props:r,numInstances:e}),this.update({value:this.value,constant:this.constant}),this._checkAttributeArray()):s?(this._updateBufferViaStandardAccessor(n,r),this._checkAttributeArray()):u=!1,o.needsUpdate=!1,o.needsRedraw=!0,u}},{key:"setGenericValue",value:function(t){var e=this.userData;if(void 0===t||"function"==typeof t)return e.isExternalBuffer=!1,!1;t=this._normalizeValue(t);var n=!this.constant||!this._areValuesEqual(t,this.value);return n&&this.update({constant:!0,value:t}),e.needsRedraw=e.needsUpdate||n,e.needsUpdate=!1,e.isExternalBuffer=!0,!0}},{key:"setExternalBuffer",value:function(t,e){var n=this.userData;if(t){if(n.isExternalBuffer=!0,n.needsUpdate=!1,t instanceof s.b)this.externalBuffer!==t&&(this.update({constant:!1,buffer:t}),n.needsRedraw=!0);else{var r=_(this.type||f.a.FLOAT);if(!(t instanceof r))throw new Error("Attribute ".concat(this.id," must be of type ").concat(r.name));if(n.auto&&t.length<=e*this.size)throw new Error("Attribute prop array must match length and size");this.value!==t&&(this.update({constant:!1,value:t}),n.needsRedraw=!0)}return!0}return n.isExternalBuffer=!1,!1}},{key:"_normalizeValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.userData.defaultValue;if(!Array.isArray(t)&&!ArrayBuffer.isView(t))return e[n]=Number.isFinite(t)?t:r[0],e;switch(this.size){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0]}return e}},{key:"_areValuesEqual",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.size,r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}},{key:"_updateBufferViaStandardAccessor",value:function(t,e){var n=this.userData.accessor,r=this.value,i=this.size,o=e[n];Object(a.a)("function"==typeof o,'accessor "'.concat(n,'" is not a function'));var s=0,u=!0,c=!1,l=void 0;try{for(var f,h=t[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=o(f.value);this._normalizeValue(p,r,s),s+=i}}catch(t){c=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}this.update({value:r})}},{key:"_validateAttributeUpdaters",value:function(){var t=this.userData;if(!(t.noAlloc||"function"==typeof t.update||"string"==typeof t.accessor))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}},{key:"_checkAttributeArray",value:function(){var t=this.value;if(t&&t.length>=4&&!(Number.isFinite(t[0])&&Number.isFinite(t[1])&&Number.isFinite(t[2])&&Number.isFinite(t[3])))throw new Error("Illegal attribute generated for ".concat(this.id))}},{key:"bufferLayout",get:function(){return this.userData.bufferLayout},set:function(t){this.userData.bufferLayout=t}}]),e}();function _(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clamped,n=void 0===e||e;switch(t){case f.a.FLOAT:return Float32Array;case f.a.UNSIGNED_SHORT:case f.a.UNSIGNED_SHORT_5_6_5:case f.a.UNSIGNED_SHORT_4_4_4_4:case f.a.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;case f.a.UNSIGNED_INT:return Uint32Array;case f.a.UNSIGNED_BYTE:return n?Uint8ClampedArray:Uint8Array;case f.a.BYTE:return Int8Array;case f.a.SHORT:return Int16Array;case f.a.INT:return Int32Array;default:throw new Error("Failed to deduce type from array")}}function b(t){var e=t.source,n=t.target,r=t.start,i=void 0===r?0:r,o=t.end,a=t.getData;o=o||n.length;var s=e.length,u=o-i;if(s>u)n.set(e.subarray(0,u),i);else if(n.set(e,i),a)for(var c=s;c<u;)for(var l=a(c,e),f=0;f<l.length;f++)n[i+c]=l[f],c++}var x={1:"float",2:"vec2",3:"vec3",4:"vec4"};function w(t){var e={},n={};for(var r in t){var i=t[r],o=i.fromState,a=i.toState,s=i.buffer;e["".concat(r,"From")]=o,e["".concat(r,"To")]=a,n["".concat(r)]=s}return{sourceBuffers:e,feedbackBuffers:n}}function E(t){var e=t.fromState,n=t.toState,r=t.fromLength,i=t.toLength,o=t.fromBufferLayout,a=t.toBufferLayout,u=t.getData,c=void 0===u?function(t){return t}:u;if((o&&a||!(r>=i))&&e instanceof s.b){var l=new Float32Array(i),f=e.getData({}),h=n.value,p=n.buffer,d=n.size,v=n.constant,g=h||p.getData({}),m=v?function(t,e){return c(h,e)}:function(t,e){return c(g.subarray(t,t+d),e)};!function(t){var e=t.source,n=t.target,r=t.size,i=t.getData,o=t.sourceLayout,a=t.targetLayout;if(!Array.isArray(a))return b({source:e,target:n,getData:i}),n;for(var s=0,u=0,c=i&&function(t,e){return i(t+u,e)},l=Math.min(o.length,a.length),f=0;f<l;f++){var h=o[f]*r,p=a[f]*r;b({source:e.subarray(s,s+h),target:n,start:u,end:u+p,getData:c}),s+=h,u+=p}u<n.length&&b({source:[],target:n,start:u,getData:c})}({source:f,target:l,sourceLayout:o,targetLayout:a,size:n.size,getData:m}),e.setData({data:l})}}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var P={NONE:"none",PENDING:"pending",IN_PROGRESS:"in_progress",ENDED:"ended"};function T(){}var A=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._startTime=null,this._state=P.NONE,this.duration=1,this.easing=function(t){return t},this.onStart=T,this.onUpdate=T,this.onInterrupt=T,this.onEnd=T,Object.assign(this,e)}return function(t,e,n){e&&S(t.prototype,e),n&&S(t,n)}(t,[{key:"start",value:function(t){this.inProgress&&this.onInterrupt(this),Object.assign(this,t),this._setState(P.PENDING)}},{key:"cancel",value:function(){this.inProgress&&(this.onInterrupt(this),this._setState(P.NONE))}},{key:"update",value:function(t){if(this.state===P.PENDING&&(this._startTime=t,this._setState(P.IN_PROGRESS)),this.state===P.IN_PROGRESS){var e=!1,n=(t-this._startTime)/this.duration;return n>=1&&(n=1,e=!0),this.time=this.easing(n),this.onUpdate(this),e&&this._setState(P.ENDED),!0}return!1}},{key:"_setState",value:function(t){if(this._state!==t)switch(this._state=t,t){case P.PENDING:this.onStart(this);break;case P.ENDED:this.onEnd(this)}}},{key:"state",get:function(){return this._state}},{key:"inProgress",get:function(){return this._state===P.PENDING||this._state===P.IN_PROGRESS}}]),t}();function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var C=function(){},O={duration:0,easing:function(t){return t},onStart:C,onEnd:C,onInterrupt:C},M=function(){function t(e,n){var r=n.id;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=r,this.gl=e,this.attributeTransitions={},this.needsRedraw=!1,this.transform=null,this.numInstances=0,s.j.isSupported(e)?this.isSupported=!0:i.a.warn("WebGL2 not supported by this browser. Transition animation is disabled.")()}return function(t,e,n){e&&k(t.prototype,e),n&&k(t,n)}(t,[{key:"finalize",value:function(){for(var t in this.transform&&this.transform.delete(),this.attributeTransitions)this._removeTransition(t)}},{key:"update",value:function(t){var e=t.attributes,n=t.transitions,r=void 0===n?{}:n,i=t.numInstances;if(this.opts=r,this.numInstances=i,this.isSupported){var o=this.attributeTransitions,a={};for(var s in e){this._updateAttribute(s,e[s])&&(a[s]=o[s])}for(var u in o){var c=e[u];c&&c.supportsTransition()||this._removeTransition(u)}if(this.transform){if(this.transform){var l=w(a),f=l.sourceBuffers,h=l.feedbackBuffers;this.transform.update({elementCount:this.numInstances,sourceBuffers:f,feedbackBuffers:h})}}else this._createModel()}}},{key:"hasAttribute",value:function(t){return t in this.attributeTransitions}},{key:"getAttributes",value:function(){var t={};for(var e in this.attributeTransitions){var n=this.attributeTransitions[e];n.buffer&&(t[e]=n.attributeInTransition)}return t}},{key:"setCurrentTime",value:function(t){if(!this.transform||0===this.numInstances)return!1;var e={},n=this.needsRedraw;for(var r in this.needsRedraw=!1,this.attributeTransitions){var i=this.attributeTransitions[r];i.update(t)&&(e["".concat(r,"Time")]=i.time,n=!0)}return n&&this.transform.run({uniforms:e}),n}},{key:"_createTransition",value:function(t,e){var n=this.attributeTransitions[t];return n?null:(n=new A({name:t,attribute:e,attributeInTransition:new y(this.gl,e),bufferLayout:e.bufferLayout}),this.attributeTransitions[t]=n,this._invalidateModel(),n)}},{key:"_removeTransition",value:function(t){var e=this.attributeTransitions[t];e&&(e.buffer&&e.buffer.delete(),e._swapBuffer&&e._swapBuffer.delete(),delete this.attributeTransitions[t],this._invalidateModel())}},{key:"_updateAttribute",value:function(t,e){var n=e.getTransitionSetting(this.opts);if(n){var r,i=this.attributeTransitions[t];if(i?r=e.needsRedraw():(i=this._createTransition(t,e),r=!0),r)return this._triggerTransition(i,n),!0}return!1}},{key:"_invalidateModel",value:function(){this.transform&&(this.transform.delete(),this.transform=null)}},{key:"_createModel",value:function(){0!==Object.keys(this.attributeTransitions).length&&(this.transform=new s.j(this.gl,Object.assign({elementCount:this.numInstances},w(this.attributeTransitions),function(t){var e=[],n=[],r=[],i=[],o=[];for(var a in t){var s=t[a],u=x[s.attribute.size];u&&(s.bufferIndex=e.length,e.push(a),n.push("attribute ".concat(u," ").concat(a,"From;")),n.push("attribute ".concat(u," ").concat(a,"To;")),r.push("uniform float ".concat(a,"Time;")),i.push("varying ".concat(u," ").concat(a,";")),o.push("".concat(a," = mix(").concat(a,"From, ").concat(a,"To,\n        ").concat(a,"Time);")))}return{vs:"\n#define SHADER_NAME feedback-vertex-shader\n".concat(n.join("\n"),"\n").concat(r.join("\n"),"\n").concat(i.join("\n"),"\n\nvoid main(void) {\n  ").concat(o.join("\n"),"\n  gl_Position = vec4(0.0);\n}\n"),fs:"#define SHADER_NAME feedback-fragment-shader\n\nprecision highp float;\n\n".concat(i.join("\n"),"\n\nvoid main(void) {\n  gl_FragColor = vec4(0.0);\n}\n"),varyings:e}}(this.attributeTransitions))))}},{key:"_getNextTransitionStates",value:function(t,e){var n,r=t.attribute,i=r.size;n=r.constant?{constant:!0,value:r.value,size:i}:{constant:!1,buffer:r.getBuffer(),size:i,value:r.externalBuffer?null:r.value};var o=t.buffer||n,a=this.numInstances*i,u=o instanceof s.b&&o.getElementCount()||a,c=t._swapBuffer;return t._swapBuffer=t.buffer,c?c.getElementCount()<a&&c.setData({data:new Float32Array(a)}):c=new s.b(this.gl,{data:new Float32Array(a),usage:f.a.DYNAMIC_COPY}),t.attributeInTransition.update({buffer:c}),E({fromState:o,toState:n,fromLength:u,toLength:a,fromBufferLayout:t.bufferLayout,toBufferLayout:r.bufferLayout,getData:e.enter}),t.bufferLayout=r.bufferLayout,{fromState:o,toState:n,buffer:c}}},{key:"_triggerTransition",value:function(t,e){Object(a.a)(e&&e.duration>0),this.needsRedraw=!0;var n=Object.assign({},O,e);t.start(Object.assign({},this._getNextTransitionStates(t,e),n))}}]),t}();function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L(t,e,n){return e&&I(t.prototype,e),n&&I(t,n),t}function R(){}var j={savedMessages:null,timeStart:null,onLog:function(t){var e=t.level,n=t.message;i.a.log(e,n)()},onUpdateStart:function(t){t.level,t.numInstances;j.savedMessages=[],j.timeStart=new Date},onUpdate:function(t){t.level;var e=t.message;j.savedMessages&&j.savedMessages.push(e)},onUpdateEnd:function(t){var e=t.level,n=t.id,r=t.numInstances,o=Math.round(new Date-j.timeStart),a="".concat(o,"ms");i.a.group(e,"Updated attributes for ".concat(r," instances in ").concat(n," in ").concat(a),{collapsed:!0})();var s=!0,u=!1,c=void 0;try{for(var l,f=j.savedMessages[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;i.a.log(e,h)()}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}i.a.groupEnd(e,"Updated attributes for ".concat(r," instances in ").concat(n," in ").concat(a))(),j.savedMessages=null}},z=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id,i=void 0===r?"attribute-manager":r,o=n.stats;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=i,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=o,this.attributeTransitionManager=new M(e,{id:"".concat(i,"-transitions")}),Object.seal(this)}return L(t,null,[{key:"setDefaultLogFunctions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.onLog,n=t.onUpdateStart,r=t.onUpdate,i=t.onUpdateEnd;void 0!==e&&(j.onLog=e||R),void 0!==n&&(j.onUpdateStart=n||R),void 0!==r&&(j.onUpdate=r||R),void 0!==i&&(j.onUpdateEnd=i||R)}}]),L(t,[{key:"finalize",value:function(){for(var t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t,n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e,n&&this.id}},{key:"setNeedsRedraw",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=!0,this}},{key:"add",value:function(t,e){this._add(t,e)}},{key:"addInstanced",value:function(t,e){this._add(t,e,{instanced:1})}},{key:"remove",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}},{key:"invalidate",value:function(t){var e=this._invalidateTrigger(t);j.onLog({level:3,message:"invalidated attributes ".concat(e," (").concat(t,") for ").concat(this.id)})}},{key:"invalidateAll",value:function(){for(var t in this.attributes)this.attributes[t].setNeedsUpdate();j.onLog({level:3,message:"invalidated all attributes for ".concat(this.id)})}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.numInstances,r=t.transitions,i=t.props,o=void 0===i?{}:i,a=t.buffers,s=void 0===a?{}:a,u=t.context,c=void 0===u?{}:u,l=!1;for(var f in j.onUpdateStart({level:2,id:this.id,numInstances:n}),this.stats&&this.stats.timeStart("attribute updates",this.id),this.attributes){var h=this.attributes[f];h.setExternalBuffer(s[f],this.numInstances)||h.setGenericValue(o[h.getAccessor()])||h.needsUpdate()&&(l=!0,this._updateAttribute({attribute:h,numInstances:n,data:e,props:o,context:c})),this.needsRedraw|=h.needsRedraw()}l&&(this.stats&&this.stats.timeEnd("attribute updates",this.id),j.onUpdateEnd({level:2,id:this.id,numInstances:n})),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}},{key:"updateTransition",value:function(){var t=this.attributeTransitionManager.setCurrentTime(Date.now());return this.needsRedraw=this.needsRedraw||t,t}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getChangedAttributes",value:function(t){t.clearChangedFlags;var e=this.attributes,n=this.attributeTransitionManager,r=Object.assign({},n.getAttributes());for(var i in e){var o=e[i];o.needsRedraw({clearChangedFlags:!0})&&(n.hasAttribute(i)||(r[i]=o))}return r}},{key:"getAccessors",value:function(){return this.updateTriggers}},{key:"_add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&i.a.warn("AttributeManager.add({updaters}) - updater map no longer supported")();var r={};for(var o in t){var a=t[o];r[o]=new y(this.gl,Object.assign({},a,{id:o,constant:a.constant||!1,isIndexed:a.isIndexed||a.elements,size:a.elements?1:a.size,value:a.value||null,instanced:a.instanced||n.instanced}))}Object.assign(this.attributes,r),this._mapUpdateTriggersToAttributes()}},{key:"_mapUpdateTriggersToAttributes",value:function(){var t=this,e={},n=function(n){t.attributes[n].getUpdateTriggers().forEach(function(t){e[t]||(e[t]=[]),e[t].push(n)})};for(var r in this.attributes)n(r);this.updateTriggers=e}},{key:"_invalidateTrigger",value:function(t){var e=this.attributes,n=this.updateTriggers[t];if(n)n.forEach(function(t){var n=e[t];n&&n.setNeedsUpdate()});else{var r="invalidating non-existent trigger ".concat(t," for ").concat(this.id,"\n");r+="Valid triggers: ".concat(Object.keys(e).join(", ")),i.a.warn(r,n)()}return n}},{key:"_updateAttribute",value:function(t){var e=t.attribute,n=t.numInstances,r=t.data,i=t.props,o=t.context;e.allocate(n)&&j.onUpdate({level:3,message:"".concat(e.id," allocated ").concat(n),id:this.id});var a=Date.now();if(e.updateBuffer({numInstances:n,data:r,props:i,context:o})){this.needsRedraw=!0;var s=Math.round(Date.now()-a);j.onUpdate({level:3,message:"".concat(e.id," updated ").concat(n," in ").concat(s,"ms")})}}}]),t}();function D(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var F=new Map,N=function(t){if(c.a.isReady()&&t.id){var e=F.get(t.id);e&&e.forEach(function(e,n){!function t(e,n,r){e&&(n.length>1?t(e[n[0]],n.slice(1),r):e[n[0]]=r)}(t,n,e),"data"===n[0]&&(t.data=D(t.data))})}},B=function(t){c.a.isReady()&&c.a.listenFor("deck.gl",t)},U=function(t){c.a.isReady()&&c.a.listenFor("init",t)},V=function(t){if(c.a.isReady()&&t){var e=[t.constructor.layerName];c.a.listItem("deck.gl",t.id,{badges:e,links:t.state&&t.state.model?["luma.gl:".concat(t.state.model.id)]:void 0,parent:t.parent?t.parent.id:void 0})}},G=function(t){if(c.a.isReady()&&!c.a.throttle("deck.gl:".concat(t.id),1e3)){var e=function(t){var e=[{path:"objects.props",data:t.props}],n=[t.constructor.layerName];if(t.state){if(t.getAttributeManager()){var r=t.getAttributeManager().getAttributes();e.push({path:"objects.attributes",data:r}),n.push(t.getAttributeManager().stats.getTimeString())}if(t.state.model){t.state.model.setProps({timerQueryEnabled:!0});var i=t.state.model.stats.lastFrameTime;i&&n.push("".concat((1e3*i).toFixed(0),"s"))}}return e.push({path:"badges",data:n}),e}(t);c.a.multiUpdate("deck.gl",t.id,e)}};function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){var n=Z({newProps:t,oldProps:e,ignoreProps:{data:null,updateTriggers:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";var n=t.dataComparator;if(n){if(!n(t.data,e.data))return"Data comparator detected a change"}else if(t.data!==e.data)return"A new data container was supplied";return null}(t,e),i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){var n=X(e,t,"all");if(n)return{all:!0}}var r={},i=!1;for(var o in t.updateTriggers)if("all"!==o){var a=X(e,t,o);a&&(r[o]=!0,i=r)}return i}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i}}function Z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.newProps,n=t.oldProps,r=t.ignoreProps,i=void 0===r?{}:r,o=t.shallowCompareProps,s=void 0===o?{}:o,u=t.triggerName,c=void 0===u?"props":u;if(Object(a.a)(void 0!==n&&void 0!==e,"compareProps args"),n===e)return null;if("object"!==q(e)||null===e)return"".concat(c," changed shallowly");if("object"!==q(n)||null===n)return"".concat(c," changed shallowly");for(var l in n)if(!(l in i)){if(!(l in e))return"".concat(c,".").concat(l," dropped: ").concat(n[l]," -> undefined");var f=e[l]&&n[l]&&e[l].equals;if(f&&!f.call(e[l],n[l]))return"".concat(c,".").concat(l," changed deeply: ").concat(n[l]," -> ").concat(e[l]);if(l in s)"function"===q(e[l])&&"function"==typeof n[l]&&(f=!0);if(!f&&n[l]!==e[l])return"".concat(c,".").concat(l," changed shallowly: ").concat(n[l]," -> ").concat(e[l])}for(var h in e)if(!(h in i||h in n))return"".concat(c,".").concat(h," added: undefined -> ").concat(e[h]);return null}function X(t,e,n){var r=t.updateTriggers[n]||{};return Z({oldProps:e.updateTriggers[n]||{},newProps:r,triggerName:n})}function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Y="count(): argument not an object",K="count(): argument not a container";function J(t){if(!function(t){return null!==t&&"object"===H(t)}(t))throw new Error(Y);if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===H(t)&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error(K)}var Q=n(125),$={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"};function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var nt={boolean:{validate:function(t,e){return!0}},number:{validateType:function(t,e){return"value"in e&&(!("max"in e)||Number.isFinite(e.max))&&(!("min"in e)||Number.isFinite(e.min))},validate:function(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}}};function rt(t,e){switch(it(e)){case"object":return function(t){var e=t.type,n=(nt[e]||{}).typeValidator;n&&Object(a.a)(n(t),"Illegal prop type");return t}(e=function(t,e){if(!("type"in e))return"value"in e?Object.assign({name:t,type:it(e.value)},e):{name:t,type:"object",value:e};return Object.assign({name:t},e)}(t,e));case"array":return function(t,e){if(/color/i.test(t)&&(3===e.length||4===e.length))return{name:t,type:"color",value:e};return{name:t,type:"array",value:e}}(t,e);case"boolean":return{name:t,type:"boolean",value:e};case"number":return function(t,e){var n=/radius|scale|width|height|pixel|size|miter/i.test(t)&&/^((?!scale).)*$/.test(t)?100:1;return{name:t,type:"number",max:Math.max(e,n),min:Math.min(e,0),value:e}}(t,e);case"function":return{name:t,type:"function",value:e};default:return{name:t,type:"unknown",value:e}}}function it(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":null===t?"null":tt(t)}function ot(t){var e=st(t,"_mergedDefaultProps");return e?{defaultProps:e,propTypes:st(t,"_propTypes")}:function(t){var e=t.prototype;if(!e)return{defaultProps:{}};var n=Object.getPrototypeOf(t),r=e&&ot(n)||null,o=function(t){for(var e={},n={},r=Object.entries(t),i=0;i<r.length;i++){var o=et(r[i],2),a=o[0],s=rt(a,o[1]);e[a]=s,n[a]=s.value}return{propTypes:e,defaultProps:n}}(st(t,"defaultProps")||{}),a=Object.assign({},r&&r.propTypes,o.propTypes),s=function(t,e,n,r){var o=Object.create(null);Object.assign(o,e,t);var a=function(t){var e=st(t,"layerName")||st(t,"componentName");e||i.a.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(r);return delete t.id,Object.defineProperties(o,{id:{configurable:!1,writable:!0,value:a}}),function(t,e){var n={},r={_asyncPropDefaultValues:{enumerable:!1,value:n},_asyncPropOriginalValues:{enumerable:!1,value:{}}};for(var i in e){var o=e[i],a=o.name,s=o.value;o.async&&(n[a]=s,r[a]=at(a))}Object.defineProperties(t,r)}(o,n),o}(o.defaultProps,r&&r.defaultProps,a,t);return t._mergedDefaultProps=s,t._propTypes=a,{propTypes:a,defaultProps:s}}(t)}function at(t){return{configurable:!1,enumerable:!0,set:function(e){"string"==typeof e||e instanceof Promise?this._asyncPropOriginalValues[t]=e:this._asyncPropResolvedValues[t]=e},get:function(){if(this._asyncPropResolvedValues){if(t in this._asyncPropResolvedValues){var e=this._asyncPropResolvedValues[t];return"data"===t?e||this._asyncPropDefaultValues[t]:e}var n=this._component&&this._component.internalState;if(n&&n.hasAsyncProp(t))return n.getAsyncProp(t)}return this._asyncPropDefaultValues[t]}}}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)&&t[e]}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=Object.freeze({}),lt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=function(){},this.oldProps=ct,this.oldAsyncProps=null}return function(t,e,n){e&&ut(t.prototype,e),n&&ut(t,n)}(t,[{key:"getOldProps",value:function(){return this.oldAsyncProps||this.oldProps}},{key:"resetOldProps",value:function(){this.oldAsyncProps=null,this.oldProps=this.component.props}},{key:"freezeAsyncOldProps",value:function(){if(!this.oldAsyncProps)for(var t in this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps={},this.oldProps)this.oldAsyncProps[t]=this.oldProps[t]}},{key:"hasAsyncProp",value:function(t){return t in this.asyncProps}},{key:"getAsyncProp",value:function(t){var e=this.asyncProps[t];return e&&e.resolvedValue}},{key:"isAsyncPropLoading",value:function(t){var e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}},{key:"setAsyncProps",value:function(t){var e=t._asyncPropResolvedValues||{},n=t._asyncPropOriginalValues||t,r=t._asyncPropDefaultValues||{};for(var i in e){var o=e[i];this._createAsyncPropData(i,o,r[i]),this._updateAsyncProp(i,o)}for(var a in n){var s=n[a];this._createAsyncPropData(a,s,r[a]),this._updateAsyncProp(a,s)}}},{key:"_updateAsyncProp",value:function(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"==typeof e)e=(0,this.layer.props.fetch)(e);e instanceof Promise?this._watchPromise(t,e):this._setPropValue(t,e)}}},{key:"_didAsyncInputValueChange",value:function(t,e){var n=this.asyncProps[t];return e!==n.lastValue&&(n.lastValue=e,!0)}},{key:"_setPropValue",value:function(t,e){var n=this.asyncProps[t];n.value=e,n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}},{key:"_setAsyncPropValue",value:function(t,e,n){var r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&(Object(a.a)(void 0!==e),this.freezeAsyncOldProps(),e=this._postProcessValue(t,e),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}},{key:"_watchPromise",value:function(t,e){var n=this,r=this.asyncProps[t];r.pendingLoadCount++;var o=r.pendingLoadCount;e.then(function(e){return n._setAsyncPropValue(t,e,o)}).catch(function(t){return i.a.error(t)()})}},{key:"_postProcessValue",value:function(t,e){var n=(this.component?this.component.props:{}).dataTransform;return"data"===t&&n&&(e=n(e)),e}},{key:"_createAsyncPropData",value:function(t,e,n){this.asyncProps[t]||(this.asyncProps[t]={lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0})}}]),t}();function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ht=0,pt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.props=function(){for(var t=ot(this.constructor).defaultProps,e=Object.create(t,{_component:{enumerable:!1,value:this},_asyncPropOriginalValues:{enumerable:!1,value:{}},_asyncPropResolvedValues:{enumerable:!1,value:{}}}),n=0;n<arguments.length;++n)Object.assign(e,arguments[n]);return N(e),Object.freeze(e),e}.apply(this,arguments),this.id=this.props.id,this.count=ht++,this.lifecycle=$.NO_STATE,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}return function(t,e,n){e&&ft(t.prototype,e),n&&ft(t,n)}(t,[{key:"clone",value:function(t){return new this.constructor(Object.assign({},this.props,t))}},{key:"_initState",value:function(){this.internalState=new lt({})}},{key:"stats",get:function(){return this.internalState.stats}}]),t}();function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gt(t,e){return!e||"object"!==dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}pt.defaultProps={};var _t=function(t){function e(t){var n,r=t.attributeManager,i=t.layer;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=gt(this,mt(e).call(this,i))).attributeManager=r,n.model=null,n.needsRedraw=!0,n.subLayers=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(e,lt),function(t,e,n){e&&vt(t.prototype,e),n&&vt(t,n)}(e,[{key:"layer",get:function(){return this.component},set:function(t){this.component=t}}]),e}(),bt=n(178);function xt(t){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t,e){return!e||"object"!==xt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var At=function(){},kt={data:{type:"data",value:Object.freeze([]),async:!0},dataComparator:null,dataTransform:function(t){return t},fetch:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return fetch(t).then(function(t){return t.json()})}),updateTriggers:{},numInstances:void 0,visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:.8},onHover:At,onClick:At,coordinateSystem:o.a.LNGLAT,coordinateOrigin:[0,0,0],wrapLongitude:!1,parameters:{},uniforms:{},framebuffer:null,animation:null,getPolygonOffset:function(t){return[0,100*-t.layerIndex]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:[0,0,128,128]},Ct=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),St(this,Pt(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(e,pt),function(t,e,n){e&&Et(t.prototype,e),n&&Et(t,n)}(e,[{key:"toString",value:function(){var t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}},{key:"setState",value:function(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.internalState&&(this.internalState.needsRedraw=t)}},{key:"setLayerNeedsUpdate",value:function(){this.context.layerManager.setNeedsUpdate(String(this))}},{key:"getNeedsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0!==t&&t;return this._getNeedsRedraw(e)}},{key:"needsUpdate",value:function(){return this.shouldUpdateState(this._getUpdateParams())}},{key:"isPickable",value:function(){return this.props.pickable&&this.props.visible}},{key:"getModels",value:function(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}},{key:"getSingleModel",value:function(){return this.state&&this.state.model}},{key:"getAttributeManager",value:function(){return this.internalState&&this.internalState.attributeManager}},{key:"getCurrentLayer",value:function(){return this.internalState&&this.internalState.layer}},{key:"getFirstObject",value:function(){var t=this.props.data,e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){return i.value}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"project",value:function(t){var e=this.context.viewport,n=Object(Q.a)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),r=wt(Object(bt.k)(n,e.pixelProjectionMatrix),3),i=r[0],o=r[1],a=r[2];return 2===t.length?[i,o]:[i,o,a]}},{key:"unproject",value:function(t){var e=this.context.viewport;return Object(a.a)(Array.isArray(t)),e.unproject(t)}},{key:"projectPosition",value:function(t){return Object(a.a)(Array.isArray(t)),Object(Q.b)(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}},{key:"projectFlat",value:function(t){i.a.deprecated("layer.projectFlat","layer.projectPosition")();var e=this.context.viewport;return Object(a.a)(Array.isArray(t)),e.projectFlat(t)}},{key:"unprojectFlat",value:function(t){i.a.deprecated("layer.unprojectFlat")();var e=this.context.viewport;return Object(a.a)(Array.isArray(t)),e.unprojectFlat(t)}},{key:"use64bitProjection",value:function(){if(this.props.fp64){if(this.props.coordinateSystem===o.a.LNGLAT_DEPRECATED)return!0;i.a.once(0,"Legacy 64-bit mode only works with coordinateSystem set to\n        COORDINATE_SYSTEM.LNGLAT_DEPRECATED. Rendering in 32-bit mode instead")()}return!1}},{key:"use64bitPositions",value:function(){return this.props.fp64||this.props.coordinateSystem===o.a.LNGLAT}},{key:"screenToDevicePixels",value:function(t){return i.a.deprecated("screenToDevicePixels","DeckGL prop useDevicePixels for conversion")(),t*("undefined"!=typeof window?window.devicePixelRatio:1)}},{key:"nullPickingColor",value:function(){return[0,0,0]}},{key:"encodePickingColor",value:function(t){return Object(a.a)(0==(t+1>>24&255),"index out of picking color range"),[t+1&255,t+1>>8&255,t+1>>8>>8&255]}},{key:"decodePickingColor",value:function(t){Object(a.a)(t instanceof Uint8Array);var e=wt(t,3);return e[0]+256*e[1]+65536*e[2]-1}},{key:"initializeState",value:function(){throw new Error("Layer ".concat(this," has not defined initializeState"))}},{key:"shouldUpdateState",value:function(t){t.oldProps,t.props,t.context;return t.changeFlags.propsOrDataChanged}},{key:"updateState",value:function(t){t.oldProps,t.props,t.context;var e=t.changeFlags,n=this.getAttributeManager();e.dataChanged&&n&&n.invalidateAll()}},{key:"finalizeState",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.getModels()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.delete()}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}var o=this.getAttributeManager();o&&o.finalize()}},{key:"draw",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.draw(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"getPickingInfo",value:function(t){var e=t.info,n=(t.mode,e.index);return n>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[n]),e}},{key:"invalidateAttribute",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getAttributeManager();n&&("all"===t?(i.a.log(1,"updateTriggers invalidating all attributes: ".concat(e))(),n.invalidateAll()):(i.a.log(1,"updateTriggers invalidating attribute ".concat(t,": ").concat(e))(),n.invalidate(t)))}},{key:"updateAttributes",value:function(t){var e=this.getAttributeManager();if(e){var n=this.getNumInstances(t);e.update({data:t.data,numInstances:n,props:t,transitions:t.transitions,buffers:t,context:this,ignoreUnknownAttributes:!0});var r=this.getSingleModel();if(r){var i=e.getChangedAttributes({clearChangedFlags:!0});r.setAttributes(i)}}}},{key:"updateTransition",value:function(){var t=this.getAttributeManager();t&&t.updateTransition()}},{key:"calculateInstancePickingColors",value:function(t,e){for(var n=e.numInstances,r=t.value,i=t.size,o=0;o<n;o++){var a=this.encodePickingColor(o);r[o*i+0]=a[0],r[o*i+1]=a[1],r[o*i+2]=a[2]}}},{key:"_clearInstancePickingColor",value:function(t){var e=this.getAttributeManager().attributes.instancePickingColors,n=e.value,r=e.size,i=this.decodePickingColor(t);n[i*r+0]=0,n[i*r+1]=0,n[i*r+2]=0,e.update({value:n})}},{key:"_clearPickingColor",value:function(t){for(var e=this.getAttributeManager().attributes.pickingColors,n=e.value,r=0;r<n.length;r+=3)n[r+0]===t[0]&&n[r+1]===t[1]&&n[r+2]===t[2]&&(n[r+0]=0,n[r+1]=0,n[r+2]=0);e.update({value:n})}},{key:"clearPickingColor",value:function(t){this.getAttributeManager().attributes.pickingColors?this._clearPickingColor(t):this._clearInstancePickingColor(t)}},{key:"copyPickingColors",value:function(){var t=this.getAttributeManager().attributes,e=t.pickingColors,n=t.instancePickingColors;return new Uint8ClampedArray((e||n).value)}},{key:"restorePickingColors",value:function(t){var e=this.getAttributeManager().attributes,n=e.pickingColors,r=e.instancePickingColors;(n||r).update({value:t})}},{key:"getNumInstances",value:function(t){return t=t||this.props,this.state&&void 0!==this.state.numInstances?this.state.numInstances:void 0!==t.numInstances?t.numInstances:J(this.props.data)}},{key:"_initialize",value:function(){Object(a.a)(this.context.gl),this._initState(),this.initializeState(this.context),this.state.attributeManager=this.getAttributeManager(),this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0}),this._updateState();var t=this.getSingleModel();t&&(t.id=this.props.id,t.program.id="".concat(this.props.id,"-program"),t.geometry.id="".concat(this.props.id,"-geometry"))}},{key:"_update",value:function(){this.needsUpdate()&&this._updateState()}},{key:"_updateState",value:function(){var t=this._getUpdateParams();this.updateState(t),this.isComposite?this._renderLayers(t):(this.setNeedsRedraw(),this.updateAttributes(this.props),this._updateBaseUniforms(),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances())),this.clearChangeFlags(),this.internalState.resetOldProps()}},{key:"_finalize",value:function(){Object(a.a)(this.internalState&&this.state),this.finalizeState(this.context),function(t){c.a.isReady()&&t&&c.a.deleteItem("deck.gl",t)}(this.id)}},{key:"drawLayer",value:function(t){var e=this,n=t.moduleParameters,r=void 0===n?null:n,i=t.uniforms,o=void 0===i?{}:i,a=t.parameters,u=void 0===a?{}:a;o.picking_uActive||this.updateTransition(),r&&this.setModuleParameters(r);var c=this.context.animationProps;if(c){var l=!0,f=!1,h=void 0;try{for(var p,d=this.getModels()[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){p.value._setAnimationProps(c)}}catch(t){f=!0,h=t}finally{try{l||null==d.return||d.return()}finally{if(f)throw h}}}var v=this.props.getPolygonOffset,g=v&&v(o)||[0,0];u.polygonOffset=g,Object(s.D)(this.context.gl,u,function(){e.draw({moduleParameters:r,uniforms:o,parameters:u,context:e.context})})}},{key:"pickLayer",value:function(t){return this.getPickingInfo(t)}},{key:"getChangeFlags",value:function(){return this.internalState.changeFlags}},{key:"setChangeFlags",value:function(t){var e=this;this.internalState.changeFlags=this.internalState.changeFlags||{};var n=this.internalState.changeFlags;t.dataChanged&&!n.dataChanged&&(n.dataChanged=t.dataChanged,i.a.log(2,function(){return"dataChanged: ".concat(t.dataChanged," in ").concat(e.id)})()),t.updateTriggersChanged&&!n.updateTriggersChanged&&(n.updateTriggersChanged=n.updateTriggersChanged&&t.updateTriggersChanged?Object.assign({},t.updateTriggersChanged,n.updateTriggersChanged):t.updateTriggersChanged||n.updateTriggersChanged,i.a.log(2,function(){return"updateTriggersChanged: "+"".concat(Object.keys(t.updateTriggersChanged).join(", ")," in ").concat(e.id)})()),t.propsChanged&&!n.propsChanged&&(n.propsChanged=t.propsChanged,i.a.log(2,function(){return"propsChanged: ".concat(t.propsChanged," in ").concat(e.id)})()),t.viewportChanged&&!n.viewportChanged&&(n.viewportChanged=t.viewportChanged,i.a.log(3,function(){return"viewportChanged: ".concat(t.viewportChanged," in ").concat(e.id)})()),t.stateChanged&&!n.stateChanged&&(n.stateChanged=t.stateChanged,i.a.log(2,function(){return"stateChanged: ".concat(t.stateChanged," in ").concat(e.id)})());var r=t.dataChanged||t.updateTriggersChanged||t.propsChanged;n.propsOrDataChanged=n.propsOrDataChanged||r,n.somethingChanged=n.somethingChanged||r||t.viewportChanged||t.stateChanged}},{key:"clearChangeFlags",value:function(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}},{key:"printChangeFlags",value:function(){var t=this.internalState.changeFlags;return"".concat(t.dataChanged?"data ":"").concat(t.propsChanged?"props ":"").concat(t.updateTriggersChanged?"triggers ":"").concat(t.viewportChanged?"viewport":"")}},{key:"diffProps",value:function(t,e){var n=W(t,e);if(n.updateTriggersChanged)for(var r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this._activeUpdateTrigger(r);return this.setChangeFlags(n)}},{key:"setModuleParameters",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.updateModuleSettings(t)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"_getUpdateParams",value:function(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}},{key:"_getNeedsRedraw",value:function(t){if(!this.internalState)return!1;var e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t;var n=this.getAttributeManager(),r=n&&n.getNeedsRedraw({clearRedrawFlags:t}),i=this._modelNeedsRedraw(t);return e=e||r||i}},{key:"_modelNeedsRedraw",value:function(t){var e=!1,n=!0,r=!1,i=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=s.getNeedsRedraw({clearRedrawFlags:t});u&&"string"!=typeof u&&(u="model ".concat(s.id)),e=e||u}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_getAttributeManager",value:function(){return new z(this.context.gl,{id:this.props.id,stats:this.context.stats})}},{key:"_initState",value:function(){Object(a.a)(!this.internalState&&!this.state);var t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:f.a.UNSIGNED_BYTE,size:3,update:this.calculateInstancePickingColors}}),this.internalState=new _t({attributeManager:t,layer:this}),this.state={},this.state.attributeManager=t,this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}},{key:"_transferState",value:function(t){var e=t.state,n=t.internalState;if(Object(a.a)(e&&n),this!==t){this.internalState=n,this.internalState.component=this,this.state=e,e.layer=this,this.internalState.setAsyncProps(this.props);var r=!0,i=!1,o=void 0;try{for(var s,u=this.getModels()[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){s.value.userData.layer=this}}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps())}}},{key:"_onAsyncPropUpdated",value:function(){this.diffProps(this.props,this.internalState.getOldProps()),this.setLayerNeedsUpdate()}},{key:"_activeUpdateTrigger",value:function(t){this.invalidateAttribute(t)}},{key:"_checkRequiredProp",value:function(t,e){var n=this.props[t];if(void 0===n)throw new Error("Property ".concat(t," undefined in layer ").concat(this));if(e&&!e(n))throw new Error("Bad property ".concat(t," in layer ").concat(this))}},{key:"_updateBaseUniforms",value:function(){var t=this,e={opacity:"function"==typeof this.props.opacity?function(e){return Math.pow(t.props.opacity(e),1/2.2)}:Math.pow(this.props.opacity,1/2.2)},n=!0,r=!1,i=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){o.value.setUniforms(e)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"setUniforms",value:function(t){var e=!0,n=!1,r=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){o.value.setUniforms(t)}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}this.setNeedsRedraw(),i.a.deprecated("layer.setUniforms","model.setUniforms")()}},{key:"is64bitEnabled",value:function(){return i.a.deprecated("is64bitEnabled","use64bitProjection")(),this.use64bitProjection()}}]),e}();Ct.layerName="Layer",Ct.defaultProps=kt;var Ot=2,Mt=0,It=function(t){var e=t.useDevicePixels;return Object(a.a)("boolean"==typeof e,"Invalid useDevicePixels"),e&&"undefined"!=typeof window?window.devicePixelRatio:1},Lt=function(t,e){var n=e.viewport,r=e.pixelRatio,i=t.canvas?t.canvas.clientHeight:100,o=n;return[o.x*r,(i-o.y-o.height)*r,o.width*r,o.height*r]};function Rt(t,e){var n=e.layers,r=e.viewports,o=e.views,a=e.onViewportActive,u=e.useDevicePixels,c=e.drawPickingColors,l=void 0!==c&&c,h=e.deviceRect,p=void 0===h?null:h,d=e.parameters,v=void 0===d?{}:d,g=e.layerFilter,m=void 0===g?null:g,y=e.pass,_=void 0===y?"draw":y,b=e.redrawReason,x=void 0===b?"":b,w=e.stats;e.customRender||function(t,e){e.useDevicePixels;var n=t.drawingBufferWidth,r=t.drawingBufferHeight;Object(s.D)(t,{viewport:[0,0,n,r]},function(){t.clear(f.a.COLOR_BUFFER_BIT|f.a.DEPTH_BUFFER_BIT)})}(t,{useDevicePixels:u}),r.forEach(function(e,r){var c=function(t){return t.viewport?t.viewport:t}(e),f=o&&o[c.id];a(c),function(t,e){var n=e.layers,r=e.viewport,o=e.view,a=e.useDevicePixels,u=e.drawPickingColors,c=void 0!==u&&u,l=(e.deviceRect,e.parameters),f=void 0===l?{}:l,h=e.layerFilter,p=e.pass,d=void 0===p?"draw":p,v=e.redrawReason,g=void 0===v?"":v,m=e.stats,y=It({useDevicePixels:a}),_=Lt(t,{viewport:r,pixelRatio:y});if(o&&o.props.clear){var b=!0===o.props.clear?{color:!0,depth:!0}:o.props.clear;Object(s.D)(t,{scissorTest:!0,scissor:_},function(){return Object(s.q)(t,b)})}var x={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Object(s.B)(t,f||{}),n.forEach(function(e,n){var i=!e.isComposite&&e.props.visible;c&&(i=i&&e.props.pickable),i&&h&&(i=h({layer:e,viewport:r,isPicking:c})),i&&e.props.pickable&&x.pickableCount++,e.isComposite&&x.compositeCount++,i&&(x.visibleCount++,function(t){t.gl;var e=t.layer,n=t.layerIndex,r=t.drawPickingColors,i=t.pixelRatio,o=t.glViewport,a=t.parameters,s=Object.assign(Object.create(e.props),{viewport:e.context.viewport,pickingActive:r?1:0,devicePixelRatio:i}),u=Object.assign({},e.context.uniforms,{layerIndex:n}),c=Object.assign({},e.props.parameters||{},a);Object.assign(c,{viewport:o}),r?Object.assign(c,{blendColor:[0,0,0,(n+1)/255]}):Object.assign(s,function(t){var e=t.props,n=e.highlightedObjectIndex,r={pickingHighlightColor:e.highlightColor};Number.isInteger(n)&&(r.pickingSelectedColor=n>=0?t.encodePickingColor(n):null);return r}(e));e.drawLayer({moduleParameters:s,uniforms:u,parameters:c})}({gl:t,layer:e,layerIndex:n,drawPickingColors:c,pixelRatio:y,glViewport:_,parameters:f}))}),Mt++,function(t){var e=t.renderStats,n=t.pass,r=t.redrawReason,o=t.stats;if(i.a.priority>=Ot){var a=e.totalCount,s=e.visibleCount,u=e.compositeCount,c=e.pickableCount,l=a-u,f=l-s,h="";h+="RENDER #".concat(Mt," ").concat(s," (of ").concat(a," layers) to ").concat(n," because ").concat(r," "),i.a.priority>Ot&&(h+="(".concat(f," hidden, ").concat(u," composite ").concat(c," pickable)")),i.a.log(Ot,h)(),o&&o.increment("redraw layers",s)}}({renderStats:x,pass:d,redrawReason:g,stats:m})}(t,{layers:n,viewport:c,view:f,useDevicePixels:u,drawPickingColors:l,deviceRect:p,parameters:v,layerFilter:m,pass:_,redrawReason:x,stats:w})})}var jt={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function zt(t,e){for(var n=e.layers,r=e.viewports,i=e.x,o=e.y,a=e.radius,s=e.layerFilter,u=e.depth,c=void 0===u?1:u,l=e.mode,f=e.onViewportActive,h=e.pickingFBO,p=e.lastPickedInfo,d=e.useDevicePixels,v=It({useDevicePixels:d}),g=Math.round(i*v),m=Math.round(t.canvas.height-o*v),y=Math.round(a*v),_=function(t){var e=t.deviceX,n=t.deviceY,r=t.deviceRadius,i=t.deviceWidth,o=t.deviceHeight;if(!(e>=0&&n>=0&&e<i&&n<o))return null;var a=Math.max(0,e-r),s=Math.max(0,n-r),u=Math.min(i,e+r)-a+1,c=Math.min(o,n+r)-s+1;return{x:a,y:s,width:u,height:c}}({deviceX:g,deviceY:m,deviceRadius:y,deviceWidth:h.width,deviceHeight:h.height}),b=[],x={},w=0;w<c;w++){var E=_&&Ft(t,{layers:n,viewports:r,onViewportActive:f,useDevicePixels:d,pickingFBO:h,deviceRect:_,layerFilter:s,redrawReason:l}),S=E&&Bt(t,{pickedColors:E,layers:n,deviceX:g,deviceY:m,deviceRadius:y,deviceRect:_})||jt;if(S.pickedColor&&w+1<c){var P=S.pickedColor[3]-1;x[P]||(x[P]=n[P].copyPickingColors()),n[P].clearPickingColor(S.pickedColor)}var T=Nt({pickInfo:S,lastPickedInfo:p,mode:l,layers:n,viewports:r,x:i,y:o,deviceX:g,deviceY:m,pixelRatio:v});if(T&&T.forEach(function(t){return b.push(t)}),!S.pickedColor)break}return Object.keys(x).forEach(function(t){return n[t].restorePickingColors(x[t])}),b}function Dt(t,e){var n=e.layers,r=e.viewports,o=e.x,a=e.y,s=e.width,u=e.height,c=e.mode,l=e.layerFilter,f=e.onViewportActive,h=e.pickingFBO,p=e.useDevicePixels,d=It({useDevicePixels:p}),v=Math.round(o*d),g=Math.round(t.canvas.height-a*d),m=Math.round((o+s)*d),y=Math.round(t.canvas.height-(a+u)*d),_=function(t,e){var n=e.pickedColors,r=e.layers,o=new Map;if(n)for(var a=0;a<n.length;a+=4){var s=n[a+3]-1;if(s>=0){var u=n.slice(a,a+4),c=u.join(",");if(!o.has(c)){var l=r[s];l?o.set(c,{pickedColor:u,pickedLayer:l,pickedObjectIndex:l.decodePickingColor(u)}):i.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(o.values())}(0,{pickedColors:Ft(t,{layers:n,viewports:r,onViewportActive:f,pickingFBO:h,useDevicePixels:p,deviceRect:{x:v,y:y,width:m-v,height:g-y},layerFilter:l,redrawReason:c}),layers:n}),b=new Map;return _.forEach(function(t){var e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:o,y:a,width:s,height:u,pixelRatio:d};e=Ut({layer:t.pickedLayer,info:e,mode:c}),b.has(e.object)||b.set(e.object,e)}),Array.from(b.values())}function Ft(t,e){var n=e.layers,r=e.viewports,i=e.onViewportActive,o=e.useDevicePixels,u=e.pickingFBO,c=e.deviceRect,l=e.layerFilter,f=e.redrawReason;if(Object(a.a)(c),Object(a.a)(Number.isFinite(c.width)&&c.width>0,"`width` must be > 0"),Object(a.a)(Number.isFinite(c.height)&&c.height>0,"`height` must be > 0"),n.filter(function(t){return t.isPickable()}).length<1)return null;!function(t,e){var n=e.layers,r=e.viewports,i=e.onViewportActive,o=e.useDevicePixels,a=e.pickingFBO,u=e.deviceRect,c=u.x,l=u.y,f=u.width,h=u.height,p=e.layerFilter,d=void 0===p?null:p,v=e.redrawReason,g=void 0===v?"":v;Object(s.D)(t,{framebuffer:a,scissorTest:!0,scissor:[c,l,f,h],clearColor:[0,0,0,0]},function(){Rt(t,{layers:n,viewports:r,onViewportActive:i,useDevicePixels:o,drawPickingColors:!0,layerFilter:d,pass:"picking",redrawReason:g,parameters:{blend:!0,blendFunc:[t.ONE,t.ZERO,t.CONSTANT_ALPHA,t.ZERO],blendEquation:t.FUNC_ADD,blendColor:[0,0,0,0]}})})}(t,{layers:n,viewports:r,onViewportActive:i,useDevicePixels:o,pickingFBO:u,deviceRect:c,layerFilter:l,redrawReason:f});var h=c.x,p=c.y,d=c.width,v=c.height,g=new Uint8Array(d*v*4);return u.readPixels({x:h,y:p,width:d,height:v,pixelArray:g}),g}function Nt(t){var e=t.pickInfo,n=t.lastPickedInfo,r=t.mode,i=t.layers,o=t.viewports,a=t.x,s=t.y,u=t.deviceX,c=t.deviceY,l=t.pixelRatio,f=e.pickedColor,h=e.pickedLayer,p=e.pickedObjectIndex,d=h?[h]:[];if("hover"===r){var v=n.index,g=n.layerId,m=h&&h.props.id;if(m!==g||p!==v){if(m!==g){var y=i.find(function(t){return t.props.id===g});y&&d.unshift(y)}n.layerId=m,n.index=p}}var _=function(t){return t.viewports[0]}({viewports:o}),b={color:null,layer:null,index:-1,picked:!1,x:a,y:s,pixel:[a,s],lngLat:_&&_.unproject([a,s]),devicePixel:[u,c],pixelRatio:l},x=new Map;return d.forEach(function(t){var e=Object.assign({},b);t===h&&(e.color=f,e.index=p,e.picked=!0),(e=Ut({layer:t,info:e,mode:r}))&&x.set(e.layer.id,e);var n=t.props.autoHighlight&&h===t?f:null;t.setModuleParameters({pickingSelectedColor:n})}),function(t,e){var n=[];return t.forEach(function(t){var r=!1;switch(e){case"click":r=t.layer.props.onClick(t);break;case"hover":r=t.layer.props.onHover(t);break;case"query":break;default:throw new Error("unknown pick type")}r||n.push(t)}),n}(x,r)}function Bt(t,e){var n=e.pickedColors,r=e.layers,o=e.deviceX,s=e.deviceY,u=e.deviceRadius,c=e.deviceRect;Object(a.a)(n);for(var l=c.x,f=c.y,h=c.width,p=c.height,d=u*u,v=-1,g=0,m=0;m<p;m++){var y=m+f-s,_=y*y;if(_>d)g+=4*h;else for(var b=0;b<h;b++){if(n[g+3]-1>=0){var x=b+l-o,w=x*x+_;w<=d&&(d=w,v=g)}g+=4}}if(v>=0){var E=n[v+3]-1,S=n.slice(v,v+4),P=r[E];if(P)return{pickedColor:S,pickedLayer:P,pickedObjectIndex:P.decodePickingColor(S)};i.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}return jt}function Ut(t){for(var e=t.layer,n=t.info,r=t.mode;e&&n;){var i=n.layer||e;n.layer=e,n=e.pickLayer({info:n,mode:r,sourceLayer:i}),e=e.parent}return n}function Vt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.filter,r=void 0===n?function(){return!0}:n,i=e.map,o=void 0===i?function(t){return t}:i,a=e.result,s=void 0===a?[]:a;return Array.isArray(t)?function t(e,n,r,i){var o=-1;for(;++o<e.length;){var a=e[o];Array.isArray(a)?t(a,n,r,i):n(a)&&i.push(r(a))}return i}(t,r,o,s):r(t)?[o(t)]:[]}var Gt=n(1),qt=n(2),Wt=n(48),Zt=n(78),Xt=function(){function t(e){var n=e.id;Object(Gt.a)(this,t),this.id=n,this.time=Object(Wt.a)(),this.counters={},Object.seal(this)}return Object(qt.a)(t,[{key:"addCounter",value:function(t){return this._getCounter(t),this}},{key:"bump",value:function(t){var e=this._getCounter(t);return e.call++,e.count++,this}},{key:"increment",value:function(t,e){var n=this._getCounter(t);return n.call++,n.count+=e,this}},{key:"addTimer",value:function(t){return this._getCounter(t).time=0,this}},{key:"addTime",value:function(t,e){var n=this._getCounter(t);return n.time+=e,n.count++,this}},{key:"timeStart",value:function(t,e){this._getCounter(t)._startTime=Object(Wt.a)()}},{key:"timeEnd",value:function(t,e){var n=this._getCounter(t);this.addTime(t,Object(Wt.a)()-n._startTime)}},{key:"reset",value:function(){for(var t in this.time=Object(Wt.a)(),this.counters){var e=this.counters[t];e.count=0,e.time=0}return this}},{key:"hasTimeElapsed",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(Wt.a)()-this.time>1e3}},{key:"getStats",value:function(){var t=(Object(Wt.a)()-this.time)/1e3,e={};for(var n in this.counters){var r=this.counters[n];e[r.title]={total:r.count,fps:Math.round(r.count/t)},r.time&&(e[r.title].totalTime=Object(Zt.b)(r.time),e[r.title].avgTime=Object(Zt.b)(r.time/r.count))}return e}},{key:"getStatsTable",value:function(){var t=this.getStats();for(var e in t)0===t[e].total&&delete t[e];return t}},{key:"getStatNames",value:function(){return Object.keys(this.counters)}},{key:"get",value:function(t){return this._getCounter(t).count}},{key:"getCount",value:function(t){return this._getCounter(t).count}},{key:"getFPS",value:function(t){var e=this._getCounter(t),n=(Object(Wt.a)()-this.time)/1e3;return Math.round(e.count/n)}},{key:"getTimeString",value:function(){return"".concat(this.id,":").concat(Object(Zt.b)(this.time),"(").concat(this.count,")")}},{key:"oneSecondPassed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.hasTimeElapsed(t)}},{key:"_getCounter",value:function(t){var e=this.counters[t];return e||(e={title:t,unit:"",timer:!1,count:0,time:0,totalTime:0,averageTime:0},this.counters[t]=e),e}},{key:"_incrementTimer",value:function(t,e,n){t.count+=n,t.totalTime+=e,t.averageTime=t.totalTime/n}}]),t}(),Ht=n(263),Yt=n.n(Ht),Kt=n(56),Jt=n.n(Kt);function Qt(t,e){if(!t)return null;var n=Jt()([0,0,0,0],e,t),r=1/n[3];return Yt()(n,n,[r,r,r,r]),n}var $t=n(104),te=n(568),ee=n(221),ne=n(49),re=n.n(ne),ie=n(55),oe=n.n(ie),ae=n(33),se=n.n(ae),ue=n(92),ce=n.n(ue);function le(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var he=Math.PI/180,pe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],de=[0,0,0],ve={pixelsPerMeter:[1,1,1],metersPerPixel:[1,1,1],pixelsPerDegree:[1,1,1],degreesPerPixel:[1,1,1]},ge=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.id,r=void 0===n?null:n,i=e.x,o=void 0===i?0:i,a=e.y,s=void 0===a?0:a,u=e.width,c=void 0===u?1:u,l=e.height,f=void 0===l?1:l;this.id=r||this.constructor.displayName||"viewport",this.x=o,this.y=s,this.width=c||1,this.height=f||1,this._initViewMatrix(e),this._initProjectionMatrix(e),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this),this.getMatrices=this.getMatrices.bind(this)}return function(t,e,n){e&&fe(t.prototype,e),n&&fe(t,n)}(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&Object($t.e)(e.projectionMatrix,this.projectionMatrix)&&Object($t.e)(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0===e||e,r=this.projectPosition(t),i=Object(bt.k)(r,this.pixelProjectionMatrix),o=le(i,2),a=o[0],s=o[1],u=n?s:this.height-s;return 2===t.length?[a,u]:[a,u,i[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=le(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.distanceScales.pixelsPerMeter[2],f=Object(bt.h)([a,c,u],this.pixelUnprojectionMatrix,l),h=le(this.unprojectPosition(f),3),p=h[0],d=h[1],v=h[2];return Number.isFinite(u)?[p,d,v]:Number.isFinite(i)?[p,d,i]:[p,d]}},{key:"projectPosition",value:function(t){var e=le(this.projectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.pixelsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=le(this.unprojectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.metersPerPixel[2]]}},{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return this.isGeospatial?Object(bt.g)(t,e):t}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return this.isGeospatial?Object(bt.j)(t,e):t}},{key:"getDistanceScales",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?Object(bt.b)({longitude:t[0],latitude:t[1],scale:this.scale,highPrecision:!0}):this.distanceScales}},{key:"getMatrices",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).modelMatrix,e=void 0===t?null:t,n=this.viewProjectionMatrix,r=this.pixelProjectionMatrix,i=this.pixelUnprojectionMatrix;return e&&(n=se()([],this.viewProjectionMatrix,e),r=se()([],this.pixelProjectionMatrix,e),i=ce()([],r)),Object.assign({modelViewProjectionMatrix:n,viewProjectionMatrix:this.viewProjectionMatrix,viewMatrix:this.viewMatrix,projectionMatrix:this.projectionMatrix,pixelProjectionMatrix:r,pixelUnprojectionMatrix:i,width:this.width,height:this.height,scale:this.scale})}},{key:"containsPixel",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+a}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"getCameraDirection",value:function(){return this.cameraDirection}},{key:"getCameraUp",value:function(){return this.cameraUp}},{key:"_addMetersToLngLat",value:function(t,e){var n=le(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o,s=le(this._metersToLngLatDelta(e),3),u=s[0],c=s[1],l=s[2],f=void 0===l?0:l;return 2===t.length?[r+u,i+c]:[r+u,i+c,a+f]}},{key:"_metersToLngLatDelta",value:function(t){var e=le(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;Object(a.a)(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to Viewport");var s=this.distanceScales,u=s.pixelsPerMeter,c=s.degreesPerPixel,l=n*u[0]*c[0],f=r*u[1]*c[1];return 2===t.length?[l,f]:[l,f,o]}},{key:"_createProjectionMatrix",value:function(t){var e=t.orthographic,n=t.fovyRadians,r=t.aspect,i=t.focalDistance,o=t.near,s=t.far;return Object(a.a)(Number.isFinite(n)),e?(new te.a).orthographic({fovy:n,aspect:r,focalDistance:i,near:o,far:s}):(new te.a).perspective({fovy:n,aspect:r,near:o,far:s})}},{key:"_initViewMatrix",value:function(t){var e=t.viewMatrix,n=void 0===e?pe:e,r=t.longitude,i=void 0===r?null:r,o=t.latitude,a=void 0===o?null:o,s=t.zoom,u=void 0===s?null:s,c=t.position,l=void 0===c?null:c,f=t.modelMatrix,h=void 0===f?null:f,p=t.focalDistance,d=void 0===p?1:p,v=t.distanceScales,g=void 0===v?null:v;this.isGeospatial=Number.isFinite(a)&&Number.isFinite(i),this.zoom=u,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?Object(bt.c)({latitude:a})+Math.log2(d):0),this.scale=Math.pow(2,this.zoom),this.distanceScales=this.isGeospatial?Object(bt.b)({latitude:a,longitude:i,scale:this.scale}):g||ve,this.focalDistance=d,this.distanceScales.metersPerPixel=new ee.a(this.distanceScales.metersPerPixel),this.distanceScales.pixelsPerMeter=new ee.a(this.distanceScales.pixelsPerMeter),this.position=de,this.meterOffset=de,l&&(this.position=l,this.modelMatrix=h,this.meterOffset=h?h.transformVector(l):l),this.isGeospatial?(this.longitude=i,this.latitude=a,this.center=this._getCenterInWorld({longitude:i,latitude:a}),this.viewMatrixUncentered=re()([],n,[1,-1,1]),this.viewMatrix=(new te.a).multiplyRight(this.viewMatrixUncentered).translate(new ee.a(this.center||de).negate())):(this.center=l,this.viewMatrixUncentered=n,this.viewMatrix=n)}},{key:"_getCenterInWorld",value:function(t){var e=t.longitude,n=t.latitude,r=this.meterOffset,i=this.scale,o=this.distanceScales,a=this.projectFlat([e,n],i),s=new ee.a(a[0],a[1],0);if(r){var u=new ee.a(r).scale(o.pixelsPerMeter);s.add(u)}return s}},{key:"_initProjectionMatrix",value:function(t){var e=t.projectionMatrix,n=void 0===e?null:e,r=t.orthographic,i=void 0!==r&&r,o=t.fovyRadians,a=t.fovyDegrees,s=t.fovy,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?1e3:l,h=t.focalDistance,p=void 0===h?1:h,d=t.orthographicFocalDistance,v=o||(a||s||75)*he;this.projectionMatrix=n||this._createProjectionMatrix({orthographic:i,fovyRadians:v,aspect:this.width/this.height,focalDistance:d||p,near:c,far:f})}},{key:"_initPixelMatrices",value:function(){var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];se()(t,t,this.projectionMatrix),se()(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=ce()([],this.viewMatrix)||this.viewMatrix;var e=function(t){var e=t.viewMatrix,n=t.viewMatrixInverse;return{eye:[n[12],n[13],n[14]],direction:[e[2],e[6],e[10]],up:[e[1],e[5],e[9]]}}({viewMatrix:this.viewMatrix,viewMatrixInverse:this.viewMatrixInverse}),n=e.eye,r=e.direction,o=e.up;this.cameraPosition=n,this.cameraDirection=r,this.cameraUp=o;var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];re()(a,a,[this.width/2,-this.height/2,1]),oe()(a,a,[1,-1,0]),se()(s,a,this.viewProjectionMatrix),this.pixelProjectionMatrix=s,this.viewportMatrix=a,this.pixelUnprojectionMatrix=ce()([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||i.a.warn("Pixel project matrix not invertible")()}}]),t}();function me(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ye(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}ge.displayName="Viewport";var _e=Object.seal({layerManager:null,gl:null,useDevicePixels:!0,stats:null,shaderCache:null,pickingFBO:null,lastPickedInfo:null,animationProps:null,userData:{}}),be=function(t){return t instanceof Ct?"".concat(t):t?"invalid":"null"},xe=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.stats,i=n.viewport,o=void 0===i?null:i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lastRenderedLayers=[],this.layers=[],this.context=Object.assign({},_e,{layerManager:this,gl:e,shaderCache:new s.o({gl:e,_cachePrograms:!0}),stats:r||new Xt({id:"deck.gl"}),lastPickedInfo:{index:-1,layerId:null},viewport:o||new ge({id:"DEFAULT-INITIAL-VIEWPORT"})}),this.layerFilter=null,this.drawPickingColors=!1,this._needsRedraw="Initial render",this._needsUpdate=!1,this._activateViewport=this._activateViewport.bind(this),this._initSeer=this._initSeer.bind(this),this._editSeer=this._editSeer.bind(this),Object.seal(this),U(this._initSeer),B(this._editSeer)}return function(t,e,n){e&&ye(t.prototype,e),n&&ye(t,n)}(t,[{key:"finalize",value:function(){c.a.removeListener(this._initSeer),c.a.removeListener(this._editSeer)}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0===t||t;return this._checkIfNeedsRedraw(e)}},{key:"needsUpdate",value:function(){return this._needsUpdate}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t}},{key:"getLayers",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).layerIds,e=void 0===t?null:t;return e?this.layers.filter(function(t){return e.find(function(e){return 0===t.id.indexOf(e)})}):this.layers}},{key:"setProps",value:function(t){"userData"in t&&(this.context.userData=t.userData),"useDevicePixels"in t&&(this.context.useDevicePixels=t.useDevicePixels),"layers"in t&&this.setLayers(t.layers),"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this.setNeedsRedraw("layerFilter changed")),"drawPickingColors"in t&&t.drawPickingColors!==this.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this.setNeedsRedraw("drawPickingColors changed"))}},{key:"setLayers",value:function(t){if(t===this.lastRenderedLayers)return i.a.log(3,"Ignoring layer update due to layer array not changed")(),this;this.lastRenderedLayers=t,t=Vt(t,{filter:Boolean});var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){o.value.context=this.context}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}var s=this._updateLayers({oldLayers:this.layers,newLayers:t}),u=s.error,c=s.generatedLayers;if(this.layers=c,u)throw u;return this}},{key:"updateLayers",value:function(){var t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(me(this.lastRenderedLayers)))}},{key:"drawLayers",value:function(t){var e=t.pass,n=void 0===e?"render to screen":e,r=t.viewports,i=t.views,o=t.redrawReason,a=void 0===o?"unknown reason":o,s=t.customRender,u=void 0!==s&&s,c=this.drawPickingColors,l=this.context,f=l.gl,h=l.useDevicePixels;Rt(f,{layers:this.layers,viewports:r,views:i,onViewportActive:this._activateViewport,useDevicePixels:h,drawPickingColors:c,pass:n,layerFilter:this.layerFilter,redrawReason:a,customRender:u})}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.mode,i=t.radius,o=void 0===i?0:i,a=t.layerIds,s=t.viewports,u=t.depth,c=void 0===u?1:u,l=this.context,f=l.gl,h=l.useDevicePixels;return zt(f,{x:e,y:n,radius:o,layers:this.getLayers({layerIds:a}),mode:r,layerFilter:this.layerFilter,depth:c,viewports:s,onViewportActive:this._activateViewport,pickingFBO:this._getPickingBuffer(),lastPickedInfo:this.context.lastPickedInfo,useDevicePixels:h})}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.layerIds,a=t.viewports,s=this.context,u=s.gl,c=s.useDevicePixels;return Dt(u,{x:e,y:n,width:r,height:i,layers:this.getLayers({layerIds:o}),layerFilter:this.layerFilter,mode:"pickObjects",viewports:a,onViewportActive:this._activateViewport,pickingFBO:this._getPickingBuffer(),useDevicePixels:c})}},{key:"_checkIfNeedsRedraw",value:function(t){var e=this._needsRedraw;t&&(this._needsRedraw=!1);var n=!0,r=!1,i=void 0;try{for(var o,a=this.layers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getNeedsRedraw({clearRedrawFlags:t});e=e||s}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_activateViewport",value:function(t){var e=this.context.viewport;if(!e||!t.equals(e)){i.a.log(4,"Viewport changed",t)(),this.context.viewport=t;var n=!0,r=!1,o=void 0;try{for(var s,u=this.layers[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value;c.setChangeFlags({viewportChanged:"Viewport changed"}),this._updateLayer(c)}}catch(t){r=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(r)throw o}}}return Object(a.a)(this.context.viewport,"LayerManager: viewport not set"),this}},{key:"_getPickingBuffer",value:function(){var t=this.context.gl;return this.context.pickingFBO=this.context.pickingFBO||new s.f(t),this.context.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.context.pickingFBO}},{key:"_updateLayers",value:function(t){var e=t.oldLayers,n=t.newLayers,r={},o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l.id]?i.a.warn("Multiple old layers with same id ".concat(be(l)))():r[l.id]=l}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var f=[],h=this._updateSublayersRecursively({newLayers:n,oldLayerMap:r,generatedLayers:f}),p=this._finalizeOldLayers(r);return this._needsUpdate=!1,{error:h||p,generatedLayers:f}}},{key:"_updateSublayersRecursively",value:function(t){var e=t.newLayers,n=t.oldLayerMap,r=t.generatedLayers,o=null,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;f.context=this.context;var h=n[f.id];null===h&&i.a.warn("Multiple new layers with same id ".concat(be(f)))(),n[f.id]=null;var p=null;try{h?(this._transferLayerState(h,f),this._updateLayer(f),G(f)):(this._initializeLayer(f),V(f)),r.push(f),p=f.isComposite&&f.getSubLayers()}catch(t){i.a.warn("error during matching of ".concat(be(f)),t)(),o=o||t}p&&this._updateSublayersRecursively({newLayers:p,oldLayerMap:n,generatedLayers:r})}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return o}},{key:"_finalizeOldLayers",value:function(t){var e=null;for(var n in t){var r=t[n];r&&(e=e||this._finalizeLayer(r))}return e}},{key:"_initializeLayer",value:function(t){i.a.log(2,"initializing ".concat(be(t)))();var e=null;try{t._initialize(),t.lifecycle=$.INITIALIZED}catch(n){i.a.warn("error while initializing ".concat(be(t),"\n"),n)(),e=e||n}t.internalState.layer=t;var n=!0,r=!1,o=void 0;try{for(var a,s=t.getModels()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){a.value.userData.layer=t}}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return e}},{key:"_transferLayerState",value:function(t,e){e._transferState(t),e.lifecycle=$.MATCHED,e!==t?(i.a.log(4,"matched ".concat(be(e)),t,"->",e)(),t.lifecycle=$.AWAITING_GC):i.a.log(4,"Matching layer is unchanged ".concat(e.id))()}},{key:"_updateLayer",value:function(t){i.a.log(4,"updating ".concat(t," because: ").concat(t.printChangeFlags()))();var e=null;try{t._update()}catch(n){i.a.warn("error during update of ".concat(be(t)),n)(),e=n}return e}},{key:"_finalizeLayer",value:function(t){Object(a.a)(t.lifecycle!==$.AWAITING_FINALIZATION),t.lifecycle=$.AWAITING_FINALIZATION;var e=null;this.setNeedsRedraw("finalized ".concat(be(t)));try{t._finalize()}catch(n){i.a.warn("error during finalization of ".concat(be(t)),n)(),e=n}return t.lifecycle=$.FINALIZED,i.a.log(2,"finalizing ".concat(be(t)))(),e}},{key:"_initSeer",value:function(){this.layers.forEach(function(t){V(t),G(t)})}},{key:"_editSeer",value:function(t){if("edit"===t.type&&"props"===t.valuePath[0]){!function(t,e,n){c.a.isReady()&&(F.has(t)||F.set(t,new Map),F.get(t).set(e,n))}(t.itemKey,t.valuePath.slice(1),t.value);var e=this.layers.map(function(t){return new t.constructor(t.props)});this.updateLayers({newLayers:e})}}}]),t}();function we(t,e){return t===e||Object.keys(t).every(function(n){return Array.isArray(t[n])&&Array.isArray(e[n])?we(t[n],e[n]):t[n]===e[n]})}function Ee(t){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Se=/([0-9]+\.?[0-9]*)(%|px)/;function Pe(t){switch(Ee(t)){case"number":return{position:t,relative:!1};case"string":var e=t.match(Se);if(e&&e.length>=3){var n="%"===e[2],r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Te(t,e){return t.relative?Math.round(t.position*e):t.position}function Ae(t){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ce=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.id,r=void 0===n?null:n,i=e.x,o=void 0===i?0:i,s=e.y,u=void 0===s?0:s,c=e.width,l=void 0===c?"100%":c,f=e.height,h=void 0===f?"100%":f,p=e.projectionMatrix,d=void 0===p?null:p,v=e.fovy,g=void 0===v?75:v,m=e.near,y=void 0===m?.1:m,_=e.far,b=void 0===_?1e3:_,x=e.modelMatrix,w=void 0===x?null:x,E=e.viewportInstance,S=void 0===E?null:E,P=e.type,T=void 0===P?ge:P;Object(a.a)(!S||S instanceof ge),this.viewportInstance=S,this.id=r||this.constructor.displayName||"view",this.type=T,this.props=Object.assign({},e,{projectionMatrix:d,fovy:g,near:y,far:b,modelMatrix:w}),this._parseDimensions({x:o,y:u,width:l,height:h}),this.equals=this.equals.bind(this),Object.seal(this)}return function(t,e,n){e&&ke(t.prototype,e),n&&ke(t,n)}(t,[{key:"equals",value:function(t){return this===t||(this.viewportInstance?t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):we(this.props,t.props))}},{key:"makeViewport",value:function(t){var e=t.width,n=t.height,r=t.viewState;if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);var i=this.getDimensions({width:e,height:n}),o=Object.assign({viewState:r},r,this.props,i);return this._getViewport(o)}},{key:"getViewStateId",value:function(){switch(Ae(this.props.viewState)){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}},{key:"filterViewState",value:function(t){if(this.props.viewState&&"object"===Ae(this.props.viewState)){if(!this.props.viewState.id)return this.props.viewState;var e=Object.assign({},t);for(var n in this.props.viewState)"id"!==n&&(e[n]=this.props.viewState[n]);return e}return t}},{key:"getDimensions",value:function(t){var e=t.width,n=t.height;return{x:Te(this._x,e),y:Te(this._y,n),width:Te(this._width,e),height:Te(this._height,n)}}},{key:"_getControllerProps",value:function(t){var e=this.props.controller;return e?!0===e?t:("function"==typeof e&&(e={type:e}),Object.assign({},t,e)):null}},{key:"_getViewport",value:function(t){return new(0,this.type)(t)}},{key:"_parseDimensions",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height;this._x=Pe(e),this._y=Pe(n),this._width=Pe(r),this._height=Pe(i)}}]),t}();function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Me=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractiveStateChange:e.onInteractiveStateChange},Object.seal(this),this.setProps(e)}return function(t,e,n){e&&Oe(t.prototype,e),n&&Oe(t,n)}(t,[{key:"finalize",value:function(){for(var t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0===t||t,n=this._needsRedraw;return e&&(this._needsRedraw=!1),n}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}},{key:"getViewports",value:function(t){return t?this._viewports.filter(function(e){return e.containsPixel(t)}):this._viewports}},{key:"getViews",value:function(){var t={};return this.views.forEach(function(e){t[e.id]=e}),t}},{key:"getView",value:function(t){return"string"==typeof t?this.views.find(function(e){return e.id===t}):t}},{key:"getViewState",value:function(t){var e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}},{key:"getViewport",value:function(t){return this._viewportMap[t]}},{key:"project",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{topLeft:!0},n=this.getViewports(),r=n.length-1;r>=0;--r){var i=n[r];if(i.contains(t,e))return i.project(t,e)}return null}},{key:"unproject",value:function(t,e){for(var n=this.getViewports(),r=n.length-1;r>=0;--r){var i=n[r];if(i.containsPixel(t,e))return i.unproject(t)}return null}},{key:"setProps",value:function(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}},{key:"_update",value:function(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}},{key:"_setSize",value:function(t,e){Object(a.a)(Number.isFinite(t)&&Number.isFinite(e)),t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}},{key:"_setViews",value:function(t){t=Vt(t,{filter:Boolean}).map(function(t){return t instanceof ge?new Ce({viewportInstance:t}):t}),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}},{key:"_setViewState",value:function(t){t?(!we(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):i.a.warn("setting null viewState")()}},{key:"_onViewStateChange",value:function(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange(e)}},{key:"_createController",value:function(t){return new(0,t.type)(Object.assign({eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractiveStateChange},t))}},{key:"_updateController",value:function(t,e,n,r){if(t.controller){var i=Object.assign({},t.controller,t.defaultState,e,{id:t.id,x:n.x,y:n.y,width:n.width,height:n.height});return r?r.setProps(i):r=this._createController(i),r}return null}},{key:"_rebuildViewports",value:function(){var t=this,e=this.width,n=this.height,r=this.views,i=this.controllers;for(var o in this.controllers={},this._viewports=r.map(function(r){var o=t.getViewState(r),a=r.makeViewport({width:e,height:n,viewState:o});return t.controllers[r.id]=t._updateController(r,o,a,i[r.id]),a}),i)i[o]&&!this.controllers[o]&&i[o].finalize();this._buildViewportMap()}},{key:"_buildViewportMap",value:function(){var t=this;this._viewportMap={},this._viewports.forEach(function(e){e.id&&(t._viewportMap[e.id]=t._viewportMap[e.id]||e)})}},{key:"_diffViews",value:function(t,e){return t.length!==e.length||t.some(function(n,r){return!t[r].equals(e[r])})}}]),t}(),Ie=n(508),Le=n(115),Re=n.n(Le),je=n(148),ze=n.n(je);function De(t){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ue(t,e){return(Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ve(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ge=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.latitude,i=void 0===r?0:r,o=n.longitude,a=void 0===o?0:o,s=n.zoom,u=void 0===s?11:s,c=n.pitch,l=void 0===c?0:c,f=n.bearing,h=void 0===f?0:f,p=n.nearZMultiplier,d=void 0===p?.1:p,v=n.farZMultiplier,g=void 0===v?10:v,m=n.orthographic,y=void 0!==m&&m,_=n.width,b=n.height,x=n.altitude,w=void 0===x?1.5:x;_=_||1,b=b||1,w=Math.max(.75,w);var E=Object(bt.e)({width:_,height:b,pitch:l,altitude:w,nearZMultiplier:d,farZMultiplier:g}),S=E.fov,P=E.aspect,T=E.focalDistance,A=E.near,k=E.far,C=Object(bt.f)({height:b,pitch:l,bearing:h,altitude:w}),O=n.position&&[n.position[0],n.position[1],0],M=Object.assign({},n,{width:_,height:b,viewMatrix:C,longitude:a,latitude:i,zoom:u,position:O,orthographic:y,fovyRadians:S,aspect:P,orthographicFocalDistance:T,near:A,far:k});return(t=function(t,e){return!e||"object"!==De(e)&&"function"!=typeof e?Ve(t):e}(this,Be(e).call(this,M))).latitude=i,t.longitude=a,t.zoom=u,t.pitch=l,t.bearing=h,t.altitude=w,t.orthographic=y,t.metersToLngLatDelta=t.metersToLngLatDelta.bind(Ve(Ve(t))),t.lngLatDeltaToMeters=t.lngLatDeltaToMeters.bind(Ve(Ve(t))),t.addMetersToLngLat=t.addMetersToLngLat.bind(Ve(Ve(t))),Object.freeze(Ve(Ve(t))),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ue(t,e)}(e,ge),function(t,e,n){e&&Ne(t.prototype,e),n&&Ne(t,n)}(e,[{key:"metersToLngLatDelta",value:function(t){var e=Fe(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;Object(a.a)(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to WebMercatorViewport");var s=this.distanceScales,u=s.pixelsPerMeter,c=s.degreesPerPixel,l=n*u[0]*c[0],f=r*u[1]*c[1];return 2===t.length?[l,f]:[l,f,o]}},{key:"lngLatDeltaToMeters",value:function(t){var e=Fe(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;Object(a.a)(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to WebMercatorViewport");var s=this.distanceScales,u=s.pixelsPerDegree,c=s.metersPerPixel,l=n*u[0]*c[0],f=r*u[1]*c[1];return 2===t.length?[l,f]:[l,f,o]}},{key:"addMetersToLngLat",value:function(t,e){return Object(bt.a)(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=t.pos,r=Object(bt.h)(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),o=Re()([],i,ze()([],r)),a=Re()([],this.center,o);return this.unprojectFlat(a)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=Object(Ie.a)(Object.assign({width:r,height:i,bounds:t},n));return new e({width:r,height:i,longitude:o.longitude,latitude:o.latitude,zoom:o.zoom})}}]),e}();function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Ge.displayName="WebMercatorViewport";var We=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Array.isArray(e)&&(e={compare:e,extract:e,required:e});var n=e,r=n.compare,i=n.extract,o=n.required;this._propsToCompare=r,this._propsToExtract=i,this._requiredProps=o}return function(t,e,n){e&&qe(t.prototype,e),n&&qe(t,n)}(t,[{key:"arePropsEqual",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=(this._propsToCompare||Object.keys(e))[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!Object($t.e)(t[s],e[s]))return!1}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"initializeProps",value:function(t,e){var n;if(this._propsToExtract){var r={},i={},o=!0,a=!1,s=void 0;try{for(var u,c=this._propsToExtract[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l]=t[l],i[l]=e[l]}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}},{key:"interpolateProps",value:function(t,e,n){Object(a.a)(!1,"interpolateProps is not implemented")}},{key:"_checkRequiredProps",value:function(t){this._requiredProps&&this._requiredProps.forEach(function(e){var n=t[e];Object(a.a)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}]),t}();function Ze(t){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function He(t,e){return!e||"object"!==Ze(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ye(t){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ke(t,e){return(Ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Je=["longitude","latitude","zoom","bearing","pitch"],Qe=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),He(this,Ye(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ke(t,e)}(e,We),function(t,e,n){e&&Xe(t.prototype,e),n&&Xe(t,n)}(e,[{key:"interpolateProps",value:function(t,e,n){var r={};for(var i in e)r[i]=Object($t.g)(t[i],e[i],n);return r}}]),e}();function $e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var tn=function(){},en={BREAK:1,SNAP_TO_END:2,IGNORE:3},nn={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new Qe,transitionInterruption:en.BREAK,onTransitionStart:tn,onTransitionInterrupt:tn,onTransitionEnd:tn},rn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(a.a)(e),this.ControllerState=e,this.props=Object.assign({},nn,n),this.animation=null,this.propsInTransition=null,this.transition=new A,this.onViewStateChange=n.onViewStateChange,this._onTransitionFrame=this._onTransitionFrame.bind(this),this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}return function(t,e,n){e&&$e(t.prototype,e),n&&$e(t,n)}(t,[{key:"finalize",value:function(){cancelAnimationFrame(this.animation)}},{key:"getViewportInTransition",value:function(){return this.propsInTransition}},{key:"processViewStateChange",value:function(t){var e=!1,n=this.props;if(t=Object.assign({},nn,t),this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){var r=Object.assign({},n,this.transition.interruption===en.SNAP_TO_END?this.transition.endProps:this.propsInTransition||n);this._triggerTransition(r,t),e=!0}else this.transition.cancel();return e}},{key:"_isTransitionEnabled",value:function(t){return t.transitionDuration>0&&t.transitionInterpolator}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.transition.inProgress&&this.transition.interpolator.arePropsEqual(t,this.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return this.transition.inProgress?this.transition.interruption===en.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}},{key:"_triggerTransition",value:function(t,e){Object(a.a)(this._isTransitionEnabled(e),"Transition is not enabled"),cancelAnimationFrame(this.animation);var n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),i=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.transition.start({duration:e.transitionDuration,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:i.start,endProps:i.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this._onTransitionFrame()}},{key:"_onTransitionFrame",value:function(){this.animation=requestAnimationFrame(this._onTransitionFrame),this.transition.update(Date.now())}},{key:"_onTransitionEnd",value:function(t){var e=this;return function(n){cancelAnimationFrame(e.animation),e.propsInTransition=null,t(n)}}},{key:"_onTransitionUpdate",value:function(t){var e=t.interpolator,n=t.startProps,r=t.endProps,i=t.time,o=e.interpolateProps(n,r,i);this.propsInTransition=new this.ControllerState(Object.assign({},this.props,o)).getViewportProps(),this.onViewStateChange&&this.onViewStateChange({viewState:this.propsInTransition,interactionState:{inTransition:!0}})}}]),t}();function on(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function an(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}rn.defaultProps=nn;var sn={transitionDuration:0},un=["wheel"],cn=["panstart","panmove","panend"],ln=["pinchstart","pinchmove","pinchend"],fn=["doubletap"],hn=["keydown"],pn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(a.a)(e),this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new rn(e,n),this._events=null,this._state={isDragging:!1},this.events=[],this.onViewStateChange=null,this.onStateChange=null,this.invertPan=!1,this.handleEvent=this.handleEvent.bind(this),this.setProps(n)}return function(t,e,n){e&&an(t.prototype,e),n&&an(t,n)}(t,[{key:"finalize",value:function(){for(var t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}},{key:"handleEvent",value:function(t){var e=this.ControllerState;switch(this.controllerState=new e(Object.assign({},this.controllerStateProps,this._state)),t.type){case"panstart":return this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=this.controllerStateProps,n=e.x,r=e.y,i=t.offsetCenter;return[i.x-n,i.y-r]}},{key:"isPointInBounds",value:function(t){var e=this.controllerStateProps,n=e.width,r=e.height;return t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"isDragging",value:function(){return this._state.isDragging}},{key:"setProps",value:function(t){"onViewportChange"in t&&i.a.removed("onViewportChange")(),"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this.events,!0)),this.transitionManager.processViewStateChange(this.controllerStateProps);var e=t.scrollZoom,n=void 0===e||e,r=t.dragPan,o=void 0===r||r,a=t.dragRotate,s=void 0===a||a,u=t.doubleClickZoom,c=void 0===u||u,l=t.touchZoom,f=void 0===l||l,h=t.touchRotate,p=void 0!==h&&h,d=t.keyboard,v=void 0===d||d,g=Boolean(this.onViewStateChange);this.toggleEvents(un,g&&n),this.toggleEvents(cn,g&&(o||s)),this.toggleEvents(ln,g&&(f||p)),this.toggleEvents(fn,g&&c),this.toggleEvents(hn,g&&v),this.scrollZoom=n,this.dragPan=o,this.dragRotate=s,this.doubleClickZoom=c,this.touchZoom=f,this.touchRotate=p,this.keyboard=v}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach(function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))})}},{key:"setOptions",value:function(t){return this.setProps(t)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},t.getViewportProps(),e);if(this.controllerState!==t){var i=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:n,oldViewState:i})}Object.assign(this._state,Object.assign({},t.getInteractiveState(),n)),this.onStateChange&&this.onStateChange(this._state)}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.controllerState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,sn,{isDragging:!0})}},{key:"_onPan",value:function(t){var e=this.isFunctionKeyPressed(t)||t.rightButton;return(e=this.invertPan?!e:e)?this._onPanMove(t):this._onPanRotate(t)}},{key:"_onPanEnd",value:function(t){var e=this.controllerState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1})}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,sn,{isDragging:!0})}},{key:"_onPanRotate",value:function(t){return!!this.dragRotate&&(this.invertPan?this._onPanRotateMap(t):this._onPanRotateStandard(t))}},{key:"_onPanRotateStandard",value:function(t){var e=t.deltaX,n=t.deltaY,r=this.controllerState.getViewportProps(),i=e/r.width,o=n/r.height,a=this.controllerState.rotate({deltaScaleX:i,deltaScaleY:o});return this.updateViewport(a,sn,{isDragging:!0})}},{key:"_onPanRotateMap",value:function(t){var e=t.deltaX,n=t.deltaY,r=on(this.getCenter(t),2)[1],i=r-n,o=this.controllerState.getViewportProps(),a=o.width,s=o.height,u=e/a,c=0;n>0?Math.abs(s-i)>5&&(c=n/(i-s)*1.2):n<0&&i>5&&(c=1-r/i),c=Math.min(1,Math.max(-1,c));var l=this.controllerState.rotate({deltaScaleX:u,deltaScaleY:c});return this.updateViewport(l,sn,{isDragging:!0})}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.controllerState.zoom({pos:e,scale:r});return this.updateViewport(i,sn)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,sn,{isDragging:!0})}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.controllerState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,o=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-o)/180})}return this.updateViewport(e,sn,{isDragging:!0})}},{key:"_onPinchEnd",value:function(t){var e=this.controllerState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1})}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps())}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.controllerState;switch(t.srcEvent.keyCode){case 189:e=n?r.zoomOut().zoomOut():r.zoomOut();break;case 187:e=n?r.zoomIn().zoomIn():r.zoomIn();break;case 37:e=n?r.rotateLeft():r.moveLeft();break;case 39:e=n?r.rotateRight():r.moveRight();break;case 38:e=n?r.rotateUp():r.moveUp();break;case 40:e=n?r.rotateDown():r.moveDown();break;default:return!1}return this.updateViewport(e,this._getTransitionProps())}},{key:"_getTransitionProps",value:function(){return sn}}]),t}(),dn=n(18),vn=n(264),gn=n.n(vn),mn=6371e3,yn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.phi,r=e.theta,i=e.radius,o=e.bearing,a=e.pitch,s=(e.altitude,e.radiusScale),u=void 0===s?mn:s;Object(Gt.a)(this,t),0===arguments.length?(this.phi=0,this.theta=0,this.radius=1):Number.isFinite(n)||Number.isFinite(r)?(this.phi=n||0,this.theta=r||0):(Number.isFinite(o)||Number.isFinite(a))&&(this.bearing=o||0,this.pitch=a||0),this.radius=i||1,this.radiusScale=u||1,this.check()}return Object(qt.a)(t,[{key:"toString",value:function(){return this.formatString($t.c)}},{key:"formatString",value:function(t){var e=t.printTypes,n=(t.printDegrees,$t.f);return"".concat(e?"Spherical":"","[rho:").concat(n(this.radius),",theta:").concat(n(this.theta),",phi:").concat(n(this.phi),"]")}},{key:"equals",value:function(t){return Object($t.e)(this.radius,t.radius)&&Object($t.e)(this.theta,t.theta)&&Object($t.e)(this.phi,t.phi)}},{key:"exactEquals",value:function(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}},{key:"set",value:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}},{key:"fromLngLatZ",value:function(t){var e=Object(dn.a)(t,3),n=e[0],r=e[1],i=e[2];this.radius=1+i/this.radiusScale,this.phi=Object($t.h)(r),this.theta=Object($t.h)(n)}},{key:"fromVector3",value:function(t){return this.radius=gn()(t),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(Object($t.b)(t[2]/this.radius,-1,1))),this.check()}},{key:"toVector3",value:function(){return new ee.a(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}},{key:"makeSafe",value:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))}},{key:"check",value:function(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}},{key:"bearing",get:function(){return 180-Object($t.d)(this.phi)},set:function(t){this.phi=Math.PI-Object($t.h)(t)}},{key:"pitch",get:function(){return Object($t.d)(this.theta)},set:function(t){this.theta=Object($t.h)(t)}},{key:"longitude",get:function(){return Object($t.d)(this.phi)}},{key:"latitude",get:function(){return Object($t.d)(this.theta)}},{key:"lng",get:function(){return Object($t.d)(this.phi)}},{key:"lat",get:function(){return Object($t.d)(this.theta)}},{key:"z",get:function(){return(this.radius-1)*this.radiusScale}}]),t}();function _n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bn={position:[0,0,0],lookAt:[0,0,0],up:[0,0,1],rotationX:0,rotationY:0,fov:50,near:1,far:100},xn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.width,r=e.height,i=e.position,o=void 0===i?bn.position:i;Object(a.a)(Number.isFinite(n),"`width` must be supplied"),Object(a.a)(Number.isFinite(r),"`height` must be supplied"),this._viewportProps=this._applyConstraints(Object.assign({},e,{position:new ee.a(o)}))}return function(t,e,n){e&&_n(t.prototype,e),n&&_n(t,n)}(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getDirection",value:function(){return new yn({bearing:this._viewportProps.bearing,pitch:this._viewportProps.pitch}).toVector3().normalize()}},{key:"getDirectionFromBearing",value:function(t){return new yn({bearing:t,pitch:90}).toVector3().normalize()}},{key:"shortestPathFrom",value:function(t){return this._viewportProps}},{key:"_applyConstraints",value:function(t){return t}}]),t}(),wn=n(239),En=n(566);function Sn(t){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Tn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function An(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kn(t,e,n){return e&&An(t.prototype,e),n&&An(t,n),t}function Cn(t,e){return!e||"object"!==Sn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function On(t){return(On=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ln={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Qe,transitionInterruption:en.BREAK},Rn={minZoom:0,maxZoom:20,minPitch:0,maxPitch:60},jn={pitch:0,bearing:0,altitude:1.5},zn=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,s=n.longitude,u=n.zoom,c=n.bearing,l=void 0===c?jn.bearing:c,f=n.pitch,h=void 0===f?jn.pitch:f,p=n.altitude,d=void 0===p?jn.altitude:p,v=n.maxZoom,g=void 0===v?Rn.maxZoom:v,m=n.minZoom,y=void 0===m?Rn.minZoom:m,_=n.maxPitch,b=void 0===_?Rn.maxPitch:_,x=n.minPitch,w=void 0===x?Rn.minPitch:x,E=n.startPanLngLat,S=n.startZoomLngLat,P=n.startBearing,T=n.startPitch,A=n.startZoom;return Tn(this,e),Object(a.a)(Number.isFinite(s),"`longitude` must be supplied"),Object(a.a)(Number.isFinite(o),"`latitude` must be supplied"),Object(a.a)(Number.isFinite(u),"`zoom` must be supplied"),(t=Cn(this,On(e).call(this,{width:r,height:i,latitude:o,longitude:s,zoom:u,bearing:l,pitch:h,altitude:d,maxZoom:g,minZoom:y,maxPitch:b,minPitch:w})))._interactiveState={startPanLngLat:E,startZoomLngLat:S,startBearing:P,startPitch:T,startZoom:A},t}return Mn(e,xn),kn(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=Pn(this._calculateNewLngLat({startPanLngLat:r,pos:e}),2),o=i[0],a=i[1];return this._getUpdatedState({longitude:o,latitude:a})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,o=this._interactiveState,a=o.startBearing,s=o.startPitch;if(!Number.isFinite(a)||!Number.isFinite(s))return this;var u=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:a,startPitch:s}),c=u.pitch,l=u.bearing;return this._getUpdatedState({bearing:l,pitch:c})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;Object(a.a)(r>0,"`scale` must be a positive number");var i=this._interactiveState,o=i.startZoom,s=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,s=this._unproject(n)||this._unproject(e)),Object(a.a)(s,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var u=this._calculateNewZoom({scale:r,startZoom:o}),c=Pn(new wn.a(Object.assign({},this._viewportProps,{zoom:u})).getLocationAtPoint({lngLat:s,pos:e}),2),l=c[0],f=c[1];return this._getUpdatedState({zoom:u,longitude:l,latitude:f})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(.5)}},{key:"moveLeft",value:function(){return this._panFromCenter([100,0])}},{key:"moveRight",value:function(){return this._panFromCenter([-100,0])}},{key:"moveUp",value:function(){return this._panFromCenter([0,100])}},{key:"moveDown",value:function(){return this._panFromCenter([0,-100])}},{key:"rotateLeft",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing-15})}},{key:"rotateRight",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing+15})}},{key:"rotateUp",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch+10})}},{key:"rotateDown",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch-10})}},{key:"shortestPathFrom",value:function(t){var e=t.getViewportProps(),n=Object.assign({},this._viewportProps),r=n.bearing,i=n.longitude;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}},{key:"_zoomFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height;return this.zoom({pos:[n/2,r/2],scale:t})}},{key:"_panFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height;return this.pan({startPos:[n/2,r/2],pos:[n/2+t[0],r/2+t[1]]})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Object($t.b)(r,n,e);var i=t.maxPitch,o=t.minPitch,a=t.pitch;return t.pitch=Object($t.b)(a,o,i),Object.assign(t,Object(En.a)(t)),t}},{key:"_unproject",value:function(t){var e=new wn.a(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new wn.a(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom,a=n+Math.log2(e);return Object($t.b)(a,o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=Object($t.b)(n,-1,1);var o=this._viewportProps,a=o.minPitch,s=o.maxPitch,u=i;return n>0?u=i+n*(s-i):n<0&&(u=i-n*(a-i)),{pitch:u,bearing:r+180*e}}}]),e}(),Dn=function(t){function e(t){var n;return Tn(this,e),(n=Cn(this,On(e).call(this,zn,t))).invertPan=!0,n}return Mn(e,pn),kn(e,[{key:"_getTransitionProps",value:function(){return Ln}}]),e}();function Fn(t){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bn(t,e){return!e||"object"!==Fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Un(t){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vn(t,e){return(Vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gn=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Bn(this,Un(e).call(this,Object.assign({},t,{type:Ge})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vn(t,e)}(e,Ce),function(t,e,n){e&&Nn(t.prototype,e),n&&Nn(t,n)}(e,[{key:"controller",get:function(){return this._getControllerProps({type:Dn})}}]),e}();function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Gn.displayName="MapView";var Wn=function(){function t(e){var n=e.gl,r=e.layerManager;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=n,this.layerManager=r,this._effects=[]}return function(t,e,n){e&&qn(t.prototype,e),n&&qn(t,n)}(t,[{key:"addEffect",value:function(t){this._effects.push(t),this._sortEffects(),t.initialize({gl:this.gl,layerManager:this.layerManager})}},{key:"removeEffect",value:function(t){var e=this._effects.indexOf(t);return e>=0&&(t.finalize({gl:this.gl,layerManager:this.layerManager}),this._effects.splice(e,1),!0)}},{key:"preDraw",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._effects[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.needsRedraw&&o.preDraw({gl:this.gl,layerManager:this.layerManager})}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"draw",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._effects[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.needsRedraw&&o.draw({gl:this.gl,layerManager:this.layerManager})}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"_sortEffects",value:function(){this._effects.sort(function(t,e){return t.priority>e.priority?-1:t.priority<e.priority?1:t.count-e.count})}}]),t}();function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xn=0,Hn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="effect",this.count=Xn++,this.visible=!0,this.priority=0,this.needsRedraw=!1}return function(t,e,n){e&&Zn(t.prototype,e),n&&Zn(t,n)}(t,[{key:"initialize",value:function(t){t.gl,t.layerManager}},{key:"finalize",value:function(t){t.gl,t.layerManager}},{key:"preDraw",value:function(t){t.gl,t.layerManager}},{key:"draw",value:function(t){t.gl,t.layerManager}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.needsRedraw=t}}]),t}(),Yn=n(265),Kn=1,Jn=2,Qn=4,$n={mousedown:Kn,mousemove:Jn,mouseup:Qn};var tr=void 0;Yn.a&&(tr=n(116)),tr&&(function(t){var e=t.prototype.handler;t.prototype.handler=function(t){var n=this.store;t.button>0&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,function(e){return e.pointerId===t.pointerId})||n.push(t)),e.call(this,t)}}(tr.PointerEventInput),function(t){t.prototype.handler=function(t){var e=$n[t.type];e&Kn&&t.button>=0&&(this.pressed=!0),e&Jn&&0===t.which&&(e=Qn),this.pressed&&(e&Qn&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(tr.MouseInput));var er=tr?tr.Manager:function(t){var e={},n=function(){return e};return e.get=function(){return null},e.set=n,e.on=n,e.off=n,e.destroy=n,e.emit=n,e},nr=tr,rr=nr?[[nr.Rotate,{enable:!1}],[nr.Pinch,{enable:!1}],[nr.Swipe,{enable:!1}],[nr.Pan,{threshold:0,enable:!1}],[nr.Press,{enable:!1}],[nr.Tap,{event:"doubletap",taps:2,enable:!1}],[nr.Tap,{enable:!1}]]:null,ir={rotate:["pinch"]},or={doubletap:["tap"]},ar={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},sr=["keydown","keyup"],ur=["mousedown","mousemove","mouseup","mouseleave"],cr=["wheel","mousewheel","DOMMouseScroll"],lr={tap:"tap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},fr={click:"tap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseleave:"pointerleave"},hr=n(117),pr=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var dr=-1!==hr.a.indexOf("firefox"),vr=cr,gr=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.events=vr.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(function(t){return e.addEventListener(t,r.handleEvent)})}return pr(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){if(this.options.enable){this.options.legacyBlockScroll&&t.preventDefault();var e=t.deltaY;hr.b.WheelEvent&&(dr&&t.deltaMode===hr.b.WheelEvent.DOM_DELTA_PIXEL&&(e/=hr.b.devicePixelRatio),t.deltaMode===hr.b.WheelEvent.DOM_DELTA_LINE&&(e*=40));var n={x:t.clientX,y:t.clientY};0!==e&&e%4.000244140625==0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}}},{key:"_onWheel",value:function(t,e,n){this.callback({type:"wheel",center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),mr=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var yr=ur,_r=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.events=yr.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(function(t){return e.addEventListener(t,r.handleEvent)})}return mr(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleEvent",value:function(t){if(this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:"pointerleave",srcEvent:t,pointerType:"mouse",target:t.target}),this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}]),t}(),br=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var xr=sr,wr=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=xr.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=1,e.style.outline="none",this.events.forEach(function(t){return e.addEventListener(t,r.handleEvent)})}return br(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}},{key:"handleEvent",value:function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))}}]),t}(),Er=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Sr=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}return Er(t,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"handleEvent",value:function(t){this.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target}),this.options.rightButton&&t.preventDefault()}}]),t}(),Pr=1,Tr=2,Ar=4,kr={pointerdown:Pr,pointermove:Tr,pointerup:Ar,mousedown:Pr,mousemove:Tr,mouseup:Ar},Cr=1,Or=2,Mr=3,Ir=0,Lr=1,Rr=2,jr=1,zr=2,Dr=4;var Fr=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Nr={events:null,recognizers:null,Manager:er,rightButton:!1,touchAction:"none",legacyBlockScroll:!0},Br=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=Object.assign({},Nr,n),this.eventHandlers=[],this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);var r=n.events;r&&this.on(r)}return Fr(t,[{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||rr}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(ir).forEach(function(t){var n=e.manager.get(t);n&&ir[t].forEach(function(t){n.recognizeWith(t)})}),this.wheelInput=new gr(t,this._onOtherEvent,{enable:!1,legacyBlockScroll:n.legacyBlockScroll}),this.moveInput=new _r(t,this._onOtherEvent,{enable:!1}),this.keyInput=new wr(t,this._onOtherEvent,{enable:!1}),this.contextmenuInput=new Sr(t,this._onOtherEvent,{rightButton:n.rightButton}),this.eventHandlers.forEach(function(t){var n=t.recognizerName,r=t.eventAlias,i=t.wrappedHandler;e._toggleRecognizer(n,!0),e.manager.on(r,i)})}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){if("string"==typeof t)this._addEventHandler(t,e,n);else for(var r in n=e,t)this._addEventHandler(r,t[r],n)}},{key:"off",value:function(t,e){if("string"==typeof t)this._removeEventHandler(t,e);else for(var n in t)this._removeEventHandler(n,t[n])}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r){r.set({enable:e});var i=or[t];i&&!this.options.recognizers&&i.forEach(function(r){var i=n.get(r);e?i.requireFailure(t):i.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.manager,i=this.eventHandlers,o=this._wrapEventHandler(t,e,n),a=fr[t]||t,s=lr[a]||a;this._toggleRecognizer(s,!0);var u=i.filter(function(t){return t.eventAlias===a&&t.srcElement!==n&&(!t.srcElement||t.srcElement.contains(n))});i.push({event:t,eventAlias:a,recognizerName:s,srcElement:n,handler:e,wrappedHandler:o}),u.forEach(function(t){return r.off(a,t.wrappedHandler)}),r&&r.on(a,o),u.forEach(function(t){return r.on(a,t.wrappedHandler)})}},{key:"_removeEventHandler",value:function(t,e){for(var n=this.manager,r=this.eventHandlers,i=!1,o=r.length;o--;){var a=r[o];a.event===t&&a.handler===e&&(n&&n.off(a.eventAlias,a.wrappedHandler),r.splice(o,1),i=!0)}if(i){var s=fr[t]||t,u=lr[s]||s;r.find(function(t){return t.recognizerName===u})||this._toggleRecognizer(u,!1)}}},{key:"_wrapEventHandler",value:function(t,e,n){var r=this;return function(i){var o=i.mjolnirEvent;(o||(o=r._normalizeEvent(i),i.mjolnirEvent=o),o.handled&&o.handled!==n)||(!n||n.contains(i.srcEvent.target))&&e(Object.assign({},o,{type:t,stopPropagation:function(){o.handled||(o.handled=n)}}))}}},{key:"_normalizeEvent",value:function(t){var e=this.element;return Object.assign({},t,function(t){var e=kr[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,o=n.which,a=!1,s=!1,u=!1;return e===Ar||e===Tr&&!Number.isFinite(r)?(a=o===Cr,s=o===Or,u=o===Mr):e===Tr?(a=Boolean(r&jr),s=Boolean(r&Dr),u=Boolean(r&zr)):e===Pr&&(a=i===Ir,s=i===Lr,u=i===Rr),{leftButton:a,middleButton:s,rightButton:u}}(t),function(t,e){var n=t.srcEvent;if(!t.center&&!Number.isFinite(n.clientX))return null;var r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth,a=i.height/e.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/a}}}(t,e),{handled:!1,rootElement:e})}},{key:"_onBasicInput",value:function(t){var e=t.srcEvent,n=ar[e.type];n&&this.manager.emit(n,t)}},{key:"_onOtherEvent",value:function(t){this.manager.emit(t.type,t)}}]),t}(),Ur="";try{var Vr=document.createElement("div").style,Gr=/^(webkit|moz|ms|o)(?=[A-Z])/;for(var qr in Vr)if(Gr.test(qr)){Ur="-".concat(qr.match(Gr)[0],"-");break}}catch(t){}function Wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zr(){}var Xr="-webkit-"===Ur?Ur:"",Hr={GRABBING:"".concat(Xr,"grabbing"),GRAB:"".concat(Xr,"grab"),POINTER:"pointer"};var Yr={id:"deckgl-overlay",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,_animate:!1,onWebGLInitialized:Zr,onResize:Zr,onViewStateChange:Zr,onBeforeRender:Zr,onAfterRender:Zr,onLayerClick:null,onLayerHover:null,onLoad:Zr,getCursor:function(t){return t.isDragging?Hr.GRABBING:Hr.GRAB},debug:!1,drawPickingColors:!1},Kr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=Object.assign({},Yr,e),this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.stats=new Xt({id:"deck.gl"}),this._needsRedraw=!0,this.viewState=e.initialViewState||null,this.interactiveState={isDragging:!1},this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this),this._pickAndCallback=this._pickAndCallback.bind(this),this._onRendererInitialized=this._onRendererInitialized.bind(this),this._onRenderFrame=this._onRenderFrame.bind(this),this._onViewStateChange=this._onViewStateChange.bind(this),this._onInteractiveStateChange=this._onInteractiveStateChange.bind(this),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.setProps(e),this.animationLoop.start()}return function(t,e,n){e&&Wr(t.prototype,e),n&&Wr(t,n)}(t,[{key:"finalize",value:function(){this.animationLoop.stop(),this.animationLoop=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null),this.viewManager&&(this.viewManager.finalize(),this.viewManager=null),this.eventManager&&this.eventManager.destroy()}},{key:"setProps",value:function(t){this.stats.timeStart("deck.setProps"),t=Object.assign({},this.props,t),this.props=t,this._setCanvasSize(t);var e=Object.assign({},t,{views:this._getViews(t),width:this.width,height:this.height}),n=this._getViewState(t);n&&(e.viewState=n),this.viewManager&&this.viewManager.setProps(e),this.layerManager&&this.layerManager.setProps(e),this.animationLoop&&this.animationLoop.setProps(e),this.stats.timeEnd("deck.setProps")}},{key:"needsRedraw",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).clearRedrawFlags,e=void 0===t||t;if(this.props._animate)return"Deck._animate";var n=this._needsRedraw;e&&(this._needsRedraw=!1);var r=this.viewManager.needsRedraw({clearRedrawFlags:e}),i=this.layerManager.needsRedraw({clearRedrawFlags:e});return n=n||r||i}},{key:"getViews",value:function(){return this.viewManager.views}},{key:"getViewports",value:function(t){return this.viewManager.getViewports(t)}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o;this.stats.timeStart("deck.pickObject");var s=this.layerManager.pickObject({x:e,y:n,radius:i,layerIds:a,viewports:this.getViewports({x:e,y:n}),mode:"query",depth:1});return this.stats.timeEnd("deck.pickObject"),s.length?s[0]:null}},{key:"pickMultipleObjects",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o,s=t.depth,u=void 0===s?10:s;this.stats.timeStart("deck.pickMultipleObjects");var c=this.layerManager.pickObject({x:e,y:n,radius:i,layerIds:a,viewports:this.getViewports({x:e,y:n}),mode:"query",depth:u});return this.stats.timeEnd("deck.pickMultipleObjects"),c}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o,s=t.layerIds,u=void 0===s?null:s;this.stats.timeStart("deck.pickObjects");var c=this.layerManager.pickObjects({x:e,y:n,width:i,height:a,layerIds:u,viewports:this.getViewports({x:e,y:n,width:i,height:a})});return this.stats.timeEnd("deck.pickObjects"),c}},{key:"_createCanvas",value:function(t){var e=t.canvas;("string"==typeof e&&(e=document.getElementById(e),Object(a.a)(e)),e)||(e=document.createElement("canvas"),(t.parent||document.body).appendChild(e));var n=t.id,r=t.style;return e.id=n,Object.assign(e.style,r),e}},{key:"_setCanvasSize",value:function(t){if(this.canvas){var e=t.width,n=t.height;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}}},{key:"_updateCanvasSize",value:function(){if(this._checkForCanvasSizeChange()){var t=this.width,e=this.height;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}},{key:"_checkForCanvasSizeChange",value:function(){var t=this.canvas;return!(!t||this.width===t.clientWidth&&this.height===t.clientHeight)&&(this.width=t.clientWidth,this.height=t.clientHeight,!0)}},{key:"_createAnimationLoop",value:function(t){var e=this,n=t.width,r=t.height,i=t.gl,o=t.glOptions,a=t.debug,u=t.useDevicePixels,c=t.autoResizeDrawingBuffer;return new s.a({width:n,height:r,useDevicePixels:u,autoResizeDrawingBuffer:c,onCreateContext:function(t){return i||Object(s.r)(Object.assign({},o,t,{canvas:e.canvas,debug:a}))},onInitialize:this._onRendererInitialized,onRender:this._onRenderFrame,onBeforeRender:t.onBeforeRender,onAfterRender:t.onAfterRender})}},{key:"_getViewState",value:function(t){return t.viewState||this.viewState}},{key:"_getViews",value:function(t){var e=t.views||[new Gn({id:"default-view"})];return(e=Array.isArray(e)?e:[e]).length&&t.controller&&(e[0].props.controller=t.controller),e}},{key:"_pickAndCallback",value:function(t){var e=t.event.offsetCenter;if(e){var n=this.props.pickingRadius,r=this.layerManager.pickObject({x:e.x,y:e.y,radius:n,viewports:this.getViewports(e),mode:t.mode,depth:1});if(t.callback&&r){var i=r.find(function(t){return t.index>=0})||null;t.callback(i,r,t.event.srcEvent)}}}},{key:"_updateCursor",value:function(){this.canvas&&(this.canvas.style.cursor=this.props.getCursor(this.interactiveState))}},{key:"_updateAnimationProps",value:function(t){this.layerManager.context.animationProps=t}},{key:"_setGLContext",value:function(t){if(!this.layerManager){this.canvas||(this.canvas=t.canvas,Object(s.C)(t,{enable:!0,copyState:!0})),Object(s.B)(t,{blend:!0,blendFunc:[f.a.SRC_ALPHA,f.a.ONE_MINUS_SRC_ALPHA,f.a.ONE,f.a.ONE_MINUS_SRC_ALPHA],polygonOffsetFill:!0,depthTest:!0,depthFunc:f.a.LEQUAL}),this.props.onWebGLInitialized(t),this.props._customRender||(this.eventManager=new Br(t.canvas,{events:{click:this._onClick,pointermove:this._onPointerMove,pointerleave:this._onPointerLeave}})),this.viewManager=new Me({eventManager:this.eventManager,onViewStateChange:this._onViewStateChange,onInteractiveStateChange:this._onInteractiveStateChange,views:this._getViews(this.props),viewState:this._getViewState(this.props),width:this.width,height:this.height}),Object(a.a)(this.viewManager);var e=this.viewManager.getViewports()[0];this.layerManager=new xe(t,{stats:this.stats,viewport:e}),this.effectManager=new Wn({gl:t,layerManager:this.layerManager});var n=!0,r=!1,i=void 0;try{for(var o,u=this.props.effects[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var c=o.value;this.effectManager.addEffect(c)}}catch(t){r=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}}},{key:"_drawLayers",value:function(t){var e=this.layerManager.context.gl;Object(s.B)(e,this.props.parameters),this.props.onBeforeRender({gl:e}),this.layerManager.drawLayers({pass:"screen",viewports:this.viewManager.getViewports(),views:this.viewManager.getViews(),redrawReason:t,drawPickingColors:this.props.drawPickingColors,customRender:Boolean(this.props._customRender)}),this.props.onAfterRender({gl:e})}},{key:"_onRendererInitialized",value:function(t){var e=t.gl;this._setGLContext(e)}},{key:"_onRenderFrame",value:function(t){if(this.stats.oneSecondPassed()){var e=this.stats.getStatsTable();this.stats.reset(),i.a.table(3,e)()}this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.stats.bump("fps"),this._updateAnimationProps(t);var n=this.needsRedraw({clearRedrawFlags:!0});n&&(this.stats.bump("render-fps"),this.props._customRender?this.props._customRender():this._drawLayers(n))}},{key:"_onViewStateChange",value:function(t){var e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState[t.viewId]=e,this.viewManager.setProps({viewState:e}))}},{key:"_onInteractiveStateChange",value:function(t){var e=t.isDragging,n=void 0!==e&&e;n!==this.interactiveState.isDragging&&(this.interactiveState.isDragging=n)}},{key:"_onClick",value:function(t){this._pickAndCallback({callback:this.props.onLayerClick,event:t,mode:"click"})}},{key:"_onPointerMove",value:function(t){t.leftButton||t.rightButton||this._pickAndCallback({callback:this.props.onLayerHover,event:t,mode:"hover"})}},{key:"_onPointerLeave",value:function(t){this.layerManager.pickObject({x:-1,y:-1,viewports:[],radius:1,mode:"hover"}),this.props.onLayerHover&&this.props.onLayerHover(null,[],t.srcEvent)}}]),t}();function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $r(t,e){return!e||"object"!==Jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ti(t,e,n){return(ti="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ei(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function ei(t){return(ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ni(t,e){return(ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Kr.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(Hn)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.bool,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLayerClick:t.func,onLayerHover:t.func,onLoad:t.func,debug:t.bool,drawPickingColors:t.bool,_animate:t.bool}},Kr.defaultProps=Yr;var ri=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),$r(this,ei(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ni(t,e)}(e,Ct),function(t,e,n){e&&Qr(t.prototype,e),n&&Qr(t,n)}(e,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(t){ti(ei(e.prototype),"setState",this).call(this,t),this.setLayerNeedsUpdate()}},{key:"getPickingInfo",value:function(t){return t.info}},{key:"renderLayers",value:function(){return null}},{key:"getSubLayerProps",value:function(t){var e=this.props,n={opacity:e.opacity,pickable:e.pickable,visible:e.visible,parameters:e.parameters,getPolygonOffset:e.getPolygonOffset,highlightedObjectIndex:e.highlightedObjectIndex,autoHighlight:e.autoHighlight,highlightColor:e.highlightColor,coordinateSystem:e.coordinateSystem,coordinateOrigin:e.coordinateOrigin,wrapLongitude:e.wrapLongitude,modelMatrix:e.modelMatrix};return t&&Object.assign(n,t,{id:"".concat(this.props.id,"-").concat(t.id),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers)}),n}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var t=this.internalState.subLayers;t&&!this.needsUpdate()?i.a.log(3,"Composite layer reused subLayers ".concat(this),this.internalState.subLayers)():(t=Vt(t=this.renderLayers(),{filter:Boolean}),this.internalState.subLayers=t,i.a.log(2,"Composite layer rendered new subLayers ".concat(this),t)());var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){o.value.parent=this}}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"isComposite",get:function(){return!0}}]),e}();ri.layerName="CompositeLayer";var ii=n(62),oi=n(124),ai=n(123);function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ui(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fi(t,e){return!e||"object"!==si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hi(t){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&di(t,e)}function di(t,e){return(di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vi(t,e){return Number.isFinite(t)?t:e}var gi=function(t){function e(t){var n,r=t.width,i=t.height,o=t.position,a=t.bearing,s=t.pitch,u=t.longitude,c=t.latitude,l=t.zoom,f=(t.syncBearing,t.bounds,t.startPanEventPosition),h=t.startPanPosition,p=t.startRotateCenter,d=t.startRotateViewport,v=t.startZoomPos,g=t.startZoom;return ci(this,e),(n=fi(this,hi(e).call(this,{width:r,height:i,position:o,bearing:a,pitch:s,longitude:u,latitude:c,zoom:l})))._interactiveState={startPanEventPosition:f,startPanPosition:h,startRotateCenter:p,startRotateViewport:d,startZoomPos:v,startZoom:g},n}return pi(e,xn),function(t,e,n){e&&li(t.prototype,e),n&&li(t,n)}(e,[{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=this._viewportProps,r=n.translationX,i=n.translationY;return this._getUpdatedState({startPanPosition:[r,i],startPanEventPosition:e})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanEventPosition||n;if(!r)return this;var i=ui(this._interactiveState.startPanPosition||[],2),o=i[0],a=i[1];o=vi(o,this._viewportProps.translationX),a=vi(a,this._viewportProps.translationY);var s=e[0]-r[0],u=e[1]-r[1];return this._getUpdatedState({translationX:o+s,translationY:a-u})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startPanPos:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedState({startRotateCenter:this._viewportProps.position,startRotateViewport:this._viewportProps})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY;if(!this._interactiveState.startRotateCenter)return this;var r=this._viewportProps,i=r.bearing,o=r.pitch;return this._getUpdatedState({bearing:i+10*e,pitch:o-10*n})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startRotateCenter:null,startRotateViewport:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomPos:e,startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.minZoom,s=i.maxZoom,u=i.width,c=i.height,l=(i.translationX,i.translationY,this._interactiveState.startZoomPos||n||e),f=Object($t.b)(o*r,a,s);e[0],l[0],e[1],l[1],l[0],l[1];return f/o<1?this.moveBackward():this.moveForward()}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPos:null,startZoom:null})}},{key:"moveLeft",value:function(){var t=this._viewportProps.bearing-2;return this._getUpdatedState({bearing:t})}},{key:"moveRight",value:function(){var t=this._viewportProps.bearing+2;return this._getUpdatedState({bearing:t})}},{key:"moveForward",value:function(){var t=this._viewportProps.position,e=this.getDirection(),n=new ee.a(e).normalize().scale(1);return this._getUpdatedState({position:new ee.a(t).add(n)})}},{key:"moveBackward",value:function(){var t=this._viewportProps.position,e=this.getDirection(),n=new ee.a(e).normalize().scale(-1);return this._getUpdatedState({position:new ee.a(t).add(n)})}},{key:"moveUp",value:function(){var t=this._viewportProps.position;return this._getUpdatedState({position:new ee.a(t).add([0,0,1])})}},{key:"moveDown",value:function(){var t=this._viewportProps.position,e=t[2]>=1?[0,0,-1]:[0,0,0];return this._getUpdatedState({position:new ee.a(t).add(e)})}},{key:"zoomIn",value:function(){return this._getUpdatedState({zoom:this._viewportProps.zoom+.2})}},{key:"zoomOut",value:function(){return this._getUpdatedState({zoom:this._viewportProps.zoom-.2})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}}]),e}(),mi=function(t){function e(t){return ci(this,e),fi(this,hi(e).call(this,gi,t))}return pi(e,pn),e}();function yi(t){return(yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bi(t,e){return!e||"object"!==yi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xi(t){return(xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wi(t,e){return(wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ei=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bi(this,xi(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wi(t,e)}(e,Ce),function(t,e,n){e&&_i(t.prototype,e),n&&_i(t,n)}(e,[{key:"_getViewport",value:function(t){var e=t.viewState,n=e.modelMatrix,r=void 0===n?null:n,i=e.bearing,o=e.up,a=void 0===o?[0,0,1]:o,s=function(t){var e=t.bearing,n=t.pitch;return new yn({bearing:e,pitch:n}).toVector3().normalize()}({bearing:i,pitch:89}),u=r?r.transformDirection(s):s,c=(new te.a).lookAt({eye:[0,0,0],center:u,up:a});return new ge(Object.assign({},t,{zoom:null,viewMatrix:c}))}},{key:"controller",get:function(){return this._getControllerProps({type:mi})}}]),e}();function Si(t){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ti(t,e){return!e||"object"!==Si(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ai(t){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ki(t,e){return(ki=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Ei.displayName="FirstPersonView";var Ci=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ti(this,Ai(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ki(t,e)}(e,Ce),function(t,e,n){e&&Pi(t.prototype,e),n&&Pi(t,n)}(e,[{key:"_getViewport",value:function(t){var e=t.viewState,n=e.bearing,r=e.pitch,i=e.position,o=e.up,a=50*e.zoom,s=function(t){var e=t.bearing,n=t.pitch;return new yn({bearing:e,pitch:n}).toVector3().normalize()}({bearing:n,pitch:r}).scale(-a).multiply(new ee.a(1,1,-1)),u=(new te.a).multiplyRight((new te.a).lookAt({eye:s,center:i,up:o}));return new ge(Object.assign({},t,{id:this.id,zoom:null,viewMatrix:u}))}}]),e}();Ci.displayName="ThirdPersonView";var Oi=n(88),Mi=n.n(Oi),Ii=n(76),Li=n.n(Ii),Ri=n(89),ji=n.n(Ri),zi=n(113),Di=n.n(zi),Fi=n(90),Ni=n.n(Fi);function Bi(t){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ui(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qi(t,e){return!e||"object"!==Bi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xi=Math.PI/180,Hi=function(t){function e(t){var n,r=t.id,i=void 0===r?"orbit-viewport":r,o=t.width,a=t.height,s=t.distance,u=t.rotationX,c=void 0===u?0:u,l=t.rotationOrbit,f=void 0===l?0:l,h=t.orbitAxis,p=void 0===h?"Z":h,d=t.lookAt,v=void 0===d?[0,0,0]:d,g=t.up,m=void 0===g?[0,1,0]:g,y=t.fov,_=void 0===y?75:y,b=t.near,x=void 0===b?1:b,w=t.far,E=void 0===w?100:w,S=t.zoom,P=void 0===S?1:S;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var T=ji()([],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],-c/180*Math.PI);"Z"===p?Ni()(T,T,-f/180*Math.PI):Di()(T,T,-f/180*Math.PI);var A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];re()(A,A,[P,P,P]),oe()(A,A,[-v[0],-v[1],-v[2]]);var k=Mi()([],[0,0,s],[0,0,0],m),C=_*Xi,O=o/a,M=Li()([],C,O,x,E);return(n=qi(this,Wi(e).call(this,{id:i,viewMatrix:se()(k,k,se()(T,T,A)),projectionMatrix:M,width:o,height:a}))).width=o,n.height=a,n.distance=s,n.rotationX=c,n.rotationOrbit=f,n.orbitAxis=p,n.lookAt=v,n.up=m,n.fov=_,n.near=x,n.far=E,n.zoom=P,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}(e,ge),function(t,e,n){e&&Gi(t.prototype,e),n&&Gi(t,n)}(e,[{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=Ui(Qt(this.pixelProjectionMatrix,Vi(t).concat([1])),3),i=r[0],o=r[1],a=r[2];return[i,n?this.height-o:o,a]}},{key:"unproject",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=Ui(t,3),i=r[0],o=r[1],a=r[2],s=n?this.height-o:o;return Qt(this.pixelUnprojectionMatrix,[i,s,a,1])}},{key:"getDistance",value:function(t){var e=t.boundingBox,n=t.fov;return Math.max(e[0],e[1],e[2])/2/Math.tan(n/180*Math.PI/2)}},{key:"fitBounds",value:function(t){var n=this.width,r=this.height,i=this.rotationX,o=this.rotationOrbit,a=this.orbitAxis,s=this.lookAt,u=this.up,c=this.fov;return new e({width:n,height:r,rotationX:i,rotationOrbit:o,orbitAxis:a,up:u,fov:c,near:this.near,far:this.far,zoom:this.zoom,lookAt:s,distance:this.getDistance({boundingBox:t,fov:c})})}}]),e}();function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ki(t,e){return!e||"object"!==Yi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function to(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eo(t,e,n){return e&&to(t.prototype,e),n&&to(t,n),t}Hi.displayName="OrbitViewport";var no={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Qe(["zoom"]),transitionInterruption:en.BREAK},ro={lookAt:[0,0,0],rotationX:0,rotationOrbit:0,fov:50,near:1,far:100,translationX:0,translationY:0,zoom:1},io={minZoom:0,maxZoom:1/0};function oo(t,e){return Number.isFinite(t)?t:e}var ao=function(){function t(e){var n=e.width,r=e.height,i=e.distance,o=e.rotationX,s=e.rotationOrbit,u=e.orbitAxis,c=e.bounds,l=e.lookAt,f=e.fov,h=e.near,p=e.far,d=e.translationX,v=e.translationY,g=e.zoom,m=e.minZoom,y=e.maxZoom,_=e.startPanViewport,b=e.startPanPos,x=e.isPanning,w=e.startRotateViewport,E=e.isRotating,S=e.startZoomViewport,P=e.startZoomPos;$i(this,t),Object(a.a)(Number.isFinite(n),"`width` must be supplied"),Object(a.a)(Number.isFinite(r),"`height` must be supplied"),Object(a.a)(Number.isFinite(i),"`distance` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,distance:i,rotationX:oo(o,ro.rotationX),rotationOrbit:oo(s,ro.rotationOrbit),orbitAxis:u,bounds:c,lookAt:l||ro.lookAt,fov:oo(f,ro.fov),near:oo(h,ro.near),far:oo(p,ro.far),translationX:oo(d,ro.translationX),translationY:oo(v,ro.translationY),zoom:oo(g,ro.zoom),minZoom:oo(m,io.minZoom),maxZoom:oo(y,io.maxZoom)}),this._interactiveState={startPanViewport:_,startPanPos:b,isPanning:x,startRotateViewport:w,isRotating:E,startZoomViewport:S,startZoomPos:P}}return eo(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=new Hi(this._viewportProps);return this._getUpdatedOrbitState({startPanPos:e,startPanViewport:n})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos;if(this._interactiveState.isRotating)return this._getUpdatedOrbitState();var r=this._interactiveState.startPanPos||n;Object(a.a)(r,"`startPanPos` props is required");var i=this._interactiveState.startPanViewport||new Hi(this._viewportProps),o=e[0]-r[0],s=e[1]-r[1],u=i.project(i.lookAt),c=i.unproject([u[0]-o,u[1]-s,u[2]]);return this._getUpdatedOrbitState({lookAt:c,isPanning:!0})}},{key:"panEnd",value:function(){return this._getUpdatedOrbitState({startPanViewport:null,startPanPos:null,isPanning:null})}},{key:"rotateStart",value:function(t){t.pos;var e=new Hi(this._viewportProps);return this._getUpdatedOrbitState({startRotateViewport:e})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY;if(this._interactiveState.isPanning)return this._getUpdatedOrbitState();var r=this._interactiveState.startRotateViewport||{},i=r.rotationX,o=r.rotationOrbit;i=oo(i,this._viewportProps.rotationX),o=oo(o,this._viewportProps.rotationOrbit);var a=Object($t.b)(i-180*n,-89.999,89.999),s=(o-180*e)%360;return this._getUpdatedOrbitState({rotationX:a,rotationOrbit:s,isRotating:!0})}},{key:"rotateEnd",value:function(){return this._getUpdatedOrbitState({startRotateViewport:null,isRotating:null})}},{key:"shortestPathFrom",value:function(t){return Object.assign({},this._viewportProps)}},{key:"zoomStart",value:function(t){var e=t.pos,n=new Hi(this._viewportProps);return this._getUpdatedOrbitState({startZoomViewport:n,startZoomPos:e})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.minZoom,s=i.maxZoom,u=i.width,c=i.height,l=this._interactiveState.startZoomPos||n||e,f=this._interactiveState.startZoomViewport||new Hi(this._viewportProps),h=Object($t.b)(o*r,a,s),p=e[0]-l[0],d=e[1]-l[1],v=l[0]-u/2,g=c/2-l[1],m=f.project(f.lookAt),y=m[0]-v+v*h/o+p,_=m[1]+g-g*h/o-d,b=f.unproject([y,_,m[2]]);return this._getUpdatedOrbitState({lookAt:b,zoom:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedOrbitState({startZoomPos:null})}},{key:"_getUpdatedOrbitState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;return t.zoom=r>e?e:r,t.zoom=r<n?n:r,t}}]),t}(),so=function(t){function e(t){return $i(this,e),Ki(this,Ji(e).call(this,ao,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,pn),eo(e,[{key:"_getTransitionProps",value:function(){return no}}]),e}();function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function co(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function lo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function po(t,e,n){return e&&ho(t.prototype,e),n&&ho(t,n),t}function vo(t,e){return!e||"object"!==uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yo(t,e)}function yo(t,e){return(yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _o=Math.PI/180,bo=function(t){function e(){return fo(this,e),vo(this,go(e).apply(this,arguments))}return mo(e,ge),po(e,[{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=co(Qt(this.pixelProjectionMatrix,lo(t).concat([1])),3),i=r[0],o=r[1],a=r[2];return[i,n?this.height-o:o,a]}},{key:"unproject",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0!==e&&e,r=co(t,3),i=r[0],o=r[1],a=r[2],s=n?this.height-o:o;return Qt(this.pixelUnprojectionMatrix,[i,s,a,1])}}]),e}(),xo=function(t){function e(){return fo(this,e),vo(this,go(e).apply(this,arguments))}return mo(e,Ce),po(e,[{key:"_getViewport",value:function(t){var e=t.viewState,n=t.width||1,r=t.height||1,i=t.fov||t.fovy||e.fovy||75,o=t.near||e.near||1,a=t.far||e.far||100,s=Number.isFinite(e.aspect)?e.aspect:n/r,u=i*_o;return new bo({id:this.id,viewMatrix:this._getViewMatrix(t.viewState),projectionMatrix:Li()([],u,s,o,a),x:t.x,y:t.y,width:n,height:r})}},{key:"_getViewMatrix",value:function(t){var e=t.distance,n=t.rotationX,r=void 0===n?0:n,i=t.rotationOrbit,o=void 0===i?0:i,a=t.orbitAxis,s=void 0===a?"Z":a,u=t.lookAt,c=void 0===u?[0,0,0]:u,l=t.up,f=void 0===l?[0,1,0]:l,h=t.zoom,p=void 0===h?1:h,d=ji()([],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],-r/180*Math.PI);"Z"===s?Ni()(d,d,-o/180*Math.PI):Di()(d,d,-o/180*Math.PI);var v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];re()(v,v,[p,p,p]),oe()(v,v,[-c[0],-c[1],-c[2]]);var g=Mi()([],[0,0,e],[0,0,0],f);return se()(g,g,se()(d,d,v)),g}},{key:"fitBounds",value:function(t,e){var n=this.width,r=this.height,i=this.fov,o=this.near,a=this.far;return this._getViewport({width:n,height:r,fov:i,near:o,far:a})}},{key:"controller",get:function(){return this._getControllerProps({type:so})}}],[{key:"getDistance",value:function(t){var e=t.boundingBox,n=t.fov;return Math.max(e[0],e[1],e[2])/2/Math.tan(n/180*Math.PI/2)}}]),e}();function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function So(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Po(t){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function To(t,e){return(To=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}xo.displayName="OrbitView";var Ao=Math.PI/180,ko=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),So(this,Po(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&To(t,e)}(e,Ce),function(t,e,n){e&&Eo(t.prototype,e),n&&Eo(t,n)}(e,[{key:"_getViewport",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.viewState,a=o.eye,s=o.lookAt,u=void 0===s?[0,0,0]:s,c=o.up,l=void 0===c?[0,1,0]:c,f=t.fovy||o.fovy||75,h=t.near||o.near||1,p=t.far||o.far||100,d=Number.isFinite(o.aspect)?o.aspect:r/i,v=f*Ao;return new ge({id:this.id,x:e,y:n,width:r,height:i,viewMatrix:Mi()([],a,u,l),projectionMatrix:Li()([],v,d,h,p)})}}]),e}();ko.displayName="PerspectiveView";var Co=n(500);function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lo(t,e){return!e||"object"!==Oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(t){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zo(t,e)}function zo(t,e){return(zo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Do=function(t){function e(t){var n,r=t.width,i=t.height,o=t.offset,a=t.zoom,s=t.startPanPosition,u=t.startPanOffset,c=t.startRotatePosition,l=t.startRotateOffset;return Mo(this,e),(n=Lo(this,Ro(e).call(this,{width:r,height:i,offset:o,zoom:a})))._interactiveState={startPanPosition:s,startPanOffset:u,startRotatePosition:c,startRotateOffset:l},n}return jo(e,xn),function(t,e,n){e&&Io(t.prototype,e),n&&Io(t,n)}(e,[{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=this._viewportProps.offset;return this._getUpdatedState({startPanPosition:e,startPanOffset:n})}},{key:"pan",value:function(t){var e=t.pos,n=this._interactiveState,r=n.startPanPosition,i=n.startPanOffset,o=new Co.a(e).subtract(r);return this._getUpdatedState({offset:new Co.a(i).subtract(o)})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startPanOffset:null})}},{key:"rotateStart",value:function(t){t.pos;return this}},{key:"rotate",value:function(t){t.deltaScaleX,t.deltaScaleY;return this}},{key:"rotateEnd",value:function(){return this}},{key:"zoom",value:function(t){var e=t.pos,n=t.scale,r=this._viewportProps,i=r.zoom,o=r.width,a=r.height,s=r.offset,u=Object($t.b)(i*n,.1,10),c=o/2-s[0],l=a/2-s[1],f=(e[0]-c)*(i/u-1),h=(e[1]-l)*(i/u-1);return this._getUpdatedState({zoom:u,offset:[s[0]+f,s[1]+h]})}},{key:"moveLeft",value:function(){var t=this._viewportProps.offset,e=[10,0];return this._getUpdatedState({offset:new Co.a(t).add(e)})}},{key:"moveRight",value:function(){var t=this._viewportProps.offset,e=[-10,0];return this._getUpdatedState({offset:new Co.a(t).add(e)})}},{key:"moveUp",value:function(){var t=this._viewportProps.offset,e=[0,10];return this._getUpdatedState({offset:new Co.a(t).add(e)})}},{key:"moveDown",value:function(){var t=this._viewportProps.offset,e=[0,-10];return this._getUpdatedState({offset:new Co.a(t).add(e)})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}}]),e}(),Fo=function(t){function e(t){var n;return Mo(this,e),(n=Lo(this,Ro(e).call(this,Do,t))).invertPan=!0,n}return jo(e,pn),e}();function No(t){return(No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uo(t,e){return!e||"object"!==No(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vo(t){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Go(t,e){return(Go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Uo(this,Vo(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Go(t,e)}(e,Ce),function(t,e,n){e&&Bo(t.prototype,e),n&&Bo(t,n)}(e,[{key:"_getViewport",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.viewState,a=o.eye,s=void 0===a?[0,0,1]:a,u=o.lookAt,c=void 0===u?[0,0,0]:u,l=o.up,f=void 0===l?[0,1,0]:l,h=o.offset,p=void 0===h?[0,1]:h,d=o.zoom,v=void 0===d?1:d;r=r||1,i=i||1;var g=this.props,m=g.left,y=void 0===m?(-r/2+p[0])*v:m,_=g.top,b=void 0===_?(-i/2+p[1])*v:_,x=g.right,w=void 0===x?(r/2+p[0])*v:x,E=g.bottom,S=void 0===E?(i/2+p[1])*v:E,P=g.near,T=void 0===P?1:P,A=g.far,k=void 0===A?100:A;return new ge({id:this.id,x:e,y:n,width:r,height:i,viewMatrix:(new te.a).lookAt({eye:s,lookAt:c,up:f}),projectionMatrix:(new te.a).ortho({left:y,right:w,bottom:S,top:b,near:T,far:k})})}},{key:"controller",get:function(){return this._getControllerProps({type:Fo})}}]),e}();qo.displayName="OrthographicView";function Wo(t){return(Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xo(t,e){return!e||"object"!==Wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ho(t){return(Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yo(t,e){return(Yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ko=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=Xo(this,Ho(e).call(this))).reflectivity=n,t.blur=r,t.framebuffer=null,t.setNeedsRedraw(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yo(t,e)}(e,Hn),function(t,e,n){e&&Zo(t.prototype,e),n&&Zo(t,n)}(e,[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME reflection-effect-vs\n\nattribute vec3 vertices;\n\nvarying vec2 uv;\n\nvoid main(void) {\n  uv = vertices.xy;\n  gl_Position = vec4(2. * vertices.xy - vec2(1., 1.), 1., 1.);\n}\n",fs:'#define SHADER_NAME reflection-effect-fs\n\nprecision highp float;\n\nuniform sampler2D reflectionTexture;\nuniform int reflectionTextureWidth;\nuniform int reflectionTextureHeight;\n\nuniform float reflectivity;\nuniform float blur;\n\n\nvarying vec2 uv;\n\n#define KERNEL_SIZE 7\n\n/*\n * Samples from tex with a gaussian-shaped patch, centered at uv and\n * with standard deviation sigma.  The size of the texture in\n * pixels must be specified by dim\n */\nvec4 sample_gaussian(sampler2D tex, vec2 dim, vec2 uv, float sigma) {\n  if (sigma == 0.0) {\n    return texture2D(tex, uv);\n  }\n\n  vec2 delta = 1.0 / dim;\n  vec2 top_left = uv - delta * float(KERNEL_SIZE+1) / 2.0;\n\n  vec4 color = vec4(0);\n  float sum = 0.0;\n  for (int i = 0; i <  KERNEL_SIZE; ++i) {\n    for (int j = 0; j < KERNEL_SIZE; ++j) {\n      vec2 uv2 = top_left + vec2(i, j) * delta;\n      float d = length((uv2 - uv) * dim);\n      float f = exp(-(d*d) / (2.0*sigma * sigma));\n      color += f * texture2D(tex, uv2);\n      sum += f;\n    }\n  }\n  return color / sum;\n}\n\nvoid main(void) {\n  //map blur in [0, 1] to sigma in [0, inf]\n  //alpha will determine the "steepness" of our curve.\n  //this was picked just to make the scale feel "natural"\n  //if our image is 1000 pixels wide, a blur of 0.5 should correspond\n  //to a sigma of 1 pixels\n  float alpha = 1000.0;\n  float sigma = blur / (alpha * (1.0 - blur));\n  //let this be our standard deviation in terms of screen-widths.\n  //rewrite this in terms of pixels.\n  sigma *= float(reflectionTextureWidth);\n\n\n  gl_FragColor = sample_gaussian(reflectionTexture, vec2(reflectionTextureWidth,\n    reflectionTextureHeight), vec2(uv.x, 1. - uv.y), sigma);\n  //because our canvas expects alphas to be pre-multiplied, we multiply by whole\n  //color vector by reflectivity, not just the alpha channel\n  gl_FragColor *= reflectivity;\n}\n',modules:[],shaderCache:this.context.shaderCache}}},{key:"initialize",value:function(t){var e=t.gl;t.layerManager;this.unitQuad=new s.h(e,Object.assign({},this.getShaders(),{id:"reflection-effect",geometry:new s.g({drawMode:f.a.TRIANGLE_FAN,vertices:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])})})),this.framebuffer=new s.f(e,{depth:!0})}},{key:"preDraw",value:function(t){var e=t.gl,n=t.layerManager,r=n.context.viewport,i="undefined"!=typeof window&&window.devicePixelRatio||1;this.framebuffer.resize({width:i*r.width,height:i*r.height});var o=r.pitch;this.framebuffer.bind(),n.setViewport(new Ge(Object.assign({},r,{pitch:-180-o}))),e.clear(f.a.COLOR_BUFFER_BIT|f.a.DEPTH_BUFFER_BIT),n.drawLayers({pass:"reflection"}),n.setViewport(r),this.framebuffer.unbind()}},{key:"draw",value:function(t){t.gl,t.layerManager;this.unitQuad.render({reflectionTexture:this.framebuffer.texture,reflectionTextureWidth:this.framebuffer.width,reflectionTextureHeight:this.framebuffer.height,reflectivity:this.reflectivity,blur:this.blur})}},{key:"finalize",value:function(t){t.gl,t.layerManager}}]),e}(),Jo=n(567);function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ta(t,e){return!e||"object"!==Qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ea(t){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function na(t,e){return(na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ra=["bearing","pitch"],ia=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ta(this,ea(e).call(this,{compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&na(t,e)}(e,We),function(t,e,n){e&&$o(t.prototype,e),n&&$o(t,n)}(e,[{key:"interpolateProps",value:function(t,e,n){for(var r=Object(Jo.a)(t,e,n),i=0;i<ra.length;i++){var o=ra[i];r[o]=Object($t.g)(t[o]||0,e[o]||0,n)}return r}}]),e}();function oa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function aa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var sa=function(t){return t.length},ua=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sa;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sortedBins=this.getSortedBins(e,n),this.maxCount=this.getMaxCount(),this.binMap=this.getBinMap()}return function(t,e,n){e&&aa(t.prototype,e),n&&aa(t,n)}(t,[{key:"getSortedBins",value:function(t,e){return t.reduce(function(t,n,r){var i=e(n.points);return null!==i&&void 0!==i&&t.push({i:Number.isFinite(n.index)?n.index:r,value:i,counts:n.points.length}),t},[]).sort(function(t,e){return t.value-e.value})}},{key:"getValueRange",value:function(t){var e=oa(t,2),n=e[0],r=e[1],i=this.sortedBins.length;if(!i)return[0,0];var o=Math.ceil(n/100*(i-1)),a=Math.floor(r/100*(i-1));return[this.sortedBins[o].value,this.sortedBins[a].value]}},{key:"getMaxCount",value:function(){var t=0;return this.sortedBins.forEach(function(e){return t=t>e.counts?t:e.counts}),t}},{key:"getBinMap",value:function(){return this.sortedBins.reduce(function(t,e){return Object.assign(t,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e.i,e))},{})}}]),t}();function ca(t,e,n){var r=t[1]-t[0];if(r<=0)return i.a.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];var o=r/e.length,a=Math.floor((n-t[0])/o);return e[Math.max(Math.min(a,e.length-1),0)]}var la=n(37),fa=n.n(la);function ha(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function va(t,e,n){return e&&da(t.prototype,e),n&&da(t,n),t}var ga=s.t.fp64ifyMatrix4,ma=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ya={dataChanged:!0,viewportChanged:!0,cellSizeChanged:!0},_a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=n.id||"gpu-grid-aggregator",this.shaderCache=n.shaderCache||null,this.gl=e,this.state={},this._hasGPUSupport=Object(s.w)(e)&&Object(s.v)(this.gl,s.e.BLEND_EQUATION_MINMAX,s.e.COLOR_ATTACHMENT_RGBA32F,s.e.TEXTURE_FILTER_LINEAR_FLOAT),this._hasGPUSupport&&this._setupGPUResources()}return va(t,null,[{key:"getAggregationData",value:function(t){var e=t.countsData,n=t.maxCountData,r=t.pixelIndex;fa()(e.length>=4*(r+1)),fa()(4===n.length);var i=4*r;return{cellCount:e[i],cellWeight:e[i+1],totalCount:n[0],totalWeight:n[1],maxCellWieght:n[3]}}},{key:"getCellData",value:function(t){for(var e=t.countsData,n=[],r=[],i=0;i<e.length;i+=4)r.push(e[i]),n.push(e[i+1]);return{cellCounts:r,cellWeights:n}}}]),va(t,[{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.positions,n=t.positions64xyLow,r=t.weights,o=t.changeFlags,a=void 0===o?ya:o,s=t.cellSize,u=t.viewport,c=t.width,l=t.height,f=t.countsBuffer,h=void 0===f?null:f,p=t.maxCountBuffer,d=void 0===p?null:p,v=t.gridTransformMatrix,g=void 0===v?null:v,m=t.projectPoints,y=void 0!==m&&m,_=t.useGPU,b=void 0===_||_,x=t.fp64,w=void 0!==x&&x;this.state.useGPU!==b&&(a=ya),this._setState({useGPU:b});var E={positions:e,positions64xyLow:n,weights:r,changeFlags:a,cellSize:s,viewport:u,gridTransformMatrix:(y?u.viewportMatrix:g)||ma,countsBuffer:h,maxCountBuffer:d,projectPoints:y,fp64:w};return this._updateGridSize({viewport:u,cellSize:s,width:c,height:l}),this._hasGPUSupport&&b?this._runAggregationOnGPU(E):(b&&i.a.warn("ScreenGridAggregator: GPU Aggregation not supported, falling back to CPU")(),this._runAggregationOnCPU(E))}},{key:"_getAggregateData",value:function(t){var e=t.countsBuffer,n=t.maxCountBuffer;return e=this.gridAggregationFramebuffer.readPixelsToBuffer({buffer:e,type:f.a.FLOAT}),n=this.allAggregrationFramebuffer.readPixelsToBuffer({width:1,height:1,type:f.a.FLOAT,buffer:n}),{countsBuffer:e,countsTexture:this.gridAggregationFramebuffer.texture,maxCountBuffer:n,maxCountTexture:this.allAggregrationFramebuffer.texture}}},{key:"_getAggregationModel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.gl,n=this.shaderCache;return new s.h(e,{id:"Gird-Aggregation-Model",vs:t?"#define SHADER_NAME gpu-aggregation-to-grid-vs-64\n\nattribute vec2 positions;\nattribute vec2 positions64xyLow;\nattribute float weights;\nuniform vec2 windowSize;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform vec2 uProjectionMatrixFP64[16];\nuniform bool projectPoints;\n\nvarying float vWeights;\n\nvoid project_to_pixel(vec2 pos, vec2 pos64xyLow, out vec2 pixelXY64[2]) {\n\n  vec2 result64[4];\n  vec2 position64[4];\n  position64[0] = vec2(pos.x, pos64xyLow.x);\n  position64[1] = vec2(pos.y, pos64xyLow.y);\n  position64[2] = vec2(0., 0.);\n  position64[3] = vec2(1., 0.);\n  mat4_vec4_mul_fp64(uProjectionMatrixFP64, position64,\n  result64);\n\n  pixelXY64[0] = div_fp64(result64[0], result64[3]);\n  pixelXY64[1] = div_fp64(result64[1], result64[3]);\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec2 windowPos = positions;\n  vec2 windowPos64xyLow = positions64xyLow;\n  if (projectPoints) {\n    vec2 projectedXY[2];\n    project_position_fp64(windowPos, windowPos64xyLow, projectedXY);\n    windowPos.x = projectedXY[0].x;\n    windowPos.y = projectedXY[1].x;\n    windowPos64xyLow.x = projectedXY[0].y;\n    windowPos64xyLow.y = projectedXY[1].y;\n  }\n\n  vec2 pixelXY64[2];\n  project_to_pixel(windowPos, windowPos64xyLow, pixelXY64);\n\n  // Transform (0,0):windowSize -> (0, 0): gridSize\n  vec2 gridXY64[2];\n  gridXY64[0] = div_fp64(pixelXY64[0], vec2(cellSize.x, 0));\n  gridXY64[1] = div_fp64(pixelXY64[1], vec2(cellSize.y, 0));\n  float x = floor(gridXY64[0].x);\n  float y = floor(gridXY64[1].x);\n  vec2 pos = vec2(x, y);\n\n  // Transform (0,0):gridSize -> (-1, -1):(1,1)\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n\n  // Move to pixel center, pixel-size in screen sapce (2/gridSize) * 0.5 => 1/gridSize\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n}\n":"#define SHADER_NAME gpu-aggregation-to-grid-vs\n\nattribute vec2 positions;\nattribute float weights;\nuniform vec2 windowSize;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform mat4 uProjectionMatrix;\nuniform bool projectPoints;\n\nvarying float vWeights;\n\nvec2 project_to_pixel(vec4 pos) {\n  vec4 result =  uProjectionMatrix * pos;\n  return result.xy/result.w;\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec4 windowPos = vec4(positions, 0, 1.);\n  if (projectPoints) {\n    windowPos = project_position_to_clipspace(vec3(positions, 0), vec2(0, 0), vec3(0, 0, 0));\n  }\n\n  vec2 pos = project_to_pixel(windowPos);\n\n  // Transform (0,0):windowSize -> (0, 0): gridSize\n  pos = floor(pos / cellSize);\n\n  // Transform (0,0):gridSize -> (-1, -1):(1,1)\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n\n  // Move to pixel center, pixel-size in screen sapce (2/gridSize) * 0.5 => 1/gridSize\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n}\n",fs:"#define SHADER_NAME gpu-aggregation-to-grid-fs\n\nprecision highp float;\n\nvarying float vWeights;\n\nvoid main(void) {\n  gl_FragColor = vec4(1., vWeights, 0, 0.0);\n}\n",modules:t?["fp64","project64"]:["project32"],shaderCache:n,vertexCount:0,drawMode:f.a.POINTS})}},{key:"_getAllAggregationModel",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this.gl,e=this.shaderCache;return new s.h(t,{id:"All-Aggregation-Model",vs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-vs-64\n\nin vec2 position;\nuniform vec2 gridSize;\n\nout vec2 vTextureCoord;\nvoid main(void) {\n  // Map each position to single pixel\n  vec2 pos = vec2(-1.0, -1.0);\n\n  // Move to pixel center, pixel-size in screen sapce (2/gridSize) * 0.5 => 1/gridSize\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n\n  float yIndex = floor(float(gl_InstanceID) / gridSize[0]);\n  float xIndex = float(gl_InstanceID) - (yIndex * gridSize[0]);\n\n  vec2 yIndexFP64 = vec2(yIndex, 0.);\n  vec2 xIndexFP64 = vec2(xIndex, 0.);\n  vec2 gridSizeYFP64 = vec2(gridSize[1], 0.);\n  vec2 gridSizeXFP64 = vec2(gridSize[0], 0.);\n\n  vec2 texCoordXFP64 = div_fp64(yIndexFP64, gridSizeYFP64);\n  vec2 texCoordYFP64 = div_fp64(xIndexFP64, gridSizeXFP64);\n\n  vTextureCoord = vec2(texCoordYFP64.x, texCoordXFP64.x);\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-fs\n\nprecision highp float;\n\nin vec2 vTextureCoord;\nuniform sampler2D uSampler;\nout vec4 fragColor;\nvoid main(void) {\n  vec4 textureColor = texture(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n  // Red: total count, Green: total weight, Alpha: maximum wieght\n  fragColor = vec4(textureColor.r, textureColor.g, 0., textureColor.g);\n}\n",modules:["fp64"],shaderCache:e,vertexCount:1,drawMode:f.a.POINTS,isInstanced:!0,instanceCount:0,attributes:{position:new s.b(t,{size:2,data:new Float32Array([0,0])})}})}},{key:"_projectPositions",value:function(t){var e=this.state.projectedPositions;if(!e||t.changeFlags.dataChanged||t.changeFlags.viewportChanged){var n=t.positions,r=t.viewport;e=[];for(var i=0;i<n.length;i+=2){var o=pa(r.projectFlat([n[i],n[i+1]]),2),a=o[0],s=o[1];e.push(a,s)}this._setState({projectedPositions:e})}}},{key:"_renderAggregateData",value:function(t){var e=t.cellSize,n=t.viewport,r=t.gridTransformMatrix,i=t.projectPoints,o=this.state,a=o.numCol,s=o.numRow,u=o.windowSize,c=this.gl,l=this.gridAggregationFramebuffer,h=this.gridAggregationModel,p=this.allAggregrationFramebuffer,d=this.allAggregationModel,v=ga(r),g=[a,s];l.bind(),c.viewport(0,0,g[0],g[1]),c.clear(c.COLOR_BUFFER_BIT),h.draw({parameters:{clearColor:[0,0,0,0],clearDepth:0,blend:!0,depthTest:!1,blendEquation:f.a.FUNC_ADD,blendFunc:[f.a.ONE,f.a.ONE]},moduleSettings:{viewport:n},uniforms:{windowSize:u,cellSize:e,gridSize:g,uProjectionMatrix:r,uProjectionMatrixFP64:v,projectPoints:i}}),l.unbind(),p.bind(),c.viewport(0,0,g[0],g[1]),c.clear(c.COLOR_BUFFER_BIT),d.draw({parameters:{clearColor:[0,0,0,0],clearDepth:0,blend:!0,depthTest:!1,blendEquation:[f.a.FUNC_ADD,f.a.MAX],blendFunc:[f.a.ONE,f.a.ONE]},uniforms:{uSampler:l.texture,gridSize:g}}),p.unbind()}},{key:"_runAggregationOnCPU",value:function(t){var e=t.positions,n=t.weights,r=t.cellSize,i=t.projectPoints,o=t.gridTransformMatrix,a=t.viewport,u=t.countsBuffer,c=t.maxCountBuffer,l=this.state,f=l.numCol,h=l.numRow,p=new Float32Array(f*h*4),d=o,v=e;i&&(this._projectPositions(t),v=this.state.projectedPositions,d=a.pixelProjectionMatrix),p.fill(0);for(var g=0,m=0,y=0,_=0;_<v.length;_+=2){var b=Object(bt.k)([v[_],v[_+1],0],d),x=b[0],w=b[1],E=n?n[_/2]:1;fa()(Number.isFinite(E));var S=Math.floor(x/r[0]),P=Math.floor(w/r[1]);if(S>=0&&S<f&&P>=0&&P<h){var T=4*(S+P*f);p[T]++,p[T+1]+=E,m+=1,y+=E,p[T+1]>g&&(g=p[T+1])}}var A=new Float32Array(4);return A[0]=m,A[1]=y,A[3]=g,u?u.subData({data:p}):u=new s.b(this.gl,{data:p}),c?c.subData({data:A}):c=new s.b(this.gl,{data:A}),{countsBuffer:u,maxCountBuffer:c,countsData:p,maxCountData:A,totalCount:m,totalWeight:y,maxWeight:g}}},{key:"_runAggregationOnGPU",value:function(t){return this._updateModels(t),this._renderAggregateData(t),this._getAggregateData(t)}},{key:"_setState",value:function(t){Object.assign(this.state,t)}},{key:"_setupGPUResources",value:function(){var t=this.gl;this.gridAggregationFramebuffer=ba(t,{id:"GridAggregation"}),this.allAggregrationFramebuffer=ba(t,{id:"AllAggregation"})}},{key:"_setupModels",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.gridAggregationModel&&this.gridAggregationModel.delete(),this.gridAggregationModel=this._getAggregationModel(t),this.allAggregationModel&&this.allAggregationModel.delete(),this.allAggregationModel=this._getAllAggregationModel(t)}},{key:"_updateModels",value:function(t){var e=this.gl,n=t.positions,r=t.positions64xyLow,i=t.weights,o=t.changeFlags,a=this.state,u=a.numCol,c=a.numRow,l=this.state,f=l.positionsBuffer,h=l.positions64xyLowBuffer,p=l.weightsBuffer,d={},v=!1;if(t.fp64!==this.state.fp64&&(this._setupModels(t.fp64),this._setState({fp64:t.fp64}),t.fp64&&(v=!0)),!o.dataChanged&&f||(f&&f.delete(),p&&p.delete(),f=new s.b(e,{size:2,data:new Float32Array(n)}),p=new s.b(e,{size:1,data:new Float32Array(i)}),v=t.fp64,Object.assign(d,{positions:f,weights:p}),this.gridAggregationModel.setVertexCount(n.length/2),this._setState({positionsBuffer:f,weightsBuffer:p})),v&&(fa()(r),h&&h.delete(),h=new s.b(e,{size:2,data:new Float32Array(r)}),Object.assign(d,{positions64xyLow:h}),this._setState({positions64xyLowBuffer:h})),this.gridAggregationModel.setAttributes(d),o.cellSizeChanged||o.viewportChanged){this.allAggregationModel.setInstanceCount(u*c);var g={width:u,height:c};this.gridAggregationFramebuffer.resize(g),this.allAggregrationFramebuffer.resize(g)}}},{key:"_updateGridSize",value:function(t){var e=t.viewport,n=t.cellSize,r=t.width||e.width,i=t.height||e.height,o=Math.ceil(r/n[0]),a=Math.ceil(i/n[1]);this._setState({numCol:o,numRow:a,windowSize:[r,i]})}}]),t}();function ba(t,e){var n,r=e.id,i=new s.i(t,{data:null,format:f.a.RGBA32F,type:f.a.FLOAT,border:0,mipmaps:!1,parameters:(n={},ha(n,f.a.TEXTURE_MAG_FILTER,f.a.NEAREST),ha(n,f.a.TEXTURE_MIN_FILTER,f.a.NEAREST),n),dataFormat:f.a.RGBA});return new s.f(t,{id:r,attachments:ha({},f.a.COLOR_ATTACHMENT0,i)})}var xa=s.t.fp64LowPart,wa=6378e3;function Ea(t){var e=t.data,n=t.getPosition,r=t.cellSizeMeters,i=t.gpuGridAggregator,a=t.gpuAggregation,s=t.fp64,u=void 0!==s&&s,c=t.coordinateSystem,l=void 0===c?o.a.LNGLAT:c,f=t.viewport,h=void 0===f?null:f,p=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;fa()(t&&e);for(var r,i,o=[],a=[],s=[],u=1/0,c=-1/0,l=1/0,f=-1/0,h=0;h<t.length;h++){var p=e(t[h]);i=p[0],r=p[1],o.push(i,r),a.push(xa(i),xa(r));var d=n?n(t[h]):1;s.push(d),Number.isFinite(r)&&Number.isFinite(i)&&(u=r<u?r:u,c=r>c?r:c,l=i<l?i:l,f=i>f?i:f)}return{positions:o,positions64xyLow:a,weights:s,yMin:u,yMax:c,xMin:l,xMax:f}}(e,n),d=[r,r],v=[0,0];if(fa()(l===o.a.LNGLAT||l===o.a.IDENTITY),l===o.a.LNGLAT){var g=function(t,e){var n=t.yMin,r=t.yMax;return function(t,e){var n=function(t){return t/wa*(180/Math.PI)}(t),r=function(t,e){return e/wa*(180/Math.PI)/Math.cos(t*Math.PI/180)}(e,t);return{yOffset:n,xOffset:r}}(e,(n+r)/2)}(p,r);d=[g.xOffset,g.yOffset],v=[-180,-90]}else{fa()(l===o.a.IDENTITY),v=[-h.width/2,-h.height/2]}var m=function(t){var e=t.gridData,n=t.cellSize,r=t.worldOrigin,i=e.yMin,o=e.yMax,a=e.xMin,s=e.xMax,u=Sa(a-r[0],n[0])+r[0],c=Sa(i-r[1],n[1])+r[1],l=(new te.a).translate([-1*u,-1*c,0]),f=[u,c],h=s-a+n[0],p=o-i+n[1],d=[Math.ceil(h/n[0]),Math.ceil(p/n[1])];return{gridOrigin:f,gridSize:d,width:h,height:p,gridTransformMatrix:l}}({gridData:p,cellSize:d,worldOrigin:v}),y=i.run({positions:p.positions,positions64xyLow:p.positions64xyLow,weights:p.weights,cellSize:d,width:m.width,height:m.height,gridTransformMatrix:m.gridTransformMatrix,useGPU:a,fp64:u});return{countsBuffer:y.countsBuffer,maxCountBuffer:y.maxCountBuffer,countsData:y.countsData,maxCountData:y.maxCountData,gridSize:m.gridSize,gridOrigin:m.gridOrigin,cellSize:d}}function Sa(t,e){var n=t<0?-1:1,r=n<0?Math.abs(t)+e:Math.abs(t);return(r=Math.floor(r/e)*e)*n}n.d(e,"experimental",function(){return Pa}),n.d(e,"COORDINATE_SYSTEM",function(){return o.a}),n.d(e,"Deck",function(){return Kr}),n.d(e,"LayerManager",function(){return xe}),n.d(e,"AttributeManager",function(){return z}),n.d(e,"Layer",function(){return Ct}),n.d(e,"CompositeLayer",function(){return ri}),n.d(e,"Viewport",function(){return ge}),n.d(e,"WebMercatorViewport",function(){return Ge}),n.d(e,"project",function(){return ii.a}),n.d(e,"project64",function(){return oi.a}),n.d(e,"lighting",function(){return ai.a}),n.d(e,"View",function(){return Ce}),n.d(e,"MapView",function(){return Gn}),n.d(e,"FirstPersonView",function(){return Ei}),n.d(e,"ThirdPersonView",function(){return Ci}),n.d(e,"OrbitView",function(){return xo}),n.d(e,"PerspectiveView",function(){return ko}),n.d(e,"OrthographicView",function(){return qo}),n.d(e,"Controller",function(){return pn}),n.d(e,"MapController",function(){return Dn}),n.d(e,"_FirstPersonController",function(){return mi}),n.d(e,"_OrbitController",function(){return so}),n.d(e,"_OrthographicController",function(){return Fo}),n.d(e,"_EffectManager",function(){return Wn}),n.d(e,"_Effect",function(){return Hn}),n.d(e,"_ReflectionEffect",function(){return Ko}),n.d(e,"TRANSITION_EVENTS",function(){return en}),n.d(e,"LinearInterpolator",function(){return Qe}),n.d(e,"FlyToInterpolator",function(){return ia}),n.d(e,"log",function(){return i.a}),n.d(e,"_GPUGridAggregator",function(){return _a}),n.d(e,"_pointToDensityGridData",function(){return Ea});var Pa={BinSorter:ua,linearScale:function(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]},getLinearScale:function(t,e){return function(n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}},quantizeScale:ca,getQuantizeScale:function(t,e){return function(n){return ca(t,e,n)}},defaultColorRange:[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]],flattenVertices:function t(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.result,i=void 0===r?[]:r,o=n.dimensions,a=void 0===o?3:o,s=-1,u=0;++s<e.length;){var c=e[s];Array.isArray(c)||ArrayBuffer.isView(c)?t(c,{result:i,dimensions:a}):u<a&&(i.push(c),u++)}return u>0&&u<a&&i.push(0),i},fillArray:function(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u);return e}}},function(t,e,n){t.exports=n(507)},function(t,e,n){"use strict";t.exports=n(475)},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";var r=n(269);e.a=new r.a({id:"deck"}).enable()},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"a",function(){return r})},function(t,e,n){var r=n(24);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r={LNGLAT:1,LNGLAT_EXPERIMENTAL:1,LNGLAT_DEPRECATED:5,METER_OFFSETS:2,METERS:2,LNGLAT_OFFSETS:3,IDENTITY:0}},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(e,"a",function(){return r})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){"use strict";n.d(e,"a",function(){return v});var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(3),c=n(32),l=n(50),f=n(12),h=n(43),p=n(6),d=n(5),v=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t,i))).stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),n.target=i.target||(n.gl.webgl2?36662:34962),n._initialize(i),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"getElementCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/l.a.getBytesPerElement(t))}},{key:"getVertexCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/l.a.getBytesPerVertex(t))}},{key:"initialize",value:function(t){return this._initialize(t)}},{key:"setProps",value:function(t){return"data"in t&&this.setData(t),this}},{key:"setAccessor",value:function(t){return this.accessor=t,this}},{key:"reallocate",value:function(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}},{key:"setData",value:function(t){return this.initialize(t)}},{key:"subData",value:function(t){ArrayBuffer.isView(t)&&(t={data:t});var e=t,n=e.data,r=e.offset,i=void 0===r?0:r,o=e.srcOffset,a=void 0===o?0:o,s=t.byteLength||t.length;Object(d.a)(n);var u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),0!==a||void 0!==s?(Object(f.d)(this.gl),this.gl.bufferSubData(this.target,i,n,a,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this.accessor.type||this.setAccessor(new l.a(this.accessor,{type:Object(h.b)(n)})),this}},{key:"copyData",value:function(t){var e=t.sourceBuffer,n=t.readOffset,r=void 0===n?0:n,i=t.writeOffset,o=void 0===i?0:i,a=t.size,s=this.gl;return Object(f.d)(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,r,o,a),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dstData,n=void 0===e?null:e,r=t.srcByteOffset,i=void 0===r?0:r,o=t.dstOffset,a=void 0===o?0:o,s=t.length,u=void 0===s?0:s;Object(f.d)(this.gl);var c,l,p=Object(h.c)(this.accessor.type||5126,{clamped:!1}),v=this._getAvailableElementCount(i),g=a;n?c=(l=n.length)-g:l=g+(c=Math.min(v,u||v));var m=Math.min(v,c);return u=u||m,Object(d.a)(u<=m),n=n||new p(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,i,n,a,u),this.gl.bindBuffer(36662,null),n}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r,o=t.offset,a=void 0===o?0:o,s=t.size;return 35345===n||35982===n?void 0!==s?this.gl.bindBufferRange(n,i,this.handle,a,s):(Object(d.a)(0===a),this.gl.bindBufferBase(n,i,this.handle)):this.gl.bindBuffer(n,this.handle),this}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r;return 35345===n||35982===n?this.gl.bindBufferBase(n,i,null):this.gl.bindBuffer(n,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:10}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t.bytes&&p.g.deprecated("bytes","byteLength");var e=t.byteLength||t.bytes||0;return this.usage=t.usage||35044,this.setAccessor(new l.a(t,t.accessor)),t.data?this._setData(t.data):this._setByteLength(e)}},{key:"_setData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(d.a)(ArrayBuffer.isView(t));var n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,e),this.gl.bindBuffer(n,null),this.usage=e,this.debugData=t.slice(0,10),this.byteLength=t.byteLength,this.bytesUsed=t.byteLength;var r=Object(h.b)(t);return Object(d.a)(r),this.setAccessor(new l.a(this.accessor,{type:r})),this}},{key:"_setByteLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(d.a)(t>=0);var n=t;0===t&&(n=new Float32Array(0));var r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.byteLength=t,this.bytesUsed=t,this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(t){var e=t/Object(h.c)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle)}},{key:"_getParameter",value:function(t){this.gl.bindBuffer(this.target,this.handle);var e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}},{key:"updateAccessor",value:function(t){return p.g.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)"),this.accessor=new l.a(this.accessor,t),this}},{key:"setByteLength",value:function(t){return p.g.deprecated("setByteLength","reallocate"),this.reallocate(t)}},{key:"data",get:function(){p.g.removed("Buffer.data","N/A","v6.0")}},{key:"bytes",get:function(){return p.g.deprecated("Buffer.bytes","Buffer.byteLength","v6.1"),this.byteLength}}]),e}(c.a)},function(t,e,n){var r=n(127)("wks"),i=n(95),o=n(20).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){"use strict";n.d(e,"b",function(){return f}),n.d(e,"c",function(){return h});var r=n(18),i=n(22),o=n(87),a=n(70);n.d(e,"a",function(){return a.c});var s=n(6),u=n(5),c={framebuffer:function(t,e){var n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:function(t,e){return e?t.enable(3042):t.disable(3042)},blendColor:function(t,e){return t.blendColor.apply(t,Object(i.a)(e))},blendEquation:function(t,e){e=l(e)?e:[e,e],t.blendEquationSeparate.apply(t,Object(i.a)(e))},blendFunc:function(t,e){e=l(e)&&2===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,t.blendFuncSeparate.apply(t,Object(i.a)(e))},clearColor:function(t,e){return t.clearColor.apply(t,Object(i.a)(e))},clearDepth:function(t,e){return t.clearDepth(e)},clearStencil:function(t,e){return t.clearStencil(e)},colorMask:function(t,e){return t.colorMask.apply(t,Object(i.a)(e))},cull:function(t,e){return e?t.enable(2884):t.disable(2884)},cullFace:function(t,e){return t.cullFace(e)},depthTest:function(t,e){return e?t.enable(2929):t.disable(2929)},depthFunc:function(t,e){return t.depthFunc(e)},depthMask:function(t,e){return t.depthMask(e)},depthRange:function(t,e){return t.depthRange.apply(t,Object(i.a)(e))},dither:function(t,e){return e?t.enable(3024):t.disable(3024)},derivativeHint:function(t,e){t.hint(35723,e)},frontFace:function(t,e){return t.frontFace(e)},mipmapHint:function(t,e){return t.hint(33170,e)},lineWidth:function(t,e){return t.lineWidth(e)},polygonOffsetFill:function(t,e){return e?t.enable(32823):t.disable(32823)},polygonOffset:function(t,e){return t.polygonOffset.apply(t,Object(i.a)(e))},sampleCoverage:function(t,e){return t.sampleCoverage.apply(t,Object(i.a)(e))},scissorTest:function(t,e){return e?t.enable(3089):t.disable(3089)},scissor:function(t,e){return t.scissor.apply(t,Object(i.a)(e))},stencilTest:function(t,e){return e?t.enable(2960):t.disable(2960)},stencilMask:function(t,e){var n=e=l(e)?e:[e,e],i=Object(r.a)(n,2),o=i[0],a=i[1];t.stencilMaskSeparate(1028,o),t.stencilMaskSeparate(1029,a)},stencilFunc:function(t,e){var n=e=l(e)&&3===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,o=Object(r.a)(n,6),a=o[0],s=o[1],u=o[2],c=o[3],f=o[4],h=o[5];t.stencilFuncSeparate(1028,a,s,u),t.stencilFuncSeparate(1029,c,f,h)},stencilOp:function(t,e){var n=e=l(e)&&3===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,o=Object(r.a)(n,6),a=o[0],s=o[1],u=o[2],c=o[3],f=o[4],h=o[5];t.stencilOpSeparate(1028,a,s,u),t.stencilOpSeparate(1029,c,f,h)},viewport:function(t,e){return t.viewport.apply(t,Object(i.a)(e))}};function l(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function f(t,e){for(var n in Object(a.d)(t,e),e){var r=c[n];r&&r(t,e[n],n)}}function h(t,e,n){if(Object(s.d)(e))return n(t);var r,i=e.nocatch,a=void 0===i||i;if(Object(u.a)(!e.frameBuffer),Object(o.c)(t),f(t,e),a)r=n(t),Object(o.b)(t);else try{r=n(t)}finally{Object(o.b)(t)}return r}},,function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}n.d(e,"a",function(){return i})},function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document},i=r.window||r.self||r.global,o=r.global||r.self||r.window}).call(this,n(41))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i="undefined"!=typeof window&&window.addEventListener,o=new Map,a=function(){return i&&window.__SEER_INITIALIZED__},s=function(t,e){var n=o.get(t),r=Date.now();return!!(n&&r-n<e)||(o.set(t,r),!1)},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&a()){var n=new Set,o=JSON.stringify(e,function(t){return function(e,n){if(!n||"object"!==(void 0===n?"undefined":r(n))||!t.has(n))return t.add(n),Object.prototype.toString.call(n).slice(8,-1).includes("Array")?Array.prototype.slice.call(n,0,20):n}}(n));try{window.postMessage({type:t,payload:o,source:"seer-agent"},"*")}catch(t){if(s("seer-log",2e3))return;console.log(t)}}},c=new Map,l=function(t){if(t&&t.data&&"seer-core"===t.data.source){var e=t.data,n=e.type,r=e.payload,i=c.get(n);i&&i.forEach(function(t){return t(r)})}},f=function(){i&&!window.__SEER_LISTENER__&&(window.addEventListener("message",l),window.__SEER_LISTENER__=!0)};e.default={send:u,throttle:s,isReady:a,list:function(t,e){return u("LIST",{key:t,data:e})},listItem:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u("LIST_ITEM",{key:t,itemKey:e,data:n})},updateItem:function(t,e,n,r){return u("UPDATE_ITEM",{key:t,itemKey:e,path:n,data:r})},multiUpdate:function(t,e,n){return u("MULTI_UPDATE_ITEM",{key:t,itemKey:e,array:n})},deleteItem:function(t,e){return u("DELETE_ITEM",{key:t,itemKey:e})},addLog:function(t,e,n){return u("ADD_LOG",{key:t,itemKey:e,msg:n})},listeners:c,listenFor:function(t,e){if(i){if(!t||!e)throw new Error("Please provide a type and callback");c.has(t)||c.set(t,[]),window.__SEER_LISTENER__||f(),c.get(t).push(e)}},removeListener:function(t){c.forEach(function(e,n){c.set(n,e.filter(function(e){return e!==t}))})},init:f,clean:function(){i&&window.__SEER_LISTENER__&&(window.removeEventListener("message",l),delete window.__SEER_LISTENER__)}}},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(1),i=n(2),o=n(149),a=n(12),s=n(6),u=n(5),c="Resource subclass must define virtual methods",l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,t),Object(a.e)(e);var i=n.id,o=n.userData,u=void 0===o?{}:o;this.gl=e,this.id=i||Object(s.i)(this.constructor.name),this.userData=u,this._bound=!1,this._handle=n.handle,void 0===this._handle&&(this._handle=this._createHandle()),this._addStats()}return Object(i.a)(t,[{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.id,")")}},{key:"delete",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).deleteChildren,e=void 0!==t&&t,n=this._handle&&this._deleteHandle(this._handle);return this._handle=null,this._removeStats(),n&&e&&n.filter(Boolean).forEach(function(t){t.delete()}),this}},{key:"bind",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Object(a.j)(this.gl,t),Object(u.a)(t);var n=(this.constructor.PARAMETERS||{})[t];if(n){var r=Object(a.n)(this.gl);if(!((!("webgl2"in n)||r)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){var i=n.webgl1,o="webgl2"in n?n.webgl2:n.webgl1;return r?o:i}}return this._getParameter(t,e)}},{key:"getParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=e.parameters,r=e.keys,i=this.constructor.PARAMETERS||{},o=Object(a.n)(this.gl),s={},u=n||Object.keys(i),c=!0,l=!1,f=void 0;try{for(var h,p=u[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var d=h.value,v=i[d];if(v&&(!("webgl2"in v)||o)&&(!("extension"in v)||this.gl.getExtension(v.extension))){var g=r?Object(a.i)(this.gl,d):d;s[g]=this.getParameter(d,t),r&&"GLenum"===v.type&&(s[g]=Object(a.i)(this.gl,s[g]))}}}catch(t){l=!0,f=t}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}return s}},{key:"setParameter",value:function(t,e){t=Object(a.j)(this.gl,t),Object(u.a)(t);var n=(this.constructor.PARAMETERS||{})[t];if(n){var r=Object(a.n)(this.gl);if(!((!("webgl2"in n)||r)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=Object(a.j)(e))}return this._setParameter(t,e),this}},{key:"setParameters",value:function(t){for(var e in t)this.setParameter(e,t[e]);return this}},{key:"stubRemovedMethods",value:function(t,e,n){return Object(s.h)(this,t,e,n)}},{key:"initialize",value:function(t){}},{key:"_createHandle",value:function(){throw new Error(c)}},{key:"_deleteHandle",value:function(){throw new Error(c)}},{key:"_bindHandle",value:function(){throw new Error(c)}},{key:"_getOptsFromHandle",value:function(){throw new Error(c)}},{key:"_getParameter",value:function(t,e){throw new Error(c)}},{key:"_setParameter",value:function(t,e){throw new Error(c)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_addStats",value:function(){var t=this.constructor.name,e=o.default.stats;e.resourceCount=e.resourceCount||0,e.resourceMap=e.resourceMap||{},e.resourceCount++,e.resourceMap[t]=e.resourceMap[t]||{created:0,active:0},e.resourceMap[t].created++,e.resourceMap[t].active++}},{key:"_removeStats",value:function(){var t=this.constructor.name;o.default.stats.resourceMap[t].active--}},{key:"handle",get:function(){return this._handle}}]),t}()},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],d=e[11],v=e[12],g=e[13],m=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*s+x*f+w*v,t[1]=_*i+b*u+x*h+w*g,t[2]=_*o+b*c+x*p+w*m,t[3]=_*a+b*l+x*d+w*y,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*r+b*s+x*f+w*v,t[5]=_*i+b*u+x*h+w*g,t[6]=_*o+b*c+x*p+w*m,t[7]=_*a+b*l+x*d+w*y,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*r+b*s+x*f+w*v,t[9]=_*i+b*u+x*h+w*g,t[10]=_*o+b*c+x*p+w*m,t[11]=_*a+b*l+x*d+w*y,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*r+b*s+x*f+w*v,t[13]=_*i+b*u+x*h+w*g,t[14]=_*o+b*c+x*p+w*m,t[15]=_*a+b*l+x*d+w*y,t}},function(t,e,n){t.exports=!n(23)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(19),i=n(185),o=n(71),a=Object.defineProperty;e.f=n(34)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(73),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function i(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=n(493),a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,u="foo"===function(){}.name;function c(t){return Object.prototype.toString.call(t)}function l(t){return!i(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var f=t.exports=m,h=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(o.isFunction(t)){if(u)return t.name;var e=t.toString().match(h);return e&&e[1]}}function d(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function v(t){if(u||!o.isFunction(t))return o.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function g(t,e,n,r,i){throw new f.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function m(t,e){t||g(t,!0,e,"==",f.ok)}function y(t,e,n,a){if(t===e)return!0;if(i(t)&&i(e))return 0===r(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(l(t)&&l(e)&&c(t)===c(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(i(t)!==i(e))return!1;var u=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==u&&u===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),function(t,e,n,r){if(null===t||void 0===t||null===e||void 0===e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=_(t),a=_(e);if(i&&!a||!i&&a)return!1;if(i)return t=s.call(t),e=s.call(e),y(t,e,n);var u,c,l=w(t),f=w(e);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),c=l.length-1;c>=0;c--)if(l[c]!==f[c])return!1;for(c=l.length-1;c>=0;c--)if(u=l[c],!y(t[u],e[u],n,r))return!1;return!0}(t,e,n,a))}return n?t===e:t==e}function _(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function b(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function x(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&g(i,n,"Missing expected exception"+r);var a="string"==typeof r,s=!t&&o.isError(i),u=!t&&i&&!n;if((s&&a&&b(i,n)||u)&&g(i,n,"Got unwanted exception"+r),t&&i&&n&&!b(i,n)||!t&&i)throw i}f.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return d(v(t.actual),128)+" "+t.operator+" "+d(v(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=p(e),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},o.inherits(f.AssertionError,Error),f.fail=g,f.ok=m,f.equal=function(t,e,n){t!=e&&g(t,e,n,"==",f.equal)},f.notEqual=function(t,e,n){t==e&&g(t,e,n,"!=",f.notEqual)},f.deepEqual=function(t,e,n){y(t,e,!1)||g(t,e,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,n){y(t,e,!0)||g(t,e,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,n){y(t,e,!1)&&g(t,e,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,n,r){y(e,n,!0)&&g(e,n,r,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,n){t!==e&&g(t,e,n,"===",f.strictEqual)},f.notStrictEqual=function(t,e,n){t===e&&g(t,e,n,"!==",f.notStrictEqual)},f.throws=function(t,e,n){x(!0,t,e,n)},f.doesNotThrow=function(t,e,n){x(!1,t,e,n)},f.ifError=function(t){if(t)throw t};var w=Object.keys||function(t){var e=[];for(var n in t)a.call(t,n)&&e.push(n);return e}}).call(this,n(41))},function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"c",function(){return l}),n.d(e,"b",function(){return h}),n.d(e,"a",function(){return p});var r=n(1),i=n(30),o=null,a=function(){throw new Error("luma.gl: loaded under Node.js without headless gl installed, meaning that WebGL contexts can not be created. This may not be an error. For example, this is a typical configuration for isorender applications running on the server.")};if(!n(111).a)try{a=n(491),o=n(492)}catch(t){}var s=function t(){Object(r.a)(this,t)},u=o||i.a,c=u.WebGLRenderingContext,l=void 0===c?s:c,f=(u.WebGLProgram,u.WebGLShader,u.WebGLBuffer),h=void 0===f?s:f;u.WebGLFramebuffer,u.WebGLRenderbuffer,u.WebGLTexture,u.WebGLUniformLocation,u.WebGLActiveInfo,u.WebGLShaderPrecisionFormat;var p=i.a.WebGL2RenderingContext||function t(){Object(r.a)(this,t)};i.a.Image},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s});var r=n(5),i=n(44);function o(t,e){if("string"!=typeof e)return e;var n=Number(e);if(!isNaN(n))return n;var i=t[e=e.replace(/^.*\./,"")];return Object(r.a)(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function a(t,e){for(var n in e=Number(e),t)if(t[n]===e)return"GL.".concat(n);return String(e)}function s(t,e){return void 0===e&&i.a.removed("glKey(value)","glKey(gl, value)","6.0")(),a(t,e)}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r={LNG_LAT:1,LNGLAT_AUTO_OFFSET:4,METER_OFFSETS:2,LNGLAT_OFFSETS:3,IDENTITY:0}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(72);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"d",function(){return s});var r="Failed to deduce GL constant from typed array";function i(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(r)}}function o(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clamped,n=void 0===e||e;switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function a(t){var e=t.data,n=t.width,r=t.height,i=t.bytesPerPixel,o=void 0===i?4:i,a=t.temp,s=n*o;a=a||new Uint8Array(s);for(var u=0;u<r/2;++u){var c=u*s,l=(r-u-1)*s;a.set(e.subarray(c,c+s)),e.copyWithin(c,l,l+s),e.set(a,l)}}function s(t){for(var e=t.data,n=t.width,r=t.height,i=Math.round(n/2),o=Math.round(r/2),a=new Uint8Array(i*o*4),s=0;s<o;s++)for(var u=0;u<i;u++)for(var c=0;c<4;c++)a[4*(s*i+u)+c]=e[4*(2*s*n+2*u)+c];return{data:a,width:i,height:o}}},function(t,e,n){"use strict";var r=n(269);e.a=new r.a({id:"luma"}).enable()},function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"d",function(){return u}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return l});var r=n(262),i=n.n(r),o=n(56),a=n.n(o);function s(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function u(t,e){var n=a()([],e,t);return i()(n,n,1/n[3]),n}function c(t,e){var n=t%e;return n<0?e+n:n}function l(t,e,n){return n*e+(1-n)*t}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){"use strict";(function(t,r){n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var i=n(29),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document,process:"object"===(void 0===r?"undefined":Object(i.a)(r))&&r},a=o.window||o.self||o.global,s=o.process||{};console}).call(this,n(41),n(68))},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(77),i=n(47);function o(){if(!r.b){var t=i.a.hrtime();return t[0]+t[1]/1e6}return i.b.performance?i.b.performance.now():Date.now()}o()},function(t,e){t.exports=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e,n){"use strict";var r=n(145);function i(t,e,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&Object(r.a)(o,n.prototype),o}).apply(null,arguments)}var o=n(1),a=n(2),s=n(43),u=n(44),c=n(5);n.d(e,"a",function(){return f});var l={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},f=function(){function t(){var e=this;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(t){return e._assign(t)}),Object.freeze(this)}return Object(a.a)(t,null,[{key:"getBytesPerElement",value:function(t){return Object(s.c)(t.type||5126).BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(t){return Object(c.a)(t.size),Object(s.c)(t.type||5126).BYTES_PER_ELEMENT*t.size}},{key:"resolve",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i(t,[l].concat(n))}}]),Object(a.a)(t,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"_assign",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0!==t.type&&(this.type!==t.type&&u.a.warn("accessor type mismatch"),this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size!==t.size&&u.a.warn("accessor size mismatch"),this.size=t.size),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.instanced&&(u.a.deprecated("Accessor.instanced","Accessor.divisor"),this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(u.a.deprecated("Accessor.isInstanced","Accessor.divisor"),this.divisor=t.isInstanced?1:0),void 0!==t.index&&(this.index=t.index?1:0),this}},{key:"BYTES_PER_ELEMENT",get:function(){return t.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return t.getBytesPerVertex(this)}}]),t}()},function(t,e,n){var r=n(35),i=n(94);t.exports=n(34)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(20),i=n(51),o=n(57),a=n(95)("src"),s=Function.toString,u=(""+s).split("toString");n(64).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(o(n,a)||i(n,a,t[e]?""+t[e]:u.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var r=n(7),i=n(23),o=n(72),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){"use strict";n.d(e,"a",function(){return y});var r,i=n(1),o=n(9),a=n(8),s=n(2),u=n(10),c=n(0),l=n(32),f=n(25),h=n(27),p=n(12),d=n(6),v=n(5),g=[9729,9728],m=(r={},Object(c.a)(r,6407,{dataFormat:6407,types:[5121,33635]}),Object(c.a)(r,6408,{dataFormat:6408,types:[5121,32819,32820]}),Object(c.a)(r,6406,{dataFormat:6406,types:[5121]}),Object(c.a)(r,6409,{dataFormat:6409,types:[5121]}),Object(c.a)(r,6410,{dataFormat:6410,types:[5121]}),Object(c.a)(r,33326,{dataFormat:6403,types:[5126],gl2:!0}),Object(c.a)(r,33328,{dataFormat:33319,types:[5126],gl2:!0}),Object(c.a)(r,34837,{dataFormat:6407,types:[5126],gl2:!0}),Object(c.a)(r,34836,{dataFormat:6408,types:[5126],gl2:!0}),r);var y=function(t){function e(t,n){var r;Object(i.a)(this,e);var s=n.id,u=void 0===s?Object(d.i)("texture"):s,c=n.handle,l=n.target;return(r=Object(o.a)(this,Object(a.a)(e).call(this,t,{id:u,handle:c}))).target=l,r.hasFloatTexture=t.getExtension("OES_texture_float"),r.textureUnit=void 0,r}return Object(u.a)(e,t),Object(s.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.format,r=e.linearFiltering,i=!0;return n&&(i=(i=i&&function(t,e){var n=m[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;var r=Object(p.n)(t)&&n.gl2||n.gl1;return"string"==typeof r?t.getExtension(r):r}(t,n))&&(!r||function(t,e){var n=m[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),i}}]),Object(s.a)(e,[{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.pixels,r=void 0===n?null:n,i=t.format,o=void 0===i?6408:i,a=t.type,s=void 0===a?5121:a,u=t.border,l=void 0===u?0:u,f=t.recreate,h=void 0!==f&&f,p=t.parameters,v=void 0===p?{}:p,g=t.pixelStore,m=void 0===g?{}:g,y=t.textureUnit,_=void 0===y?void 0:y,b=t.unpackFlipY,x=void 0===b||b,w=t.mipmaps,E=void 0===w||w;e||(e=r);var S=t.width,P=t.height,T=t.dataFormat,A=this._deduceParameters({format:o,type:s,dataFormat:T,compressed:!1,data:e,width:S,height:P});S=A.width,P=A.height,T=A.dataFormat,this.width=S,this.height=P,this.format=o,this.type=s,this.dataFormat=T,this.border=l,this.textureUnit=_,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle));var k=Object(c.a)({},37440,x),C=Object.assign({},k,m);this._isNPOT()&&E&&(d.g.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),E=!1,this._updateForNPOT(v)),this.mipmaps=E,this.setImageData({data:e,width:S,height:P,format:o,type:s,dataFormat:T,border:l,mipmaps:E,parameters:C}),E&&this.generateMipmap(),this.setParameters(v),h&&(this.data=e)}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:!1}):this}},{key:"generateMipmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindTexture(this.target,this.handle),Object(h.c)(this.gl,e,function(){t.gl.generateMipmap(t.target)}),this.gl.bindTexture(this.target,null),this}},{key:"setImageData",value:function(t){var e=this,n=t.target,r=void 0===n?this.target:n,i=t.pixels,o=void 0===i?null:i,a=t.data,s=void 0===a?null:a,u=t.width,c=t.height,l=t.level,f=void 0===l?0:l,d=t.format,g=void 0===d?6408:d,m=t.type,y=t.dataFormat,_=t.offset,b=void 0===_?0:_,x=t.border,w=void 0===x?0:x,E=t.compressed,S=void 0!==E&&E,P=t.parameters,T=void 0===P?{}:P;s||(s=o);var A=this._deduceParameters({format:g,type:m,dataFormat:y,compressed:S,data:s,width:u,height:c});m=A.type,y=A.dataFormat,S=A.compressed,u=A.width,c=A.height;var k=this.gl;k.bindTexture(this.target,this.handle);var C,O=this._getDataType({data:s,compressed:S});s=O.data,C=O.dataType,Object(h.c)(this.gl,T,function(){switch(C){case"null":k.texImage2D(r,f,g,u,c,w,y,m,s);break;case"typed-array":k.texImage2D(r,f,g,u,c,w,y,m,s,b);break;case"buffer":Object(p.d)(k),k.bindBuffer(35052,s.handle||s),k.texImage2D(r,f,g,u,c,w,g,m,b);break;case"browser-object":k.texImage2D(r,f,g,g,m,s);break;case"compressed":k.compressedTexImage2D(e.target,f,g,u,c,w,s);break;default:Object(v.a)(!1,"Unknown image data type")}})}},{key:"setSubImageData",value:function(t){var e=this,n=t.target,r=void 0===n?this.target:n,i=t.pixels,o=void 0===i?null:i,a=t.data,s=void 0===a?null:a,u=t.x,c=void 0===u?0:u,l=t.y,d=void 0===l?0:l,v=t.width,g=t.height,m=t.level,y=void 0===m?0:m,_=t.format,b=void 0===_?6408:_,x=t.type,w=t.dataFormat,E=t.compressed,S=void 0!==E&&E,P=t.offset,T=void 0===P?0:P,A=t.border,k=void 0===A?0:A,C=t.parameters,O=void 0===C?{}:C,M=this._deduceParameters({format:b,type:x,dataFormat:w,compressed:S,data:s,width:v,height:g});if(x=M.type,w=M.dataFormat,S=M.compressed,v=M.width,g=M.height,s||(s=o),s&&s.data){var I=s;s=I.data,v=I.shape[0],g=I.shape[1]}s instanceof f.a&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),Object(h.c)(this.gl,O,function(){S?e.gl.compressedTexSubImage2D(r,y,c,d,v,g,b,s):null===s?e.gl.texSubImage2D(r,y,b,v,g,k,w,x,null):ArrayBuffer.isView(s)?e.gl.texSubImage2D(r,y,c,d,v,g,b,x,s,T):s instanceof p.b?(Object(p.d)(e.gl),e.gl.bindBuffer(35052,s),e.gl.texSubImage2D(r,y,b,v,g,k,b,x,T),e.gl.bindBuffer(35052,null)):e.gl.texSubImage2D(r,y,c,d,b,x,s)}),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(t){var e=t.target,n=(void 0===e&&this.target,t.framebuffer),r=(t.offset,t.x),i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.width,u=t.height,c=t.level,l=void 0===c?0:c,f=t.internalFormat,h=void 0===f?6408:f,p=t.border,d=void 0===p?0:p;n&&n.bind(),this.bind(),this.gl.copyTexImage2D(this.target,l,h,i,a,s,u,d),this.unbind(),n&&n.unbind()}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;if(void 0===t)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=t,this.gl.activeTexture(33984+t),this.gl.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,null),this.textureUnit}},{key:"_getDataType",value:function(t){var e=t.data,n=t.compressed;return void 0!==n&&n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof f.a?{data:e.handle,dataType:"buffer"}:e instanceof p.b?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}},{key:"setImage3D",value:function(t){var e=t.level,n=void 0===e?0:e,r=t.internalformat,i=void 0===r?6408:r,o=t.width,a=t.height,s=t.depth,u=void 0===s?1:s,c=t.border,l=void 0===c?0:c,h=t.format,p=t.type,d=void 0===p?5121:p,v=t.offset,g=void 0===v?0:v,m=t.pixels;return ArrayBuffer.isView(m)?(this.gl.texImage3D(this.target,n,i,o,a,u,l,h,d,m),this):(m instanceof f.a&&(this.gl.bindBuffer(35052,m.handle),this.gl.texImage3D(this.target,n,i,o,a,u,l,h,d,g)),this)}},{key:"_deduceParameters",value:function(t){var e=t.format,n=t.data,r=t.width,i=t.height,o=t.dataFormat,a=t.type,s=t.compressed,u=m[e];o=o||u&&u.dataFormat,a=a||u&&u.types[0],s=s||u&&u.compressed;var c=this._deduceImageSize({data:n,width:r,height:i});return{dataFormat:o,type:a,compressed:s,width:r=c.width,height:i=c.height,format:e,data:n}}},{key:"_deduceImageSize",value:function(t){var e,n=t.data,r=t.width,i=t.height;return e="undefined"!=typeof ImageData&&n instanceof ImageData?{width:n.width,height:n.height}:"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement?{width:n.naturalWidth,height:n.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement?{width:n.width,height:n.height}:"undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement?{width:n.videoWidth,height:n.videoHeight}:n?{width:r,height:i}:{width:r>=0?r:1,height:i>=0?i:1},Object(v.a)(e,"Could not deduced texture size"),Object(v.a)(void 0===r||e.width===r,"Deduced texture width does not match supplied width"),Object(v.a)(void 0===i||e.height===i,"Deduced texture height does not match supplied height"),e}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle)}},{key:"_getParameter",value:function(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}},{key:"_setParameter",value:function(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Object(v.a)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return!(Object(p.n)(this.gl)||Object(d.f)(this.width)&&Object(d.f)(this.height))}},{key:"_updateForNPOT",value:function(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(t,e){if(this._isNPOT())switch(t){case 10241:-1===g.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}]),e}(l.a)},function(t,e){t.exports=function(t,e,n){var r,i,o,a,s,u,c,l,f,h,p,d,v=n[0],g=n[1],m=n[2];e===t?(t[12]=e[0]*v+e[4]*g+e[8]*m+e[12],t[13]=e[1]*v+e[5]*g+e[9]*m+e[13],t[14]=e[2]*v+e[6]*g+e[10]*m+e[14],t[15]=e[3]*v+e[7]*g+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=p,t[11]=d,t[12]=r*v+s*g+f*m+e[12],t[13]=i*v+u*g+h*m+e[13],t[14]=o*v+c*g+p*m+e[14],t[15]=a*v+l*g+d*m+e[15]);return t}},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(119),i=n(72);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(120),i=n(94),o=n(58),a=n(71),s=n(57),u=n(185),c=Object.getOwnPropertyDescriptor;e.f=n(34)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(57),i=n(42),o=n(154)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){"use strict";var r=n(226),i=n(513),o=Object.prototype.toString;function a(t){return"[object Array]"===o.call(t)}function s(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===o.call(t)}function c(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),a(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===o.call(t)},isBuffer:i,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)c(arguments[r],n);return e},extend:function(t,e,n){return c(e,function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,n){"use strict";var r=n(11),i=n(40),o=Object.keys(i.a).map(function(t){return"const float COORDINATE_SYSTEM_".concat(t," = ").concat(i.a[t],".;")}).join(""),a="".concat(o,'\n\nuniform float project_uCoordinateSystem;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform float project_uAntimeridian;\nuniform vec3 project_uPixelsPerMeter;\nuniform vec3 project_uPixelsPerDegree;\nuniform vec3 project_uPixelsPerUnit;\nuniform vec3 project_uPixelsPerUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec2 project_coordinate_origin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);\n\n//\n// Scaling offsets - scales meters to "pixels"\n// Note the scalar version of project_scale is for scaling the z component only\n//\nfloat project_scale(float meters) {\n  return meters * project_uPixelsPerMeter.z;\n}\n\nvec2 project_scale(vec2 meters) {\n  return meters * project_uPixelsPerMeter.xy;\n}\n\nvec3 project_scale(vec3 meters) {\n  return meters * project_uPixelsPerMeter;\n}\n\nvec4 project_scale(vec4 meters) {\n  return vec4(meters.xyz * project_uPixelsPerMeter, meters.w);\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uPixelsPerDegree);\n  }\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uPixelsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  vec3 pixelsPerUnit = project_uPixelsPerUnit + project_uPixelsPerUnit2 * offset.y;\n  return vec4(offset.xyz * pixelsPerUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x - project_uAntimeridian, 360.0) + project_uAntimeridian;\n  }\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan_fp32(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\n//\n// Projects lnglats (or meter offsets, depending on mode) to pixels\n//\nvec4 project_position(vec4 position, vec2 position64xyLow) {\n  // TODO - why not simply subtract center and fall through?\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT) {\n    return project_uModelMatrix * vec4(\n      project_mercator_(position.xy) * WORLD_SCALE * project_uScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    float X = position.x - project_coordinate_origin.x;\n    float Y = position.y - project_coordinate_origin.y;\n    return project_offset_(vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w));\n  }\n\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return project_offset_(position);\n  }\n\n  // METER_OFFSETS or IDENTITY\n  // Apply model matrix\n  vec4 position_modelspace = project_uModelMatrix * position;\n  return project_offset_(position_modelspace);\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_XY_LOW);\n}\n\nvec3 project_position(vec3 position, vec2 position64xyLow) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64xyLow);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_XY_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_XY_LOW);\n  return projected_position.xy;\n}\n\n//\n// Projects from "world" coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_to_clipspace(vec4 position) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_METER_OFFSETS ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // Needs to be divided with project_uPixelsPerMeter\n    position.w *= project_uPixelsPerMeter.z;\n  }\n  return project_uViewProjectionMatrix * position + project_uCenter;\n}\n\n// Returns a clip space offset that corresponds to a given number of **non-device** pixels\nvec4 project_pixel_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return vec4(offset * project_uFocalDistance, 0.0, 0.0);\n}\n'),s=n(147),u={};e.a={name:"project",dependencies:[r.s],vs:a,getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;return t.viewport?Object(s.b)(t):{}},deprecations:[{type:"uniform vec3",old:"selectedPickingColor",new:"luma.gl's picking module"},{type:"uniform float",old:"renderPickingBuffer",new:"luma.gl's picking module"},{type:"uniform float",old:"pickingEnabled",new:"luma.gl's picking module"},{type:"uniform float",old:"projectionMode",new:"project_uCoordinateSystem"},{type:"uniform vec4",old:"projectionCenter",new:"project_uCenter"},{type:"uniform vec2",old:"projectionOrigin"},{type:"uniform mat4",old:"modelMatrix",new:"project_uModelMatrix"},{type:"uniform mat4",old:"viewMatrix"},{type:"uniform mat4",old:"projectionMatrix",new:"project_uViewProjectionMatrix"},{type:"uniform vec3",old:"projectionPixelsPerUnit",new:"project_uPixelsPerUnit"},{type:"uniform float",old:"projectionScale",new:"project_uScale"},{type:"uniform vec2",old:"viewportSize",new:"project_uViewportSize"},{type:"uniform float",old:"devicePixelRatio",new:"project_uDevicePixelRatio"},{type:"uniform vec3",old:"cameraPos",new:"project_uCameraPosition"},{type:"function",old:"scale",new:"project_scale"},{type:"function",old:"preproject",new:"project_position"},{type:"function",old:"project",new:"project_to_clipspace"}]}},,function(t,e){var n=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(46);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(23);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(1),i=n(9),o=n(8),a=n(2),s=n(10),u=n(3),c=n(54),l=n(12),f=function(t){function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),Object(l.e)(t),(n=Object(i.a)(this,Object(o.a)(e).call(this,t,Object.assign({},a,{target:3553})))).initialize(a),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"isSupported",value:function(t,e){return c.a.isSupported(t,e)}}]),Object(a.a)(e,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit,e=this.gl;if(void 0===t)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){var t=this.gl;if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return t.activeTexture(33984+this.textureUnit),t.bindTexture(this.target,null),this.textureUnit}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}}]),e}(c.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"d",function(){return m}),n.d(e,"b",function(){return _}),n.d(e,"c",function(){return b});var r,i,o,a=n(22),s=n(0),u=n(12),c=(n(5),r={},Object(s.a)(r,3042,!1),Object(s.a)(r,32773,new Float32Array([0,0,0,0])),Object(s.a)(r,32777,32774),Object(s.a)(r,34877,32774),Object(s.a)(r,32969,1),Object(s.a)(r,32968,0),Object(s.a)(r,32971,1),Object(s.a)(r,32970,0),Object(s.a)(r,3106,new Float32Array([0,0,0,0])),Object(s.a)(r,3107,[!0,!0,!0,!0]),Object(s.a)(r,2884,!1),Object(s.a)(r,2885,1029),Object(s.a)(r,2929,!1),Object(s.a)(r,2931,1),Object(s.a)(r,2932,513),Object(s.a)(r,2928,new Float32Array([0,1])),Object(s.a)(r,2930,!0),Object(s.a)(r,3024,!0),Object(s.a)(r,36006,null),Object(s.a)(r,2886,2305),Object(s.a)(r,33170,4352),Object(s.a)(r,2849,1),Object(s.a)(r,32823,!1),Object(s.a)(r,32824,0),Object(s.a)(r,10752,0),Object(s.a)(r,32938,1),Object(s.a)(r,32939,!1),Object(s.a)(r,3089,!1),Object(s.a)(r,3088,new Int32Array([0,0,1024,1024])),Object(s.a)(r,2960,!1),Object(s.a)(r,2961,0),Object(s.a)(r,2968,4294967295),Object(s.a)(r,36005,4294967295),Object(s.a)(r,2962,519),Object(s.a)(r,2967,0),Object(s.a)(r,2963,4294967295),Object(s.a)(r,34816,519),Object(s.a)(r,36003,0),Object(s.a)(r,36004,4294967295),Object(s.a)(r,2964,7680),Object(s.a)(r,2965,7680),Object(s.a)(r,2966,7680),Object(s.a)(r,34817,7680),Object(s.a)(r,34818,7680),Object(s.a)(r,34819,7680),Object(s.a)(r,2978,new Int32Array([0,0,1024,1024])),Object(s.a)(r,3333,4),Object(s.a)(r,3317,4),Object(s.a)(r,37440,!1),Object(s.a)(r,37441,!1),Object(s.a)(r,37443,37444),Object(s.a)(r,35723,4352),Object(s.a)(r,36010,null),Object(s.a)(r,35977,!1),Object(s.a)(r,3330,0),Object(s.a)(r,3332,0),Object(s.a)(r,3331,0),Object(s.a)(r,3314,0),Object(s.a)(r,32878,0),Object(s.a)(r,3316,0),Object(s.a)(r,3315,0),Object(s.a)(r,32877,0),r),l=function(t,e,n){return e?t.enable(n):t.disable(n)},f=function(t,e,n){return t.hint(n,e)},h=function(t,e,n){return t.pixelStorei(n,e)},p=(i={},Object(s.a)(i,3042,l),Object(s.a)(i,32773,function(t,e){return t.blendColor.apply(t,Object(a.a)(e))}),Object(s.a)(i,32777,"blendEquation"),Object(s.a)(i,34877,"blendEquation"),Object(s.a)(i,32969,"blendFunc"),Object(s.a)(i,32968,"blendFunc"),Object(s.a)(i,32971,"blendFunc"),Object(s.a)(i,32970,"blendFunc"),Object(s.a)(i,3106,function(t,e){return t.clearColor.apply(t,Object(a.a)(e))}),Object(s.a)(i,3107,function(t,e){return t.colorMask.apply(t,Object(a.a)(e))}),Object(s.a)(i,2884,l),Object(s.a)(i,2885,function(t,e){return t.cullFace(e)}),Object(s.a)(i,2929,l),Object(s.a)(i,2931,function(t,e){return t.clearDepth(e)}),Object(s.a)(i,2932,function(t,e){return t.depthFunc(e)}),Object(s.a)(i,2928,function(t,e){return t.depthRange.apply(t,Object(a.a)(e))}),Object(s.a)(i,2930,function(t,e){return t.depthMask(e)}),Object(s.a)(i,3024,l),Object(s.a)(i,35723,f),Object(s.a)(i,36006,function(t,e){var n=Object(u.n)(t)?36009:36160;return t.bindFramebuffer(n,e)}),Object(s.a)(i,2886,function(t,e){return t.frontFace(e)}),Object(s.a)(i,33170,f),Object(s.a)(i,2849,function(t,e){return t.lineWidth(e)}),Object(s.a)(i,32823,l),Object(s.a)(i,32824,"polygonOffset"),Object(s.a)(i,10752,"polygonOffset"),Object(s.a)(i,35977,l),Object(s.a)(i,32938,"sampleCoverage"),Object(s.a)(i,32939,"sampleCoverage"),Object(s.a)(i,3089,l),Object(s.a)(i,3088,function(t,e){return t.scissor.apply(t,Object(a.a)(e))}),Object(s.a)(i,2960,l),Object(s.a)(i,2961,function(t,e){return t.clearStencil(e)}),Object(s.a)(i,2968,function(t,e){return t.stencilMaskSeparate(1028,e)}),Object(s.a)(i,36005,function(t,e){return t.stencilMaskSeparate(1029,e)}),Object(s.a)(i,2962,"stencilFuncFront"),Object(s.a)(i,2967,"stencilFuncFront"),Object(s.a)(i,2963,"stencilFuncFront"),Object(s.a)(i,34816,"stencilFuncBack"),Object(s.a)(i,36003,"stencilFuncBack"),Object(s.a)(i,36004,"stencilFuncBack"),Object(s.a)(i,2964,"stencilOpFront"),Object(s.a)(i,2965,"stencilOpFront"),Object(s.a)(i,2966,"stencilOpFront"),Object(s.a)(i,34817,"stencilOpBack"),Object(s.a)(i,34818,"stencilOpBack"),Object(s.a)(i,34819,"stencilOpBack"),Object(s.a)(i,2978,function(t,e){return t.viewport.apply(t,Object(a.a)(e))}),Object(s.a)(i,3333,h),Object(s.a)(i,3317,h),Object(s.a)(i,37440,h),Object(s.a)(i,37441,h),Object(s.a)(i,37443,h),Object(s.a)(i,3330,h),Object(s.a)(i,3332,h),Object(s.a)(i,3331,h),Object(s.a)(i,36010,function(t,e){return t.bindFramebuffer(36008,e)}),Object(s.a)(i,3314,h),Object(s.a)(i,32878,h),Object(s.a)(i,3316,h),Object(s.a)(i,3315,h),Object(s.a)(i,32877,h),i),d={blendEquation:function(t,e){return t.blendEquationSeparate(e[32777],e[34877])},blendFunc:function(t,e){return t.blendFuncSeparate(e[32969],e[32968],e[32971],e[32970])},polygonOffset:function(t,e){return t.polygonOffset(e[32824],e[10752])},sampleCoverage:function(t,e){return t.sampleCoverage(e[32938],e[32939])},stencilFuncFront:function(t,e){return t.stencilFuncSeparate(1028,e[2962],e[2967],e[2963])},stencilFuncBack:function(t,e){return t.stencilFuncSeparate(1029,e[34816],e[36003],e[36004])},stencilOpFront:function(t,e){return t.stencilOpSeparate(1028,e[2964],e[2965],e[2966])},stencilOpBack:function(t,e){return t.stencilOpSeparate(1029,e[34817],e[34818],e[34819])}},v=function(t,e){return t.isEnabled(e)},g=(o={},Object(s.a)(o,3042,v),Object(s.a)(o,2884,v),Object(s.a)(o,2929,v),Object(s.a)(o,3024,v),Object(s.a)(o,32823,v),Object(s.a)(o,32926,v),Object(s.a)(o,32928,v),Object(s.a)(o,3089,v),Object(s.a)(o,2960,v),Object(s.a)(o,35977,v),o);function m(t,e){var n={};for(var r in e){var i=Number(r),o=p[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],i))}var a=t.state&&t.state.cache;if(a){var s=Object.assign({},a,e);for(var u in n){(0,d[u])(t,s)}}}function y(t,e){var n=g[e];return n?n(t,Number(e)):t.getParameter(Number(e))}function _(t,e){e=e||c;var n=Array.isArray(e)?e:Object.keys(e),r={},i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;r[l]=y(t,l)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r}function b(t){m(t,Object.assign({},c,{}))}},function(t,e,n){var r=n(24);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(7),i=n(64),o=n(23);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var r=n(65),i=n(119),o=n(42),a=n(36),s=n(171);t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,f=6==t,h=5==t||f,p=e||s;return function(e,s,d){for(var v,g,m=o(e),y=i(m),_=r(s,d,3),b=a(y.length),x=0,w=n?p(e,b):u?p(e,0):void 0;b>x;x++)if((h||x in y)&&(g=_(v=y[x],x,m),t))if(n)w[x]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return x;case 2:w.push(v)}else if(l)return!1;return f?-1:c||l?l:w}}},function(t,e){t.exports=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t}},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o});var r=n(143),i="2.0.1",o=Object(r.a)()},function(t,e,n){"use strict";function r(t){return t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s")}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function o(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}n.d(e,"b",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return o})},function(t,e,n){"use strict";(function(t){n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i});var r="undefined"!=typeof window?window:t,i=(void 0!==t||window,"undefined"!=typeof document?document:{})}).call(this,n(41))},function(t,e,n){"use strict";if(n(34)){var r=n(84),i=n(20),o=n(23),a=n(7),s=n(138),u=n(177),c=n(65),l=n(101),f=n(94),h=n(51),p=n(103),d=n(73),v=n(36),g=n(211),m=n(97),y=n(71),_=n(57),b=n(121),x=n(24),w=n(42),E=n(168),S=n(98),P=n(60),T=n(99).f,A=n(170),k=n(95),C=n(26),O=n(75),M=n(128),I=n(135),L=n(173),R=n(108),j=n(132),z=n(100),D=n(172),F=n(201),N=n(35),B=n(59),U=N.f,V=B.f,G=i.RangeError,q=i.TypeError,W=i.Uint8Array,Z=Array.prototype,X=u.ArrayBuffer,H=u.DataView,Y=O(0),K=O(2),J=O(3),Q=O(4),$=O(5),tt=O(6),et=M(!0),nt=M(!1),rt=L.values,it=L.keys,ot=L.entries,at=Z.lastIndexOf,st=Z.reduce,ut=Z.reduceRight,ct=Z.join,lt=Z.sort,ft=Z.slice,ht=Z.toString,pt=Z.toLocaleString,dt=C("iterator"),vt=C("toStringTag"),gt=k("typed_constructor"),mt=k("def_constructor"),yt=s.CONSTR,_t=s.TYPED,bt=s.VIEW,xt=O(1,function(t,e){return Tt(I(t,t[mt]),e)}),wt=o(function(){return 1===new W(new Uint16Array([1]).buffer)[0]}),Et=!!W&&!!W.prototype.set&&o(function(){new W(1).set({})}),St=function(t,e){var n=d(t);if(n<0||n%e)throw G("Wrong offset!");return n},Pt=function(t){if(x(t)&&_t in t)return t;throw q(t+" is not a typed array!")},Tt=function(t,e){if(!(x(t)&&gt in t))throw q("It is not a typed array constructor!");return new t(e)},At=function(t,e){return kt(I(t,t[mt]),e)},kt=function(t,e){for(var n=0,r=e.length,i=Tt(t,r);r>n;)i[n]=e[n++];return i},Ct=function(t,e,n){U(t,e,{get:function(){return this._d[n]}})},Ot=function(t){var e,n,r,i,o,a,s=w(t),u=arguments.length,l=u>1?arguments[1]:void 0,f=void 0!==l,h=A(s);if(void 0!=h&&!E(h)){for(a=h.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(f&&u>2&&(l=c(l,arguments[2],2)),e=0,n=v(s.length),i=Tt(this,n);n>e;e++)i[e]=f?l(s[e],e):s[e];return i},Mt=function(){for(var t=0,e=arguments.length,n=Tt(this,e);e>t;)n[t]=arguments[t++];return n},It=!!W&&o(function(){pt.call(new W(1))}),Lt=function(){return pt.apply(It?ft.call(Pt(this)):Pt(this),arguments)},Rt={copyWithin:function(t,e){return F.call(Pt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(Pt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return D.apply(Pt(this),arguments)},filter:function(t){return At(this,K(Pt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(Pt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(Pt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Y(Pt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(Pt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(Pt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(Pt(this),arguments)},lastIndexOf:function(t){return at.apply(Pt(this),arguments)},map:function(t){return xt(Pt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(Pt(this),arguments)},reduceRight:function(t){return ut.apply(Pt(this),arguments)},reverse:function(){for(var t,e=Pt(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return J(Pt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return lt.call(Pt(this),t)},subarray:function(t,e){var n=Pt(this),r=n.length,i=m(t,r);return new(I(n,n[mt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:m(e,r))-i))}},jt=function(t,e){return At(this,ft.call(Pt(this),t,e))},zt=function(t){Pt(this);var e=St(arguments[1],1),n=this.length,r=w(t),i=v(r.length),o=0;if(i+e>n)throw G("Wrong length!");for(;o<i;)this[e+o]=r[o++]},Dt={entries:function(){return ot.call(Pt(this))},keys:function(){return it.call(Pt(this))},values:function(){return rt.call(Pt(this))}},Ft=function(t,e){return x(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Nt=function(t,e){return Ft(t,e=y(e,!0))?f(2,t[e]):V(t,e)},Bt=function(t,e,n){return!(Ft(t,e=y(e,!0))&&x(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?U(t,e,n):(t[e]=n.value,t)};yt||(B.f=Nt,N.f=Bt),a(a.S+a.F*!yt,"Object",{getOwnPropertyDescriptor:Nt,defineProperty:Bt}),o(function(){ht.call({})})&&(ht=pt=function(){return ct.call(this)});var Ut=p({},Rt);p(Ut,Dt),h(Ut,dt,Dt.values),p(Ut,{slice:jt,set:zt,constructor:function(){},toString:ht,toLocaleString:Lt}),Ct(Ut,"buffer","b"),Ct(Ut,"byteOffset","o"),Ct(Ut,"byteLength","l"),Ct(Ut,"length","e"),U(Ut,vt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,u){var c=t+((u=!!u)?"Clamped":"")+"Array",f="get"+t,p="set"+t,d=i[c],m=d||{},y=d&&P(d),_=!d||!s.ABV,w={},E=d&&d.prototype,A=function(t,n){U(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[f](n*e+r.o,wt)}(this,n)},set:function(t){return function(t,n,r){var i=t._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[p](n*e+i.o,r,wt)}(this,n,t)},enumerable:!0})};_?(d=n(function(t,n,r,i){l(t,d,c,"_d");var o,a,s,u,f=0,p=0;if(x(n)){if(!(n instanceof X||"ArrayBuffer"==(u=b(n))||"SharedArrayBuffer"==u))return _t in n?kt(d,n):Ot.call(d,n);o=n,p=St(r,e);var m=n.byteLength;if(void 0===i){if(m%e)throw G("Wrong length!");if((a=m-p)<0)throw G("Wrong length!")}else if((a=v(i)*e)+p>m)throw G("Wrong length!");s=a/e}else s=g(n),o=new X(a=s*e);for(h(t,"_d",{b:o,o:p,l:a,e:s,v:new H(o)});f<s;)A(t,f++)}),E=d.prototype=S(Ut),h(E,"constructor",d)):o(function(){d(1)})&&o(function(){new d(-1)})&&j(function(t){new d,new d(null),new d(1.5),new d(t)},!0)||(d=n(function(t,n,r,i){var o;return l(t,d,c),x(n)?n instanceof X||"ArrayBuffer"==(o=b(n))||"SharedArrayBuffer"==o?void 0!==i?new m(n,St(r,e),i):void 0!==r?new m(n,St(r,e)):new m(n):_t in n?kt(d,n):Ot.call(d,n):new m(g(n))}),Y(y!==Function.prototype?T(m).concat(T(y)):T(m),function(t){t in d||h(d,t,m[t])}),d.prototype=E,r||(E.constructor=d));var k=E[dt],C=!!k&&("values"==k.name||void 0==k.name),O=Dt.values;h(d,gt,!0),h(E,_t,c),h(E,bt,!0),h(E,mt,d),(u?new d(1)[vt]==c:vt in E)||U(E,vt,{get:function(){return c}}),w[c]=d,a(a.G+a.W+a.F*(d!=m),w),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o(function(){m.of.call(d,1)}),c,{from:Ot,of:Mt}),"BYTES_PER_ELEMENT"in E||h(E,"BYTES_PER_ELEMENT",e),a(a.P,c,Rt),z(c),a(a.P+a.F*Et,c,{set:zt}),a(a.P+a.F*!C,c,Dt),r||E.toString==ht||(E.toString=ht),a(a.P+a.F*o(function(){new d(1).slice()}),c,{slice:jt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!o(function(){E.toLocaleString.call([1,2])})),c,{toLocaleString:Lt}),R[c]=C?k:O,r||C||h(E,dt,O)}}else t.exports=function(){}},function(t,e,n){var r=n(206),i=n(7),o=n(127)("metadata"),a=o.store||(o.store=new(n(209))),s=function(t,e,n){var i=a.get(t);if(!i){if(!n)return;a.set(t,i=new r)}var o=i.get(e);if(!o){if(!n)return;i.set(e,o=new r)}return o};t.exports={store:a,map:s,has:function(t,e,n){var r=s(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=s(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){s(n,r,!0).set(t,e)},keys:function(t,e){var n=s(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){i(i.S,"Reflect",t)}}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(15);e.MapContext=i.createContext(void 0),e.withMap=function(t){return function(n){return i.createElement(e.MapContext.Consumer,null,function(e){return i.createElement(t,r({map:e},n))})}}},function(t,e,n){var r=n(95)("meta"),i=n(24),o=n(57),a=n(35).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(23)(function(){return u(Object.preventExtensions({}))}),l=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},f=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[r].w},onFreeze:function(t){return c&&f.NEED&&u(t)&&!o(t,r)&&l(t),t}}},function(t,e){t.exports=!1},function(t,e,n){var r=n(26)("unscopables"),i=Array.prototype;void 0==i[r]&&n(51)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e,n){"use strict";n.d(e,"c",function(){return c}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return f}),n.d(e,"a",function(){return h});var r=n(38),i=n(5),o=34962,a=32874,s="Invalid WebGLRenderingContext",u="Requires WebGL2";function c(t){return Boolean(t&&(t instanceof r.c||t.ARRAY_BUFFER===o))}function l(t){return Boolean(t&&(t instanceof r.a||t.TEXTURE_BINDING_3D===a))}function f(t){Object(i.a)(c(t),s)}function h(t){Object(i.a)(l(t),u)}},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return p}),n.d(e,"c",function(){return d}),n.d(e,"b",function(){return v});var r=n(1),i=n(2),o=n(0),a=n(70),s=n(5),u=function(t,e){var n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return t===e},c={enable:function(t,e){return t(Object(o.a)({},e,!0))},disable:function(t,e){return t(Object(o.a)({},e,!1))},pixelStorei:function(t,e,n){return t(Object(o.a)({},e,n))},hint:function(t,e,n){return t(Object(o.a)({},e,n))},bindFramebuffer:function(t,e,n){var r;switch(e){case 36160:return t((r={},Object(o.a)(r,36006,n),Object(o.a)(r,36010,n),r));case 36009:return t(Object(o.a)({},36006,n));case 36008:return t(Object(o.a)({},36010,n));default:return null}},blendColor:function(t,e,n,r,i){return t(Object(o.a)({},32773,new Float32Array([e,n,r,i])))},blendEquation:function(t,e){var n;return t((n={},Object(o.a)(n,32777,e),Object(o.a)(n,34877,e),n))},blendEquationSeparate:function(t,e,n){var r;return t((r={},Object(o.a)(r,32777,e),Object(o.a)(r,34877,n),r))},blendFunc:function(t,e,n){var r;return t((r={},Object(o.a)(r,32969,e),Object(o.a)(r,32968,n),Object(o.a)(r,32971,e),Object(o.a)(r,32970,n),r))},blendFuncSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,32969,e),Object(o.a)(a,32968,n),Object(o.a)(a,32971,r),Object(o.a)(a,32970,i),a))},clearColor:function(t,e,n,r,i){return t(Object(o.a)({},3106,new Float32Array([e,n,r,i])))},clearDepth:function(t,e){return t(Object(o.a)({},2931,e))},clearStencil:function(t,e){return t(Object(o.a)({},2961,e))},colorMask:function(t,e,n,r,i){return t(Object(o.a)({},3107,[e,n,r,i]))},cullFace:function(t,e){return t(Object(o.a)({},2885,e))},depthFunc:function(t,e){return t(Object(o.a)({},2932,e))},depthRange:function(t,e,n){return t(Object(o.a)({},2928,new Float32Array([e,n])))},depthMask:function(t,e){return t(Object(o.a)({},2930,e))},frontFace:function(t,e){return t(Object(o.a)({},2886,e))},lineWidth:function(t,e){return t(Object(o.a)({},2849,e))},polygonOffset:function(t,e,n){var r;return t((r={},Object(o.a)(r,32824,e),Object(o.a)(r,10752,n),r))},sampleCoverage:function(t,e,n){var r;return t((r={},Object(o.a)(r,32938,e),Object(o.a)(r,32939,n),r))},scissor:function(t,e,n,r,i){return t(Object(o.a)({},3088,new Int32Array([e,n,r,i])))},stencilMask:function(t,e){var n;return t((n={},Object(o.a)(n,2968,e),Object(o.a)(n,36005,e),n))},stencilMaskSeparate:function(t,e,n){return t(Object(o.a)({},1028===e?2968:36005,n))},stencilFunc:function(t,e,n,r){var i;return t((i={},Object(o.a)(i,2962,e),Object(o.a)(i,2967,n),Object(o.a)(i,2963,r),Object(o.a)(i,34816,e),Object(o.a)(i,36003,n),Object(o.a)(i,36004,r),i))},stencilFuncSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,1028===e?2962:34816,n),Object(o.a)(a,1028===e?2967:36003,r),Object(o.a)(a,1028===e?2963:36004,i),a))},stencilOp:function(t,e,n,r){var i;return t((i={},Object(o.a)(i,2964,e),Object(o.a)(i,2965,n),Object(o.a)(i,2966,r),Object(o.a)(i,34817,e),Object(o.a)(i,34818,n),Object(o.a)(i,34819,r),i))},stencilOpSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,1028===e?2964:34817,n),Object(o.a)(a,1028===e?2965:34818,r),Object(o.a)(a,1028===e?2966:34819,i),a))},viewport:function(t,e,n,r,i){return t(Object(o.a)({},2978,new Int32Array([e,n,r,i])))}};function l(t,e){var n=t[e].bind(t);t[e]=function(){var e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache||(t.state.cache[e]=n.apply(void 0,arguments)),t.state.enable?t.state.cache[e]:n.apply(void 0,arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function f(t,e,n){var r=t[e].bind(t);t[e]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var s,u=n.apply(void 0,[t.state._updateCache].concat(o)),c=u.valueChanged,l=u.oldValue;c&&((s=t.state).log.apply(s,["gl.".concat(e)].concat(o)),r.apply(void 0,o));return l},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}var h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.copyState,o=void 0!==i&&i,s=n.log,u=void 0===s?function(){}:s;Object(r.a)(this,t),this.gl=e,this.stateStack=[],this.enable=!0,this.cache=o?Object(a.b)(e):Object.assign({},a.a),this.log=u,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return Object(i.a)(t,[{key:"push",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stateStack.push({})}},{key:"pop",value:function(){Object(s.a)(this.stateStack.length>0);var t=this.stateStack[this.stateStack.length-1];Object(a.d)(this.gl,t,this.cache),this.stateStack.pop()}},{key:"_updateCache",value:function(t){var e,n=!1,r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var i in t)Object(s.a)(void 0!==i),u(t[i],this.cache[i])||(n=!0,e=this.cache[i],!r||i in r||(r[i]=this.cache[i]),this.cache[i]=t[i]);return{valueChanged:n,oldValue:e}}}]),t}();function p(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.enable,i=void 0===r||r,o=n.copyState;if(Object(s.a)(void 0!==o),!e.state){var a=void 0!==t?t:window;for(var u in a.polyfillContext&&a.polyfillContext(e),e.state=new h(e,{copyState:o,enable:i}),c){f(e,u,c[u])}l(e,"getParameter"),l(e,"isEnabled")}return e.state.enable=i,e}function d(t){t.state||p(t,{copyState:!1}),t.state.push()}function v(t){Object(s.a)(t.state),t.state.pop()}}).call(this,n(41))},function(t,e,n){var r=n(499);t.exports=function(t,e,n,i){var o,a,s,u,c,l,f,h,p,d,v=e[0],g=e[1],m=e[2],y=i[0],_=i[1],b=i[2],x=n[0],w=n[1],E=n[2];if(Math.abs(v-x)<1e-6&&Math.abs(g-w)<1e-6&&Math.abs(m-E)<1e-6)return r(t);f=v-x,h=g-w,p=m-E,d=1/Math.sqrt(f*f+h*h+p*p),o=_*(p*=d)-b*(h*=d),a=b*(f*=d)-y*p,s=y*h-_*f,(d=Math.sqrt(o*o+a*a+s*s))?(o*=d=1/d,a*=d,s*=d):(o=0,a=0,s=0);u=h*s-p*a,c=p*o-f*s,l=f*a-h*o,(d=Math.sqrt(u*u+c*c+l*l))?(u*=d=1/d,c*=d,l*=d):(u=0,c=0,l=0);return t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=l,t[10]=p,t[11]=0,t[12]=-(o*v+a*g+s*m),t[13]=-(u*v+c*g+l*m),t[14]=-(f*v+h*g+p*m),t[15]=1,t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t}},function(t,e,n){"use strict";var r=n(8);function i(t,e,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(r.a)(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}n.d(e,"a",function(){return i})},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],p=e[11],d=e[12],v=e[13],g=e[14],m=e[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,E=i*c-o*u,S=l*v-f*d,P=l*g-h*d,T=l*m-p*d,A=f*g-h*v,k=f*m-p*v,C=h*m-p*g,O=y*C-_*k+b*A+x*T-w*P+E*S;if(!O)return null;return O=1/O,t[0]=(s*C-u*k+c*A)*O,t[1]=(i*k-r*C-o*A)*O,t[2]=(v*E-g*w+m*x)*O,t[3]=(h*w-f*E-p*x)*O,t[4]=(u*T-a*C-c*P)*O,t[5]=(n*C-i*T+o*P)*O,t[6]=(g*b-d*E-m*_)*O,t[7]=(l*E-h*b+p*_)*O,t[8]=(a*k-s*T+c*S)*O,t[9]=(r*T-n*k-o*S)*O,t[10]=(d*w-v*b+m*y)*O,t[11]=(f*b-l*w-p*y)*O,t[12]=(s*P-a*A-u*S)*O,t[13]=(n*A-r*P+i*S)*O,t[14]=(v*_-d*x-g*y)*O,t[15]=(l*x-f*_+h*y)*O,t}},function(t,e,n){"use strict";function r(t){if(!t)throw new Error("viewport-mercator-project: assertion failed.")}n.d(e,"a",function(){return r})},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){var r=n(187),i=n(155);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(73),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(19),i=n(188),o=n(155),a=n(154)("IE_PROTO"),s=function(){},u=function(){var t,e=n(152)("iframe"),r=o.length;for(e.style.display="none",n(156).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(187),i=n(155).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=n(20),i=n(35),o=n(34),a=n(26)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(65),i=n(199),o=n(168),a=n(19),s=n(36),u=n(170),c={},l={};(e=t.exports=function(t,e,n,f,h){var p,d,v,g,m=h?function(){return t}:u(t),y=r(n,f,e?2:1),_=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(o(m)){for(p=s(t.length);p>_;_++)if((g=e?y(a(d=t[_])[0],d[1]):y(t[_]))===c||g===l)return g}else for(v=m.call(t);!(d=v.next()).done;)if((g=i(v,y,d.value,e))===c||g===l)return g}).BREAK=c,e.RETURN=l},function(t,e,n){var r=n(52);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"f",function(){return a}),n.d(e,"h",function(){return c}),n.d(e,"d",function(){return l}),n.d(e,"b",function(){return f}),n.d(e,"g",function(){return h}),n.d(e,"e",function(){return p});var r={};function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t){return Math.round(t/r.EPSILON)*r.EPSILON}function a(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===e?r.precision||4:e;return t=o(t),parseFloat(t.toPrecision(n))}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function u(t,e){if(s(t)){for(var n=function(t){return t.clone?t.clone():new Array(t)}(t),r=0;r<n.length;++r)n[r]=e(n[r],r,n);return n}return e(t)}function c(t){return u(t,function(t){return t/180*Math.PI})}function l(t){return u(t,function(t){return 180*t/Math.PI})}function f(t,e,n){return u(t,function(t){return Math.max(e,Math.min(n,t))})}function h(t,e,n){return s(t)?t.map(function(t,r){return h(t,e[r],n)}):n*e+(1-n)*t}function p(t,e){if(s(t)&&s(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!p(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}r.EPSILON=1e-12,r.debug=!0,r.precision=4,r.printTypes=!1,r.printDegrees=!1,r.printRowMajor=!0},function(t,e,n){(function(e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i="object"!==(void 0===e?"undefined":r(e))||"[object process]"!==String(e)||e.browser;t.exports={window:"undefined"!=typeof window?window:n,global:void 0!==n?n:window,document:"undefined"!=typeof document?document:{},isBrowser:i}}).call(this,n(68),n(41))},function(t,e,n){var r=n(35).f,i=n(57),o=n(26)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(7),i=n(72),o=n(23),a=n(158),s="["+a+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),l=function(t,e,n){var i={},s=o(function(){return!!a[t]()||""!=""[t]()}),u=i[t]=s?e(f):a[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},f=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=l},function(t,e){t.exports={}},function(t,e,n){var r=n(24);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(3),c=n(54),l=n(5),f=[34069,34070,34071,34072,34073,34074],h=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t,Object.assign({},i,{target:34067})))).initialize(i),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.format,n=void 0===e?6408:e,r=t.mipmaps,i=void 0===r||r,o=t.width,a=void 0===o?1:o,s=t.height,u=void 0===s?1:s,c=t.type,f=void 0===c?5121:c,h=t.dataFormat,p=this._deduceParameters({format:n,type:f,dataFormat:h});f=p.type,h=p.dataFormat;var d=this._deduceImageSize({data:t[34069],width:a,height:u});a=d.width,u=d.height,Object(l.a)(a===u),this.setCubeMapImageData(t),i&&this.generateMipmap(t),this.opts=t}},{key:"subImage",value:function(t){var e=t.face,n=t.data,r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.mipmapLevel,u=void 0===s?0:s;return this._subImage({target:e,data:n,x:i,y:a,mipmapLevel:u})}},{key:"setCubeMapImageData",value:function(t){var e=t.width,n=t.height,r=t.pixels,i=t.data,o=t.border,a=void 0===o?0:o,s=t.format,u=void 0===s?6408:s,c=t.type,l=void 0===c?5121:c,h=(t.generateMipmap,this.gl);if(r=r||i,this.bind(),this.width||this.height)for(var p=0;p<f.length;p++){var d=f[p];h.texImage2D(d,0,u,e,n,a,u,l,r[d])}else for(var v=0;v<f.length;v++){var g=f[v];h.texImage2D(g,0,u,u,l,r[g])}}},{key:"bind",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).index;return void 0!==t&&this.gl.activeTexture(33984+t),this.gl.bindTexture(34067,this.handle),t}},{key:"unbind",value:function(){return this.gl.bindTexture(34067,null),this}}]),e}(c.a);h.FACES=f},function(t,e,n){"use strict";(function(t){var r=n(29),i=n(244),o=!("object"===(void 0===t?"undefined":Object(r.a)(t))&&"[object process]"===String(t)&&!t.browser)||i.a;e.a=o}).call(this,n(68))},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(146),c=n(104),l=function(t,e){if(!t)throw new Error(e)},f=function(t){function e(){return Object(r.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(c.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(c.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"scaleAndAdd",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*e+t[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return l(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(c.a)(this[t])}},{key:"setComponent",value:function(t,e){return l(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(c.a)(t)}}]),e}(u.a)},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i,t}},function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){var e,n={};return function(i){for(var o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,"a",function(){return i})},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}},function(t,e,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),f="function",h=Math.round,p=Math.abs,d=Date.now;function v(t,e,n){return setTimeout(w(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var _=y(function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===s)&&(t[r[i]]=e[r[i]]),i++;return t},"extend","Use `assign`."),b=y(function(t,e){return _(t,e,!0)},"merge","Use `assign`.");function x(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==f?t.apply(e&&e[0]||s,e):t}function S(t,e){return t===s?e:t}function P(t,e,n){m(C(e),function(e){t.addEventListener(e,n,!1)})}function T(t,e,n){m(C(e),function(e){t.removeEventListener(e,n,!1)})}function A(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function C(t){return t.trim().split(/\s+/g)}function O(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function M(t){return Array.prototype.slice.call(t,0)}function I(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];O(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function L(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}return s}var R=1;function j(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var z="ontouchstart"in i,D=L(i,"PointerEvent")!==s,F=z&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N=25,B=1,U=2,V=4,G=8,q=1,W=2,Z=4,X=8,H=16,Y=W|Z,K=X|H,J=Y|K,Q=["x","y"],$=["clientX","clientY"];function tt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function et(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&B&&r-i==0,a=e&(V|G)&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=nt(e));i>1&&!n.firstMultiple?n.firstMultiple=nt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,u=a?a.center:o.center,c=e.center=rt(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=st(u,c),e.distance=at(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==B&&o.eventType!==V||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var l=it(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=p(l.x)>p(l.y)?l.x:l.y,e.scale=a?function(t,e){return at(e[0],e[1],$)/at(t[0],t[1],$)}(a.pointers,r):1,e.rotation=a?function(t,e){return st(e[1],e[0],$)+st(t[1],t[0],$)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=G&&(u>N||a.velocity===s)){var c=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,f=it(u,c,l);r=f.x,i=f.y,n=p(f.x)>p(f.y)?f.x:f.y,o=ot(c,l),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var f=t.element;A(e.srcEvent.target,f)&&(f=e.srcEvent.target);e.target=f}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function nt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:rt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function rt(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function it(t,e,n){return{x:e/t||0,y:n/t||0}}function ot(t,e){return t===e?q:p(t)>=p(e)?t<0?W:Z:e<0?X:H}function at(t,e,n){n||(n=Q);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function st(t,e,n){n||(n=Q);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}tt.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(j(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(j(this.element),this.evWin,this.domHandler)}};var ut={mousedown:B,mousemove:U,mouseup:V},ct="mousedown",lt="mousemove mouseup";function ft(){this.evEl=ct,this.evWin=lt,this.pressed=!1,tt.apply(this,arguments)}x(ft,tt,{handler:function(t){var e=ut[t.type];e&B&&0===t.button&&(this.pressed=!0),e&U&&1!==t.which&&(e=V),this.pressed&&(e&V&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var ht={pointerdown:B,pointermove:U,pointerup:V,pointercancel:G,pointerout:G},pt={2:"touch",3:"pen",4:"mouse",5:"kinect"},dt="pointerdown",vt="pointermove pointerup pointercancel";function gt(){this.evEl=dt,this.evWin=vt,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(dt="MSPointerDown",vt="MSPointerMove MSPointerUp MSPointerCancel"),x(gt,tt,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=ht[r],o=pt[t.pointerType]||t.pointerType,a="touch"==o,s=O(e,t.pointerId,"pointerId");i&B&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(V|G)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var mt={touchstart:B,touchmove:U,touchend:V,touchcancel:G},yt="touchstart",_t="touchstart touchmove touchend touchcancel";function bt(){this.evTarget=yt,this.evWin=_t,this.started=!1,tt.apply(this,arguments)}x(bt,tt,{handler:function(t){var e=mt[t.type];if(e===B&&(this.started=!0),this.started){var n=function(t,e){var n=M(t.touches),r=M(t.changedTouches);e&(V|G)&&(n=I(n.concat(r),"identifier",!0));return[n,r]}.call(this,t,e);e&(V|G)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var xt={touchstart:B,touchmove:U,touchend:V,touchcancel:G},wt="touchstart touchmove touchend touchcancel";function Et(){this.evTarget=wt,this.targetIds={},tt.apply(this,arguments)}x(Et,tt,{handler:function(t){var e=xt[t.type],n=function(t,e){var n=M(t.touches),r=this.targetIds;if(e&(B|U)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=M(t.changedTouches),s=[],u=this.target;if(o=n.filter(function(t){return A(t.target,u)}),e===B)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;i=0;for(;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(V|G)&&delete r[a[i].identifier],i++;if(!s.length)return;return[I(o.concat(s),"identifier",!0),s]}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var St=2500,Pt=25;function Tt(){tt.apply(this,arguments);var t=w(this.handler,this);this.touch=new Et(this.manager,t),this.mouse=new ft(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function At(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)},St)}}x(Tt,tt,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(t,e){t&B?(this.primaryTouch=e.changedPointers[0].identifier,At.call(this,e)):t&(V|G)&&At.call(this,e)}).call(this,e,n);else if(i&&function(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=Pt&&a<=Pt)return!0}return!1}.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var kt=L(l.style,"touchAction"),Ct=kt!==s,Ot="auto",Mt="manipulation",It="none",Lt="pan-x",Rt="pan-y",jt=function(){if(!Ct)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!e||i.CSS.supports("touch-action",n)}),t}();function zt(t,e){this.manager=t,this.set(e)}zt.prototype={set:function(t){"compute"==t&&(t=this.compute()),Ct&&this.manager.element.style&&jt[t]&&(this.manager.element.style[kt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(k(t,It))return It;var e=k(t,Lt),n=k(t,Rt);if(e&&n)return It;if(e||n)return e?Lt:Rt;if(k(t,Mt))return Mt;return Ot}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=k(r,It)&&!jt[It],o=k(r,Rt)&&!jt[Rt],a=k(r,Lt)&&!jt[Lt];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&Y||a&&n&K?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Dt=1,Ft=2,Nt=4,Bt=8,Ut=Bt,Vt=16;function Gt(t){this.options=u({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=Dt,this.simultaneous={},this.requireFail=[]}function qt(t){return t&Vt?"cancel":t&Bt?"end":t&Nt?"move":t&Ft?"start":""}function Wt(t){return t==H?"down":t==X?"up":t==W?"left":t==Z?"right":""}function Zt(t,e){var n=e.manager;return n?n.get(t):t}function Xt(){Gt.apply(this,arguments)}function Ht(){Xt.apply(this,arguments),this.pX=null,this.pY=null}function Yt(){Xt.apply(this,arguments)}function Kt(){Gt.apply(this,arguments),this._timer=null,this._input=null}function Jt(){Xt.apply(this,arguments)}function Qt(){Xt.apply(this,arguments)}function $t(){Gt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function te(t,e){return(e=e||{}).recognizers=S(e.recognizers,te.defaults.preset),new ee(t,e)}Gt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Zt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)?this:(t=Zt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===O(e,t=Zt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Zt(t,this);var e=O(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<Bt&&r(e.options.event+qt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=Bt&&r(e.options.event+qt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Dt)))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Ut|Vt|32)&&(this.state=Dt),this.state=this.process(e),this.state&(Ft|Nt|Bt|Vt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(Xt,Gt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(Ft|Nt),i=this.attrTest(t);return r&&(n&G||!i)?e|Vt:r||i?n&V?e|Bt:e&Ft?e|Nt:Ft:32}}),x(Ht,Xt,{defaults:{event:"pan",threshold:10,pointers:1,direction:J},getTouchAction:function(){var t=this.options.direction,e=[];return t&Y&&e.push(Rt),t&K&&e.push(Lt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&Y?(i=0===o?q:o<0?W:Z,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?q:a<0?X:H,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Xt.prototype.attrTest.call(this,t)&&(this.state&Ft||!(this.state&Ft)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Wt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x(Yt,Xt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Ft)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(Kt,Gt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ot]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(V|G)&&!i)this.reset();else if(t.eventType&B)this.reset(),this._timer=v(function(){this.state=Ut,this.tryEmit()},e.time,this);else if(t.eventType&V)return Ut;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Ut&&(t&&t.eventType&V?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),x(Jt,Xt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[It]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Ft)}}),x(Qt,Xt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Y|K,pointers:1},getTouchAction:function(){return Ht.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Y|K)?e=t.overallVelocity:n&Y?e=t.overallVelocityX:n&K&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&p(e)>this.options.velocity&&t.eventType&V},emit:function(t){var e=Wt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x($t,Gt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Mt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&B&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=V)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=v(function(){this.state=Ut,this.tryEmit()},e.interval,this),Ft):Ut}return 32},failTimeout:function(){return this._timer=v(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ut&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),te.VERSION="2.0.7",te.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Jt,{enable:!1}],[Yt,{enable:!1},["rotate"]],[Qt,{direction:Y}],[Ht,{direction:Y},["swipe"]],[$t],[$t,{event:"doubletap",taps:2},["tap"]],[Kt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function ee(t,e){this.options=u({},te.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(D?gt:F?Et:z?Tt:ft))(t,et)}(this),this.touchAction=new zt(this,this.options.touchAction),ne(this,!0),m(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ne(t,e){var n,r=t.element;r.style&&(m(t.options.cssProps,function(i,o){n=L(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={}))}ee.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&Ut)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(Ft|Nt|Bt)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Gt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=O(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return m(C(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==s){var n=this.handlers;return m(C(t),function(t){e?n[t]&&n[t].splice(O(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ne(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(te,{INPUT_START:B,INPUT_MOVE:U,INPUT_END:V,INPUT_CANCEL:G,STATE_POSSIBLE:Dt,STATE_BEGAN:Ft,STATE_CHANGED:Nt,STATE_ENDED:Bt,STATE_RECOGNIZED:Ut,STATE_CANCELLED:Vt,STATE_FAILED:32,DIRECTION_NONE:q,DIRECTION_LEFT:W,DIRECTION_RIGHT:Z,DIRECTION_UP:X,DIRECTION_DOWN:H,DIRECTION_HORIZONTAL:Y,DIRECTION_VERTICAL:K,DIRECTION_ALL:J,Manager:ee,Input:tt,TouchAction:zt,TouchInput:Et,MouseInput:ft,PointerEventInput:gt,TouchMouseInput:Tt,SingleTouchInput:bt,Recognizer:Gt,AttrRecognizer:Xt,Tap:$t,Pan:Ht,Swipe:Qt,Pinch:Yt,Rotate:Jt,Press:Kt,on:P,off:T,each:m,merge:b,extend:_,assign:u,inherit:x,bindFn:w,prefixed:L}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=te,(r=function(){return te}.call(e,n,e,t))===s||(t.exports=r)}(window,document)},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",i="undefined"!=typeof window?window:t;void 0!==t||window,"undefined"!=typeof document&&document}).call(this,n(41))},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",i="undefined"!=typeof window?window:t;void 0!==t||window,"undefined"!=typeof document&&document}).call(this,n(41))},function(t,e,n){var r=n(66);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(66),i=n(26)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){t.exports=function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),(n=i(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else e=i;else t=i}return r(0,function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=r;function r(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var n,r,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=o;function o(t,e){this.x=t,this.y=e}function a(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!a(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!a(t[r],e[r]))return!1;return!0}return t===e}function s(t,e,r,i){var o=new n(t,e,r,i);return function(t){return o.solve(t)}}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var u=s(.25,.1,.25,1);function c(t,e,n){return Math.min(n,Math.max(e,t))}function l(t,e,n){var r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i}function f(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}var h=1;function p(){return h++}function d(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function v(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function g(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function m(t,e){return-1!==t.indexOf(e,t.length-e.length)}function y(t,e,n){var r={};for(var i in t)r[i]=e.call(n||this,t[i],i,t);return r}function _(t,e,n){var r={};for(var i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function b(t){return Array.isArray(t)?t.map(b):"object"==typeof t&&t?y(t,b):t}var x={};function w(t){x[t]||("undefined"!=typeof console&&console.warn(t),x[t]=!0)}function E(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function S(t){for(var e=0,n=0,r=t.length,i=r-1,o=void 0,a=void 0;n<r;i=n++)o=t[n],e+=((a=t[i]).x-o.x)*(o.y+a.y);return e}function P(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var T=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),A=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,k=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,C={now:T,frame:function(t){var e=A(t);return{cancel:function(){return k(e)}}},getImageData:function(t){var e=self.document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(0,0,t.width,t.height)},resolveURL:function(t){var e=self.document.createElement("a");return e.href=t,e.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},supportsWebp:!1};if(self.document){var O=self.document.createElement("img");O.onload=function(){C.supportsWebp=!0},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var M={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return 0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":"https://events.mapbox.com/events/v2"},REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},I="See https://www.mapbox.com/api-documentation/#access-tokens";function L(t,e){var n=N(M.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"/"!==n.path&&(t.path=""+n.path+t.path),!M.REQUIRE_ACCESS_TOKEN)return B(t);if(!(e=e||M.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+I);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+I);return t.params.push("access_token="+e),B(t)}function R(t){return 0===t.indexOf("mapbox:")}var j=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function z(t){return j.test(t)}var D=/(\.(png|jpg)\d*)(?=$)/,F=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function N(t){var e=t.match(F);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function B(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var U=function(t){this.type=t,this.anonId=null,this.eventData={lastSuccess:null,accessToken:M.ACCESS_TOKEN},this.queue=[],this.pendingRequest=null};U.prototype.fetchEventData=function(){var t=P("localStorage"),e="mapbox.eventData:"+(M.ACCESS_TOKEN||""),n="mapbox.eventData.uuid:"+(M.ACCESS_TOKEN||"");if(t)try{var r=self.localStorage.getItem(e);r&&(this.eventData=JSON.parse(r));var i=self.localStorage.getItem(n);i&&(this.anonId=i)}catch(t){w("Unable to read from LocalStorage")}},U.prototype.saveEventData=function(){var t=P("localStorage"),e="mapbox.eventData:"+(M.ACCESS_TOKEN||""),n="mapbox.eventData.uuid:"+(M.ACCESS_TOKEN||"");if(t)try{self.localStorage.setItem(n,this.anonId),this.eventData.lastSuccess&&self.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){w("Unable to write to LocalStorage")}},U.prototype.processRequests=function(){},U.prototype.postEvent=function(t,e,n){var r=this,i=N(M.EVENTS_URL);i.params.push("access_token="+(M.ACCESS_TOKEN||""));var o={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"0.51.0",userId:this.anonId},a=e?f(o,e):o,s={url:B(i),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=Q(s,function(t){r.pendingRequest=null,n(t),r.saveEventData(),r.processRequests()})},U.prototype.queueRequest=function(t){this.queue.push(t),this.processRequests()};var V=function(t){function e(){t.call(this,"map.load"),this.success={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postMapLoadEvent=function(t,e){M.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return z(t)})&&this.queueRequest({id:e,timestamp:Date.now()})},e.prototype.processRequests=function(){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var e=this.queue.shift(),n=e.id,r=e.timestamp;n&&this.success[n]||(this.anonId||this.fetchEventData(),v(this.anonId)||(this.anonId=d()),this.postEvent(r,{},function(e){e||n&&(t.success[n]=!0)}))}},e}(U),G=new(function(t){function e(){t.call(this,"appUserTurnstile")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postTurnstileEvent=function(t){M.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return z(t)})&&this.queueRequest(Date.now())},e.prototype.processRequests=function(){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var e=!!this.eventData.accessToken&&this.eventData.accessToken!==M.ACCESS_TOKEN;e&&(this.anonId=this.eventData.lastSuccess=null),this.anonId&&this.eventData.lastSuccess||this.fetchEventData(),v(this.anonId)||(this.anonId=d(),e=!0);var n=this.queue.shift();if(this.eventData.lastSuccess){var r=new Date(this.eventData.lastSuccess),i=new Date(n),o=(n-this.eventData.lastSuccess)/864e5;e=e||o>=1||o<-1||r.getDate()!==i.getDate()}else e=!0;if(!e)return this.processRequests();this.postEvent(n,{"enabled.telemetry":!1},function(e){e||(t.eventData.lastSuccess=n,t.eventData.accessToken=M.ACCESS_TOKEN)})}},e}(U)),q=G.postTurnstileEvent.bind(G),W=new V,Z=W.postMapLoadEvent.bind(W),X={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(X);var H=function(t){function e(e,n,r){401===n&&z(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens"),t.call(this,e),this.status=n,this.url=r,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),Y="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope?function(){return self.worker&&self.worker.referrer}:function(){var t=self.location.origin;if(t&&"null"!==t&&"file://"!==t)return t+self.location.pathname},K=self.fetch&&self.Request&&self.AbortController?function(t,e){var n=new self.AbortController,r=new self.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:Y(),signal:n.signal});return"json"===t.type&&r.headers.set("Accept","application/json"),self.fetch(r).then(function(n){n.ok?n[t.type||"text"]().then(function(t){e(null,t,n.headers.get("Cache-Control"),n.headers.get("Expires"))}).catch(function(t){return e(new Error(t.message))}):e(new H(n.statusText,n.status,t.url))}).catch(function(t){e(new Error(t.message))}),{cancel:function(){return n.abort()}}}:function(t,e){var n=new self.XMLHttpRequest;for(var r in n.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(n.responseType="arraybuffer"),t.headers)n.setRequestHeader(r,t.headers[r]);return"json"===t.type&&n.setRequestHeader("Accept","application/json"),n.withCredentials="include"===t.credentials,n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var r=n.response;if("json"===t.type)try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else e(new H(n.statusText,n.status,t.url))},n.send(t.body),{cancel:function(){return n.abort()}}},J=function(t,e){return K(f(t,{type:"arrayBuffer"}),e)},Q=function(t,e){return K(f(t,{method:"POST"}),e)},$=[],tt=0,et=function(t,e){if(tt>=M.MAX_PARALLEL_IMAGE_REQUESTS){var n={requestParameters:t,callback:e,cancelled:!1};return $.push(n),{cancel:function(){n.cancelled=!0}}}return tt++,J(t,function(t,n,r,i){for(tt--;$.length&&tt<M.MAX_PARALLEL_IMAGE_REQUESTS;){var o=$.shift(),a=o.requestParameters,s=o.callback;o.cancelled||et(a,s)}if(t)e(t);else if(n){var u=new self.Image,c=self.URL||self.webkitURL;u.onload=function(){e(null,u),c.revokeObjectURL(u.src)},u.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var l=new self.Blob([new Uint8Array(n)],{type:"image/png"});u.cacheControl=r,u.expires=i,u.src=n.byteLength?c.createObjectURL(l):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})};function nt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function rt(t,e,n){if(n&&n[t]){var r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}var it=function(t,e){void 0===e&&(e={}),f(this,e),this.type=t},ot=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",f({error:e},n))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(it),at=function(){};at.prototype.on=function(t,e){return this._listeners=this._listeners||{},nt(t,e,this._listeners),this},at.prototype.off=function(t,e){return rt(t,e,this._listeners),rt(t,e,this._oneTimeListeners),this},at.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},nt(t,e,this._oneTimeListeners),this},at.prototype.fire=function(t){"string"==typeof t&&(t=new it(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var n=0,r=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];n<r.length;n+=1)r[n].call(this,t);for(var i=0,o=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];i<o.length;i+=1){var a=o[i];rt(e,a,this._oneTimeListeners),a.call(this,t)}var s=this._eventedParent;s&&(f(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else t instanceof ot&&console.error(t.error);return this},at.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},at.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var st={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-z-order":{type:"enum",values:{"viewport-y":{},source:{}},default:"viewport-y",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},ut=function(t,e,n,r){this.message=(t?t+": ":"")+n,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)};function ct(t){var e=t.key,n=t.value;return n?[new ut(e,n,"constants have been deprecated as of v8")]:[]}function lt(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}function ft(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function ht(t){return Array.isArray(t)?t.map(ht):ft(t)}var pt=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),dt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,r=e;n<r.length;n+=1){var i=r[n],o=i[0],a=i[1];this.bindings[o]=a}};dt.prototype.concat=function(t){return new dt(this,t)},dt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},dt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var vt={kind:"null"},gt={kind:"number"},mt={kind:"string"},yt={kind:"boolean"},_t={kind:"color"},bt={kind:"object"},xt={kind:"value"},wt={kind:"collator"},Et={kind:"formatted"};function St(t,e){return{kind:"array",itemType:t,N:e}}function Pt(t){if("array"===t.kind){var e=Pt(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Tt=[vt,gt,mt,yt,_t,Et,bt,St(xt)];function At(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!At(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,r=Tt;n<r.length;n+=1)if(!At(r[n],e))return null}return"Expected "+Pt(t)+" but found "+Pt(e)+" instead."}var kt=e(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?r(parseFloat(t)/100*255):r(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in n)return n[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=i.indexOf("("),c=i.indexOf(")");if(-1!==u&&c+1===i.length){var l=i.substr(0,u),f=i.substr(u+1,c-(u+1)).split(","),h=1;switch(l){case"rgba":if(4!==f.length)return null;h=a(f.pop());case"rgb":return 3!==f.length?null:[o(f[0]),o(f[1]),o(f[2]),h];case"hsla":if(4!==f.length)return null;h=a(f.pop());case"hsl":if(3!==f.length)return null;var p=(parseFloat(f[0])%360+360)%360/360,d=a(f[1]),v=a(f[2]),g=v<=.5?v*(d+1):v+d-v*d,m=2*v-g;return[r(255*s(m,g,p+1/3)),r(255*s(m,g,p)),r(255*s(m,g,p-1/3)),h];default:return null}}return null}}catch(t){}}).parseCSSColor,Ct=function(t,e,n,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=n,this.a=r};Ct.parse=function(t){if(t){if(t instanceof Ct)return t;if("string"==typeof t){var e=kt(t);if(e)return new Ct(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Ct.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],r=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(r)+","+i+")"},Ct.prototype.toArray=function(){var t=this.r,e=this.g,n=this.b,r=this.a;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]},Ct.black=new Ct(0,0,0,1),Ct.white=new Ct(1,1,1,1),Ct.transparent=new Ct(0,0,0,0),Ct.red=new Ct(1,0,0,1);var Ot=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ot.prototype.compare=function(t,e){return this.collator.compare(t,e)},Ot.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Mt=function(t,e,n){this.text=t,this.scale=e,this.fontStack=n},It=function(t){this.sections=t};function Lt(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[t,e,n,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Rt(t){if(null===t)return vt;if("string"==typeof t)return mt;if("boolean"==typeof t)return yt;if("number"==typeof t)return gt;if(t instanceof Ct)return _t;if(t instanceof Ot)return wt;if(t instanceof It)return Et;if(Array.isArray(t)){for(var e,n=t.length,r=0,i=t;r<i.length;r+=1){var o=Rt(i[r]);if(e){if(e===o)continue;e=xt;break}e=o}return St(e||xt,n)}return bt}function jt(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Ct||t instanceof It?t.toString():JSON.stringify(t)}It.fromString=function(t){return new It([new Mt(t,null,null)])},It.prototype.toString=function(){return this.sections.map(function(t){return t.text}).join("")},It.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.text);var i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),t.push(i)}return t};var zt=function(t,e){this.type=t,this.value=e};zt.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Ct)return!0;if(e instanceof Ot)return!0;if(e instanceof It)return!0;if(Array.isArray(e)){for(var n=0,r=e;n<r.length;n+=1)if(!t(r[n]))return!1;return!0}if("object"==typeof e){for(var i in e)if(!t(e[i]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var n=t[1],r=Rt(n),i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new zt(r,n)},zt.prototype.evaluate=function(){return this.value},zt.prototype.eachChild=function(){},zt.prototype.possibleOutputs=function(){return[this.value]},zt.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Ct?["rgba"].concat(this.value.toArray()):this.value instanceof It?this.value.serialize():this.value};var Dt=function(t){this.name="ExpressionEvaluationError",this.message=t};Dt.prototype.toJSON=function(){return this.message};var Ft={string:mt,number:gt,boolean:yt,object:bt},Nt=function(t,e){this.type=t,this.args=e};Nt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,r=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in Ft)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=Ft[s],r++}else o=xt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}n=St(o,a)}else n=Ft[i];for(var u=[];r<t.length;r++){var c=e.parse(t[r],r,xt);if(!c)return null;u.push(c)}return new Nt(n,u)},Nt.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!At(this.type,Rt(n)))return n;if(e===this.args.length-1)throw new Dt("Expected value to be of type "+Pt(this.type)+", but found "+Pt(Rt(n))+" instead.")}return null},Nt.prototype.eachChild=function(t){this.args.forEach(t)},Nt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Nt.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map(function(t){return t.serialize()}))};var Bt=function(t){this.type=Et,this.sections=t};Bt.parse=function(t,e){if(t.length<3)return e.error("Expected at least two arguments.");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");for(var n=[],r=1;r<t.length-1;r+=2){var i=e.parse(t[r],1,xt);if(!i)return null;var o=i.type.kind;if("string"!==o&&"value"!==o&&"null"!==o)return e.error("Formatted text type must be 'string', 'value', or 'null'.");var a=t[r+1];if("object"!=typeof a||Array.isArray(a))return e.error("Format options argument must be an object.");var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,gt)))return null;var u=null;if(a["text-font"]&&!(u=e.parse(a["text-font"],1,St(mt))))return null;n.push({text:i,scale:s,font:u})}return new Bt(n)},Bt.prototype.evaluate=function(t){return new It(this.sections.map(function(e){return new Mt(jt(e.text.evaluate(t)),e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null)}))},Bt.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t(r.text),r.scale&&t(r.scale),r.font&&t(r.font)}},Bt.prototype.possibleOutputs=function(){return[void 0]},Bt.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.text.serialize());var i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),t.push(i)}return t};var Ut={"to-boolean":yt,"to-color":_t,"to-number":gt,"to-string":mt},Vt=function(t,e){this.type=t,this.args=e};Vt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var r=Ut[n],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,xt);if(!a)return null;i.push(a)}return new Vt(r,i)},Vt.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,r=0,i=this.args;r<i.length;r+=1){if(n=null,(e=i[r].evaluate(t))instanceof Ct)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":Lt(e[0],e[1],e[2],e[3])))return new Ct(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Dt(n||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new Dt("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?It.fromString(jt(this.args[0].evaluate(t))):jt(this.args[0].evaluate(t))},Vt.prototype.eachChild=function(t){this.args.forEach(t)},Vt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Vt.prototype.serialize=function(){if("formatted"===this.type.kind)return new Bt([{text:this.args[0],scale:null,font:null}]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var Gt=["Unknown","Point","LineString","Polygon"],qt=function(){this.globals=null,this.feature=null,this.featureState=null,this._parseColorCache={}};qt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},qt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Gt[this.feature.type]:this.feature.type:null},qt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},qt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Ct.parse(t)),e};var Wt=function(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r};Wt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Wt.prototype.eachChild=function(t){this.args.forEach(t)},Wt.prototype.possibleOutputs=function(){return[void 0]},Wt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Wt.parse=function(t,e){var n=t[0],r=Wt.definitions[n];if(!r)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=o.filter(function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1}),s=null,u=0,c=a;u<c.length;u+=1){var l=c[u],f=l[0],h=l[1];s=new Jt(e.registry,e.path,null,e.scope);for(var p=[],d=!1,v=1;v<t.length;v++){var g=t[v],m=Array.isArray(f)?f[v-1]:f.type,y=s.parse(g,1+p.length,m);if(!y){d=!0;break}p.push(y)}if(!d)if(Array.isArray(f)&&f.length!==p.length)s.error("Expected "+f.length+" arguments, but found "+p.length+" instead.");else{for(var _=0;_<p.length;_++){var b=Array.isArray(f)?f[_]:f.type,x=p[_];s.concat(_+1).checkSubtype(b,x.type)}if(0===s.errors.length)return new Wt(n,i,h,p)}}if(1===a.length)e.errors.push.apply(e.errors,s.errors);else{for(var w=(a.length?a:o).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Pt).join(", ")+")":"("+Pt(e.type)+"...)"}).join(" | "),E=[],S=1;S<t.length;S++){var P=e.parse(t[S],1+E.length);if(!P)return null;E.push(Pt(P.type))}e.error("Expected arguments of type "+w+", but found ("+E.join(", ")+") instead.")}return null},Wt.register=function(t,e){for(var n in Wt.definitions=e,e)t[n]=Wt};var Zt=function(t,e,n){this.type=wt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function Xt(t){if(t instanceof Wt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!Xt(t)&&(e=!1)}),e}function Ht(t){if(t instanceof Wt&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(t){e&&!Ht(t)&&(e=!1)}),e}function Yt(t,e){if(t instanceof Wt&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild(function(t){n&&!Yt(t,e)&&(n=!1)}),n}Zt.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,yt);if(!r)return null;var i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,yt);if(!i)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,mt))?null:new Zt(r,i,o)},Zt.prototype.evaluate=function(t){return new Ot(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Zt.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Zt.prototype.possibleOutputs=function(){return[void 0]},Zt.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Kt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Kt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Kt(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Kt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Kt.prototype.eachChild=function(){},Kt.prototype.possibleOutputs=function(){return[void 0]},Kt.prototype.serialize=function(){return["var",this.name]};var Jt=function(t,e,n,r,i){void 0===e&&(e=[]),void 0===r&&(r=new dt),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=r,this.errors=i,this.expectedType=n};function Qt(t,e){for(var n,r,i=0,o=t.length-1,a=0;i<=o;){if(n=t[a=Math.floor((i+o)/2)],r=t[a+1],e===n||e>n&&e<r)return a;if(n<e)i=a+1;else{if(!(n>e))throw new Dt("Input is not a number.");o=a-1}}return Math.max(a-1,0)}Jt.prototype.parse=function(t,e,n,r,i){return void 0===i&&(i={}),e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)},Jt.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new Nt(e,[t]):"coerce"===n?new Vt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[r];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof zt)&&function t(e){if(e instanceof Kt)return t(e.boundExpression);if(e instanceof Wt&&"error"===e.name)return!1;if(e instanceof Zt)return!1;var n=e instanceof Vt||e instanceof Nt,r=!0;return e.eachChild(function(e){r=n?r&&t(e):r&&e instanceof zt}),!!r&&Xt(e)&&Yt(e,["zoom","heatmap-density","line-progress","is-supported-script"])}(o)){var u=new qt;try{o=new zt(o.type,o.evaluate(u))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},Jt.prototype.concat=function(t,e,n){var r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new Jt(this.registry,r,e||null,i,this.errors)},Jt.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new pt(r,t))},Jt.prototype.checkSubtype=function(t,e){var n=At(t,e);return n&&this.error(n),n};var $t=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var r=0,i=n;r<i.length;r+=1){var o=i[r],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};$t.parse=function(t,e){var n=t[1],r=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,1,gt)))return null;var i=[],o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType),r.unshift(-1/0);for(var a=0;a<r.length;a+=2){var s=r[a],u=r[a+1],c=a+1,l=a+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(i.length&&i[i.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',c);var f=e.parse(u,l,o);if(!f)return null;o=o||f.type,i.push([s,f])}return new $t(o,n,i)},$t.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[Qt(e,r)].evaluate(t)},$t.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},$t.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},$t.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var te=ee;function ee(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}function ne(t,e,n){return t*(1-n)+e*n}ee.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},ee.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},ee.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},ee.prototype.solveCurveX=function(t,e){var n,r,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=t)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?n=i:r=i,i=.5*(r-n)+n}return i},ee.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var re=Object.freeze({number:ne,color:function(t,e,n){return new Ct(ne(t.r,e.r,n),ne(t.g,e.g,n),ne(t.b,e.b,n),ne(t.a,e.a,n))},array:function(t,e,n){return t.map(function(t,r){return ne(t,e[r],n)})}}),ie=.95047,oe=1,ae=1.08883,se=4/29,ue=6/29,ce=3*ue*ue,le=ue*ue*ue,fe=Math.PI/180,he=180/Math.PI;function pe(t){return t>le?Math.pow(t,1/3):t/ce+se}function de(t){return t>ue?t*t*t:ce*(t-se)}function ve(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ge(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function me(t){var e=ge(t.r),n=ge(t.g),r=ge(t.b),i=pe((.4124564*e+.3575761*n+.1804375*r)/ie),o=pe((.2126729*e+.7151522*n+.072175*r)/oe);return{l:116*o-16,a:500*(i-o),b:200*(o-pe((.0193339*e+.119192*n+.9503041*r)/ae)),alpha:t.a}}function ye(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=oe*de(e),n=ie*de(n),r=ae*de(r),new Ct(ve(3.2404542*n-1.5371385*e-.4985314*r),ve(-.969266*n+1.8760108*e+.041556*r),ve(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}var _e={forward:me,reverse:ye,interpolate:function(t,e,n){return{l:ne(t.l,e.l,n),a:ne(t.a,e.a,n),b:ne(t.b,e.b,n),alpha:ne(t.alpha,e.alpha,n)}}},be={forward:function(t){var e=me(t),n=e.l,r=e.a,i=e.b,o=Math.atan2(i,r)*he;return{h:o<0?o+360:o,c:Math.sqrt(r*r+i*i),l:n,alpha:t.a}},reverse:function(t){var e=t.h*fe,n=t.c;return ye({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:function(t,e,n){var r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}(t.h,e.h,n),c:ne(t.c,e.c,n),l:ne(t.l,e.l,n),alpha:ne(t.alpha,e.alpha,n)}}},xe=Object.freeze({lab:_e,hcl:be}),we=function(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],c=s[1];this.labels.push(u),this.outputs.push(c)}};function Ee(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}we.interpolationFactor=function(t,e,n,r){var i=0;if("exponential"===t.name)i=Ee(e,t.base,n,r);else if("linear"===t.name)i=Ee(e,1,n,r);else if("cubic-bezier"===t.name){var o=t.controlPoints;i=new te(o[0],o[1],o[2],o[3]).solve(Ee(e,1,n,r))}return i},we.parse=function(t,e){var n=t[0],r=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some(function(t){return"number"!=typeof t||t<0||t>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,gt)))return null;var u=[],c=null;"interpolate-hcl"===n||"interpolate-lab"===n?c=_t:e.expectedType&&"value"!==e.expectedType.kind&&(c=e.expectedType);for(var l=0;l<o.length;l+=2){var f=o[l],h=o[l+1],p=l+3,d=l+4;if("number"!=typeof f)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(u.length&&u[u.length-1][0]>=f)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var v=e.parse(h,d,c);if(!v)return null;c=c||v.type,u.push([f,v])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new we(c,n,r,i,u):e.error("Type "+Pt(c)+" is not interpolatable.")},we.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);var o=Qt(e,r),a=e[o],s=e[o+1],u=we.interpolationFactor(this.interpolation,r,a,s),c=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?re[this.type.kind.toLowerCase()](c,l,u):"interpolate-hcl"===this.operator?be.reverse(be.interpolate(be.forward(c),be.forward(l),u)):_e.reverse(_e.interpolate(_e.forward(c),_e.forward(l),u))},we.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},we.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},we.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var Se=function(t,e){this.type=t,this.args=e};Se.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,r=e.expectedType;r&&"value"!==r.kind&&(n=r);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],u=e.parse(s,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!u)return null;n=n||u.type,i.push(u)}var c=r&&i.some(function(t){return At(r,t.type)});return new Se(c?xt:n,i)},Se.prototype.evaluate=function(t){for(var e=null,n=0,r=this.args;n<r.length&&null===(e=r[n].evaluate(t));n+=1);return e},Se.prototype.eachChild=function(t){this.args.forEach(t)},Se.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Se.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Pe=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};Pe.prototype.evaluate=function(t){return this.result.evaluate(t)},Pe.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},Pe.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],r=1;r<t.length-1;r+=2){var i=t[r];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return a?new Pe(n,a):null},Pe.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Pe.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var Te=function(t,e,n){this.type=t,this.index=e,this.input=n};Te.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,gt),r=e.parse(t[2],2,St(e.expectedType||xt));if(!n||!r)return null;var i=r.type;return new Te(i.itemType,n,r)},Te.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new Dt("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new Dt("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new Dt("Array index must be an integer, but found "+e+" instead.");return n[e]},Te.prototype.eachChild=function(t){t(this.index),t(this.input)},Te.prototype.possibleOutputs=function(){return[void 0]},Te.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ae=function(t,e,n,r,i,o){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o};Ae.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],u=t[a+1];Array.isArray(s)||(s=[s]);var c=e.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var l=0,f=s;l<f.length;l+=1){var h=f[l];if("number"!=typeof h&&"string"!=typeof h)return c.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,Rt(h)))return null}else n=Rt(h);if(void 0!==i[String(h)])return c.error("Branch labels must be unique.");i[String(h)]=o.length}var p=e.parse(u,a,r);if(!p)return null;r=r||p.type,o.push(p)}var d=e.parse(t[1],1,xt);if(!d)return null;var v=e.parse(t[t.length-1],t.length-1,r);return v?"value"!==d.type.kind&&e.concat(1).checkSubtype(n,d.type)?null:new Ae(n,r,d,i,o,v):null},Ae.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(Rt(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Ae.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Ae.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},Ae.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],r={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i],s=r[t.cases[a]];void 0===s?(r[t.cases[a]]=n.length,n.push([t.cases[a],[a]])):n[s][1].push(a)}for(var u=function(e){return"number"===t.inputType.kind?Number(e):e},c=0,l=n;c<l.length;c+=1){var f=l[c],h=f[0],p=f[1];1===p.length?e.push(u(p[0])):e.push(p.map(u)),e.push(t.outputs[h].serialize())}return e.push(this.otherwise.serialize()),e};var ke=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};function Ce(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Oe(t,e,n,r){return 0===r.compare(e,n)}function Me(t,e,n){var r="=="!==t&&"!="!==t;return function(){function i(t,e,n){this.type=yt,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,xt);if(!o)return null;if(!Ce(n,o.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Pt(o.type)+"'.");var a=e.parse(t[2],2,xt);if(!a)return null;if(!Ce(n,a.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Pt(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+Pt(o.type)+"' and '"+Pt(a.type)+"'.");r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new Nt(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new Nt(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,wt)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var s=Rt(o),u=Rt(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new Dt('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var c=Rt(o),l=Rt(a);if("string"!==c.kind||"string"!==l.kind)return e(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.possibleOutputs=function(){return[!0,!1]},i.prototype.serialize=function(){var e=[t];return this.eachChild(function(t){e.push(t.serialize())}),e},i}()}ke.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var r=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,yt);if(!o)return null;var a=e.parse(t[i+1],i+1,n);if(!a)return null;r.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new ke(n,r,s):null},ke.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},ke.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];t(i),t(o)}t(this.otherwise)},ke.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},ke.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ie=Me("==",function(t,e,n){return e===n},Oe),Le=Me("!=",function(t,e,n){return e!==n},function(t,e,n,r){return!Oe(0,e,n,r)}),Re=Me("<",function(t,e,n){return e<n},function(t,e,n,r){return r.compare(e,n)<0}),je=Me(">",function(t,e,n){return e>n},function(t,e,n,r){return r.compare(e,n)>0}),ze=Me("<=",function(t,e,n){return e<=n},function(t,e,n,r){return r.compare(e,n)<=0}),De=Me(">=",function(t,e,n){return e>=n},function(t,e,n,r){return r.compare(e,n)>=0}),Fe=function(t){this.type=gt,this.input=t};Fe.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Pt(n.type)+" instead."):new Fe(n):null},Fe.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new Dt("Expected value to be of type string or array, but found "+Pt(Rt(e))+" instead.")},Fe.prototype.eachChild=function(t){t(this.input)},Fe.prototype.possibleOutputs=function(){return[void 0]},Fe.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Ne={"==":Ie,"!=":Le,">":je,"<":Re,">=":De,"<=":ze,array:Nt,at:Te,boolean:Nt,case:ke,coalesce:Se,collator:Zt,format:Bt,interpolate:we,"interpolate-hcl":we,"interpolate-lab":we,length:Fe,let:Pe,literal:zt,match:Ae,number:Nt,object:Nt,step:$t,string:Nt,"to-boolean":Vt,"to-color":Vt,"to-number":Vt,"to-string":Vt,var:Kt};function Be(t,e){var n=e[0],r=e[1],i=e[2],o=e[3];n=n.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=Lt(n,r,i,a);if(s)throw new Dt(s);return new Ct(n/255*a,r/255*a,i/255*a,a)}function Ue(t,e){return t in e}function Ve(t,e){var n=e[t];return void 0===n?null:n}function Ge(t){return{type:t}}function qe(t){return{result:"success",value:t}}function We(t){return{result:"error",value:t}}function Ze(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Xe(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function He(t){return!!t.expression&&t.expression.interpolated}function Ye(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ke(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Je(t){return t}function Qe(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function $e(t,e,n,r,i){return Qe(typeof n===i?r[n]:void 0,t.default,e.default)}function tn(t,e,n){if("number"!==Ye(n))return Qe(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var i=rn(t.stops,n);return t.stops[i][1]}function en(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==Ye(n))return Qe(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var o=rn(t.stops,n),a=function(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],u=t.stops[o+1][1],c=re[e.type]||Je;if(t.colorSpace&&"rgb"!==t.colorSpace){var l=xe[t.colorSpace];c=function(t,e){return l.reverse(l.interpolate(l.forward(t),l.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),r=u.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return c(n,r,a)}}:c(s,u,a)}function nn(t,e,n){return"color"===e.type?n=Ct.parse(n):"formatted"===e.type?n=It.fromString(n.toString()):Ye(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Qe(n,t.default,e.default)}function rn(t,e){for(var n,r,i=0,o=t.length-1,a=0;i<=o;){if(n=t[a=Math.floor((i+o)/2)][0],r=t[a+1][0],e===n||e>n&&e<r)return a;n<e?i=a+1:n>e&&(o=a-1)}return Math.max(a-1,0)}Wt.register(Ne,{error:[{kind:"error"},[mt],function(t,e){var n=e[0];throw new Dt(n.evaluate(t))}],typeof:[mt,[xt],function(t,e){return Pt(Rt(e[0].evaluate(t)))}],"to-rgba":[St(gt,4),[_t],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[_t,[gt,gt,gt],Be],rgba:[_t,[gt,gt,gt,gt],Be],has:{type:yt,overloads:[[[mt],function(t,e){return Ue(e[0].evaluate(t),t.properties())}],[[mt,bt],function(t,e){var n=e[0],r=e[1];return Ue(n.evaluate(t),r.evaluate(t))}]]},get:{type:xt,overloads:[[[mt],function(t,e){return Ve(e[0].evaluate(t),t.properties())}],[[mt,bt],function(t,e){var n=e[0],r=e[1];return Ve(n.evaluate(t),r.evaluate(t))}]]},"feature-state":[xt,[mt],function(t,e){return Ve(e[0].evaluate(t),t.featureState||{})}],properties:[bt,[],function(t){return t.properties()}],"geometry-type":[mt,[],function(t){return t.geometryType()}],id:[xt,[],function(t){return t.id()}],zoom:[gt,[],function(t){return t.globals.zoom}],"heatmap-density":[gt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[gt,[],function(t){return t.globals.lineProgress||0}],"+":[gt,Ge(gt),function(t,e){for(var n=0,r=0,i=e;r<i.length;r+=1)n+=i[r].evaluate(t);return n}],"*":[gt,Ge(gt),function(t,e){for(var n=1,r=0,i=e;r<i.length;r+=1)n*=i[r].evaluate(t);return n}],"-":{type:gt,overloads:[[[gt,gt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)-r.evaluate(t)}],[[gt],function(t,e){return-e[0].evaluate(t)}]]},"/":[gt,[gt,gt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)/r.evaluate(t)}],"%":[gt,[gt,gt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)%r.evaluate(t)}],ln2:[gt,[],function(){return Math.LN2}],pi:[gt,[],function(){return Math.PI}],e:[gt,[],function(){return Math.E}],"^":[gt,[gt,gt],function(t,e){var n=e[0],r=e[1];return Math.pow(n.evaluate(t),r.evaluate(t))}],sqrt:[gt,[gt],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[gt,[gt],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN10}],ln:[gt,[gt],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[gt,[gt],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN2}],sin:[gt,[gt],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[gt,[gt],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[gt,[gt],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[gt,[gt],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[gt,[gt],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[gt,[gt],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[gt,Ge(gt),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[gt,Ge(gt),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[gt,[gt],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[gt,[gt],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[gt,[gt],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[gt,[gt],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[yt,[mt,xt],function(t,e){var n=e[0],r=e[1];return t.properties()[n.value]===r.value}],"filter-id-==":[yt,[xt],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[yt,[mt],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[yt,[mt,xt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<o}],"filter-id-<":[yt,[xt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[yt,[mt,xt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>o}],"filter-id->":[yt,[xt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[yt,[mt,xt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[yt,[xt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[yt,[mt,xt],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[yt,[xt],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[yt,[xt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[yt,[],function(t){return null!==t.id()}],"filter-type-in":[yt,[St(mt)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[yt,[St(xt)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[yt,[mt,St(xt)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[yt,[mt,St(xt)],function(t,e){var n=e[0],r=e[1];return function(t,e,n,r){for(;n<=r;){var i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:yt,overloads:[[[yt,yt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)&&r.evaluate(t)}],[Ge(yt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(!r[n].evaluate(t))return!1;return!0}]]},any:{type:yt,overloads:[[[yt,yt],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)||r.evaluate(t)}],[Ge(yt),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(r[n].evaluate(t))return!0;return!1}]]},"!":[yt,[yt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[yt,[mt],function(t,e){var n=e[0],r=t.globals&&t.globals.isSupportedScript;return!r||r(n.evaluate(t))}],upcase:[mt,[mt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[mt,[mt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[mt,Ge(xt),function(t,e){return e.map(function(e){return jt(e.evaluate(t))}).join("")}],"resolved-locale":[mt,[wt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var on=function(t,e){var n;this.expression=t,this._warningHistory={},this._evaluator=new qt,this._defaultValue="color"===(n=e).type&&Ke(n.default)?new Ct(0,0,0,0):"color"===n.type?Ct.parse(n.default)||null:void 0===n.default?null:n.default,this._enumValues="enum"===e.type?e.values:null};function an(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ne}function sn(t,e){var n=new Jt(Ne,[],function(t){var e={color:_t,string:mt,number:gt,enum:mt,boolean:yt,formatted:Et};return"array"===t.type?St(e[t.value]||xt,t.length):e[t.type]}(e)),r=n.parse(t,void 0,void 0,void 0,"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?qe(new on(r,e)):We(n.errors)}on.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this.expression.evaluate(this._evaluator)},on.prototype.evaluate=function(t,e,n){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null;try{var r=this.expression.evaluate(this._evaluator);if(null==r)return this._defaultValue;if(this._enumValues&&!(r in this._enumValues))throw new Dt("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(r)+" instead.");return r}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var un=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Ht(e.expression)};un.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n)},un.prototype.evaluate=function(t,e,n){return this._styleExpression.evaluate(t,e,n)};var cn=function(t,e,n){this.kind=t,this.zoomStops=n.labels,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Ht(e.expression),n instanceof we&&(this._interpolationType=n.interpolation)};function ln(t,e){if("error"===(t=sn(t,e)).result)return t;var n=t.value.expression,r=Xt(n);if(!r&&!Ze(e))return We([new pt("","data expressions not supported")]);var i=Yt(n,["zoom"]);if(!i&&!Xe(e))return We([new pt("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof Pe)n=t(e.result);else if(e instanceof Se)for(var r=0,i=e.args;r<i.length;r+=1){var o=i[r];if(n=t(o))break}else(e instanceof $t||e instanceof we)&&e.input instanceof Wt&&"zoom"===e.input.name&&(n=e);return n instanceof pt?n:(e.eachChild(function(e){var r=t(e);r instanceof pt?n=r:!n&&r?n=new pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new pt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n)}(n);return o||i?o instanceof pt?We([o]):o instanceof we&&!He(e)?We([new pt("",'"interpolate" expressions cannot be used with this property')]):qe(o?new cn(r?"camera":"composite",t.value,o):new un(r?"constant":"source",t.value)):We([new pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}cn.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n)},cn.prototype.evaluate=function(t,e,n){return this._styleExpression.evaluate(t,e,n)},cn.prototype.interpolationFactor=function(t,e,n){return this._interpolationType?we.interpolationFactor(this._interpolationType,t,e,n):0};var fn=function(t,e){this._parameters=t,this._specification=e,lt(this,function t(e,n){var r,i,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],u=s||void 0!==e.property,c=s||!u,l=e.type||(He(n)?"exponential":"interval");if(a&&((e=lt({},e)).stops&&(e.stops=e.stops.map(function(t){return[t[0],Ct.parse(t[1])]})),e.default?e.default=Ct.parse(e.default):e.default=Ct.parse(n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!xe[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===l)r=en;else if("interval"===l)r=tn;else if("categorical"===l){r=$e,i=Object.create(null);for(var f=0,h=e.stops;f<h.length;f+=1){var p=h[f];i[p[0]]=p[1]}o=typeof e.stops[0][0]}else{if("identity"!==l)throw new Error('Unknown function type "'+l+'"');r=nn}if(s){for(var d={},v=[],g=0;g<e.stops.length;g++){var m=e.stops[g],y=m[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},v.push(y)),d[y].stops.push([m[0].value,m[1]])}for(var _=[],b=0,x=v;b<x.length;b+=1){var w=x[b];_.push([d[w].zoom,t(d[w],n)])}return{kind:"composite",interpolationFactor:we.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:_.map(function(t){return t[0]}),evaluate:function(t,r){var i=t.zoom;return en({stops:_,base:e.base},n,i).evaluate(i,r)}}}return c?{kind:"camera",interpolationFactor:"exponential"===l?we.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(t){return t[0]}),evaluate:function(t){var a=t.zoom;return r(e,n,a,i,o)}}:{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Qe(e.default,n.default):r(e,n,s,i,o)}}}(this._parameters,this._specification))};function hn(t,e){if(Ke(t))return new fn(t,e);if(an(t)){var n=ln(t,e);if("error"===n.result)throw new Error(n.value.map(function(t){return t.key+": "+t.message}).join(", "));return n.value}var r=t;return"string"==typeof t&&"color"===e.type&&(r=Ct.parse(t)),{kind:"constant",evaluate:function(){return r}}}function pn(t){var e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],u=Ye(n);if("object"!==u)return[new ut(e,n,"object expected, "+u+" found")];for(var c in n){var l=c.split(".")[0],f=r[l]||r["*"],h=void 0;if(i[l])h=i[l];else if(r[l])h=Dn;else if(i["*"])h=i["*"];else{if(!r["*"]){s.push(new ut(e,n[c],'unknown property "'+c+'"'));continue}h=Dn}s=s.concat(h({key:(e?e+".":e)+c,value:n[c],valueSpec:f,style:o,styleSpec:a,object:n,objectKey:c},n))}for(var p in r)i[p]||r[p].required&&void 0===r[p].default&&void 0===n[p]&&s.push(new ut(e,n,'missing required property "'+p+'"'));return s}function dn(t){var e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||Dn;if("array"!==Ye(e))return[new ut(o,e,"array expected, "+Ye(e)+" found")];if(n.length&&e.length!==n.length)return[new ut(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new ut(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value};i.$version<7&&(s.function=n.function),"object"===Ye(n.value)&&(s=n.value);for(var u=[],c=0;c<e.length;c++)u=u.concat(a({array:e,arrayIndex:c,value:e[c],valueSpec:s,style:r,styleSpec:i,key:o+"["+c+"]"}));return u}function vn(t){var e=t.key,n=t.value,r=t.valueSpec,i=Ye(n);return"number"!==i?[new ut(e,n,"number expected, "+i+" found")]:"minimum"in r&&n<r.minimum?[new ut(e,n,n+" is less than the minimum value "+r.minimum)]:"maximum"in r&&n>r.maximum?[new ut(e,n,n+" is greater than the maximum value "+r.maximum)]:[]}function gn(t){var e,n,r,i=t.valueSpec,o=ft(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,u=!s,c="array"===Ye(t.value.stops)&&"array"===Ye(t.value.stops[0])&&"object"===Ye(t.value.stops[0][0]),l=pn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new ut(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(dn({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:f})),"array"===Ye(n)&&0===n.length&&e.push(new ut(t.key,n,"array must have at least one stop")),e},default:function(t){return Dn({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&l.push(new ut(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||l.push(new ut(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!He(t.valueSpec)&&l.push(new ut(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!Ze(t.valueSpec)?l.push(new ut(t.key,t.value,"property functions not supported")):s&&!Xe(t.valueSpec)&&l.push(new ut(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==t.value.property||l.push(new ut(t.key,t.value,'"property" property is required')),l;function f(t){var e=[],o=t.value,s=t.key;if("array"!==Ye(o))return[new ut(s,o,"array expected, "+Ye(o)+" found")];if(2!==o.length)return[new ut(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==Ye(o[0]))return[new ut(s,o,"object expected, "+Ye(o[0])+" found")];if(void 0===o[0].zoom)return[new ut(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new ut(s,o,"object stop key must have value")];if(r&&r>ft(o[0].zoom))return[new ut(s,o[0].zoom,"stop zoom values must appear in ascending order")];ft(o[0].zoom)!==r&&(r=ft(o[0].zoom),n=void 0,a={}),e=e.concat(pn({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:vn,value:h}}))}else e=e.concat(h({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return an(ht(o[1]))?e.concat([new ut(s+"[1]",o[1],"expressions are not allowed in function stops.")]):e.concat(Dn({key:s+"[1]",value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function h(t,r){var s=Ye(t.value),u=ft(t.value),c=null!==t.value?t.value:r;if(e){if(s!==e)return[new ut(t.key,c,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new ut(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var l="number expected, "+s+" found";return Ze(i)&&void 0===o&&(l+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ut(t.key,c,l)]}return"categorical"!==o||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==o&&"number"===s&&void 0!==n&&u<n?[new ut(t.key,c,"stop domain values must appear in ascending order")]:(n=u,"categorical"===o&&u in a?[new ut(t.key,c,"stop domain values must be unique")]:(a[u]=!0,[])):[new ut(t.key,c,"integer expected, found "+u)]}}function mn(t){var e=("property"===t.expressionContext?ln:sn)(ht(t.value),t.valueSpec);return"error"===e.result?e.value.map(function(e){return new ut(""+t.key+e.key,t.value,e.message)}):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new ut(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')]:"property"!==t.expressionContext||"layout"!==t.propertyType||Ht(e.value._styleExpression.expression)?"filter"!==t.expressionContext||Ht(e.value.expression)?[]:[new ut(t.key,t.value,'"feature-state" data expressions are not supported with filters.')]:[new ut(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')]}function yn(t){var e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(ft(n))&&i.push(new ut(e,n,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(r.values).indexOf(ft(n))&&i.push(new ut(e,n,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}function _n(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var r=n[e];if(!_n(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}fn.deserialize=function(t){return new fn(t._parameters,t._specification)},fn.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var bn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function xn(t){if(null==t)return function(){return!0};_n(t)||(t=En(t));var e=sn(t,bn);if("error"===e.result)throw new Error(e.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,n){return e.value.evaluate(t,n)}}function wn(t,e){return t<e?-1:t>e?1:0}function En(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?Sn(t[1],t[2],"=="):"!="===n?An(Sn(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?Sn(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(En))):"all"===n?["all"].concat(t.slice(1).map(En)):"none"===n?["all"].concat(t.slice(1).map(En).map(An)):"in"===n?Pn(t[1],t.slice(2)):"!in"===n?An(Pn(t[1],t.slice(2))):"has"===n?Tn(t[1]):"!has"!==n||An(Tn(t[1]))}function Sn(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function Pn(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(wn)]]:["filter-in-small",t,["literal",e]]}}function Tn(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function An(t){return["!",t]}function kn(t){return _n(ht(t.value))?mn(lt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,r=e.key;if("array"!==Ye(n))return[new ut(r,n,"array expected, "+Ye(n)+" found")];var i,o=e.styleSpec,a=[];if(n.length<1)return[new ut(r,n,"filter array must have at least 1 element")];switch(a=a.concat(yn({key:r+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),ft(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===ft(n[1])&&a.push(new ut(r,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new ut(r,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(i=Ye(n[1]))&&a.push(new ut(r+"[1]",n[1],"string expected, "+i+" found"));for(var s=2;s<n.length;s++)i=Ye(n[s]),"$type"===ft(n[1])?a=a.concat(yn({key:r+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new ut(r+"["+s+"]",n[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var u=1;u<n.length;u++)a=a.concat(t({key:r+"["+u+"]",value:n[u],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Ye(n[1]),2!==n.length?a.push(new ut(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new ut(r+"[1]",n[1],"string expected, "+i+" found"))}return a}(t)}function Cn(t,e){var n=t.key,r=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var u=a.match(/^(.*)-transition$/);if("paint"===e&&u&&s[u[1]]&&s[u[1]].transition)return Dn({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});var c,l=t.valueSpec||s[a];if(!l)return[new ut(n,o,'unknown property "'+a+'"')];if("string"===Ye(o)&&Ze(l)&&!l.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new ut(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var f=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&f.push(new ut(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Ke(ht(o))&&"identity"===ft(o.type)&&f.push(new ut(n,o,'"text-font" does not support identity functions'))),f.concat(Dn({key:t.key,value:o,valueSpec:l,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function On(t){return Cn(t,"paint")}function Mn(t){return Cn(t,"layout")}function In(t){var e=[],n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new ut(r,n,'either "type" or "ref" is required'));var a,s=ft(n.type),u=ft(n.ref);if(n.id)for(var c=ft(n.id),l=0;l<t.arrayIndex;l++){var f=i.layers[l];ft(f.id)===c&&e.push(new ut(r,n.id,'duplicate layer id "'+n.id+'", previously used at line '+f.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach(function(t){t in n&&e.push(new ut(r,n[t],'"'+t+'" is prohibited for ref layers'))}),i.layers.forEach(function(t){ft(t.id)===u&&(a=t)}),a?a.ref?e.push(new ut(r,n.ref,"ref cannot reference another ref layer")):s=ft(a.type):e.push(new ut(r,n.ref,'ref layer "'+u+'" not found'));else if("background"!==s)if(n.source){var h=i.sources&&i.sources[n.source],p=h&&ft(h.type);h?"vector"===p&&"raster"===s?e.push(new ut(r,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===p&&"raster"!==s?e.push(new ut(r,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==p||n["source-layer"]?"raster-dem"===p&&"hillshade"!==s?e.push(new ut(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===p&&h.lineMetrics||e.push(new ut(r,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new ut(r,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new ut(r,n.source,'source "'+n.source+'" not found'))}else e.push(new ut(r,n,'missing required property "source"'));return e=e.concat(pn({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Dn({key:r+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:kn,layout:function(t){return pn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return Mn(lt({layerType:s},t))}}})},paint:function(t){return pn({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return On(lt({layerType:s},t))}}})}}}))}function Ln(t){var e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new ut(n,e,'"type" is required')];var o=ft(e.type),a=[];switch(o){case"vector":case"raster":case"raster-dem":if(a=a.concat(pn({key:n,value:e,valueSpec:r["source_"+o.replace("-","_")],style:t.style,styleSpec:r})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&a.push(new ut(n+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return a;case"geojson":return pn({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r});case"video":return pn({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return pn({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return a.push(new ut(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),a;default:return yn({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function Rn(t){var e=t.value,n=t.styleSpec,r=n.light,i=t.style,o=[],a=Ye(e);if(void 0===e)return o;if("object"!==a)return o.concat([new ut("light",e,"object expected, "+a+" found")]);for(var s in e){var u=s.match(/^(.*)-transition$/);o=u&&r[u[1]]&&r[u[1]].transition?o.concat(Dn({key:s,value:e[s],valueSpec:n.transition,style:i,styleSpec:n})):r[s]?o.concat(Dn({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n})):o.concat([new ut(s,e[s],'unknown property "'+s+'"')])}return o}function jn(t){var e=t.value,n=t.key,r=Ye(e);return"string"!==r?[new ut(n,e,"string expected, "+r+" found")]:[]}var zn={"*":function(){return[]},array:dn,boolean:function(t){var e=t.value,n=t.key,r=Ye(e);return"boolean"!==r?[new ut(n,e,"boolean expected, "+r+" found")]:[]},number:vn,color:function(t){var e=t.key,n=t.value,r=Ye(n);return"string"!==r?[new ut(e,n,"color expected, "+r+" found")]:null===kt(n)?[new ut(e,n,'color expected, "'+n+'" found')]:[]},constants:ct,enum:yn,filter:kn,function:gn,layer:In,object:pn,source:Ln,light:Rn,string:jn,formatted:function(t){return 0===jn(t).length?[]:mn(t)}};function Dn(t){var e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&Ke(ft(e))?gn(t):n.expression&&an(ht(e))?mn(t):n.type&&zn[n.type]?zn[n.type](t):pn(lt({},t,{valueSpec:n.type?r[n.type]:n}))}function Fn(t){var e=t.value,n=t.key,r=jn(t);return r.length?r:(-1===e.indexOf("{fontstack}")&&r.push(new ut(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new ut(n,e,'"glyphs" url must include a "{range}" token')),r)}function Nn(t,e){e=e||st;var n=[];return n=n.concat(Dn({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:Fn,"*":function(){return[]}}})),t.constants&&(n=n.concat(ct({key:"constants",value:t.constants,style:t,styleSpec:e}))),Bn(n)}function Bn(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function Un(t){return function(){return Bn(t.apply(this,arguments))}}Nn.source=Un(Ln),Nn.light=Un(Rn),Nn.layer=Un(In),Nn.filter=Un(kn),Nn.paintProperty=Un(On),Nn.layoutProperty=Un(Mn);var Vn=Nn,Gn=Nn.light,qn=Nn.paintProperty,Wn=Nn.layoutProperty;function Zn(t,e){var n=!1;if(e&&e.length)for(var r=0,i=e;r<i.length;r+=1){var o=i[r];t.fire(new ot(new Error(o.message))),n=!0}return n}var Xn=Yn,Hn=3;function Yn(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],e=i[1],n=i[2],this.d=e+2*n;for(var o=0;o<this.d*this.d;o++){var a=i[Hn+o],s=i[Hn+o+1];r.push(a===s?null:i.subarray(a,s))}var u=i[Hn+r.length],c=i[Hn+r.length+1];this.keys=i.subarray(u,c),this.bboxes=i.subarray(c),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var l=0;l<this.d*this.d;l++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var f=n/e*t;this.min=-f,this.max=t+f}Yn.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Yn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Yn.prototype._insertCell=function(t,e,n,r,i,o){this.cells[i].push(o)},Yn.prototype.query=function(t,e,n,r){var i=this.min,o=this.max;if(t<=i&&e<=i&&o<=n&&o<=r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,r,this._queryCell,a,{}),a},Yn.prototype._queryCell=function(t,e,n,r,i,o,a){var s=this.cells[i];if(null!==s)for(var u=this.keys,c=this.bboxes,l=0;l<s.length;l++){var f=s[l];if(void 0===a[f]){var h=4*f;t<=c[h+2]&&e<=c[h+3]&&n>=c[h+0]&&r>=c[h+1]?(a[f]=!0,o.push(u[f])):a[f]=!1}}},Yn.prototype._forEachCell=function(t,e,n,r,i,o,a){for(var s=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),l=this._convertToCellCoord(r),f=s;f<=c;f++)for(var h=u;h<=l;h++){var p=this.d*h+f;if(i.call(this,t,e,n,r,p,o,a))return}},Yn.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Yn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Hn+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[Hn+a]=o,i.set(s,o),o+=s.length}return i[Hn+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[Hn+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var Kn=self.ImageData,Jn={};function Qn(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Jn[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var $n in Qn("Object",Object),Xn.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Xn.deserialize=function(t){return new Xn(t.buffer)},Qn("Grid",Xn),Qn("Color",Ct),Qn("Error",Error),Qn("StylePropertyFunction",fn),Qn("StyleExpression",on,{omit:["_evaluator"]}),Qn("ZoomDependentExpression",cn),Qn("ZoomConstantExpression",un),Qn("CompoundExpression",Wt,{omit:["_evaluate"]}),Ne)Ne[$n]._classRegistryKey||Qn("Expression_"+$n,Ne[$n]);function tr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Kn)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var r=[],i=0,o=t;i<o.length;i+=1){var a=o[i];r.push(tr(a,e))}return r}if("object"==typeof t){var s=t.constructor,u=s._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");var c=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var l in t)if(t.hasOwnProperty(l)&&!(Jn[u].omit.indexOf(l)>=0)){var f=t[l];c[l]=Jn[u].shallow.indexOf(l)>=0?f:tr(f,e)}t instanceof Error&&(c.message=t.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(c.$name=u),c}throw new Error("can't serialize object of type "+typeof t)}function er(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof Kn)return t;if(Array.isArray(t))return t.map(er);if("object"==typeof t){var e=t.$name||"Object",n=Jn[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var r=Object.create(n.prototype),i=0,o=Object.keys(t);i<o.length;i+=1){var a=o[i];if("$name"!==a){var s=t[a];r[a]=Jn[e].shallow.indexOf(a)>=0?s:er(s)}}return r}throw new Error("can't deserialize object of type "+typeof t)}var nr=function(){this.first=!0};nr.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var rr={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function ir(t){for(var e=0,n=t;e<n.length;e+=1)if(ar(n[e].charCodeAt(0)))return!0;return!1}function or(t){return!(rr.Arabic(t)||rr["Arabic Supplement"](t)||rr["Arabic Extended-A"](t)||rr["Arabic Presentation Forms-A"](t)||rr["Arabic Presentation Forms-B"](t))}function ar(t){return!(746!==t&&747!==t&&(t<4352||!(rr["Bopomofo Extended"](t)||rr.Bopomofo(t)||rr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||rr["CJK Compatibility Ideographs"](t)||rr["CJK Compatibility"](t)||rr["CJK Radicals Supplement"](t)||rr["CJK Strokes"](t)||!(!rr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||rr["CJK Unified Ideographs Extension A"](t)||rr["CJK Unified Ideographs"](t)||rr["Enclosed CJK Letters and Months"](t)||rr["Hangul Compatibility Jamo"](t)||rr["Hangul Jamo Extended-A"](t)||rr["Hangul Jamo Extended-B"](t)||rr["Hangul Jamo"](t)||rr["Hangul Syllables"](t)||rr.Hiragana(t)||rr["Ideographic Description Characters"](t)||rr.Kanbun(t)||rr["Kangxi Radicals"](t)||rr["Katakana Phonetic Extensions"](t)||rr.Katakana(t)&&12540!==t||!(!rr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!rr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||rr["Unified Canadian Aboriginal Syllabics"](t)||rr["Unified Canadian Aboriginal Syllabics Extended"](t)||rr["Vertical Forms"](t)||rr["Yijing Hexagram Symbols"](t)||rr["Yi Syllables"](t)||rr["Yi Radicals"](t))))}function sr(t){return!(ar(t)||function(t){return!!(rr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||rr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||rr["Letterlike Symbols"](t)||rr["Number Forms"](t)||rr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||rr["Control Pictures"](t)&&9251!==t||rr["Optical Character Recognition"](t)||rr["Enclosed Alphanumerics"](t)||rr["Geometric Shapes"](t)||rr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||rr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||rr["CJK Symbols and Punctuation"](t)||rr.Katakana(t)||rr["Private Use Area"](t)||rr["CJK Compatibility Forms"](t)||rr["Small Form Variants"](t)||rr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function ur(t,e){return!(!e&&(t>=1424&&t<=2303||rr["Arabic Presentation Forms-A"](t)||rr["Arabic Presentation Forms-B"](t))||t>=2304&&t<=3583||t>=3840&&t<=4255||rr.Khmer(t))}var cr,lr=!1,fr=null,hr=!1,pr=new at,dr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return hr||null!=dr.applyArabicShaping}},vr=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new nr,this.transition={})};vr.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,r=t;n<r.length;n+=1)if(!ur(r[n].charCodeAt(0),e))return!1;return!0}(t,dr.isLoaded())},vr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},vr.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var gr=function(t,e){this.property=t,this.value=e,this.expression=hn(void 0===e?t.specification.default:e,t.specification)};gr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},gr.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var mr=function(t){this.property=t,this.value=new gr(t,void 0)};mr.prototype.transitioned=function(t,e){return new _r(this.property,this.value,e,f({},t.transition,this.transition),t.now)},mr.prototype.untransitioned=function(){return new _r(this.property,this.value,null,{},0)};var yr=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};yr.prototype.getValue=function(t){return b(this._values[t].value.value)},yr.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new mr(this._values[t].property)),this._values[t].value=new gr(this._values[t].property,null===e?void 0:b(e))},yr.prototype.getTransition=function(t){return b(this._values[t].transition)},yr.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new mr(this._values[t].property)),this._values[t].transition=b(e)||void 0},yr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i);var o=this.getTransition(r);void 0!==o&&(t[r+"-transition"]=o)}return t},yr.prototype.transitioned=function(t,e){for(var n=new br(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},yr.prototype.untransitioned=function(){for(var t=new br(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e];t._values[r]=this._values[r].untransitioned()}return t};var _r=function(t,e,n,r,i){this.property=t,this.value=e,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)};_r.prototype.possiblyEvaluate=function(t){var e=t.now||0,n=this.value.possiblyEvaluate(t),r=this.prior;if(r){if(e>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(e<this.begin)return r.possiblyEvaluate(t);var i=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(r.possiblyEvaluate(t),n,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(i))}return n};var br=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};br.prototype.possiblyEvaluate=function(t){for(var e=new Er(this._properties),n=0,r=Object.keys(this._values);n<r.length;n+=1){var i=r[n];e._values[i]=this._values[i].possiblyEvaluate(t)}return e},br.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var n=e[t];if(this._values[n].prior)return!0}return!1};var xr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};xr.prototype.getValue=function(t){return b(this._values[t].value)},xr.prototype.setValue=function(t,e){this._values[t]=new gr(this._values[t].property,null===e?void 0:b(e))},xr.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i)}return t},xr.prototype.possiblyEvaluate=function(t){for(var e=new Er(this._properties),n=0,r=Object.keys(this._values);n<r.length;n+=1){var i=r[n];e._values[i]=this._values[i].possiblyEvaluate(t)}return e};var wr=function(t,e,n){this.property=t,this.value=e,this.parameters=n};wr.prototype.isConstant=function(){return"constant"===this.value.kind},wr.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},wr.prototype.evaluate=function(t,e){return this.property.evaluate(this.value,this.parameters,t,e)};var Er=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Er.prototype.get=function(t){return this._values[t]};var Sr=function(t){this.specification=t};Sr.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Sr.prototype.interpolate=function(t,e,n){var r=re[this.specification.type];return r?r(t,e,n):t};var Pr=function(t){this.specification=t};Pr.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new wr(this,{kind:"constant",value:t.expression.evaluate(e)},e):new wr(this,t.expression,e)},Pr.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new wr(this,{kind:"constant",value:void 0},t.parameters);var r=re[this.specification.type];return r?new wr(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t},Pr.prototype.evaluate=function(t,e,n,r){return"constant"===t.kind?t.value:t.evaluate(e,n,r)};var Tr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(t,e){if(void 0===t.value)return new wr(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var n=t.expression.evaluate(e),r=this._calculate(n,n,n,e);return new wr(this,{kind:"constant",value:r},e)}if("camera"===t.expression.kind){var i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new wr(this,{kind:"constant",value:i},e)}return new wr(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,r){if("source"===t.kind){var i=t.evaluate(e,n,r);return this._calculate(i,i,i,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value},e.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}(Pr),Ar=function(t){this.specification=t};Ar.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var n=t.expression.evaluate(e);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new vr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new vr(Math.floor(e.zoom),e)),t.expression.evaluate(new vr(Math.floor(e.zoom+1),e)),e)}},Ar.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},Ar.prototype.interpolate=function(t){return t};var kr=function(t){this.specification=t};kr.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},kr.prototype.interpolate=function(){return!1};var Cr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var n=t[e],r=this.defaultPropertyValues[e]=new gr(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new mr(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}};Qn("DataDrivenProperty",Pr),Qn("DataConstantProperty",Sr),Qn("CrossFadedDataDrivenProperty",Tr),Qn("CrossFadedProperty",Ar),Qn("ColorRampProperty",kr);var Or=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this.visibility="visible",this._featureFilter=function(){return!0},"custom"!==e.type&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new xr(n.layout)),n.paint)){for(var r in this._transitionablePaint=new yr(n.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){if(null!=e){var r="layers."+this.id+".layout."+t;if(this._validate(Wn,r,t,e,n))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return m(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(null!=e){var r="layers."+this.id+".paint."+t;if(this._validate(qn,r,t,e,n))return!1}if(m(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],o="cross-faded-data-driven"===i.property.specification["property-type"]&&!i.value.value&&e,a=this._transitionablePaint._values[t].value.isDataDriven();this._transitionablePaint.setValue(t,e);var s=this._transitionablePaint._values[t].value.isDataDriven();return this._handleSpecialPaintPropertyUpdate(t),s||a||o},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),_(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,n,r,i){return(!i||!1!==i.validate)&&Zn(this,t.call(Vn,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:st,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof wr&&Ze(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(at),Mr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ir=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Lr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Rr(t,e){void 0===e&&(e=1);var n=0,r=0;return{members:t.map(function(t){var i,o=(i=t.type,Mr[i].BYTES_PER_ELEMENT),a=n=jr(n,Math.max(e,o)),s=t.components||1;return r=Math.max(r,o),n+=o*s,{name:t.name,type:t.type,components:s,offset:a}}),size:jr(n,Math.max(r,e)),alignment:e}}function jr(t,e){return Math.ceil(t/e)*e}Lr.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Lr.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Lr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Lr.prototype.clear=function(){this.length=0},Lr.prototype.resize=function(t){this.reserve(t),this.length=t},Lr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Lr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t},e}(Lr);zr.prototype.bytesPerElement=4,Qn("StructArrayLayout2i4",zr);var Dr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t},e}(Lr);Dr.prototype.bytesPerElement=8,Qn("StructArrayLayout4i8",Dr);var Fr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(Lr);Fr.prototype.bytesPerElement=12,Qn("StructArrayLayout2i4i12",Fr);var Nr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,o,a,s)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=6*t,l=12*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.uint8[l+8]=o,this.uint8[l+9]=a,this.uint8[l+10]=s,this.uint8[l+11]=u,t},e}(Lr);Nr.prototype.bytesPerElement=12,Qn("StructArrayLayout4i4ub12",Nr);var Br=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,o,a,s)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=8*t;return this.uint16[c+0]=e,this.uint16[c+1]=n,this.uint16[c+2]=r,this.uint16[c+3]=i,this.uint16[c+4]=o,this.uint16[c+5]=a,this.uint16[c+6]=s,this.uint16[c+7]=u,t},e}(Lr);Br.prototype.bytesPerElement=16,Qn("StructArrayLayout8ui16",Br);var Ur=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,r,i,o,a,s)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=8*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.uint16[c+4]=o,this.uint16[c+5]=a,this.uint16[c+6]=s,this.uint16[c+7]=u,t},e}(Lr);Ur.prototype.bytesPerElement=16,Qn("StructArrayLayout4i4ui16",Ur);var Vr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t},e}(Lr);Vr.prototype.bytesPerElement=12,Qn("StructArrayLayout3f12",Vr);var Gr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var n=1*t;return this.uint32[n+0]=e,t},e}(Lr);Gr.prototype.bytesPerElement=4,Qn("StructArrayLayout1ul4",Gr);var qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l){var f=this.length;return this.resize(f+1),this.emplace(f,t,e,n,r,i,o,a,s,u,c,l)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f){var h=12*t,p=6*t;return this.int16[h+0]=e,this.int16[h+1]=n,this.int16[h+2]=r,this.int16[h+3]=i,this.int16[h+4]=o,this.int16[h+5]=a,this.uint32[p+3]=s,this.uint16[h+8]=u,this.uint16[h+9]=c,this.int16[h+10]=l,this.int16[h+11]=f,t},e}(Lr);qr.prototype.bytesPerElement=24,Qn("StructArrayLayout6i1ul2ui2i24",qr);var Wr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,r,i,o)},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(Lr);Wr.prototype.bytesPerElement=12,Qn("StructArrayLayout2i2i2i12",Wr);var Zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=4*t;return this.uint8[r+0]=e,this.uint8[r+1]=n,t},e}(Lr);Zr.prototype.bytesPerElement=4,Qn("StructArrayLayout2ub4",Zr);var Xr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p){var d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,r,i,o,a,s,u,c,l,f,h,p)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p,d){var v=20*t,g=10*t,m=40*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.uint16[v+2]=r,this.uint16[v+3]=i,this.uint32[g+2]=o,this.uint32[g+3]=a,this.uint32[g+4]=s,this.uint16[v+10]=u,this.uint16[v+11]=c,this.uint16[v+12]=l,this.float32[g+7]=f,this.float32[g+8]=h,this.uint8[m+36]=p,this.uint8[m+37]=d,t},e}(Lr);Xr.prototype.bytesPerElement=40,Qn("StructArrayLayout2i2ui3ul3ui2f2ub40",Xr);var Hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p){var d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,r,i,o,a,s,u,c,l,f,h,p)},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p,d){var v=16*t,g=8*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.int16[v+2]=r,this.int16[v+3]=i,this.uint16[v+4]=o,this.uint16[v+5]=a,this.uint16[v+6]=s,this.uint16[v+7]=u,this.uint16[v+8]=c,this.uint16[v+9]=l,this.uint16[v+10]=f,this.uint16[v+11]=h,this.uint16[v+12]=p,this.uint32[g+7]=d,t},e}(Lr);Hr.prototype.bytesPerElement=32,Qn("StructArrayLayout4i9ui1ul32",Hr);var Yr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var n=1*t;return this.float32[n+0]=e,t},e}(Lr);Yr.prototype.bytesPerElement=4,Qn("StructArrayLayout1f4",Yr);var Kr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t},e}(Lr);Kr.prototype.bytesPerElement=6,Qn("StructArrayLayout3i6",Kr);var Jr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=2*t,o=4*t;return this.uint32[i+0]=e,this.uint16[o+2]=n,this.uint16[o+3]=r,t},e}(Lr);Jr.prototype.bytesPerElement=8,Qn("StructArrayLayout1ul2ui8",Jr);var Qr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;return this.resize(r+1),this.emplace(r,t,e,n)},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t},e}(Lr);Qr.prototype.bytesPerElement=6,Qn("StructArrayLayout3ui6",Qr);var $r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t},e}(Lr);$r.prototype.bytesPerElement=4,Qn("StructArrayLayout2ui4",$r);var ti=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){var n=1*t;return this.uint16[n+0]=e,t},e}(Lr);ti.prototype.bytesPerElement=2,Qn("StructArrayLayout1ui2",ti);var ei=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;return this.resize(n+1),this.emplace(n,t,e)},e.prototype.emplace=function(t,e,n){var r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t},e}(Lr);ei.prototype.bytesPerElement=8,Qn("StructArrayLayout2f8",ei);var ni=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,n,r)},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t},e}(Lr);ni.prototype.bytesPerElement=16,Qn("StructArrayLayout4f16",ni);var ri=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.radius.get=function(){return this._structArray.int16[this._pos2+10]},n.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},n.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},n.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},n.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(Ir);ri.prototype.size=24;var ii=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new ri(this,t)},e}(qr);Qn("CollisionBoxArray",ii);var oi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,n),e}(Ir);oi.prototype.size=40;var ai=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new oi(this,t)},e}(Xr);Qn("PlacedSymbolArray",ai);var si=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},horizontalPlacedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.horizontalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.horizontalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+2]=t},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.verticalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+3]=t},n.key.get=function(){return this._structArray.uint16[this._pos2+4]},n.key.set=function(t){this._structArray.uint16[this._pos2+4]=t},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+5]},n.textBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+5]=t},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+6]},n.textBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+6]=t},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},n.iconBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+7]=t},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.iconBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.featureIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.numGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+10]},n.numGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+11]},n.numVerticalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+12]},n.numIconVertices.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+7]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+7]=t},Object.defineProperties(e.prototype,n),e}(Ir);si.prototype.size=32;var ui=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new si(this,t)},e}(Hr);Qn("SymbolInstanceArray",ui);var ci=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={offsetX:{configurable:!0}};return n.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},n.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,n),e}(Ir);ci.prototype.size=4;var li=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new ci(this,t)},e}(Yr);Qn("GlyphOffsetArray",li);var fi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return n.x.get=function(){return this._structArray.int16[this._pos2+0]},n.x.set=function(t){this._structArray.int16[this._pos2+0]=t},n.y.get=function(){return this._structArray.int16[this._pos2+1]},n.y.set=function(t){this._structArray.int16[this._pos2+1]=t},n.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},n.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,n),e}(Ir);fi.prototype.size=6;var hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new fi(this,t)},e}(Kr);Qn("SymbolLineVertexArray",hi);var pi=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,n),e}(Ir);pi.prototype.size=8;var di=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new pi(this,t)},e}(Jr);Qn("FeatureIndexArray",di);var vi=Rr([{name:"a_pos",components:2,type:"Int16"}],4),gi=vi.members,mi=(vi.size,vi.alignment,function(t){void 0===t&&(t=[]),this.segments=t});mi.prototype.prepareSegment=function(t,e,n){var r=this.segments[this.segments.length-1];return t>mi.MAX_VERTEX_ARRAY_LENGTH&&w("Max vertices per segment is "+mi.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!r||r.vertexLength+t>mi.MAX_VERTEX_ARRAY_LENGTH)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},this.segments.push(r)),r},mi.prototype.get=function(){return this.segments},mi.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var r in n.vaos)n.vaos[r].destroy()}},mi.simpleSegment=function(t,e,n,r){return new mi([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{}}])},mi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qn("SegmentVector",mi);var yi=function(t,e){return 256*(t=c(Math.floor(t),0,255))+c(Math.floor(e),0,255)},_i=function(){this.ids=[],this.positions=[],this.indexed=!1};function bi(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}_i.prototype.add=function(t,e,n,r){this.ids.push(t),this.positions.push(e,n,r)},_i.prototype.getPositions=function(t){for(var e=0,n=this.ids.length-1;e<n;){var r=e+n>>1;this.ids[r]>=t?n=r:e=r+1}for(var i=[];this.ids[e]===t;){var o=this.positions[3*e],a=this.positions[3*e+1],s=this.positions[3*e+2];i.push({index:o,start:a,end:s}),e++}return i},_i.serialize=function(t,e){var n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,n,r,i){if(!(r>=i)){for(var o=e[r+i>>1],a=r-1,s=i+1;;){do{a++}while(e[a]<o);do{s--}while(e[s]>o);if(a>=s)break;bi(e,a,s),bi(n,3*a,3*s),bi(n,3*a+1,3*s+1),bi(n,3*a+2,3*s+2)}t(e,n,r,s),t(e,n,s+1,i)}}(n,r,0,n.length-1),e.push(n.buffer,r.buffer),{ids:n,positions:r}},_i.deserialize=function(t){var e=new _i;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e},Qn("FeaturePositionMap",_i);var xi=function(t,e){this.gl=t.gl,this.location=e},wi=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(xi),Ei=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(xi),Si=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(xi),Pi=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(xi),Ti=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(xi),Ai=function(t){function e(e,n){t.call(this,e,n),this.current=Ct.transparent}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(xi),ki=new Float32Array(16),Ci=function(t){function e(e,n){t.call(this,e,n),this.current=ki}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(xi);function Oi(t){return[yi(255*t.r,255*t.g),yi(255*t.b,255*t.a)]}var Mi=function(t,e,n){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=n,this.maxValue=-1/0};Mi.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},Mi.prototype.setConstantPatternPositions=function(){},Mi.prototype.populatePaintArray=function(){},Mi.prototype.updatePaintArray=function(){},Mi.prototype.upload=function(){},Mi.prototype.destroy=function(){},Mi.prototype.setUniforms=function(t,e,n,r){e.set(r.constantOr(this.value))},Mi.prototype.getBinding=function(t,e){return"color"===this.type?new Ai(t,e):new Ei(t,e)},Mi.serialize=function(t){var e=t.value,n=t.names,r=t.type;return{value:tr(e),names:n,type:r}},Mi.deserialize=function(t){var e=t.value,n=t.names,r=t.type;return new Mi(er(e),n,r)};var Ii=function(t,e,n){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=n,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};Ii.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},Ii.prototype.populatePaintArray=function(){},Ii.prototype.updatePaintArray=function(){},Ii.prototype.upload=function(){},Ii.prototype.destroy=function(){},Ii.prototype.setConstantPatternPositions=function(t,e){this.patternPositions.patternTo=t.tlbr,this.patternPositions.patternFrom=e.tlbr},Ii.prototype.setUniforms=function(t,e,n,r,i){var o=this.patternPositions;"u_pattern_to"===i&&o.patternTo&&e.set(o.patternTo),"u_pattern_from"===i&&o.patternFrom&&e.set(o.patternFrom)},Ii.prototype.getBinding=function(t,e){return new Ti(t,e)};var Li=function(t,e,n,r){this.expression=t,this.names=e,this.type=n,this.uniformNames=this.names.map(function(t){return"a_"+t}),this.maxValue=-1/0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}}),this.paintVertexArray=new r};Li.prototype.defines=function(){return[]},Li.prototype.setConstantPatternPositions=function(){},Li.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,r=n.length;n.reserve(t);var i=this.expression.evaluate(new vr(0),e,{});if("color"===this.type)for(var o=Oi(i),a=r;a<t;a++)n.emplaceBack(o[0],o[1]);else{for(var s=r;s<t;s++)n.emplaceBack(i);this.maxValue=Math.max(this.maxValue,i)}},Li.prototype.updatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:0},n,r);if("color"===this.type)for(var a=Oi(o),s=t;s<e;s++)i.emplace(s,a[0],a[1]);else{for(var u=t;u<e;u++)i.emplace(u,o);this.maxValue=Math.max(this.maxValue,o)}},Li.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Li.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Li.prototype.setUniforms=function(t,e){e.set(0)},Li.prototype.getBinding=function(t,e){return new Ei(t,e)};var Ri=function(t,e,n,r,i,o){this.expression=t,this.names=e,this.uniformNames=this.names.map(function(t){return"a_"+t+"_t"}),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=-1/0;var a=o;this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}}),this.paintVertexArray=new a};Ri.prototype.defines=function(){return[]},Ri.prototype.setConstantPatternPositions=function(){},Ri.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,r=n.length;n.reserve(t);var i=this.expression.evaluate(new vr(this.zoom),e,{}),o=this.expression.evaluate(new vr(this.zoom+1),e,{});if("color"===this.type)for(var a=Oi(i),s=Oi(o),u=r;u<t;u++)n.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var c=r;c<t;c++)n.emplaceBack(i,o);this.maxValue=Math.max(this.maxValue,i,o)}},Ri.prototype.updatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},n,r),a=this.expression.evaluate({zoom:this.zoom+1},n,r);if("color"===this.type)for(var s=Oi(o),u=Oi(a),c=t;c<e;c++)i.emplace(c,s[0],s[1],u[0],u[1]);else{for(var l=t;l<e;l++)i.emplace(l,o,a);this.maxValue=Math.max(this.maxValue,o,a)}},Ri.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ri.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ri.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},Ri.prototype.setUniforms=function(t,e,n){e.set(this.interpolationFactor(n.zoom))},Ri.prototype.getBinding=function(t,e){return new Ei(t,e)};var ji=function(t,e,n,r,i,o,a){this.expression=t,this.names=e,this.type=n,this.uniformNames=this.names.map(function(t){return"a_"+t+"_t"}),this.useIntegerZoom=r,this.zoom=i,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};ji.prototype.defines=function(){return[]},ji.prototype.setConstantPatternPositions=function(){},ji.prototype.populatePaintArray=function(t,e,n){var r=this.zoomInPaintVertexArray,i=this.zoomOutPaintVertexArray,o=this.layerId,a=r.length;if(r.reserve(t),i.reserve(t),n&&e.patterns&&e.patterns[o]){var s=e.patterns[o],u=s.min,c=s.mid,l=s.max,f=n[u],h=n[c],p=n[l];if(!f||!h||!p)return;for(var d=a;d<t;d++)r.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1]),i.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1])}},ji.prototype.updatePaintArray=function(t,e,n,r,i){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this.layerId;if(i&&n.patterns&&n.patterns[s]){var u=n.patterns[s],c=u.min,l=u.mid,f=u.max,h=i[c],p=i[l],d=i[f];if(!h||!p||!d)return;for(var v=t;v<e;v++)o.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),a.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},ji.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ji.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ji.prototype.setUniforms=function(t,e){e.set(0)},ji.prototype.getBinding=function(t,e){return new Ei(t,e)};var zi=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new _i,this._bufferOffset=0};zi.createDynamic=function(t,e,n){var r=new zi,i=[];for(var o in t.paint._values)if(n(o)){var a=t.paint.get(o);if(a instanceof wr&&Ze(a.property.specification)){var s=Fi(o,t.type),u=a.property.specification.type,c=a.property.useIntegerZoom;if("cross-faded"===a.property.specification["property-type"]||"cross-faded-data-driven"===a.property.specification["property-type"])if("constant"===a.value.kind)r.binders[o]=new Ii(a.value.value,s,u),i.push("/u_"+o);else{var l=Ni(o,u,"source");r.binders[o]=new ji(a.value,s,u,c,e,l,t.id),i.push("/a_"+o)}else if("constant"===a.value.kind)r.binders[o]=new Mi(a.value.value,s,u),i.push("/u_"+o);else if("source"===a.value.kind){var f=Ni(o,u,"source");r.binders[o]=new Li(a.value,s,u,f),i.push("/a_"+o)}else{var h=Ni(o,u,"composite");r.binders[o]=new Ri(a.value,s,u,c,e,h),i.push("/z_"+o)}}}return r.cacheKey=i.sort().join(""),r},zi.prototype.populatePaintArrays=function(t,e,n,r){for(var i in this.binders)this.binders[i].populatePaintArray(t,e,r);void 0!==e.id&&this._featureMap.add(+e.id,n,this._bufferOffset,t),this._bufferOffset=t},zi.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders)this.binders[n].setConstantPatternPositions(t,e)},zi.prototype.updatePaintArrays=function(t,e,n,r){var i=!1;for(var o in t)for(var a=0,s=this._featureMap.getPositions(+o);a<s.length;a+=1){var u=s[a],c=e.feature(u.index);for(var l in this.binders){var f=this.binders[l];if(!(f instanceof Mi||f instanceof Ii)&&!0===f.expression.isStateDependent){var h=n.paint.get(l);f.expression=h.value,f.updatePaintArray(u.start,u.end,c,t[o],r),i=!0}}}return i},zi.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},zi.prototype.getPaintVertexBuffers=function(){return this._buffers},zi.prototype.getUniforms=function(t,e){var n={};for(var r in this.binders)for(var i=this.binders[r],o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];n[s]=i.getBinding(t,e[s])}return n},zi.prototype.setUniforms=function(t,e,n,r){for(var i in this.binders)for(var o=this.binders[i],a=0,s=o.uniformNames;a<s.length;a+=1){var u=s[a];o.setUniforms(t,e[u],r,n.get(i),u)}},zi.prototype.updatePatternPaintBuffers=function(t){var e=[];for(var n in this.binders){var r=this.binders[n];if(r instanceof ji){var i=2===t.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;i&&e.push(i)}else(r instanceof Li||r instanceof Ri)&&r.paintVertexBuffer&&e.push(r.paintVertexBuffer)}this._buffers=e},zi.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var n=[];for(var r in this.binders){var i=this.binders[r];(i instanceof Li||i instanceof Ri)&&i.paintVertexBuffer&&n.push(i.paintVertexBuffer)}this._buffers=n},zi.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var Di=function(t,e,n,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,o=e;i<o.length;i+=1){var a=o[i];this.programConfigurations[a.id]=zi.createDynamic(a,n,r),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1};function Fi(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Ni(t,e,n){var r={color:{source:ei,composite:ni},number:{source:Yr,composite:ei}},i=function(t){return{"line-pattern":{source:Br,composite:Br},"fill-pattern":{source:Br,composite:Br},"fill-extrusion-pattern":{source:Br,composite:Br}}[t]}(t);return i&&i[n]||r[e][n]}Di.prototype.populatePaintArrays=function(t,e,n,r){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,n,r);this.needsUpload=!0},Di.prototype.updatePaintArrays=function(t,e,n,r){for(var i=0,o=n;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,e,a,r)||this.needsUpload}},Di.prototype.get=function(t){return this.programConfigurations[t]},Di.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Di.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Qn("ConstantBinder",Mi),Qn("CrossFadedConstantBinder",Ii),Qn("SourceExpressionBinder",Li),Qn("CrossFadedCompositeBinder",ji),Qn("CompositeExpressionBinder",Ri),Qn("ProgramConfiguration",zi,{omit:["_buffers"]}),Qn("ProgramConfigurationSet",Di);var Bi=8192,Ui={min:-1*Math.pow(2,15),max:Math.pow(2,15)-1};function Vi(t){for(var e=Bi/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],o=0;o<i.length;o++){var a=i[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<Ui.min||a.x>Ui.max||a.y<Ui.min||a.y>Ui.max)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function Gi(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}var qi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new zr,this.indexArray=new Qr,this.segments=new mi,this.programConfigurations=new Di(gi,t.layers,t.zoom)};function Wi(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];if(to(i,e))return!0;if(Ji(e,i,n))return!0}return!1}function Zi(t,e){if(1===t.length&&1===t[0].length)return $i(e,t[0][0]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.length;i++)if($i(t,r[i]))return!0;for(var o=0;o<t.length;o++){for(var a=t[o],s=0;s<a.length;s++)if($i(e,a[s]))return!0;for(var u=0;u<e.length;u++)if(Yi(a,e[u]))return!0}return!1}function Xi(t,e,n){for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<t.length;o++){var a=t[o];if(a.length>=3)for(var s=0;s<i.length;s++)if(to(a,i[s]))return!0;if(Hi(a,i,n))return!0}return!1}function Hi(t,e,n){if(t.length>1){if(Yi(t,e))return!0;for(var r=0;r<e.length;r++)if(Ji(e[r],t,n))return!0}for(var i=0;i<t.length;i++)if(Ji(t[i],e,n))return!0;return!1}function Yi(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var r=t[n],i=t[n+1],o=0;o<e.length-1;o++)if(Ki(r,i,e[o],e[o+1]))return!0;return!1}function Ki(t,e,n,r){return E(t,n,r)!==E(e,n,r)&&E(t,e,n)!==E(t,e,r)}function Ji(t,e,n){var r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(var i=1;i<e.length;i++)if(Qi(t,e[i-1],e[i])<r)return!0;return!1}function Qi(t,e,n){var r=e.distSqr(n);if(0===r)return t.distSqr(e);var i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return i<0?t.distSqr(e):i>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(i)._add(e))}function $i(t,e){for(var n,r,i,o=!1,a=0;a<t.length;a++)for(var s=0,u=(n=t[a]).length-1;s<n.length;u=s++)r=n[s],i=n[u],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o);return o}function to(t,e){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function eo(t,e,n){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).binders[t].maxValue}function no(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ro(t,e,n,r,o){if(!e[0]&&!e[1])return t;var a=i.convert(e);"viewport"===n&&a._rotate(-r);for(var s=[],u=0;u<t.length;u++){for(var c=t[u],l=[],f=0;f<c.length;f++)l.push(c[f].sub(a._mult(o)));s.push(l)}return s}qi.prototype.populate=function(t,e){for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new vr(this.zoom),o)){var u=Vi(o);this.addFeature(o,u,a),e.featureIndex.insert(o,u,a,s,this.index)}}},qi.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},qi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},qi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qi.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},qi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qi.prototype.addFeature=function(t,e,n){for(var r=0,i=e;r<i.length;r+=1)for(var o=0,a=i[r];o<a.length;o+=1){var s=a[o],u=s.x,c=s.y;if(!(u<0||u>=Bi||c<0||c>=Bi)){var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),f=l.vertexLength;Gi(this.layoutVertexArray,u,c,-1,-1),Gi(this.layoutVertexArray,u,c,1,-1),Gi(this.layoutVertexArray,u,c,1,1),Gi(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),l.vertexLength+=4,l.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{})},Qn("CircleBucket",qi,{omit:["layers"]});var io={paint:new Cr({"circle-radius":new Pr(st.paint_circle["circle-radius"]),"circle-color":new Pr(st.paint_circle["circle-color"]),"circle-blur":new Pr(st.paint_circle["circle-blur"]),"circle-opacity":new Pr(st.paint_circle["circle-opacity"]),"circle-translate":new Sr(st.paint_circle["circle-translate"]),"circle-translate-anchor":new Sr(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Sr(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Sr(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pr(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pr(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pr(st.paint_circle["circle-stroke-opacity"])})},oo="undefined"!=typeof Float32Array?Float32Array:Array;function ao(){var t=new oo(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function so(){var t=new oo(3);return t[0]=0,t[1]=0,t[2]=0,t}function uo(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function co(t,e,n){var r=new oo(3);return r[0]=t,r[1]=e,r[2]=n,r}Math.PI;var lo,fo=uo,ho=(lo=so(),function(t,e,n,r,i,o){var a,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,a=n;a<s;a+=e)lo[0]=t[a],lo[1]=t[a+1],lo[2]=t[a+2],i(lo,lo,o),t[a]=lo[0],t[a+1]=lo[1],t[a+2]=lo[2];return t});function po(){var t=new oo(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function vo(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t}function go(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}var mo=function(){var t=po();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function yo(){var t=new oo(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}so(),co(1,0,0),co(0,1,0),yo(),yo(),ao(),function(){var t;(t=new oo(2))[0]=0,t[1]=0}();var _o=function(t){function e(e){t.call(this,e,io)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new qi(t)},e.prototype.queryRadius=function(t){var e=t;return eo("circle-radius",this,e)+eo("circle-stroke-width",this,e)+no(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a,s){for(var u=ro(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),l="map"===this.paint.get("circle-pitch-alignment"),f=l?u:function(t,e,n){return u.map(function(t){return t.map(function(t){return bo(t,e,n)})})}(0,s,o),h=l?c*a:c,p=0,d=r;p<d.length;p+=1)for(var v=0,g=d[p];v<g.length;v+=1){var m=g[v],y=l?m:bo(m,s,o),_=h,b=go([],[m.x,m.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),Wi(f,y,_))return!0}return!1},e}(Or);function bo(t,e,n){var r=go([],[t.x,t.y,0,1],e);return new i((r[0]/r[3]+1)*n.width*.5,(r[1]/r[3]+1)*n.height*.5)}var xo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(qi);function wo(t,e,n,r){var i=e.width,o=e.height;if(r){if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return t.width=i,t.height=o,t.data=r,t}function Eo(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var o=wo({},{width:r,height:i},n);So(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=o.data}}function So(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,u=0;u<i.height;u++)for(var c=((n.y+u)*t.width+n.x)*o,l=((r.y+u)*e.width+r.x)*o,f=0;f<i.width*o;f++)s[l+f]=a[c+f];return e}Qn("HeatmapBucket",xo,{omit:["layers"]});var Po=function(t,e){wo(this,t,1,e)};Po.prototype.resize=function(t){Eo(this,t,1)},Po.prototype.clone=function(){return new Po({width:this.width,height:this.height},new Uint8Array(this.data))},Po.copy=function(t,e,n,r,i){So(t,e,n,r,i,1)};var To=function(t,e){wo(this,t,4,e)};To.prototype.resize=function(t){Eo(this,t,4)},To.prototype.clone=function(){return new To({width:this.width,height:this.height},new Uint8Array(this.data))},To.copy=function(t,e,n,r,i){So(t,e,n,r,i,4)},Qn("AlphaImage",Po),Qn("RGBAImage",To);var Ao={paint:new Cr({"heatmap-radius":new Pr(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pr(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Sr(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new kr(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Sr(st.paint_heatmap["heatmap-opacity"])})};function ko(t,e){for(var n=new Uint8Array(1024),r={},i=0,o=0;i<256;i++,o+=4){r[e]=i/255;var a=t.evaluate(r);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new To({width:256,height:1},n)}var Co=function(t){function e(e){t.call(this,e,Ao),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new xo(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=ko(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(Or),Oo={paint:new Cr({"hillshade-illumination-direction":new Sr(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Sr(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Sr(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Sr(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Sr(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Sr(st.paint_hillshade["hillshade-accent-color"])})},Mo=function(t){function e(e){t.call(this,e,Oo)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(Or),Io=Rr([{name:"a_pos",components:2,type:"Int16"}],4),Lo=Io.members,Ro=(Io.size,Io.alignment,zo),jo=zo;function zo(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,f=l?e[0]*n:t.length,h=Do(t,0,f,n,!0),p=[];if(!h)return p;if(l&&(h=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=Do(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(Xo(a));for(s.sort(qo),i=0;i<s.length;i++)Wo(s[i],n),n=Fo(n,n.next);return n}(t,e,h,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<f;d+=n)(s=t[d])<r&&(r=s),(u=t[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return No(h,p,n,r,i,c),p}function Do(t,e,n,r,i){var o,a;if(i===ia(t,e,n,r)>0)for(o=e;o<n;o+=r)a=ea(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=ea(o,t[o],t[o+1],a);return a&&Jo(a,a.next)&&(na(a),a=a.next),a}function Fo(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Jo(r,r.next)&&0!==Ko(r.prev,r,r.next))r=r.next;else{if(na(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function No(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=Zo(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?Uo(t,r,i,o):Bo(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),na(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?No(t=Vo(t,e,n),e,n,r,i,o,2):2===a&&Go(t,e,n,r,i,o):No(Fo(t),e,n,r,i,o,1);break}}}function Bo(t){var e=t.prev,n=t,r=t.next;if(Ko(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Ho(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Ko(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Uo(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Ko(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=Zo(s,u,e,n,r),h=Zo(c,l,e,n,r),p=t.prevZ,d=t.nextZ;p&&p.z>=f&&d&&d.z<=h;){if(p!==t.prev&&p!==t.next&&Ho(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ko(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&Ho(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Ko(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&Ho(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ko(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==t.prev&&d!==t.next&&Ho(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&Ko(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Vo(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Jo(i,o)&&Qo(i,r,r.next,o)&&$o(i,o)&&$o(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),na(r),na(r.next),r=t=o),r=r.next}while(r!==t);return r}function Go(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Yo(a,s)){var u=ta(a,s);return a=Fo(a,a.next),u=Fo(u,u.next),No(a,e,n,r,i,o),void No(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function qo(t,e){return t.x-e.x}function Wo(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,f=n.y,h=1/0;for(r=n.next;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&Ho(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<h||u===h&&r.x>n.x)&&$o(r,t)&&(n=r,h=u),r=r.next;return n}(t,e)){var n=ta(e,t);Fo(n,n.next)}}function Zo(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Xo(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Ho(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Yo(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Qo(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&$o(t,e)&&$o(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function Ko(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Jo(t,e){return t.x===e.x&&t.y===e.y}function Qo(t,e,n,r){return!!(Jo(t,e)&&Jo(n,r)||Jo(t,r)&&Jo(n,e))||Ko(t,e,n)>0!=Ko(t,e,r)>0&&Ko(n,r,t)>0!=Ko(n,r,e)>0}function $o(t,e){return Ko(t.prev,t,t.next)<0?Ko(t,e,t.next)>=0&&Ko(t,t.prev,e)>=0:Ko(t,e,t.prev)<0||Ko(t,t.next,e)<0}function ta(t,e){var n=new ra(t.i,t.x,t.y),r=new ra(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ea(t,e,n,r){var i=new ra(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function na(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ra(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ia(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}zo.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(ia(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(ia(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;f+=Math.abs((t[h]-t[d])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[d+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},zo.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n},Ro.default=jo;var oa=sa,aa=sa;function sa(t,e,n,r,i){!function t(e,n,r,i,o){for(;i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*c/a+l)),Math.min(i,Math.floor(n+(a-s)*c/a+l)),o)}var f=e[n],h=r,p=i;for(ua(e,r,n),o(e[i],f)>0&&ua(e,r,i);h<p;){for(ua(e,h,p),h++,p--;o(e[h],f)<0;)h++;for(;o(e[p],f)>0;)p--}0===o(e[r],f)?ua(e,r,p):ua(e,++p,i),p<=n&&(r=p+1),n<=p&&(i=p-1)}}(t,e,n||0,r||t.length-1,i||ca)}function ua(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function ca(t,e){return t<e?-1:t>e?1:0}function la(t,e){var n=t.length;if(n<=1)return[t];for(var r,i,o=[],a=0;a<n;a++){var s=S(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(r&&o.push(r),r=[t[a]]):r.push(t[a]))}if(r&&o.push(r),e>1)for(var u=0;u<o.length;u++)o[u].length<=e||(oa(o[u],e,1,o[u].length-1,fa),o[u]=o[u].slice(0,e));return o}function fa(t,e){return e.area-t.area}function ha(t,e,n){for(var r=n.patternDependencies,i=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,r[u.to]=!0,r[u.from]=!0)}return i}function pa(t,e,n,r,i){for(var o=i.patternDependencies,a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.paint.get(t+"-pattern").value;if("constant"!==c.kind){var l=c.evaluate({zoom:r-1},n,{}),f=c.evaluate({zoom:r},n,{}),h=c.evaluate({zoom:r+1},n,{});o[l]=!0,o[f]=!0,o[h]=!0,n.patterns[u.id]={min:l,mid:f,max:h}}}return n}oa.default=aa;var da=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new zr,this.indexArray=new Qr,this.indexArray2=new $r,this.programConfigurations=new Di(Lo,t.layers,t.zoom),this.segments=new mi,this.segments2=new mi};da.prototype.populate=function(t,e){this.features=[],this.hasPattern=ha("fill",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new vr(this.zoom),o)){var u=Vi(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(pa("fill",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index)}}},da.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},da.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},da.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},da.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},da.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Lo),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},da.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},da.prototype.addFeature=function(t,e,n,r){for(var i=0,o=la(e,500);i<o.length;i+=1){for(var a=o[i],s=0,u=0,c=a;u<c.length;u+=1)s+=c[u].length;for(var l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),f=l.vertexLength,h=[],p=[],d=0,v=a;d<v.length;d+=1){var g=v[d];if(0!==g.length){g!==a[0]&&p.push(h.length/2);var m=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),y=m.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(y+g.length-1,y),h.push(g[0].x),h.push(g[0].y);for(var _=1;_<g.length;_++)this.layoutVertexArray.emplaceBack(g[_].x,g[_].y),this.indexArray2.emplaceBack(y+_-1,y+_),h.push(g[_].x),h.push(g[_].y);m.vertexLength+=g.length,m.primitiveLength+=g.length}}for(var b=Ro(h,p),x=0;x<b.length;x+=3)this.indexArray.emplaceBack(f+b[x],f+b[x+1],f+b[x+2]);l.vertexLength+=s,l.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r)},Qn("FillBucket",da,{omit:["layers","features"]});var va={paint:new Cr({"fill-antialias":new Sr(st.paint_fill["fill-antialias"]),"fill-opacity":new Pr(st.paint_fill["fill-opacity"]),"fill-color":new Pr(st.paint_fill["fill-color"]),"fill-outline-color":new Pr(st.paint_fill["fill-outline-color"]),"fill-translate":new Sr(st.paint_fill["fill-translate"]),"fill-translate-anchor":new Sr(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tr(st.paint_fill["fill-pattern"])})},ga=function(t){function e(e){t.call(this,e,va)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new da(t)},e.prototype.queryRadius=function(){return no(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a){return Zi(ro(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)},e}(Or),ma=Rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ya=ma.members,_a=(ma.size,ma.alignment,Math.pow(2,13));function ba(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,2*Math.floor(r*_a)+a,i*_a*2,o*_a*2,Math.round(s))}var xa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Fr,this.indexArray=new Qr,this.programConfigurations=new Di(ya,t.layers,t.zoom),this.segments=new mi};function wa(t,e){return t.x===e.x&&(t.x<0||t.x>Bi)||t.y===e.y&&(t.y<0||t.y>Bi)}function Ea(t){return t.every(function(t){return t.x<0})||t.every(function(t){return t.x>Bi})||t.every(function(t){return t.y<0})||t.every(function(t){return t.y>Bi})}xa.prototype.populate=function(t,e){this.features=[],this.hasPattern=ha("fill-extrusion",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new vr(this.zoom),o)){var u=Vi(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(pa("fill-extrusion",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index)}}},xa.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},xa.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},xa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xa.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ya),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},xa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xa.prototype.addFeature=function(t,e,n,r){for(var i=0,o=la(e,500);i<o.length;i+=1){for(var a=o[i],s=0,u=0,c=a;u<c.length;u+=1)s+=c[u].length;for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),f=0,h=a;f<h.length;f+=1){var p=h[f];if(0!==p.length&&!Ea(p))for(var d=0,v=0;v<p.length;v++){var g=p[v];if(v>=1){var m=p[v-1];if(!wa(g,m)){l.vertexLength+4>mi.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var y=g.sub(m)._perp()._unit(),_=m.dist(g);d+_>32768&&(d=0),ba(this.layoutVertexArray,g.x,g.y,y.x,y.y,0,0,d),ba(this.layoutVertexArray,g.x,g.y,y.x,y.y,0,1,d),d+=_,ba(this.layoutVertexArray,m.x,m.y,y.x,y.y,0,0,d),ba(this.layoutVertexArray,m.x,m.y,y.x,y.y,0,1,d);var b=l.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),l.vertexLength+=4,l.primitiveLength+=2}}}}l.vertexLength+s>mi.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray));for(var x=[],w=[],E=l.vertexLength,S=0,P=a;S<P.length;S+=1){var T=P[S];if(0!==T.length){T!==a[0]&&w.push(x.length/2);for(var A=0;A<T.length;A++){var k=T[A];ba(this.layoutVertexArray,k.x,k.y,0,0,1,1,0),x.push(k.x),x.push(k.y)}}}for(var C=Ro(x,w),O=0;O<C.length;O+=3)this.indexArray.emplaceBack(E+C[O],E+C[O+2],E+C[O+1]);l.primitiveLength+=C.length/3,l.vertexLength+=s}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r)},Qn("FillExtrusionBucket",xa,{omit:["layers","features"]});var Sa={paint:new Cr({"fill-extrusion-opacity":new Sr(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pr(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Sr(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Sr(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tr(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pr(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pr(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Sr(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Pa=function(t){function e(e){t.call(this,e,Sa)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new xa(t)},e.prototype.queryRadius=function(){return no(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a){return Zi(ro(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),r)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(Or),Ta=Rr([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),Aa=Ta.members,ka=(Ta.size,Ta.alignment,Ca);function Ca(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(Oa,this,e)}function Oa(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function Ma(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}Ca.types=["Unknown","Point","LineString","Polygon"],Ca.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,o=0,a=0,s=0,u=[];t.pos<n;){if(o<=0){var c=t.readVarint();r=7&c,o=c>>3}if(o--,1===r||2===r)a+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&u.push(e),e=[]),e.push(new i(a,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&u.push(e),u},Ca.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},Ca.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,u=this.loadGeometry(),c=Ca.types[this.type];function l(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+s)/o;t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(r=0;r<u.length;r++)f[r]=u[r][0];l(u=f);break;case 2:for(r=0;r<u.length;r++)l(u[r]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=Ma(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(u),r=0;r<u.length;r++)for(i=0;i<u[r].length;i++)l(u[r][i])}1===u.length?u=u[0]:c="Multi"+c;var h={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(h.id=this.id),h};var Ia=La;function La(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Ra,this,e),this.length=this._features.length}function Ra(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}function ja(t,e,n){if(3===t){var r=new Ia(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}La.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ka(this._pbf,e,this.extent,this._keys,this._values)};var za={VectorTile:function(t,e){this.layers=t.readFields(ja,{},e)},VectorTileFeature:ka,VectorTileLayer:Ia},Da=za.VectorTileFeature.types,Fa=63,Na=Math.cos(Math.PI/180*37.5),Ba=.5,Ua=Math.pow(2,14)/Ba;function Va(t,e,n,r,i,o,a){t.emplaceBack(e.x,e.y,r?1:0,i?1:-1,Math.round(Fa*n.x)+128,Math.round(Fa*n.y)+128,1+(0===o?0:o<0?-1:1)|(a*Ba&63)<<2,a*Ba>>6)}var Ga=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.features=[],this.hasPattern=!1,this.layoutVertexArray=new Nr,this.indexArray=new Qr,this.programConfigurations=new Di(Aa,t.layers,t.zoom),this.segments=new mi};function qa(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(Ua-1)}Ga.prototype.populate=function(t,e){this.features=[],this.hasPattern=ha("line",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new vr(this.zoom),o)){var u=Vi(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(pa("line",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index)}}},Ga.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Ga.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},Ga.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ga.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ga.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Aa),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Ga.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ga.prototype.addFeature=function(t,e,n,r){for(var i=this.layers[0].layout,o=i.get("line-join").evaluate(t,{}),a=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),c=0,l=e;c<l.length;c+=1){var f=l[c];this.addLine(f,t,o,a,s,u,n,r)}},Ga.prototype.addLine=function(t,e,n,r,i,o,a,s){var u=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(u={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var c="Polygon"===Da[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var f=0;f<l-1&&t[f].equals(t[f+1]);)f++;if(!(l<(c?3:2))){u&&(u.tileTotal=function(t,e,n){for(var r,i,o=0,a=f;a<n-1;a++)r=t[a],i=t[a+1],o+=r.dist(i);return o}(t,0,l)),"bevel"===n&&(i=1.05);var h=Bi/(512*this.overscaling)*15,p=t[f],d=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var v,g,m,y=r,_=c?"butt":r,b=!0,x=void 0,w=void 0,E=void 0,S=void 0;this.e1=this.e2=this.e3=-1,c&&(v=t[l-2],S=p.sub(v)._unit()._perp());for(var P=f;P<l;P++)if(!(w=c&&P===l-1?t[f+1]:t[P+1])||!t[P].equals(w)){S&&(E=S),v&&(x=v),v=t[P],S=w?w.sub(v)._unit()._perp():E;var T=(E=E||S).add(S);0===T.x&&0===T.y||T._unit();var A=T.x*S.x+T.y*S.y,k=0!==A?1/A:1/0,C=A<Na&&x&&w;if(C&&P>f){var O=v.dist(x);if(O>2*h){var M=v.sub(v.sub(x)._mult(h/O)._round());this.distance+=M.dist(x),this.addCurrentVertex(M,this.distance,E.mult(1),0,0,!1,d,u),x=M}}var I=x&&w,L=I?n:w?y:_;if(I&&"round"===L&&(k<o?L="miter":k<=2&&(L="fakeround")),"miter"===L&&k>i&&(L="bevel"),"bevel"===L&&(k>2&&(L="flipbevel"),k<i&&(L="miter")),x&&(this.distance+=v.dist(x)),"miter"===L)T._mult(k),this.addCurrentVertex(v,this.distance,T,0,0,!1,d,u);else if("flipbevel"===L){if(k>100)T=S.clone().mult(-1);else{var R=E.x*S.y-E.y*S.x>0?-1:1,j=k*E.add(S).mag()/E.sub(S).mag();T._perp()._mult(j*R)}this.addCurrentVertex(v,this.distance,T,0,0,!1,d,u),this.addCurrentVertex(v,this.distance,T.mult(-1),0,0,!1,d,u)}else if("bevel"===L||"fakeround"===L){var z=E.x*S.y-E.y*S.x>0,D=-Math.sqrt(k*k-1);if(z?(m=0,g=D):(g=0,m=D),b||this.addCurrentVertex(v,this.distance,E,g,m,!1,d,u),"fakeround"===L){for(var F=Math.floor(8*(.5-(A-.5))),N=void 0,B=0;B<F;B++)N=S.mult((B+1)/(F+1))._add(E)._unit(),this.addPieSliceVertex(v,this.distance,N,z,d,u);this.addPieSliceVertex(v,this.distance,T,z,d,u);for(var U=F-1;U>=0;U--)N=E.mult((U+1)/(F+1))._add(S)._unit(),this.addPieSliceVertex(v,this.distance,N,z,d,u)}w&&this.addCurrentVertex(v,this.distance,S,-g,-m,!1,d,u)}else"butt"===L?(b||this.addCurrentVertex(v,this.distance,E,0,0,!1,d,u),w&&this.addCurrentVertex(v,this.distance,S,0,0,!1,d,u)):"square"===L?(b||(this.addCurrentVertex(v,this.distance,E,1,1,!1,d,u),this.e1=this.e2=-1),w&&this.addCurrentVertex(v,this.distance,S,-1,-1,!1,d,u)):"round"===L&&(b||(this.addCurrentVertex(v,this.distance,E,0,0,!1,d,u),this.addCurrentVertex(v,this.distance,E,1,1,!0,d,u),this.e1=this.e2=-1),w&&(this.addCurrentVertex(v,this.distance,S,-1,-1,!0,d,u),this.addCurrentVertex(v,this.distance,S,0,0,!1,d,u)));if(C&&P<l-1){var V=v.dist(w);if(V>2*h){var G=v.add(w.sub(v)._mult(h/V)._round());this.distance+=G.dist(v),this.addCurrentVertex(G,this.distance,S.mult(1),0,0,!1,d,u),v=G}}b=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,s)}},Ga.prototype.addCurrentVertex=function(t,e,n,r,i,o,a,s){var u,c=this.layoutVertexArray,l=this.indexArray;s&&(e=qa(e,s)),u=n.clone(),r&&u._sub(n.perp()._mult(r)),Va(c,t,u,o,!1,r,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(l.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,u=n.mult(-1),i&&u._sub(n.perp()._mult(i)),Va(c,t,u,o,!0,-i,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(l.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>Ua/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,n,r,i,o,a))},Ga.prototype.addPieSliceVertex=function(t,e,n,r,i,o){n=n.mult(r?-1:1);var a=this.layoutVertexArray,s=this.indexArray;o&&(e=qa(e,o)),Va(a,t,n,!1,r,0,e),this.e3=i.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),i.primitiveLength++),r?this.e2=this.e3:this.e1=this.e3},Qn("LineBucket",Ga,{omit:["layers","features"]});var Wa=new Cr({"line-cap":new Sr(st.layout_line["line-cap"]),"line-join":new Pr(st.layout_line["line-join"]),"line-miter-limit":new Sr(st.layout_line["line-miter-limit"]),"line-round-limit":new Sr(st.layout_line["line-round-limit"])}),Za={paint:new Cr({"line-opacity":new Pr(st.paint_line["line-opacity"]),"line-color":new Pr(st.paint_line["line-color"]),"line-translate":new Sr(st.paint_line["line-translate"]),"line-translate-anchor":new Sr(st.paint_line["line-translate-anchor"]),"line-width":new Pr(st.paint_line["line-width"]),"line-gap-width":new Pr(st.paint_line["line-gap-width"]),"line-offset":new Pr(st.paint_line["line-offset"]),"line-blur":new Pr(st.paint_line["line-blur"]),"line-dasharray":new Ar(st.paint_line["line-dasharray"]),"line-pattern":new Tr(st.paint_line["line-pattern"]),"line-gradient":new kr(st.paint_line["line-gradient"])}),layout:Wa},Xa=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new vr(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,r,i){return n=f({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,r,i)},e}(Pr))(Za.paint.properties["line-width"].specification);Xa.useIntegerZoom=!0;var Ha=function(t){function e(e){t.call(this,e,Za)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=ko(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=Xa.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new Ga(t)},e.prototype.queryRadius=function(t){var e=t,n=Ya(eo("line-width",this,e),eo("line-gap-width",this,e)),r=eo("line-offset",this,e);return n/2+Math.abs(r)+no(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,o,a,s){var u=ro(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*Ya(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(r=function(t,e){for(var n=[],r=new i(0,0),o=0;o<t.length;o++){for(var a=t[o],s=[],u=0;u<a.length;u++){var c=a[u-1],l=a[u],f=a[u+1],h=0===u?r:l.sub(c)._unit()._perp(),p=u===a.length-1?r:f.sub(l)._unit()._perp(),d=h._add(p)._unit(),v=d.x*p.x+d.y*p.y;d._mult(1/v),s.push(d._mult(e)._add(l))}n.push(s)}return n}(r,l*s)),Xi(u,r,c)},e}(Or);function Ya(t,e){return e>0?e+2*t:t}var Ka=Rr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Ja=Rr([{name:"a_projected_pos",components:3,type:"Float32"}],4),Qa=(Rr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Rr([{name:"a_placed",components:2,type:"Uint8"}],4)),$a=(Rr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),Rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),ts=Rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function es(t,e,n){return t.sections.forEach(function(t){t.text=function(t,e,n){var r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),dr.applyArabicShaping&&(t=dr.applyArabicShaping(t)),t}(t.text,e,n)}),t}Rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),Rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"horizontalPlacedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"}]),Rr([{type:"Float32",name:"offsetX"}]),Rr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ns={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},rs=function(t){function e(e,n,r,i){t.call(this,e,n),this.angle=r,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(i);function is(t,e){var n=e.expression;if("constant"===n.kind)return{functionType:"constant",layoutSize:n.evaluate(new vr(t+1))};if("source"===n.kind)return{functionType:"source"};for(var r=n.zoomStops,i=0;i<r.length&&r[i]<=t;)i++;for(var o=i=Math.max(0,i-1);o<r.length&&r[o]<t+1;)o++;o=Math.min(r.length-1,o);var a={min:r[i],max:r[o]};return"composite"===n.kind?{functionType:"composite",zoomRange:a,propertyValue:e.value}:{functionType:"camera",layoutSize:n.evaluate(new vr(t+1)),zoomRange:a,sizeRange:{min:n.evaluate(new vr(a.min)),max:n.evaluate(new vr(a.max))},propertyValue:e.value}}Qn("Anchor",rs);var os=za.VectorTileFeature.types,as=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ss(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),o,a,s?s[0]:0,s?s[1]:0)}function us(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}var cs=function(t){this.layoutVertexArray=new Ur,this.indexArray=new Qr,this.programConfigurations=t,this.segments=new mi,this.dynamicLayoutVertexArray=new Vr,this.opacityVertexArray=new Gr,this.placedSymbolArray=new ai};cs.prototype.upload=function(t,e,n,r){n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ka.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ja.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,as,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t)},cs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Qn("SymbolBuffers",cs);var ls=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new mi,this.collisionVertexArray=new Zr};ls.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Qa.members,!0)},ls.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Qn("CollisionBuffers",ls);var fs=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=is(this.zoom,e["text-size"]),this.iconSizeData=is(this.zoom,e["icon-size"]);var n=this.layers[0].layout,r="viewport-y"===n.get("symbol-z-order");this.sortFeaturesByY=r&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),this.sourceID=t.sourceID};fs.prototype.createArrays=function(){this.text=new cs(new Di(Ka.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new cs(new Di(Ka.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new ls(Wr,$a.members,$r),this.collisionCircle=new ls(Wr,ts.members,Qr),this.glyphOffsetArray=new li,this.lineVertexArray=new hi,this.symbolInstances=new ui},fs.prototype.calculateGlyphDependencies=function(t,e,n,r){for(var i=0;i<t.length;i++)if(e[t.charCodeAt(i)]=!0,n&&r){var o=ns[t.charAt(i)];o&&(e[o.charCodeAt(0)]=!0)}},fs.prototype.populate=function(t,e){var n=this.layers[0],r=n.layout,i=r.get("text-font"),o=r.get("text-field"),a=r.get("icon-image"),s=("constant"!==o.value.kind||o.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),u="constant"!==a.value.kind||a.value.value&&a.value.value.length>0;if(this.features=[],s||u){for(var c=e.iconDependencies,l=e.glyphDependencies,f=new vr(this.zoom),h=0,p=t;h<p.length;h+=1){var d=p[h],v=d.feature,g=d.index,m=d.sourceLayerIndex;if(n._featureFilter(f,v)){var y=void 0;if(s){var _=n.getValueAndResolveTokens("text-field",v);y=es(_ instanceof It?_:It.fromString(_),n,v)}var b=void 0;if(u&&(b=n.getValueAndResolveTokens("icon-image",v)),y||b){var x={text:y,icon:b,index:g,sourceLayerIndex:m,geometry:Vi(v),properties:v.properties,type:os[v.type]};if(void 0!==v.id&&(x.id=v.id),this.features.push(x),b&&(c[b]=!0),y)for(var w=i.evaluate(v,{}).join(","),E="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),S=0,P=y.sections;S<P.length;S+=1){var T=P[S],A=ir(y.toString()),k=T.fontStack||w,C=l[k]=l[k]||{};this.calculateGlyphDependencies(T.text,C,E,A)}}}}"line"===r.get("symbol-placement")&&(this.features=function(t){var e={},n={},r=[],i=0;function o(e){r.push(t[e]),i++}function a(t,e,i){var o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(t,n,i){var o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function u(t,e,n){var r=n?e[0][e[0].length-1]:e[0][0];return t+":"+r.x+":"+r.y}for(var c=0;c<t.length;c++){var l=t[c],f=l.geometry,h=l.text?l.text.toString():null;if(h){var p=u(h,f),d=u(h,f,!0);if(p in n&&d in e&&n[p]!==e[d]){var v=s(p,d,f),g=a(p,d,r[v].geometry);delete e[p],delete n[d],n[u(h,r[g].geometry,!0)]=g,r[v].geometry=null}else p in n?a(p,d,f):d in e?s(p,d,f):(o(c),e[p]=i-1,n[d]=i-1)}else o(c)}return r.filter(function(t){return t.geometry})}(this.features))}},fs.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},fs.prototype.isEmpty=function(){return 0===this.symbolInstances.length},fs.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},fs.prototype.upload=function(t){this.uploaded||(this.collisionBox.upload(t),this.collisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},fs.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},fs.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:r},a<e.length-1&&(r+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var u=0;u<e.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},fs.prototype.addSymbols=function(t,e,n,r,i,o,a,s,u,c){for(var l=t.indexArray,f=t.layoutVertexArray,h=t.dynamicLayoutVertexArray,p=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),d=this.glyphOffsetArray.length,v=p.vertexLength,g=0,m=e;g<m.length;g+=1){var y=m[g],_=y.tl,b=y.tr,x=y.bl,w=y.br,E=y.tex,S=p.vertexLength,P=y.glyphOffset[1];ss(f,s.x,s.y,_.x,P+_.y,E.x,E.y,n),ss(f,s.x,s.y,b.x,P+b.y,E.x+E.w,E.y,n),ss(f,s.x,s.y,x.x,P+x.y,E.x,E.y+E.h,n),ss(f,s.x,s.y,w.x,P+w.y,E.x+E.w,E.y+E.h,n),us(h,s,0),l.emplaceBack(S,S+1,S+2),l.emplaceBack(S+1,S+2,S+3),p.vertexLength+=4,p.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(y.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,d,this.glyphOffsetArray.length-d,v,u,c,s.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],a,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{})},fs.prototype._addCollisionDebugVertex=function(t,e,n,r,i,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))},fs.prototype.addCollisionDebugVertices=function(t,e,n,r,o,a,s,u){var c=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),l=c.vertexLength,f=o.layoutVertexArray,h=o.collisionVertexArray,p=s.anchorX,d=s.anchorY;if(this._addCollisionDebugVertex(f,h,a,p,d,new i(t,e)),this._addCollisionDebugVertex(f,h,a,p,d,new i(n,e)),this._addCollisionDebugVertex(f,h,a,p,d,new i(n,r)),this._addCollisionDebugVertex(f,h,a,p,d,new i(t,r)),c.vertexLength+=4,u){var v=o.indexArray;v.emplaceBack(l,l+1,l+2),v.emplaceBack(l,l+2,l+3),c.primitiveLength+=2}else{var g=o.indexArray;g.emplaceBack(l,l+1),g.emplaceBack(l+1,l+2),g.emplaceBack(l+2,l+3),g.emplaceBack(l+3,l),c.primitiveLength+=4}},fs.prototype.addDebugCollisionBoxes=function(t,e,n){for(var r=t;r<e;r++){var i=this.collisionBoxArray.get(r),o=i.x1,a=i.y1,s=i.x2,u=i.y2,c=i.radius>0;this.addCollisionDebugVertices(o,a,s,u,c?this.collisionCircle:this.collisionBox,i.anchorPoint,n,c)}},fs.prototype.generateCollisionDebugBuffers=function(){for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e)}},fs.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,r,i){for(var o={},a=e;a<n;a++){var s=t.get(a);if(0===s.radius){o.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},o.textFeatureIndex=s.featureIndex;break}o.textCircles||(o.textCircles=[],o.textFeatureIndex=s.featureIndex),o.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var u=r;u<i;u++){var c=t.get(u);if(0===c.radius){o.iconBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},o.iconFeatureIndex=c.featureIndex;break}}return o},fs.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex))}},fs.prototype.hasTextData=function(){return this.text.segments.get().length>0},fs.prototype.hasIconData=function(){return this.icon.segments.get().length>0},fs.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},fs.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},fs.prototype.addIndicesForPlacedTextSymbol=function(t){for(var e=this.text.placedSymbolArray.get(t),n=e.vertexStartIndex+4*e.numGlyphs,r=e.vertexStartIndex;r<n;r+=4)this.text.indexArray.emplaceBack(r,r+1,r+2),this.text.indexArray.emplaceBack(r+1,r+2,r+3)},fs.prototype.sortFeatures=function(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var e=[],n=0;n<this.symbolInstances.length;n++)e.push(n);for(var r=Math.sin(t),i=Math.cos(t),o=[],a=[],s=0;s<this.symbolInstances.length;s++){var u=this.symbolInstances.get(s);o.push(0|Math.round(r*u.anchorX+i*u.anchorY)),a.push(u.featureIndex)}e.sort(function(t,e){return o[t]-o[e]||a[e]-a[t]}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,l=e;c<l.length;c+=1){var f=l[c],h=this.symbolInstances.get(f);this.featureSortOrder.push(h.featureIndex),h.horizontalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(h.horizontalPlacedTextSymbolIndex),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(h.verticalPlacedTextSymbolIndex);var p=this.icon.placedSymbolArray.get(f);if(p.numGlyphs){var d=p.vertexStartIndex;this.icon.indexArray.emplaceBack(d,d+1,d+2),this.icon.indexArray.emplaceBack(d+1,d+2,d+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Qn("SymbolBucket",fs,{omit:["layers","collisionBoxArray","features","compareText"]}),fs.MAX_GLYPHS=65535,fs.addDynamicAttributes=us;var hs=new Cr({"symbol-placement":new Sr(st.layout_symbol["symbol-placement"]),"symbol-spacing":new Sr(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Sr(st.layout_symbol["symbol-avoid-edges"]),"symbol-z-order":new Sr(st.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Sr(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Sr(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new Sr(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Sr(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pr(st.layout_symbol["icon-size"]),"icon-text-fit":new Sr(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Sr(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pr(st.layout_symbol["icon-image"]),"icon-rotate":new Pr(st.layout_symbol["icon-rotate"]),"icon-padding":new Sr(st.layout_symbol["icon-padding"]),"icon-keep-upright":new Sr(st.layout_symbol["icon-keep-upright"]),"icon-offset":new Pr(st.layout_symbol["icon-offset"]),"icon-anchor":new Pr(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Sr(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Sr(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Sr(st.layout_symbol["text-rotation-alignment"]),"text-field":new Pr(st.layout_symbol["text-field"]),"text-font":new Pr(st.layout_symbol["text-font"]),"text-size":new Pr(st.layout_symbol["text-size"]),"text-max-width":new Pr(st.layout_symbol["text-max-width"]),"text-line-height":new Sr(st.layout_symbol["text-line-height"]),"text-letter-spacing":new Pr(st.layout_symbol["text-letter-spacing"]),"text-justify":new Pr(st.layout_symbol["text-justify"]),"text-anchor":new Pr(st.layout_symbol["text-anchor"]),"text-max-angle":new Sr(st.layout_symbol["text-max-angle"]),"text-rotate":new Pr(st.layout_symbol["text-rotate"]),"text-padding":new Sr(st.layout_symbol["text-padding"]),"text-keep-upright":new Sr(st.layout_symbol["text-keep-upright"]),"text-transform":new Pr(st.layout_symbol["text-transform"]),"text-offset":new Pr(st.layout_symbol["text-offset"]),"text-allow-overlap":new Sr(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Sr(st.layout_symbol["text-ignore-placement"]),"text-optional":new Sr(st.layout_symbol["text-optional"])}),ps={paint:new Cr({"icon-opacity":new Pr(st.paint_symbol["icon-opacity"]),"icon-color":new Pr(st.paint_symbol["icon-color"]),"icon-halo-color":new Pr(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pr(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pr(st.paint_symbol["icon-halo-blur"]),"icon-translate":new Sr(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new Sr(st.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pr(st.paint_symbol["text-opacity"]),"text-color":new Pr(st.paint_symbol["text-color"]),"text-halo-color":new Pr(st.paint_symbol["text-halo-color"]),"text-halo-width":new Pr(st.paint_symbol["text-halo-width"]),"text-halo-blur":new Pr(st.paint_symbol["text-halo-blur"]),"text-translate":new Sr(st.paint_symbol["text-translate"]),"text-translate-anchor":new Sr(st.paint_symbol["text-translate-anchor"])}),layout:hs},ds=function(t){function e(e){t.call(this,e,ps)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var n,r=this.layout.get(t).evaluate(e,{}),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||an(i.value)?r:(n=e.properties,r.replace(/{([^{}]+)}/g,function(t,e){return e in n?String(n[e]):""}))},e.prototype.createBucket=function(t){return new fs(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(Or),vs={paint:new Cr({"background-color":new Sr(st.paint_background["background-color"]),"background-pattern":new Ar(st.paint_background["background-pattern"]),"background-opacity":new Sr(st.paint_background["background-opacity"])})},gs=function(t){function e(e){t.call(this,e,vs)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Or),ms={paint:new Cr({"raster-opacity":new Sr(st.paint_raster["raster-opacity"]),"raster-hue-rotate":new Sr(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Sr(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Sr(st.paint_raster["raster-brightness-max"]),"raster-saturation":new Sr(st.paint_raster["raster-saturation"]),"raster-contrast":new Sr(st.paint_raster["raster-contrast"]),"raster-resampling":new Sr(st.paint_raster["raster-resampling"]),"raster-fade-duration":new Sr(st.paint_raster["raster-fade-duration"])})},ys=function(t){function e(e){t.call(this,e,ms)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Or),_s=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender||"3d"===this.implementation.renderingMode},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t)},e}(Or),bs={circle:_o,heatmap:Co,hillshade:Mo,fill:ga,"fill-extrusion":Pa,line:Ha,symbol:ds,background:gs,raster:ys};function xs(t){for(var e=0,n=0,r=0,i=t;r<i.length;r+=1){var o=i[r];e+=o.w*o.h,n=Math.max(n,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],s=0,u=0,c=0,l=t;c<l.length;c+=1)for(var f=l[c],h=a.length-1;h>=0;h--){var p=a[h];if(!(f.w>p.w||f.h>p.h)){if(f.x=p.x,f.y=p.y,u=Math.max(u,f.y+f.h),s=Math.max(s,f.x+f.w),f.w===p.w&&f.h===p.h){var d=a.pop();h<a.length&&(a[h]=d)}else f.h===p.h?(p.x+=f.w,p.w-=f.w):f.w===p.w?(p.y+=f.h,p.h-=f.h):(a.push({x:p.x+f.w,y:p.y,w:p.w-f.w,h:f.h}),p.y+=f.h,p.h-=f.h);break}}return{w:s,h:u,fill:e/(s*u)||0}}var ws=function(t,e){var n=e.pixelRatio;this.paddedRect=t,this.pixelRatio=n},Es={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Es.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Es.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Es.tlbr.get=function(){return this.tl.concat(this.br)},Es.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(ws.prototype,Es);var Ss=function(t,e){var n={},r={},i=[];for(var o in t){var a=t[o],s={x:0,y:0,w:a.data.width+2,h:a.data.height+2};i.push(s),n[o]=new ws(s,a)}for(var u in e){var c=e[u],l={x:0,y:0,w:c.data.width+2,h:c.data.height+2};i.push(l),r[u]=new ws(l,c)}var f=xs(i),h=f.w,p=f.h,d=new To({width:h||1,height:p||1});for(var v in t){var g=t[v],m=n[v].paddedRect;To.copy(g.data,d,{x:0,y:0},{x:m.x+1,y:m.y+1},g.data)}for(var y in e){var _=e[y],b=r[y].paddedRect,x=b.x+1,w=b.y+1,E=_.data.width,S=_.data.height;To.copy(_.data,d,{x:0,y:0},{x:x,y:w},_.data),To.copy(_.data,d,{x:0,y:S-1},{x:x,y:w-1},{width:E,height:1}),To.copy(_.data,d,{x:0,y:0},{x:x,y:w+S},{width:E,height:1}),To.copy(_.data,d,{x:E-1,y:0},{x:x-1,y:w},{width:1,height:S}),To.copy(_.data,d,{x:0,y:0},{x:x+E,y:w},{width:1,height:S})}this.image=d,this.iconPositions=n,this.patternPositions=r};Qn("ImagePosition",ws),Qn("ImageAtlas",Ss);var Ps=self.HTMLImageElement,Ts=self.HTMLCanvasElement,As=self.HTMLVideoElement,ks=self.ImageData,Cs=function(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)};Cs.prototype.update=function(t,e){var n=t.width,r=t.height,i=!this.size||this.size[0]!==n||this.size[1]!==r,o=this.context,a=o.gl;this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),i?(this.size=[n,r],t instanceof Ps||t instanceof Ts||t instanceof As||t instanceof ks?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,n,r,0,this.format,a.UNSIGNED_BYTE,t.data)):t instanceof Ps||t instanceof Ts||t instanceof As||t instanceof ks?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,0,0,n,r,a.RGBA,a.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},Cs.prototype.bind=function(t,e,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)},Cs.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Cs.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Os=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},Ms=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*v},Is=Ls;function Ls(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function Rs(t){return t.type===Ls.Bytes?t.readVarint()+t.pos:t.pos+1}function js(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function zs(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Ds(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Fs(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Ns(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Bs(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Us(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Vs(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Gs(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function qs(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Ws(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Zs(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Xs(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Hs(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Ls.Varint=0,Ls.Fixed64=1,Ls.Bytes=2,Ls.Fixed32=5,Ls.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Zs(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Hs(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Zs(this.buf,this.pos)+4294967296*Zs(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Zs(this.buf,this.pos)+4294967296*Hs(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Os(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Os(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return js(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return js(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return js(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return js(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return js(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return js(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){for(var r="",i=e;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=Rs(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=Rs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ls.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ls.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ls.Fixed32)this.pos+=4;else{if(e!==Ls.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Xs(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Xs(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Xs(this.buf,-1&t,this.pos),Xs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Xs(this.buf,-1&t,this.pos),Xs(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&zs(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Ms(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Ms(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&zs(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Ls.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,Ds,e)},writePackedSVarint:function(t,e){this.writeMessage(t,Fs,e)},writePackedBoolean:function(t,e){this.writeMessage(t,Us,e)},writePackedFloat:function(t,e){this.writeMessage(t,Ns,e)},writePackedDouble:function(t,e){this.writeMessage(t,Bs,e)},writePackedFixed32:function(t,e){this.writeMessage(t,Vs,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,Gs,e)},writePackedFixed64:function(t,e){this.writeMessage(t,qs,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,Ws,e)},writeBytesField:function(t,e){this.writeTag(t,Ls.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ls.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ls.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ls.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ls.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ls.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ls.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ls.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ls.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ls.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Ys=3;function Ks(t,e,n){1===t&&n.readMessage(Js,e)}function Js(t,e,n){if(3===t){var r=n.readMessage(Qs,{}),i=r.id,o=r.bitmap,a=r.width,s=r.height,u=r.left,c=r.top,l=r.advance;e.push({id:i,bitmap:new Po({width:a+2*Ys,height:s+2*Ys},o),metrics:{width:a,height:s,left:u,top:c,advance:l}})}}function Qs(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}var $s=Ys,tu=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.callbackID=0,g(["receive"],this),this.target.addEventListener("message",this.receive,!1)};function eu(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}tu.prototype.send=function(t,e,n,r){var i=n?this.mapId+":"+this.callbackID++:null;n&&(this.callbacks[i]=n);var o=[];this.target.postMessage({targetMapId:r,sourceMapId:this.mapId,type:t,id:String(i),data:tr(e,o)},o)},tu.prototype.receive=function(t){var e,n=this,r=t.data,i=r.id;if(!r.targetMapId||this.mapId===r.targetMapId){var o=function(t,e){var r=[];n.target.postMessage({sourceMapId:n.mapId,type:"<response>",id:String(i),error:t?tr(t):null,data:tr(e,r)},r)};if("<response>"===r.type)e=this.callbacks[r.id],delete this.callbacks[r.id],e&&r.error?e(er(r.error)):e&&e(null,er(r.data));else if(void 0!==r.id&&this.parent[r.type])this.parent[r.type](r.sourceMapId,er(r.data),o);else if(void 0!==r.id&&this.parent.getWorkerSource){var a=r.type.split("."),s=er(r.data);this.parent.getWorkerSource(r.sourceMapId,a[0],s.source)[a[1]](s,o)}else this.parent[r.type](er(r.data))}},tu.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var nu=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};nu.prototype.setNorthEast=function(t){return this._ne=t instanceof ru?new ru(t.lng,t.lat):ru.convert(t),this},nu.prototype.setSouthWest=function(t){return this._sw=t instanceof ru?new ru(t.lng,t.lat):ru.convert(t),this},nu.prototype.extend=function(t){var e,n,r=this._sw,i=this._ne;if(t instanceof ru)e=t,n=t;else{if(!(t instanceof nu))return Array.isArray(t)?t.every(Array.isArray)?this.extend(nu.convert(t)):this.extend(ru.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return r||i?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new ru(e.lng,e.lat),this._ne=new ru(n.lng,n.lat)),this},nu.prototype.getCenter=function(){return new ru((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},nu.prototype.getSouthWest=function(){return this._sw},nu.prototype.getNorthEast=function(){return this._ne},nu.prototype.getNorthWest=function(){return new ru(this.getWest(),this.getNorth())},nu.prototype.getSouthEast=function(){return new ru(this.getEast(),this.getSouth())},nu.prototype.getWest=function(){return this._sw.lng},nu.prototype.getSouth=function(){return this._sw.lat},nu.prototype.getEast=function(){return this._ne.lng},nu.prototype.getNorth=function(){return this._ne.lat},nu.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},nu.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},nu.prototype.isEmpty=function(){return!(this._sw&&this._ne)},nu.convert=function(t){return!t||t instanceof nu?t:new nu(t)};var ru=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};function iu(t){return 2*Math.PI*6378137*Math.cos(t*Math.PI/180)}function ou(t){return(180+t)/360}function au(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function su(t,e){return t/iu(e)}function uu(t){var e=180-360*t;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}ru.prototype.wrap=function(){return new ru(l(this.lng,-180,180),this.lat)},ru.prototype.toArray=function(){return[this.lng,this.lat]},ru.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ru.prototype.toBounds=function(t){var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new nu(new ru(this.lng-n,this.lat-e),new ru(this.lng+n,this.lat+e))},ru.convert=function(t){if(t instanceof ru)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new ru(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new ru(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var cu=function(t,e,n){void 0===n&&(n=0),this.x=+t,this.y=+e,this.z=+n};cu.fromLngLat=function(t,e){void 0===e&&(e=0);var n=ru.convert(t);return new cu(ou(n.lng),au(n.lat),su(e,n.lat))},cu.prototype.toLngLat=function(){return new ru(360*this.x-180,uu(this.y))},cu.prototype.toAltitude=function(){return this.z*iu(uu(this.y))};var lu=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=pu(0,t,e,n)};lu.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},lu.prototype.url=function(t,e){var n,r,i,o,a,s=(n=this.x,r=this.y,i=this.z,o=eu(256*n,256*(r=Math.pow(2,i)-r-1),i),a=eu(256*(n+1),256*(r+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),u=function(t,e,n){for(var r,i="",o=t;o>0;o--)i+=(e&(r=1<<o-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)},lu.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new i((t.x*e-this.x)*Bi,(t.y*e-this.y)*Bi)};var fu=function(t,e){this.wrap=t,this.canonical=e,this.key=pu(t,e.z,e.x,e.y)},hu=function(t,e,n,r,i){this.overscaledZ=t,this.wrap=e,this.canonical=new lu(n,+r,+i),this.key=pu(e,t,r,i)};function pu(t,e,n,r){(t*=2)<0&&(t=-1*t-1);var i=1<<e;return 32*(i*i*t+i*r+n)+e}hu.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},hu.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new hu(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new hu(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},hu.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},hu.prototype.children=function(t){if(this.overscaledZ>=t)return[new hu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new hu(e,this.wrap,e,n,r),new hu(e,this.wrap,e,n+1,r),new hu(e,this.wrap,e,n,r+1),new hu(e,this.wrap,e,n+1,r+1)]},hu.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},hu.prototype.wrapped=function(){return new hu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},hu.prototype.unwrapTo=function(t){return new hu(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},hu.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},hu.prototype.toUnwrapped=function(){return new fu(this.wrap,this.canonical)},hu.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},hu.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new cu(t.x-this.wrap,t.y))},Qn("CanonicalTileID",lu),Qn("OverscaledTileID",hu,{omit:["posMatrix"]});var du=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return w('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var r=this.dim=e.height;this.border=Math.max(Math.ceil(e.height/2),1),this.stride=this.dim+2*this.border,this.data=new Int32Array(this.stride*this.stride);for(var i=e.data,o="terrarium"===n?this._unpackTerrarium:this._unpackMapbox,a=0;a<r;a++)for(var s=0;s<r;s++){var u=4*(a*r+s);this.set(s,a,o(i[u],i[u+1],i[u+2]))}for(var c=0;c<r;c++)this.set(-1,c,this.get(0,c)),this.set(r,c,this.get(r-1,c)),this.set(c,-1,this.get(c,0)),this.set(c,r,this.get(c,r-1));this.set(-1,-1,this.get(0,0)),this.set(r,-1,this.get(r-1,0)),this.set(-1,r,this.get(0,r-1)),this.set(r,r,this.get(r-1,r-1))};du.prototype.set=function(t,e,n){this.data[this._idx(t,e)]=n+65536},du.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},du.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},du.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},du.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},du.prototype.getPixels=function(){return new To({width:this.dim+2*this.border,height:this.dim+2*this.border},new Uint8Array(this.data.buffer))},du.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=c(r,-this.border,this.dim+this.border),u=c(i,-this.border,this.dim+this.border),l=c(o,-this.border,this.dim+this.border),f=c(a,-this.border,this.dim+this.border),h=-e*this.dim,p=-n*this.dim,d=l;d<f;d++)for(var v=s;v<u;v++)this.set(v,d,t.get(v+h,d+p))},Qn("DEMData",du);var vu=Rr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),gu=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};gu.prototype.encode=function(t){return this._stringToNumber[t]},gu.prototype.decode=function(t){return this._numberToString[t]};var mu=function(t,e,n,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,null!=t.id&&(this.id=t.id)},yu={geometry:{configurable:!0}};yu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},yu.geometry.set=function(t){this._geometry=t},mu.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(mu.prototype,yu);var _u=function(){this.state={},this.stateChanges={}};_u.prototype.updateState=function(t,e,n){var r=String(e);this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},f(this.stateChanges[t][r],n)},_u.prototype.getState=function(t,e){var n=String(e),r=this.state[t]||{},i=this.stateChanges[t]||{};return f({},r[n],i[n])},_u.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},_u.prototype.coalesceChanges=function(t,e){var n={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var i={};for(var o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),f(this.state[r][o],this.stateChanges[r][o]),i[o]=this.state[r][o];n[r]=i}if(this.stateChanges={},0!==Object.keys(n).length)for(var a in t)t[a].setFeatureState(n,e)};var bu=function(t,e,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new Xn(Bi,16,0),this.featureIndexArray=n||new di};function xu(t,e){return e-t}bu.prototype.insert=function(t,e,n,r,i){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var a=0;a<e.length;a++){for(var s=e[a],u=[1/0,1/0,-1/0,-1/0],c=0;c<s.length;c++){var l=s[c];u[0]=Math.min(u[0],l.x),u[1]=Math.min(u[1],l.y),u[2]=Math.max(u[2],l.x),u[3]=Math.max(u[3],l.y)}u[0]<Bi&&u[1]<Bi&&u[2]>=0&&u[3]>=0&&this.grid.insert(o,u[0],u[1],u[2],u[3])}},bu.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new za.VectorTile(new Is(this.rawTileData)).layers,this.sourceLayerCoder=new gu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},bu.prototype.query=function(t,e,n){var r=this;this.loadVTLayers();for(var i=t.params||{},o=Bi/t.tileSize/t.scale,a=xn(i.filter),s=t.queryGeometry,u=t.queryPadding*o,c=1/0,l=1/0,f=-1/0,h=-1/0,p=0;p<s.length;p++)for(var d=s[p],v=0;v<d.length;v++){var g=d[v];c=Math.min(c,g.x),l=Math.min(l,g.y),f=Math.max(f,g.x),h=Math.max(h,g.y)}var m=this.grid.query(c-u,l-u,f+u,h+u);m.sort(xu);for(var y,_={},b=function(u){var c=m[u];if(c!==y){y=c;var l=r.featureIndexArray.get(c),f=null;r.loadMatchingFeature(_,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,a,i.layers,e,function(e,i){f||(f=Vi(e));var a={};return e.id&&(a=n.getState(i.sourceLayer||"_geojsonTileLayer",e.id)),i.queryIntersectsFeature(s,e,a,f,r.z,t.transform,o,t.posMatrix)})}},x=0;x<m.length;x++)b(x);return _},bu.prototype.loadMatchingFeature=function(t,e,n,r,i,o,a,s){var u=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,u)){var c=this.sourceLayerCoder.decode(n),l=this.vtLayers[c].feature(r);if(i(new vr(this.tileID.overscaledZ),l))for(var f=0;f<u.length;f++){var h=u[f];if(!(o&&o.indexOf(h)<0)){var p=a[h];if(p&&(!s||s(l,p))){var d=new mu(l,this.z,this.x,this.y);d.layer=p.serialize();var v=t[h];void 0===v&&(v=t[h]=[]),v.push({featureIndex:r,feature:d})}}}}},bu.prototype.lookupSymbolFeatures=function(t,e,n,r,i,o){var a={};this.loadVTLayers();for(var s=xn(r),u=0,c=t;u<c.length;u+=1){var l=c[u];this.loadMatchingFeature(a,e,n,l,s,i,o)}return a},bu.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var r=0,i=n[e];r<i.length;r+=1)if(t===i[r])return!0;return!1},Qn("FeatureIndex",bu,{omit:["rawTileData","sourceLayerCoder"]});var wu=function(t,e){this.tileID=t,this.uid=p(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};wu.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<C.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},wu.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},wu.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var r in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==a.length){o.layers=a,o.stateDependentLayers=a.filter(function(t){return t.isStateDependent()});for(var s=0,u=a;s<u.length;s+=1)n[u[s].id]=o}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[r];if(i instanceof fs){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}for(var o in this.queryPadding=0,this.buckets){var a=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(o).queryRadius(a))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new ii},wu.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},wu.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},wu.prototype.getBucket=function(t){return this.buckets[t.id]},wu.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Cs(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Cs(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},wu.prototype.queryRenderedFeatures=function(t,e,n,r,i,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,scale:r,tileSize:this.tileSize,posMatrix:s,transform:o,params:i,queryPadding:this.queryPadding*a},t,e):{}},wu.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var n=this.latestFeatureIndex.loadVTLayers(),r=e?e.sourceLayer:"",i=n._geojsonTileLayer||n[r];if(i)for(var o=xn(e&&e.filter),a=this.tileID.canonical,s=a.z,u=a.x,c=a.y,l={z:s,x:u,y:c},f=0;f<i.length;f++){var h=i.feature(f);if(o(new vr(this.tileID.overscaledZ),h)){var p=new mu(h,s,u,c);p.tile=l,t.push(p)}}}},wu.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},wu.prototype.setMask=function(t,e){if(!a(this.mask,t)&&(this.mask=t,this.clearMask(),!a(t,{0:!0}))){var n=new Dr,r=new Qr;this.segments=new mi,this.segments.prepareSegment(0,n,r);for(var o=Object.keys(t),s=0;s<o.length;s++){var u=t[o[s]],c=Bi>>u.z,l=new i(u.x*c,u.y*c),f=new i(l.x+c,l.y+c),h=this.segments.prepareSegment(4,n,r);n.emplaceBack(l.x,l.y,l.x,l.y),n.emplaceBack(f.x,l.y,f.x,l.y),n.emplaceBack(l.x,f.y,l.x,f.y),n.emplaceBack(f.x,f.y,f.x,f.y);var p=h.vertexLength;r.emplaceBack(p,p+1,p+2),r.emplaceBack(p+1,p+2,p+3),h.vertexLength+=4,h.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(n,vu.members),this.maskedIndexBuffer=e.createIndexBuffer(r)}},wu.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},wu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},wu.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,n,r,i){var o=r||i;return e[n]=!o||o.toLowerCase(),""}),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),i=!1;if(this.expirationTime>r)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var o=this.expirationTime-e;o?this.expirationTime=r+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},wu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},wu.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets){var i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(r).queryRadius(i))))}}},wu.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},wu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<C.now()},wu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},wu.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=C.now()+t};var Eu={horizontal:1,vertical:2,horizontalOnly:3},Su=function(){this.text="",this.sectionIndex=[],this.sections=[]};Su.fromFeature=function(t,e){for(var n=new Su,r=0;r<t.sections.length;r++){var i=t.sections[r];n.sections.push({scale:i.scale||1,fontStack:i.fontStack||e}),n.text+=i.text;for(var o=0;o<i.text.length;o++)n.sectionIndex.push(r)}return n},Su.prototype.length=function(){return this.text.length},Su.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Su.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Su.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;r&&sr(r)&&!ns[t[n+1]]||i&&sr(i)&&!ns[t[n-1]]||!ns[t[n]]?e+=t[n]:e+=ns[t[n]]}return e}(this.text)},Su.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Pu[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=t&&Pu[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},Su.prototype.substring=function(t,e){var n=new Su;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},Su.prototype.toString=function(){return this.text},Su.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,n){return Math.max(e,t.sections[n].scale)},0)};var Pu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Tu={};function Au(t,e,n,r){var i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function ku(t,e){var n=0;return 10===t&&(n-=1e4),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function Cu(t,e,n,r,i,o){for(var a=null,s=Au(e,n,i,o),u=0,c=r;u<c.length;u+=1){var l=c[u],f=Au(e-l.x,n,i,o)+l.badness;f<=s&&(a=l,s=f)}return{index:t,x:e,priorBreak:a,badness:s}}function Ou(t,e,n,r){if(!n)return[];if(!t)return[];for(var i,o=[],a=function(t,e,n,r){for(var i=0,o=0;o<t.length();o++){var a=t.getSection(o),s=r[a.fontStack],u=s&&s[t.getCharCode(o)];u&&(i+=u.metrics.advance*a.scale+e)}return i/Math.max(1,Math.ceil(i/n))}(t,e,n,r),s=0,u=0;u<t.length();u++){var c=t.getSection(u),l=t.getCharCode(u),f=r[c.fontStack],h=f&&f[l];h&&!Pu[l]&&(s+=h.metrics.advance*c.scale+e),u<t.length()-1&&(Tu[l]||!((i=l)<11904)&&(rr["Bopomofo Extended"](i)||rr.Bopomofo(i)||rr["CJK Compatibility Forms"](i)||rr["CJK Compatibility Ideographs"](i)||rr["CJK Compatibility"](i)||rr["CJK Radicals Supplement"](i)||rr["CJK Strokes"](i)||rr["CJK Symbols and Punctuation"](i)||rr["CJK Unified Ideographs Extension A"](i)||rr["CJK Unified Ideographs"](i)||rr["Enclosed CJK Letters and Months"](i)||rr["Halfwidth and Fullwidth Forms"](i)||rr.Hiragana(i)||rr["Ideographic Description Characters"](i)||rr["Kangxi Radicals"](i)||rr["Katakana Phonetic Extensions"](i)||rr.Katakana(i)||rr["Vertical Forms"](i)||rr["Yi Radicals"](i)||rr["Yi Syllables"](i)))&&o.push(Cu(u+1,s,a,o,ku(l,t.getCharCode(u+1)),!1))}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Cu(t.length(),s,a,o,0,!0))}function Mu(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Iu(t,e,n,r,i){if(i){var o=t[r],a=e[o.fontStack],s=a&&a[o.glyph];if(s)for(var u=s.metrics.advance*o.scale,c=(t[r].x+u)*i,l=n;l<=r;l++)t[l].x-=c}}Tu[10]=!0,Tu[32]=!0,Tu[38]=!0,Tu[40]=!0,Tu[41]=!0,Tu[43]=!0,Tu[45]=!0,Tu[47]=!0,Tu[173]=!0,Tu[183]=!0,Tu[8203]=!0,Tu[8208]=!0,Tu[8211]=!0,Tu[8231]=!0,t.createCommonjsModule=e,t.Point=i,t.window=self,t.getJSON=function(t,e){return K(f(t,{type:"json"}),e)},t.getImage=et,t.ResourceType=X,t.browser=C,t.normalizeSpriteURL=function(t,e,n,r){var i=N(t);return R(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+n,L(i,r)):(i.path+=""+e+n,B(i))},t.RGBAImage=To,t.potpack=xs,t.ImagePosition=ws,t.Texture=Cs,t.normalizeGlyphsURL=function(t,e){if(!R(t))return t;var n=N(t);return n.path="/fonts/v1"+n.path,L(n,e)},t.getArrayBuffer=J,t.parseGlyphPBF=function(t){return new Is(t).readFields(Ks,[])},t.isChar=rr,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var r=t.length,i=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),i[a]=e,0==--r&&n(o,i)})})},t.AlphaImage=Po,t.styleSpec=st,t.endsWith=m,t.extend=f,t.sphericalToCartesian=function(t){var e=t[0],n=t[1],r=t[2];return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(r),y:e*Math.sin(n)*Math.sin(r),z:e*Math.cos(r)}},t.Evented=at,t.validateStyle=Vn,t.validateLight=Gn,t.emitValidationErrors=Zn,t.Color=Ct,t.number=ne,t.Properties=Cr,t.Transitionable=yr,t.Transitioning=br,t.PossiblyEvaluated=Er,t.DataConstantProperty=Sr,t.warnOnce=w,t.uniqueId=p,t.Actor=tu,t.pick=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r];i in t&&(n[i]=t[i])}return n},t.normalizeSourceURL=function(t,e){if(!R(t))return t;var n=N(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),L(n,e)},t.LngLatBounds=nu,t.clamp=c,t.Event=it,t.ErrorEvent=ot,t.normalizeTileURL=function(t,e,n){if(!e||!R(e))return t;var r=N(t),i=C.devicePixelRatio>=2||512===n?"@2x":"",o=C.supportsWebp?".webp":"$1";return r.path=r.path.replace(D,""+i+o),function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(M.ACCESS_TOKEN||""))}(r.params),B(r)},t.postTurnstileEvent=q,t.postMapLoadEvent=Z,t.OverscaledTileID=hu,t.EXTENT=Bi,t.CanonicalTileID=lu,t.StructArrayLayout4i8=Dr,t.rasterBoundsAttributes=vu,t.SegmentVector=mi,t.MercatorCoordinate=cu,t.getVideo=function(t,e){var n,r,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");n=t[o],r=void 0,(r=self.document.createElement("a")).href=n,(r.protocol!==self.document.location.protocol||r.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),a.src=t[o],i.appendChild(a)}return{cancel:function(){}}},t.ValidationError=ut,t.bindAll=g,t.isEqual=a,t.Tile=wu,t.keysDifference=function(t,e){var n=[];for(var r in t)r in e||n.push(r);return n},t.SourceFeatureState=_u,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.create=function(){var t=new oo(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],p=e[11],d=e[12],v=e[13],g=e[14],m=e[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,E=i*c-o*u,S=l*v-f*d,P=l*g-h*d,T=l*m-p*d,A=f*g-h*v,k=f*m-p*v,C=h*m-p*g,O=y*C-_*k+b*A+x*T-w*P+E*S;return O?(O=1/O,t[0]=(s*C-u*k+c*A)*O,t[1]=(i*k-r*C-o*A)*O,t[2]=(v*E-g*w+m*x)*O,t[3]=(h*w-f*E-p*x)*O,t[4]=(u*T-a*C-c*P)*O,t[5]=(n*C-i*T+o*P)*O,t[6]=(g*b-d*E-m*_)*O,t[7]=(l*E-h*b+p*_)*O,t[8]=(a*k-s*T+c*S)*O,t[9]=(r*T-n*k-o*S)*O,t[10]=(d*w-v*b+m*y)*O,t[11]=(f*b-l*w-p*y)*O,t[12]=(s*P-a*A-u*S)*O,t[13]=(n*A-r*P+i*S)*O,t[14]=(v*_-d*x-g*y)*O,t[15]=(l*x-f*_+h*y)*O,t):null},t.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],d=e[11],v=e[12],g=e[13],m=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*s+x*f+w*v,t[1]=_*i+b*u+x*h+w*g,t[2]=_*o+b*c+x*p+w*m,t[3]=_*a+b*l+x*d+w*y,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*r+b*s+x*f+w*v,t[5]=_*i+b*u+x*h+w*g,t[6]=_*o+b*c+x*p+w*m,t[7]=_*a+b*l+x*d+w*y,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*r+b*s+x*f+w*v,t[9]=_*i+b*u+x*h+w*g,t[10]=_*o+b*c+x*p+w*m,t[11]=_*a+b*l+x*d+w*y,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*r+b*s+x*f+w*v,t[13]=_*i+b*u+x*h+w*g,t[14]=_*o+b*c+x*p+w*m,t[15]=_*a+b*l+x*d+w*y,t},t.translate=function(t,e,n){var r,i,o,a,s,u,c,l,f,h,p,d,v=n[0],g=n[1],m=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*m+e[12],t[13]=e[1]*v+e[5]*g+e[9]*m+e[13],t[14]=e[2]*v+e[6]*g+e[10]*m+e[14],t[15]=e[3]*v+e[7]*g+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=p,t[11]=d,t[12]=r*v+s*g+f*m+e[12],t[13]=i*v+u*g+h*m+e[13],t[14]=o*v+c*g+p*m+e[14],t[15]=a*v+l*g+d*m+e[15]),t},t.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t},t.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},t.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t},t.create$1=po,t.normalize=vo,t.transformMat4=go,t.forEach=mo,t.getSizeData=is,t.evaluateSizeForFeature=function(t,e,n){var r=e;return"source"===t.functionType?n.lowerSize/256:"composite"===t.functionType?ne(n.lowerSize/256,n.upperSize/256,r.uSizeT):r.uSize},t.evaluateSizeForZoom=function(t,e,n){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var r=t.propertyValue,i=t.zoomRange,o=t.sizeRange,a=c(hn(r,n.specification).interpolationFactor(e,i.min,i.max),0,1);return{uSizeT:0,uSize:o.min+a*(o.max-o.min)}}var s=t.propertyValue,u=t.zoomRange;return{uSizeT:c(hn(s,n.specification).interpolationFactor(e,u.min,u.max),0,1),uSize:0}},t.SIZE_PACK_FACTOR=256,t.addDynamicAttributes=us,t.properties=ps,t.WritingMode=Eu,t.multiPolygonIntersectsBufferedPoint=Wi,t.multiPolygonIntersectsMultiPolygon=Zi,t.multiPolygonIntersectsBufferedMultiLine=Xi,t.polygonIntersectsPolygon=function(t,e){for(var n=0;n<t.length;n++)if(to(e,t[n]))return!0;for(var r=0;r<e.length;r++)if(to(t,e[r]))return!0;return!!Yi(t,e)},t.distToSegmentSquared=Qi,t.SymbolInstanceArray=ui,t.StyleLayer=Or,t.createStyleLayer=function(t){return"custom"===t.type?new _s(t):new bs[t.type](t)},t.clone=b,t.filterObject=_,t.mapObject=y,t.getReferrer=Y,t.isMapboxURL=R,t.normalizeStyleURL=function(t,e){if(!R(t))return t;var n=N(t);return n.path="/styles/v1"+n.path,L(n,e)},t.registerForPluginAvailability=function(t){return fr?t({pluginURL:fr,completionCallback:cr}):pr.once("pluginAvailable",t),t},t.evented=pr,t.ZoomHistory=nr,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.createLayout=Rr,t.ProgramConfiguration=zi,t.Uniform1i=wi,t.Uniform1f=Ei,t.Uniform2f=Si,t.Uniform4f=Ti,t.Uniform3f=Pi,t.UniformMatrix4f=Ci,t.create$2=ao,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.create$3=so,t.length=uo,t.fromValues=co,t.normalize$1=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t},t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.len=fo,t.forEach$1=ho,t.UniformColor=Ai,t.StructArrayLayout2i4=zr,t.StructArrayLayout2ui4=$r,t.StructArrayLayout3ui6=Qr,t.StructArrayLayout1ui2=ti,t.LngLat=ru,t.mercatorXfromLng=ou,t.mercatorYfromLat=au,t.mercatorZfromAltitude=su,t.wrap=l,t.UnwrappedTileID=fu,t.create$4=function(){var t=new oo(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},t.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},t.ease=u,t.bezier=s,t.config=M,t.EvaluationParameters=vr,t.version="0.51.0",t.setRTLTextPlugin=function(t,e){if(lr)throw new Error("setRTLTextPlugin cannot be called multiple times.");lr=!0,fr=C.resolveURL(t),cr=function(t){t?(lr=!1,fr=null,e&&e(t)):hr=!0},pr.fire(new it("pluginAvailable",{pluginURL:fr,completionCallback:cr}))},t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.featureFilter=xn,t.Anchor=rs,t.GLYPH_PBF_BORDER=$s,t.shapeText=function(t,e,n,r,i,o,a,s,u,c,l){var f=Su.fromFeature(t,n);l===Eu.vertical&&f.verticalizePunctuation();var h,p=[],d={positionedGlyphs:p,text:f,top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:l},v=dr.processBidirectionalText,g=dr.processStyledBidirectionalText;if(v&&1===f.sections.length){h=[];for(var m=0,y=v(f.toString(),Ou(f,s,r,e));m<y.length;m+=1){var _=y[m],b=new Su;b.text=_,b.sections=f.sections;for(var x=0;x<_.length;x++)b.sectionIndex.push(0);h.push(b)}}else if(g){h=[];for(var w=0,E=g(f.text,f.sectionIndex,Ou(f,s,r,e));w<E.length;w+=1){var S=E[w],P=new Su;P.text=S[0],P.sectionIndex=S[1],P.sections=f.sections,h.push(P)}}else h=function(t,e){for(var n=[],r=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];n.push(t.substring(i,s)),i=s}return i<r.length&&n.push(t.substring(i,r.length)),n}(f,Ou(f,s,r,e));return function(t,e,n,r,i,o,a,s,u){for(var c=0,l=-17,f=0,h=t.positionedGlyphs,p="right"===o?1:"left"===o?0:.5,d=0,v=n;d<v.length;d+=1){var g=v[d];g.trim();var m=g.getMaxScale();if(g.length()){for(var y=h.length,_=0;_<g.length();_++){var b=g.getSection(_),x=g.getCharCode(_),w=24*(m-b.scale),E=e[b.fontStack],S=E&&E[x];S&&(ar(x)&&a!==Eu.horizontal?(h.push({glyph:x,x:c,y:w,vertical:!0,scale:b.scale,fontStack:b.fontStack}),c+=u*b.scale+s):(h.push({glyph:x,x:c,y:l+w,vertical:!1,scale:b.scale,fontStack:b.fontStack}),c+=S.metrics.advance*b.scale+s))}if(h.length!==y){var P=c-s;f=Math.max(P,f),Iu(h,e,y,h.length-1,p)}c=0,l+=r*m}else l+=r}var T=Mu(i),A=T.horizontalAlign,k=T.verticalAlign;!function(t,e,n,r,i,o,a){for(var s=(e-n)*i,u=(-r*a+.5)*o,c=0;c<t.length;c++)t[c].x+=s,t[c].y+=u}(h,p,A,k,f,r,n.length);var C=l- -17;t.top+=-k*C,t.bottom=t.top+C,t.left+=-A*f,t.right=t.left+f}(d,e,h,i,o,a,l,s,c),!!p.length&&(d.text=d.text.toString(),d)},t.shapeIcon=function(t,e,n){var r=Mu(n),i=r.horizontalAlign,o=r.verticalAlign,a=e[0],s=e[1],u=a-t.displaySize[0]*i,c=u+t.displaySize[0],l=s-t.displaySize[1]*o;return{image:t,top:l,bottom:l+t.displaySize[1],left:u,right:c}},t.allowsVerticalWritingMode=ir,t.allowsLetterSpacing=function(t){for(var e=0,n=t;e<n.length;e+=1)if(!or(n[e].charCodeAt(0)))return!1;return!0},t.classifyRings=la,t.SymbolBucket=fs,t.register=Qn,t.FeatureIndex=bu,t.CollisionBoxArray=ii,t.DictionaryCoder=gu,t.LineBucket=Ga,t.FillBucket=da,t.FillExtrusionBucket=xa,t.ImageAtlas=Ss,t.mvt=za,t.Protobuf=Is,t.DEMData=du,t.vectorTile=za,t.Point$1=i,t.pbf=Is,t.plugin=dr}),r(0,function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",i=0,o=t;i<o.length;i+=1)r+=e(o[i])+",";return r+"]"}for(var a=Object.keys(t).sort(),s="{",u=0;u<a.length;u++)s+=JSON.stringify(a[u])+":"+e(t[a[u]])+",";return s+"}"}function n(n){for(var r="",i=0,o=t.refProperties;i<o.length;i+=1)r+="/"+e(n[o[i]]);return r}var r=function(t){t&&this.replace(t)};function i(t,e,n,r,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],c=0;s<n/2;){var l=t[a-1],f=t[a],h=t[a+1];if(!h)return!1;var p=l.angleTo(f)-f.angleTo(h);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:p}),c+=p;s-u[0].distance>r;)c-=u.shift().angleDelta;if(c>i)return!1;a++,s+=f.dist(h)}return!0}function o(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function a(t,e,n){return t?.6*e*n:0}function s(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function u(e,n,r,u,c,l){for(var f=a(r,c,l),h=s(r,u)*l,p=0,d=o(e)/2,v=0;v<e.length-1;v++){var g=e[v],m=e[v+1],y=g.dist(m);if(p+y>d){var _=(d-p)/y,b=t.number(g.x,m.x,_),x=t.number(g.y,m.y,_),w=new t.Anchor(b,x,m.angleTo(g),v);return w._round(),!f||i(e,w,h,f,n)?w:void 0}p+=y}}function c(e,n,r,u,c,l,f,h,p){var d=a(u,l,f),v=s(u,c),g=v*f,m=0===e[0].x||e[0].x===p||0===e[0].y||e[0].y===p;return n-g<n/4&&(n=g+n/4),function e(n,r,a,s,u,c,l,f,h){for(var p=c/2,d=o(n),v=0,g=r-a,m=[],y=0;y<n.length-1;y++){for(var _=n[y],b=n[y+1],x=_.dist(b),w=b.angleTo(_);g+a<v+x;){var E=((g+=a)-v)/x,S=t.number(_.x,b.x,E),P=t.number(_.y,b.y,E);if(S>=0&&S<h&&P>=0&&P<h&&g-p>=0&&g+p<=d){var T=new t.Anchor(S,P,w,y);T._round(),s&&!i(n,T,c,s,u)||m.push(T)}}v+=x}return f||m.length||l||(m=e(n,v/2,a,s,u,c,l,!0,h)),m}(e,m?n/2*h%n:(v/2+2*l)*f*h%n,n,d,r,g,m,!1,p)}r.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},r.prototype.update=function(e,r){for(var i=this,o=0,a=e;o<a.length;o+=1){var s=a[o];i._layerConfigs[s.id]=s;var u=i._layers[s.id]=t.createStyleLayer(s);u._featureFilter=t.featureFilter(u.filter)}for(var c=0,l=r;c<l.length;c+=1){var f=l[c];delete i._layerConfigs[f],delete i._layers[f]}this.familiesBySource={};for(var h=0,p=function(t){for(var e={},r=0;r<t.length;r++){var i=n(t[r]),o=e[i];o||(o=e[i]=[]),o.push(t[r])}var a=[];for(var s in e)a.push(e[s]);return a}(t.values(this._layerConfigs));h<p.length;h+=1){var d=p[h].map(function(t){return i._layers[t.id]}),v=d[0];if("none"!==v.visibility){var g=v.source||"",m=i.familiesBySource[g];m||(m=i.familiesBySource[g]={});var y=v.sourceLayer||"_geojsonTileLayer",_=m[y];_||(_=m[y]=[]),_.push(d)}}};var l=function(e,n,r,i,o,a,s,u,c,l,f,h){var p=s.top*u-c,d=s.bottom*u+c,v=s.left*u-c,g=s.right*u+c;if(this.boxStartIndex=e.length,l){var m=d-p,y=g-v;m>0&&(m=Math.max(10*u,m),this._addLineCollisionCircles(e,n,r,r.segment,y,m,i,o,a,f))}else{if(h){var _=new t.Point(v,p),b=new t.Point(g,p),x=new t.Point(v,d),w=new t.Point(g,d),E=h*Math.PI/180;_._rotate(E),b._rotate(E),x._rotate(E),w._rotate(E),v=Math.min(_.x,b.x,x.x,w.x),g=Math.max(_.x,b.x,x.x,w.x),p=Math.min(_.y,b.y,x.y,w.y),d=Math.max(_.y,b.y,x.y,w.y)}e.emplaceBack(r.x,r.y,v,p,g,d,i,o,a,0,0)}this.boxEndIndex=e.length};l.prototype._addLineCollisionCircles=function(t,e,n,r,i,o,a,s,u,c){var l=o/2,f=Math.floor(i/l)||1,h=1+.4*Math.log(c)/Math.LN2,p=Math.floor(f*h/2),d=-o/2,v=n,g=r+1,m=d,y=-i/2,_=y-i/4;do{if(--g<0){if(m>y)return;g=0;break}m-=e[g].dist(v),v=e[g]}while(m>_);for(var b=e[g].dist(e[g+1]),x=-p;x<f+p;x++){var w=x*l,E=y+w;if(w<0&&(E+=w),w>i&&(E+=w-i),!(E<m)){for(;m+b<E;){if(m+=b,++g+1>=e.length)return;b=e[g].dist(e[g+1])}var S=E-m,P=e[g],T=e[g+1].sub(P)._unit()._mult(S)._add(P)._round(),A=Math.abs(E-d)<l?0:.8*(E-d);t.emplaceBack(T.x,T.y,-o/2,-o/2,o/2,o/2,a,s,u,o/2,A)}}};var f=p,h=p;function p(t,e){if(!(this instanceof p))return new p(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||d,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function d(t,e){return t<e?-1:t>e?1:0}function v(e,n,r){void 0===n&&(n=1),void 0===r&&(r=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,u=e[0],c=0;c<u.length;c++){var l=u[c];(!c||l.x<i)&&(i=l.x),(!c||l.y<o)&&(o=l.y),(!c||l.x>a)&&(a=l.x),(!c||l.y>s)&&(s=l.y)}var h=a-i,p=s-o,d=Math.min(h,p),v=d/2,y=new f(null,g);if(0===d)return new t.Point(i,o);for(var _=i;_<a;_+=d)for(var b=o;b<s;b+=d)y.push(new m(_+v,b+v,v,e));for(var x=function(t){for(var e=0,n=0,r=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var u=i[o],c=i[s],l=u.x*c.y-c.x*u.y;n+=(u.x+c.x)*l,r+=(u.y+c.y)*l,e+=3*l}return new m(n/e,r/e,0,t)}(e),w=y.length;y.length;){var E=y.pop();(E.d>x.d||!x.d)&&(x=E,r&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,w)),E.max-x.d<=n||(v=E.h/2,y.push(new m(E.p.x-v,E.p.y-v,v,e)),y.push(new m(E.p.x+v,E.p.y-v,v,e)),y.push(new m(E.p.x-v,E.p.y+v,v,e)),y.push(new m(E.p.x+v,E.p.y+v,v,e)),w+=4)}return r&&(console.log("num probes: "+w),console.log("best distance: "+x.d)),x.p}function g(t,e){return e.max-t.max}function m(e,n,r,i){this.p=new t.Point(e,n),this.h=r,this.d=function(e,n){for(var r=!1,i=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,u=a.length,c=u-1;s<u;c=s++){var l=a[s],f=a[c];l.y>e.y!=f.y>e.y&&e.x<(f.x-l.x)*(e.y-l.y)/(f.y-l.y)+l.x&&(r=!r),i=Math.min(i,t.distToSegmentSquared(e,l,f))}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}p.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r},_down:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,i)>=0)break;e[t]=s,t=o}e[t]=i}},f.default=h;var y=t.createCommonjsModule(function(t){t.exports=function(t,e){var n,r,i,o,a,s,u,c;for(n=3&t.length,r=t.length-n,i=e,a=3432918353,s=461845907,c=0;c<r;)u=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,n){case 3:u^=(255&t.charCodeAt(c+2))<<16;case 2:u^=(255&t.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&t.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}}),_=y,b=y,x=t.createCommonjsModule(function(t){t.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}});function w(e,n,r,i,o,a){e.createArrays();var s=512*e.overscaling;e.tilePixelRatio=t.EXTENT/s,e.compareText={},e.iconsNeedLinear=!1;var u=e.layers[0].layout,c=e.layers[0]._unevaluatedLayout._values,l={};if("composite"===e.textSizeData.functionType){var f=e.textSizeData.zoomRange,h=f.min,p=f.max;l.compositeTextSizes=[c["text-size"].possiblyEvaluate(new t.EvaluationParameters(h)),c["text-size"].possiblyEvaluate(new t.EvaluationParameters(p))]}if("composite"===e.iconSizeData.functionType){var d=e.iconSizeData.zoomRange,v=d.min,g=d.max;l.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new t.EvaluationParameters(v)),c["icon-size"].possiblyEvaluate(new t.EvaluationParameters(g))]}l.layoutTextSize=c["text-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),l.layoutIconSize=c["icon-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),l.textMaxSize=c["text-size"].possiblyEvaluate(new t.EvaluationParameters(18));for(var m=24*u.get("text-line-height"),y="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),_=u.get("text-keep-upright"),b=0,x=e.features;b<x.length;b+=1){var w=x[b],S=u.get("text-font").evaluate(w,{}).join(","),P=r,T={},A=w.text;if(A){var k=A.toString(),C=u.get("text-offset").evaluate(w,{}).map(function(t){return 24*t}),O=24*u.get("text-letter-spacing").evaluate(w,{}),M=t.allowsLetterSpacing(k)?O:0,I=u.get("text-anchor").evaluate(w,{}),L=u.get("text-justify").evaluate(w,{}),R="point"===u.get("symbol-placement")?24*u.get("text-max-width").evaluate(w,{}):0;T.horizontal=t.shapeText(A,n,S,R,m,I,L,M,C,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(k)&&y&&_&&(T.vertical=t.shapeText(A,n,S,R,m,I,L,M,C,24,t.WritingMode.vertical))}var j=void 0;if(w.icon){var z=i[w.icon];z&&(j=t.shapeIcon(o[w.icon],u.get("icon-offset").evaluate(w,{}),u.get("icon-anchor").evaluate(w,{})),void 0===e.sdfIcons?e.sdfIcons=z.sdf:e.sdfIcons!==z.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),z.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==u.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(T.horizontal||j)&&E(e,w,T,j,P,l)}a&&e.generateCollisionDebugBuffers()}function E(e,n,r,i,o,a){var s=a.layoutTextSize.evaluate(n,{}),f=a.layoutIconSize.evaluate(n,{}),h=a.textMaxSize.evaluate(n,{});void 0===h&&(h=s);var p=e.layers[0].layout,d=p.get("text-offset").evaluate(n,{}),g=p.get("icon-offset").evaluate(n,{}),m=s/24,y=e.tilePixelRatio*m,b=e.tilePixelRatio*h/24,x=e.tilePixelRatio*f,w=e.tilePixelRatio*p.get("symbol-spacing"),E=p.get("text-padding")*e.tilePixelRatio,A=p.get("icon-padding")*e.tilePixelRatio,k=p.get("text-max-angle")/180*Math.PI,C="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),O="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),M=p.get("symbol-placement"),I=w/2,L=function(s,u){u.x<0||u.x>=t.EXTENT||u.y<0||u.y>=t.EXTENT||function(e,n,r,i,o,a,s,u,c,f,h,p,d,v,g,m,y,b,x,w,E){var T,A,k=e.addToLineVertexArray(n,r),C=0,O=0,M=0,I=_(i.horizontal?i.horizontal.text:""),L=[];if(i.horizontal){var R=a.layout.get("text-rotate").evaluate(x,{});T=new l(s,r,n,u,c,f,i.horizontal,h,p,d,e.overscaling,R),O+=P(e,n,i.horizontal,a,d,x,v,k,i.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,L,w,E),i.vertical&&(M+=P(e,n,i.vertical,a,d,x,v,k,t.WritingMode.vertical,L,w,E))}var j=T?T.boxStartIndex:e.collisionBoxArray.length,z=T?T.boxEndIndex:e.collisionBoxArray.length;if(o){var D=function(e,n,r,i,o,a){var s,u,c,l,f=n.image,h=r.layout,p=n.top-1/f.pixelRatio,d=n.left-1/f.pixelRatio,v=n.bottom+1/f.pixelRatio,g=n.right+1/f.pixelRatio;if("none"!==h.get("icon-text-fit")&&o){var m=g-d,y=v-p,_=h.get("text-size").evaluate(a,{})/24,b=o.left*_,x=o.right*_,w=o.top*_,E=x-b,S=o.bottom*_-w,P=h.get("icon-text-fit-padding")[0],T=h.get("icon-text-fit-padding")[1],A=h.get("icon-text-fit-padding")[2],k=h.get("icon-text-fit-padding")[3],C="width"===h.get("icon-text-fit")?.5*(S-y):0,O="height"===h.get("icon-text-fit")?.5*(E-m):0,M="width"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?E:m,I="height"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?S:y;s=new t.Point(b+O-k,w+C-P),u=new t.Point(b+O+T+M,w+C-P),c=new t.Point(b+O+T+M,w+C+A+I),l=new t.Point(b+O-k,w+C+A+I)}else s=new t.Point(d,p),u=new t.Point(g,p),c=new t.Point(g,v),l=new t.Point(d,v);var L=r.layout.get("icon-rotate").evaluate(a,{})*Math.PI/180;if(L){var R=Math.sin(L),j=Math.cos(L),z=[j,-R,R,j];s._matMult(z),u._matMult(z),l._matMult(z),c._matMult(z)}return[{tl:s,tr:u,bl:l,br:c,tex:f.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,o,a,0,i.horizontal,x),F=a.layout.get("icon-rotate").evaluate(x,{});A=new l(s,r,n,u,c,f,o,g,m,!1,e.overscaling,F),C=4*D.length;var N=e.iconSizeData,B=null;"source"===N.functionType?(B=[t.SIZE_PACK_FACTOR*a.layout.get("icon-size").evaluate(x,{})])[0]>S&&t.warnOnce(e.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===N.functionType&&((B=[t.SIZE_PACK_FACTOR*E.compositeIconSizes[0].evaluate(x,{}),t.SIZE_PACK_FACTOR*E.compositeIconSizes[1].evaluate(x,{})])[0]>S||B[1]>S)&&t.warnOnce(e.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),e.addSymbols(e.icon,D,B,b,y,x,!1,n,k.lineStartIndex,k.lineLength)}var U=A?A.boxStartIndex:e.collisionBoxArray.length,V=A?A.boxEndIndex:e.collisionBoxArray.length;e.glyphOffsetArray.length>=t.SymbolBucket.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),e.symbolInstances.emplaceBack(n.x,n.y,L.length>0?L[0]:-1,L.length>1?L[1]:-1,I,j,z,U,V,u,O,M,C,0)}(e,u,s,r,i,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,y,E,C,d,x,A,O,g,n,o,a)};if("line"===M)for(var R=0,j=function(e,n,r,i,o){for(var a=[],s=0;s<e.length;s++)for(var u=e[s],c=void 0,l=0;l<u.length-1;l++){var f=u[l],h=u[l+1];f.x<0&&h.x<0||(f.x<0?f=new t.Point(0,f.y+(h.y-f.y)*((0-f.x)/(h.x-f.x)))._round():h.x<0&&(h=new t.Point(0,f.y+(h.y-f.y)*((0-f.x)/(h.x-f.x)))._round()),f.y<0&&h.y<0||(f.y<0?f=new t.Point(f.x+(h.x-f.x)*((0-f.y)/(h.y-f.y)),0)._round():h.y<0&&(h=new t.Point(f.x+(h.x-f.x)*((0-f.y)/(h.y-f.y)),0)._round()),f.x>=i&&h.x>=i||(f.x>=i?f=new t.Point(i,f.y+(h.y-f.y)*((i-f.x)/(h.x-f.x)))._round():h.x>=i&&(h=new t.Point(i,f.y+(h.y-f.y)*((i-f.x)/(h.x-f.x)))._round()),f.y>=o&&h.y>=o||(f.y>=o?f=new t.Point(f.x+(h.x-f.x)*((o-f.y)/(h.y-f.y)),o)._round():h.y>=o&&(h=new t.Point(f.x+(h.x-f.x)*((o-f.y)/(h.y-f.y)),o)._round()),c&&f.equals(c[c.length-1])||(c=[f],a.push(c)),c.push(h)))))}return a}(n.geometry,0,0,t.EXTENT,t.EXTENT);R<j.length;R+=1)for(var z=j[R],D=0,F=c(z,w,k,r.vertical||r.horizontal,i,24,b,e.overscaling,t.EXTENT);D<F.length;D+=1){var N=F[D],B=r.horizontal;B&&T(e,B.text,I,N)||L(z,N)}else if("line-center"===M)for(var U=0,V=n.geometry;U<V.length;U+=1){var G=V[U];if(G.length>1){var q=u(G,k,r.vertical||r.horizontal,i,24,b);q&&L(G,q)}}else if("Polygon"===n.type)for(var W=0,Z=t.classifyRings(n.geometry,0);W<Z.length;W+=1){var X=Z[W],H=v(X,16);L(X[0],new t.Anchor(H.x,H.y,0))}else if("LineString"===n.type)for(var Y=0,K=n.geometry;Y<K.length;Y+=1){var J=K[Y];L(J,new t.Anchor(J[0].x,J[0].y,0))}else if("Point"===n.type)for(var Q=0,$=n.geometry;Q<$.length;Q+=1)for(var tt=0,et=$[Q];tt<et.length;tt+=1){var nt=et[tt];L([nt],new t.Anchor(nt.x,nt.y,0))}}_.murmur3=b,_.murmur2=x;var S=65535;function P(e,n,r,i,o,a,s,u,c,l,f,h){var p=function(e,n,r,i,o,a){for(var s=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=r.layout.get("text-offset").evaluate(o,{}).map(function(t){return 24*t}),c=n.positionedGlyphs,l=[],f=0;f<c.length;f++){var h=c[f],p=a[h.fontStack],d=p&&p[h.glyph];if(d){var v=d.rect;if(v){var g=t.GLYPH_PBF_BORDER+1,m=d.metrics.advance*h.scale/2,y=i?[h.x+m,h.y]:[0,0],_=i?[0,0]:[h.x+m+u[0],h.y+u[1]],b=(d.metrics.left-g)*h.scale-m+_[0],x=(-d.metrics.top-g)*h.scale+_[1],w=b+v.w*h.scale,E=x+v.h*h.scale,S=new t.Point(b,x),P=new t.Point(w,x),T=new t.Point(b,E),A=new t.Point(w,E);if(i&&h.vertical){var k=new t.Point(-m,m),C=-Math.PI/2,O=new t.Point(5,0);S._rotateAround(C,k)._add(O),P._rotateAround(C,k)._add(O),T._rotateAround(C,k)._add(O),A._rotateAround(C,k)._add(O)}if(s){var M=Math.sin(s),I=Math.cos(s),L=[I,-M,M,I];S._matMult(L),P._matMult(L),T._matMult(L),A._matMult(L)}l.push({tl:S,tr:P,bl:T,br:A,tex:v,writingMode:n.writingMode,glyphOffset:y})}}}return l}(0,r,i,o,a,f),d=e.textSizeData,v=null;return"source"===d.functionType?(v=[t.SIZE_PACK_FACTOR*i.layout.get("text-size").evaluate(a,{})])[0]>S&&t.warnOnce(e.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===d.functionType&&((v=[t.SIZE_PACK_FACTOR*h.compositeTextSizes[0].evaluate(a,{}),t.SIZE_PACK_FACTOR*h.compositeTextSizes[1].evaluate(a,{})])[0]>S||v[1]>S)&&t.warnOnce(e.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),e.addSymbols(e.text,p,v,s,o,a,c,n,u.lineStartIndex,u.lineLength),l.push(e.text.placedSymbolArray.length-1),4*p.length}function T(t,e,n,r){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(r.dist(o[a])<n)return!0}else i[e]=[];return i[e].push(r),!1}var A=function(e){var n={},r=[];for(var i in e){var o=e[i],a=n[i]={};for(var s in o){var u=o[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};r.push(c),a[s]={rect:c,metrics:u.metrics}}}}var l=t.potpack(r),f=l.w,h=l.h,p=new t.AlphaImage({width:f||1,height:h||1});for(var d in e){var v=e[d];for(var g in v){var m=v[+g];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var y=n[d][g].rect;t.AlphaImage.copy(m.bitmap,p,{x:0,y:0},{x:y.x+1,y:y.y+1},m.bitmap)}}}this.image=p,this.positions=n};t.register("GlyphAtlas",A);var k=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies};function C(e,n){for(var r=new t.EvaluationParameters(n),i=0,o=e;i<o.length;i+=1)o[i].recalculate(r)}k.prototype.parse=function(e,n,r,i){var o=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var a=new t.DictionaryCoder(Object.keys(e.layers).sort()),s=new t.FeatureIndex(this.tileID);s.bucketLayerIDs=[];var u,c,l,f,h={},p={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{}},d=n.familiesBySource[this.source];for(var v in d){var g=e.layers[v];if(g){1===g.version&&t.warnOnce('Vector tile source "'+o.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var m=a.encode(v),y=[],_=0;_<g.length;_++){var b=g.feature(_);y.push({feature:b,index:_,sourceLayerIndex:m})}for(var x=0,E=d[v];x<E.length;x+=1){var S=E[x],P=S[0];P.minzoom&&o.zoom<Math.floor(P.minzoom)||P.maxzoom&&o.zoom>=P.maxzoom||"none"!==P.visibility&&(C(S,o.zoom),(h[P.id]=P.createBucket({index:s.bucketLayerIDs.length,layers:S,zoom:o.zoom,pixelRatio:o.pixelRatio,overscaling:o.overscaling,collisionBoxArray:o.collisionBoxArray,sourceLayerIndex:m,sourceID:o.source})).populate(y,p),s.bucketLayerIDs.push(S.map(function(t){return t.id})))}}}var T=t.mapObject(p.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(T).length?r.send("getGlyphs",{uid:this.uid,stacks:T},function(t,e){u||(u=t,c=e,M.call(o))}):c={};var k=Object.keys(p.iconDependencies);k.length?r.send("getImages",{icons:k},function(t,e){u||(u=t,l=e,M.call(o))}):l={};var O=Object.keys(p.patternDependencies);function M(){if(u)return i(u);if(c&&l&&f){var e=new A(c),n=new t.ImageAtlas(l,f);for(var r in h){var o=h[r];o instanceof t.SymbolBucket?(C(o.layers,this.zoom),w(o,c,e.positions,l,n.iconPositions,this.showCollisionBoxes)):o.hasPattern&&(o instanceof t.LineBucket||o instanceof t.FillBucket||o instanceof t.FillExtrusionBucket)&&(C(o.layers,this.zoom),o.addFeatures(p,n.patternPositions))}this.status="done",i(null,{buckets:t.values(h).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n,glyphMap:this.returnDependencies?c:null,iconMap:this.returnDependencies?l:null,glyphPositions:this.returnDependencies?e.positions:null})}}O.length?r.send("getImages",{icons:O},function(t,e){u||(u=t,f=e,M.call(o))}):f={},M.call(this)};var O="undefined"!=typeof performance,M={getEntriesByName:function(t){return!!(O&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(O&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,n){return!!(O&&performance&&performance.measure)&&performance.measure(t,e,n)},clearMarks:function(t){return!!(O&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(O&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},I=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},M.mark(this._marks.start)};function L(e,n){var r=t.getArrayBuffer(e.request,function(e,r,i,o){e?n(e):r&&n(null,{vectorTile:new t.mvt.VectorTile(new t.Protobuf(r)),rawData:r,cacheControl:i,expires:o})});return function(){r.cancel(),n()}}I.prototype.finish=function(){M.mark(this._marks.end);var t=M.getEntriesByName(this._marks.measure);return 0===t.length&&(M.measure(this._marks.measure,this._marks.start,this._marks.end),t=M.getEntriesByName(this._marks.measure),M.clearMarks(this._marks.start),M.clearMarks(this._marks.end),M.clearMeasures(this._marks.measure)),t},M.Performance=I;var R=function(t,e,n){this.actor=t,this.layerIndex=e,this.loadVectorData=n||L,this.loading={},this.loaded={}};R.prototype.loadTile=function(e,n){var r=this,i=e.uid;this.loading||(this.loading={});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new M.Performance(e.request),a=this.loading[i]=new k(e);a.abort=this.loadVectorData(e,function(e,s){if(delete r.loading[i],e||!s)return a.status="done",r.loaded[i]=a,n(e);var u=s.rawData,c={};s.expires&&(c.expires=s.expires),s.cacheControl&&(c.cacheControl=s.cacheControl);var l={};if(o){var f=o.finish();f&&(l.resourceTiming=JSON.parse(JSON.stringify(f)))}a.vectorTile=s.vectorTile,a.parse(s.vectorTile,r.layerIndex,r.actor,function(e,r){if(e||!r)return n(e);n(null,t.extend({rawTileData:u.slice(0)},r,c,l))}),r.loaded=r.loaded||{},r.loaded[i]=a})},R.prototype.reloadTile=function(t,e){var n=this.loaded,r=t.uid,i=this;if(n&&n[r]){var o=n[r];o.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,n){var r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,i.actor,r)),e(t,n)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.actor,a):a())}},R.prototype.abortTile=function(t,e){var n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()},R.prototype.removeTile=function(t,e){var n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()};var j=function(){this.loaded={}};j.prototype.loadTile=function(e,n){var r=e.uid,i=e.encoding,o=e.rawImageData,a=new t.DEMData(r,o,i);this.loaded=this.loaded||{},this.loaded[r]=a,n(null,a)},j.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var z={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function D(t){var e=0;if(t&&t.length>0){e+=Math.abs(F(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(F(t[n]))}return e}function F(t){var e,n,r,i,o,a,s=0,u=t.length;if(u>2){for(a=0;a<u;a++)a===u-2?(r=u-2,i=u-1,o=0):a===u-1?(r=u-1,i=0,o=1):(r=a,i=a+1,o=a+2),e=t[r],n=t[i],s+=(N(t[o][0])-N(e[0]))*Math.sin(N(n[1]));s=s*z.RADIUS*z.RADIUS/2}return s}function N(t){return t*Math.PI/180}var B={geometry:function t(e){var n,r=0;switch(e.type){case"Polygon":return D(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)r+=D(e.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)r+=t(e.geometries[n]);return r}},ring:F};function U(t,e){return function(n){return t(n,e)}}function V(t,e){e=!!e,t[0]=G(t[0],e);for(var n=1;n<t.length;n++)t[n]=G(t[n],!e);return t}function G(t,e){return function(t){return B.ring(t)>=0}(t)===e?t:t.reverse()}var q=t.mvt.VectorTileFeature.prototype.toGeoJSON,W=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};W.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,r=this._feature.geometry;n<r.length;n+=1){var i=r[n];e.push([new t.Point(i[0],i[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var u=[],c=0,l=s[a];c<l.length;c+=1){var f=l[c];u.push(new t.Point(f[0],f[1]))}o.push(u)}return o},W.prototype.toGeoJSON=function(t,e,n){return q.call(this,t,e,n)};var Z=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};Z.prototype.feature=function(t){return new W(this._features[t])};var X=t.vectorTile.VectorTileFeature,H=Y;function Y(t,e){this.options=e||{},this.features=t,this.length=t.length}function K(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Y.prototype.feature=function(t){return new K(this.features[t],this.options.extent)},K.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++)i.push(new t.Point$1(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},K.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),n=Math.max(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.y)}return[e,r,n,i]},K.prototype.toGeoJSON=X.prototype.toGeoJSON;var J=tt,Q=tt,$=H;function tt(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,et,t.layers[n])}(e,n),n.finish()}function et(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,nt,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,st,o[n])}function nt(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,rt,t),e.writeVarintField(3,n.type),e.writeMessage(4,at,n)}function rt(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var u=o[s];void 0===u&&(r.push(s),u=r.length-1,o[s]=u),e.writeVarint(u);var c=n.properties[s],l=typeof c;"string"!==l&&"boolean"!==l&&"number"!==l&&(c=JSON.stringify(c));var f=l+":"+c,h=a[f];void 0===h&&(i.push(c),h=i.length-1,a[f]=h),e.writeVarint(h)}}function it(t,e){return(e<<3)+(7&t)}function ot(t){return t<<1^t>>31}function at(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,a=n.length,s=0;s<a;s++){var u=n[s],c=1;1===r&&(c=u.length),e.writeVarint(it(1,c));for(var l=3===r?u.length-1:u.length,f=0;f<l;f++){1===f&&1!==r&&e.writeVarint(it(2,l-1));var h=u[f].x-i,p=u[f].y-o;e.writeVarint(ot(h)),e.writeVarint(ot(p)),i+=h,o+=p}3===r&&e.writeVarint(it(7,0))}}function st(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function ut(t,e,n,r){ct(t,n,r),ct(e,2*n,2*r),ct(e,2*n+1,2*r+1)}function ct(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function lt(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}function ft(t,e,n,r,i){return new ht(t,e,n,r,i)}function ht(t,e,n,r,i){e=e||pt,n=n||dt,i=i||Array,this.nodeSize=r||64,this.points=t,this.ids=new i(t.length),this.coords=new i(2*t.length);for(var o=0;o<t.length;o++)this.ids[o]=o,this.coords[2*o]=e(t[o]),this.coords[2*o+1]=n(t[o]);!function t(e,n,r,i,o,a){if(!(o-i<=r)){var s=Math.floor((i+o)/2);!function t(e,n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);t(e,n,r,Math.max(i,Math.floor(r-u*l/s+f)),Math.min(o,Math.floor(r+(s-u)*l/s+f)),a)}var h=n[2*r+a],p=i,d=o;for(ut(e,n,i,r),n[2*o+a]>h&&ut(e,n,i,o);p<d;){for(ut(e,n,p,d),p++,d--;n[2*p+a]<h;)p++;for(;n[2*d+a]>h;)d--}n[2*i+a]===h?ut(e,n,i,d):ut(e,n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(e,n,s,i,o,a%2),t(e,n,r,i,s-1,a+1),t(e,n,r,s+1,o,a+1)}}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function pt(t){return t[0]}function dt(t){return t[1]}function vt(t){this.options=xt(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function gt(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function mt(t){return{type:"Feature",id:t.id,properties:yt(t),geometry:{type:"Point",coordinates:[(r=t.x,360*(r-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,r}function yt(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return xt(xt({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function _t(t){return t/360+.5}function bt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function xt(t,e){for(var n in e)t[n]=e[n];return t}function wt(t){return t.x}function Et(t){return t.y}function St(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((t-n)*a+(e-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return(a=t-n)*a+(s=e-r)*s}function Pt(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Tt(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)Tt(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)Tt(t,e[r][i])}(i),i}function Tt(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function At(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)kt(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)kt(i[c],s);else if("LineString"===o)Ct(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<i.length;c++)s=[],Ct(i[c],s,a,!1),t.push(Pt(u,"LineString",s,e.properties));return}Ot(i,s,a,!1)}else if("Polygon"===o)Ot(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)At(t,{id:u,geometry:e.geometry.geometries[c],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];Ot(i[c],l,a,!0),s.push(l)}}t.push(Pt(u,o,s,e.properties))}}function kt(t,e){e.push(Mt(t[0])),e.push(It(t[1])),e.push(0)}function Ct(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var u=Mt(t[s][0]),c=It(t[s][1]);e.push(u),e.push(c),e.push(0),s>0&&(a+=r?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=e.length-3;e[2]=1,function t(e,n,r,i){for(var o,a=i,s=r-n>>1,u=r-n,c=e[n],l=e[n+1],f=e[r],h=e[r+1],p=n+3;p<r;p+=3){var d=St(e[p],e[p+1],c,l,f,h);if(d>a)o=p,a=d;else if(d===a){var v=Math.abs(p-s);v<u&&(o=p,u=v)}}a>i&&(o-n>3&&t(e,n,o,i),e[o+2]=a,r-o>3&&t(e,o,r,i))}(e,0,l,n),e[l+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Ot(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];Ct(t[i],o,n,r),e.push(o)}}function Mt(t){return t/360+.5}function It(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Lt(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var u=[],c=0;c<t.length;c++){var l=t[c],f=l.geometry,h=l.type,p=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(p>=n&&d<r)u.push(l);else if(!(d<n||p>=r)){var v=[];if("Point"===h||"MultiPoint"===h)Rt(f,v,n,r,i);else if("LineString"===h)jt(f,v,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===h)Dt(f,v,n,r,i,!1);else if("Polygon"===h)Dt(f,v,n,r,i,!0);else if("MultiPolygon"===h)for(var g=0;g<f.length;g++){var m=[];Dt(f[g],m,n,r,i,!0),m.length&&v.push(m)}if(v.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<v.length;g++)u.push(Pt(l.id,h,v[g],l.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===v.length?(h="LineString",v=v[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===v.length?"Point":"MultiPoint"),u.push(Pt(l.id,h,v,l.tags))}}}return u.length?u:null}function Rt(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function jt(t,e,n,r,i,o,a){for(var s,u,c=zt(t),l=0===i?Nt:Bt,f=t.start,h=0;h<t.length-3;h+=3){var p=t[h],d=t[h+1],v=t[h+2],g=t[h+3],m=t[h+4],y=0===i?p:d,_=0===i?g:m,b=!1;a&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(d-m,2))),y<n?_>n&&(u=l(c,p,d,g,m,n),a&&(c.start=f+s*u)):y>r?_<r&&(u=l(c,p,d,g,m,r),a&&(c.start=f+s*u)):Ft(c,p,d,v),_<n&&y>=n&&(u=l(c,p,d,g,m,n),b=!0),_>r&&y<=r&&(u=l(c,p,d,g,m,r),b=!0),!o&&b&&(a&&(c.end=f+s*u),e.push(c),c=zt(t)),a&&(f+=s)}var x=t.length-3;p=t[x],d=t[x+1],v=t[x+2],(y=0===i?p:d)>=n&&y<=r&&Ft(c,p,d,v),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&Ft(c,c[0],c[1],c[2]),c.length&&e.push(c)}function zt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Dt(t,e,n,r,i,o){for(var a=0;a<t.length;a++)jt(t[a],e,n,r,i,o,!1)}function Ft(t,e,n,r){t.push(e),t.push(n),t.push(r)}function Nt(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function Bt(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function Ut(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=Vt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(Vt(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(Vt(o.geometry[s][c],e));i.push(u)}n.push(Pt(o.id,a,i,o.tags))}return n}function Vt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function Gt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(r=0;r<c.length;r+=2)u.geometry.push(qt(c[r],c[r+1],e,o,a,s));else for(r=0;r<c.length;r++){var f=[];for(i=0;i<c[r].length;i+=2)f.push(qt(c[r][i],c[r][i+1],e,o,a,s));u.geometry.push(f)}}return t.transformed=!0,t}function qt(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function Wt(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Zt(a,t[s],o,i);var u=t[s].minX,c=t[s].minY,l=t[s].maxX,f=t[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),f>a.maxY&&(a.maxY=f)}return a}function Zt(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Xt(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)Xt(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)Xt(a,c[s],t,n,!0,0===s)}if(a.length){var l=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var f in l={},e.tags)l[f]=e.tags[f];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==e.id&&(h.id=e.id),t.features.push(h)}}function Xt(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===r||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function Ht(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)At(n,t.features[r],e,r);else"Feature"===t.type?At(n,t,e):At(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,i=Lt(t,1,-1-n,n,0,-1,2,e),o=Lt(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=Lt(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=Ut(i,1).concat(r)),o&&(r=r.concat(Ut(o,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yt(t,e,n){return 32*((1<<t)*n+e)+t}function Kt(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);var i=new Z(r.features),o=J(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}J.fromVectorTileJs=Q,J.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new H(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return tt({layers:n})},J.GeoJSONWrapper=$,ht.prototype={range:function(t,e,n,r){return function(t,e,n,r,i,o,a){for(var s,u,c=[0,t.length-1,0],l=[];c.length;){var f=c.pop(),h=c.pop(),p=c.pop();if(h-p<=a)for(var d=p;d<=h;d++)s=e[2*d],u=e[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var v=Math.floor((p+h)/2);s=e[2*v],u=e[2*v+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[v]);var g=(f+1)%2;(0===f?n<=s:r<=u)&&(c.push(p),c.push(v-1),c.push(g)),(0===f?i>=s:o>=u)&&(c.push(v+1),c.push(h),c.push(g))}}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)},within:function(t,e,n){return function(t,e,n,r,i,o){for(var a=[0,t.length-1,0],s=[],u=i*i;a.length;){var c=a.pop(),l=a.pop(),f=a.pop();if(l-f<=o)for(var h=f;h<=l;h++)lt(e[2*h],e[2*h+1],n,r)<=u&&s.push(t[h]);else{var p=Math.floor((f+l)/2),d=e[2*p],v=e[2*p+1];lt(d,v,n,r)<=u&&s.push(t[p]);var g=(c+1)%2;(0===c?n-i<=d:r-i<=v)&&(a.push(f),a.push(p-1),a.push(g)),(0===c?n+i>=d:r+i>=v)&&(a.push(p+1),a.push(l),a.push(g))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)}},vt.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;for(var r,i,o=[],a=0;a<t.length;a++)t[a].geometry&&o.push((r=a,{x:_t((i=t[a].geometry.coordinates)[0]),y:bt(i[1]),zoom:1/0,index:r,parentId:-1}));this.trees[this.options.maxZoom+1]=ft(o,wt,Et,this.options.nodeSize,Float32Array),e&&console.timeEnd(n);for(var s=this.options.maxZoom;s>=this.options.minZoom;s--){var u=+Date.now();o=this._cluster(o,s),this.trees[s]=ft(o,wt,Et,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",s,o.length,+Date.now()-u)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],c=u.range(_t(n),bt(o),_t(i),bt(r)),l=[],f=0;f<c.length;f++){var h=u.points[c[f]];l.push(h.numPoints?mt(h):this.points[h.index])}return l},getChildren:function(t){var e=t>>5,n=t%32,r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),u=[],c=0;c<s.length;c++){var l=i.points[s[c]];l.parentId===t&&u.push(l.numPoints?mt(l):this.points[l.index])}if(0===u.length)throw new Error(r);return u},getLeaves:function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},getTile:function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,s,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,s,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,s,a/i,u),r.points,-1,n,i,c),c.features.length?c:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,r,i){for(var o=this.getChildren(e),a=0;a<o.length;a++){var s=o[a].properties;if(s&&s.cluster?i+s.point_count<=r?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,n,r,i):i<r?i++:t.push(o[a]),t.length===n)break}return i},_addTileFeatures:function(t,e,n,r,i,o){for(var a=0;a<t.length;a++){var s=e[t[a]],u={type:1,geometry:[[Math.round(this.options.extent*(s.x*i-n)),Math.round(this.options.extent*(s.y*i-r))]],tags:s.numPoints?yt(s):this.points[s.index].properties},c=s.numPoints?s.id:this.points[s.index].id;void 0!==c&&(u.id=c),o.features.push(u)}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],r=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var o=t[i];if(!(o.zoom<=e)){o.zoom=e;var a=this.trees[e+1],s=a.within(o.x,o.y,r),u=o.numPoints||1,c=o.x*u,l=o.y*u,f=null;this.options.reduce&&(f=this.options.initial(),this._accumulate(f,o));for(var h=(i<<5)+(e+1),p=0;p<s.length;p++){var d=a.points[s[p]];if(!(d.zoom<=e)){d.zoom=e;var v=d.numPoints||1;c+=d.x*v,l+=d.y*v,u+=v,d.parentId=h,this.options.reduce&&this._accumulate(f,d)}}1===u?n.push(o):(o.parentId=h,n.push(gt(c/u,l/u,h,u,f)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.index].properties);this.options.reduce(t,n)}},Ht.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ht.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],u=this.options,c=u.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var l=1<<e,f=Yt(e,n,r),h=this.tiles[f];if(!h&&(c>1&&console.time("creation"),h=this.tiles[f]=Wt(t,e,n,r,u),this.tileCoords.push({z:e,x:n,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=t,i){if(e===u.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||h.numPoints<=u.indexMaxPoints)continue;if(h.source=null,0!==t.length){c>1&&console.time("clipping");var v,g,m,y,_,b,x=.5*u.buffer/u.extent,w=.5-x,E=.5+x,S=1+x;v=g=m=y=null,_=Lt(t,l,n-x,n+E,0,h.minX,h.maxX,u),b=Lt(t,l,n+w,n+S,0,h.minX,h.maxX,u),t=null,_&&(v=Lt(_,l,r-x,r+E,1,h.minY,h.maxY,u),g=Lt(_,l,r+w,r+S,1,h.minY,h.maxY,u),_=null),b&&(m=Lt(b,l,r-x,r+E,1,h.minY,h.maxY,u),y=Lt(b,l,r+w,r+S,1,h.minY,h.maxY,u),b=null),c>1&&console.timeEnd("clipping"),s.push(v||[],e+1,2*n,2*r),s.push(g||[],e+1,2*n,2*r+1),s.push(m||[],e+1,2*n+1,2*r),s.push(y||[],e+1,2*n+1,2*r+1)}}},Ht.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var a=1<<t,s=Yt(t,e=(e%a+a)%a,n);if(this.tiles[s])return Gt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var u,c=t,l=e,f=n;!u&&c>0;)c--,l=Math.floor(l/2),f=Math.floor(f/2),u=this.tiles[Yt(c,l,f)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,f),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,f,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Gt(this.tiles[s],i):null):null};var Jt=function(e){function n(t,n,r){e.call(this,t,n,Kt),r&&(this.loadGeoJSON=r)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,n=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var r=!!(n&&n.request&&n.request.collectResourceTiming)&&new M.Performance(n.request);this.loadGeoJSON(n,function(i,o){if(i||!o)return e(i);if("object"!=typeof o)return e(new Error("Input data is not a valid GeoJSON object."));!function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(U(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return function(t,e){return"Polygon"===t.type?t.coordinates=V(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(U(V,e))),t}(e,n);default:return e}}(o,!0);try{t._geoJSONIndex=n.cluster?(a=n.superclusterOptions,new vt(a)).load(o.features):new Ht(o,n.geojsonVtOptions)}catch(i){return e(i)}t.loaded={};var a,s={};if(r){var u=r.finish();u&&(s.resourceTiming={},s.resourceTiming[n.source]=JSON.parse(JSON.stringify(u)))}e(null,s)})}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var r=this.loaded,i=t.uid;return r&&r[i]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))},n.prototype.getClusterChildren=function(t,e){e(null,this._geoJSONIndex.getChildren(t.clusterId))},n.prototype.getClusterLeaves=function(t,e){e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))},n}(R),Qt=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.workerSourceTypes={vector:R,geojson:Jt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return Qt.prototype.setReferrer=function(t,e){this.referrer=e},Qt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},Qt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},Qt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},Qt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},Qt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},Qt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},Qt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},Qt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Qt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}},Qt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},Qt.prototype.loadRTLTextPlugin=function(e,n,r){try{t.plugin.isLoaded()||(this.self.importScripts(n),r(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+n)))}catch(t){r(t.toString())}},Qt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e},Qt.prototype.getWorkerSource=function(t,e,n){var r=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){var i={send:function(e,n,i){r.actor.send(e,n,i,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](i,this.getLayerIndex(t))}return this.workerSources[t][e][n]},Qt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new j),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Qt(self)),Qt}),r(0,function(t){var e=t.createCommonjsModule(function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(t){return void 0===n[t]&&(n[t]=function(t){var n=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",r)||n.probablySupportsContext("experimental-webgl",r):n.supportsContext?n.supportsContext("webgl",r)||n.supportsContext("experimental-webgl",r):n.getContext("webgl",r)||n.getContext("experimental-webgl",r)}(t)),n[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var n={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),n={create:function(e,n,r){var i=t.window.document.createElement(e);return n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},r=t.window.document?t.window.document.documentElement.style:null;function i(t){if(!r)return null;for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){r&&a&&(o=r[a],r[a]="none")},n.enableDrag=function(){r&&a&&(r[a]=o)};var s=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[s]=e};var u=!1;try{var c=Object.defineProperty({},"passive",{get:function(){u=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){u=!1}n.addEventListener=function(t,e,n,r){void 0===r&&(r={}),"passive"in r&&u?t.addEventListener(e,n,r):t.addEventListener(e,n,r.capture)},n.removeEventListener=function(t,e,n,r){void 0===r&&(r={}),"passive"in r&&u?t.removeEventListener(e,n,r):t.removeEventListener(e,n,r.capture)};var l=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",l,!0)};n.suppressClick=function(){t.window.addEventListener("click",l,!0),t.window.setTimeout(function(){t.window.removeEventListener("click",l,!0)},0)},n.mousePos=function(e,n){var r=e.getBoundingClientRect();return n=n.touches?n.touches[0]:n,new t.Point(n.clientX-r.left-e.clientLeft,n.clientY-r.top-e.clientTop)},n.touchPos=function(e,n){for(var r=e.getBoundingClientRect(),i=[],o="touchend"===n.type?n.changedTouches:n.touches,a=0;a<o.length;a++)i.push(new t.Point(o[a].clientX-r.left-e.clientLeft,o[a].clientY-r.top-e.clientTop));return i},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var f=function(){this.images={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0};f.prototype.isLoaded=function(){return this.loaded},f.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var r=n[e],i=r.ids,o=r.callback;this._notify(i,o)}this.requestors=[]}},f.prototype.getImage=function(t){return this.images[t]},f.prototype.addImage=function(t,e){this.images[t]=e},f.prototype.removeImage=function(t){delete this.images[t],delete this.patterns[t]},f.prototype.listImages=function(){return Object.keys(this.images)},f.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var r=0,i=t;r<i.length;r+=1){var o=i[r];this.images[o]||(n=!1)}this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},f.prototype._notify=function(t,e){for(var n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=this.images[o];a&&(n[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf})}e(null,n)},f.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},f.prototype.getPattern=function(e){var n=this.patterns[e];if(n)return n.position;var r=this.getImage(e);if(!r)return null;var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new t.ImagePosition(i,r);return this.patterns[e]={bin:i,position:o},this._updatePatternAtlas(),o},f.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},f.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var r=t.potpack(e),i=r.w,o=r.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var u=this.patterns[s].bin,c=u.x+1,l=u.y+1,f=this.images[s].data,h=f.width,p=f.height;t.RGBAImage.copy(f,a,{x:0,y:0},{x:c,y:l},{width:h,height:p}),t.RGBAImage.copy(f,a,{x:0,y:p-1},{x:c,y:l-1},{width:h,height:1}),t.RGBAImage.copy(f,a,{x:0,y:0},{x:c,y:l+p},{width:h,height:1}),t.RGBAImage.copy(f,a,{x:h-1,y:0},{x:c-1,y:l},{width:1,height:p}),t.RGBAImage.copy(f,a,{x:0,y:0},{x:c+h,y:l},{width:1,height:p})}this.dirty=!0};var h=d,p=1e20;function d(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function v(t,e,n,r,i,o,a){for(var s=0;s<e;s++){for(var u=0;u<n;u++)r[u]=t[u*e+s];for(g(r,i,o,a,n),u=0;u<n;u++)t[u*e+s]=i[u]}for(u=0;u<n;u++){for(s=0;s<e;s++)r[s]=t[u*e+s];for(g(r,i,o,a,e),s=0;s<e;s++)t[u*e+s]=Math.sqrt(i[s])}}function g(t,e,n,r,i){n[0]=0,r[0]=-p,r[1]=+p;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=+p}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}d.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=e.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?p:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?p:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(v(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),v(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var o=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return n};var m=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};m.prototype.setURL=function(t){this.url=t},m.prototype.getGlyphs=function(e,n){var r=this,i=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var u=s[a];i.push({stack:o,id:u})}t.asyncAll(i,function(t,e){var n=t.stack,i=t.id,o=r.entries[n];o||(o=r.entries[n]={glyphs:{},requests:{}});var a=o.glyphs[i];if(void 0===a)if(a=r._tinySDF(o,n,i))e(null,{stack:n,id:i,glyph:a});else{var s=Math.floor(i/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var u=o.requests[s];u||(u=o.requests[s]=[],m.loadGlyphRange(n,s,r.url,r.requestTransform,function(t,e){if(e)for(var n in e)o.glyphs[+n]=e[+n];for(var r=0,i=u;r<i.length;r+=1)(0,i[r])(t,e);delete o.requests[s]})),u.push(function(t,r){t?e(t):r&&e(null,{stack:n,id:i,glyph:r[i]||null})})}}else e(null,{stack:n,id:i,glyph:a})},function(t,e){if(t)n(t);else if(e){for(var r={},i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.stack,u=a.id,c=a.glyph;(r[s]||(r[s]={}))[u]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}n(null,r)}})},m.prototype._tinySDF=function(e,n,r){var i=this.localIdeographFontFamily;if(i&&(t.isChar["CJK Unified Ideographs"](r)||t.isChar["Hangul Syllables"](r))){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new m.TinySDF(24,3,8,.25,i,a)}return{id:r,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},m.loadGlyphRange=function(e,n,r,i,o){var a=256*n,s=a+255,u=i(t.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(u,function(e,n){if(e)o(e);else if(n){for(var r={},i=0,a=t.parseGlyphPBF(n);i<a.length;i+=1){var s=a[i];r[s.id]=s}o(null,r)}})},m.TinySDF=h;var y=function(){this.specification=t.styleSpec.light.position};y.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},y.prototype.interpolate=function(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}};var _=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new y,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),b=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(_),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var n in e){var r=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-"-transition".length),r):this._transitionable.setValue(n,r)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),x=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};x.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},x.prototype.addDash=function(e,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,u=s/2,c=e.length%2==1,l=-r;l<=r;l++)for(var f=this.nextRow+r+l,h=this.width*f,p=c?-e[e.length-1]:0,d=e[0],v=1,g=0;g<this.width;g++){for(;d<g/s;)p=d,d+=e[v],c&&v===e.length-1&&(d+=e[0]),v++;var m=Math.abs(g-p*s),y=Math.abs(g-d*s),_=Math.min(m,y),b=v%2==1,x=void 0;if(n){var w=r?l/r*(u+1):0;if(b){var E=u-Math.abs(w);x=Math.sqrt(_*_+E*E)}else x=u-Math.sqrt(_*_+w*w)}else x=(b?1:-1)*_;this.data[3+4*(h+g)]=Math.max(0,Math.min(255,x+128))}var S={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,S},x.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var w=function e(n,r){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=i[o],s=new e.Actor(a,r,this.id);s.name="Worker "+o,this.actors.push(s)}};function E(e,n,r){var i=function(e,n){if(e)return r(e);if(n){var i=t.pick(n,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);n.vector_layers&&(i.vectorLayers=n.vector_layers,i.vectorLayerIds=i.vectorLayers.map(function(t){return t.id})),r(null,i)}};return e.url?t.getJSON(n(t.normalizeSourceURL(e.url),t.ResourceType.Source),i):t.browser.frame(function(){return i(null,e)})}w.prototype.broadcast=function(e,n,r){r=r||function(){},t.asyncAll(this.actors,function(t,r){t.send(e,n,r)},r)},w.prototype.send=function(t,e,n,r){return("number"!=typeof r||isNaN(r))&&(r=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[r].send(t,e,n),r},w.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},w.Actor=t.Actor;var S=function(e,n,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=r||24};S.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},S.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),n=Math.floor(this.latY(this.bounds.getNorth(),t.z)),r=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),i=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<r&&t.y>=n&&t.y<i},S.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},S.prototype.latY=function(e,n){var r=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),i=Math.pow(2,n)/(2*Math.PI);return Math.pow(2,n-1)+.5*Math.log((1+r)/(1-r))*-i};var P=function(e){function n(n,r,i,o){if(e.call(this),this.id=n,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(r,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._transformRequest,function(n,r){e._tileJSONRequest=null,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new S(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles),t.postMapLoadEvent(r.tiles,e.map._getMapId()),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var r=t.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url),i={request:this.map._transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(t,r){return e.aborted?n(null):t&&404!==t.status?n(t):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",i,o.bind(this)):"loading"===e.state?e.reloadCallback=n:this.dispatcher.send("reloadTile",i,o.bind(this),e.workerID)},n.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),T=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._transformRequest,function(n,r){e._tileJSONRequest=null,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new S(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles),t.postMapLoadEvent(r.tiles,e.map._getMapId()),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var r=this,i=t.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(i,t.ResourceType.Tile),function(i,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){r.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=r.map.painter.context,s=a.gl;e.texture=r.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",n(null)}})},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),A=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},r),this.encoding=r.encoding||"mapbox"}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var r=t.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(r,t.ResourceType.Tile),function(r,i){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData(i),delete i.cacheControl,delete i.expires;var o=t.browser.getImageData(i),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",a,function(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,u={};return u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),u},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},n}(T),k=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=i,this.setEventedParent(o),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution);var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*a,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.EXTENT,radius:(r.clusterRadius||50)*a,log:!1}},r.workerOptions)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(n){if(n)e.fire(new t.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(r.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",r))}})},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)n.fire(new t.ErrorEvent(e));else{var r={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(r.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",r))}}),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e,this.workerID),this},n.prototype.getClusterChildren=function(t,e){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e,this.workerID),this},n.prototype.getClusterLeaves=function(t,e,n,r){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r,this.workerID),this},n.prototype._updateWorkerData=function(e){var n=this,r=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this.workerID=this.dispatcher.send(this.type+".loadData",r,function(t,i){n._removed||i&&i.abandoned||(n._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[n.id]&&(n._resourceTiming=i.resourceTiming[n.id].slice(0)),n.dispatcher.send(n.type+".coalesce",{source:r.source},null,n.workerID),e(t))},this.workerID)},n.prototype.loadTile=function(e,n){var r=this,i=void 0===e.workerID?"loadTile":"reloadTile",o={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(i,o,function(t,o){return e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,r.map.painter,"reloadTile"===i),n(null))},this.workerID)},n.prototype.abortTile=function(t){t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},n.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),C=function(e){function n(t,n,r,i){e.call(this),this.id=t,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(e,n){var r=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),function(i,o){i?r.fire(new t.ErrorEvent(i)):o&&(r.image=t.browser.getImageData(o),e&&(r.coordinates=e),n&&n(),r._finishLoading())})},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,function(){e.texture=null}),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){var n=this;this.coordinates=e;var r=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var n=1/0,r=1/0,i=-1/0,o=-1/0,a=0,s=e;a<s.length;a+=1){var u=s[a];n=Math.min(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}var c=i-n,l=o-r,f=Math.max(c,l),h=Math.max(0,Math.floor(-Math.log(f)/Math.LN2)),p=Math.pow(2,h);return new t.CanonicalTileID(h,Math.floor((n+i)/2*p),Math.floor((r+o)/2*p))}(r),this.minzoom=this.maxzoom=this.tileID.z;var i=r.map(function(t){return n.tileID.getTilePoint(t)._round()});return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),O=function(e){function n(t,n,r,i){e.call(this,t,n,r,i),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this,n=this.options;this.urls=[];for(var r=0,i=n.urls;r<i.length;r+=1){var o=i[r];e.urls.push(e.map._transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,function(n,r){n?e.fire(new t.ErrorEvent(n)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map.triggerRepaint()}),e.map&&e.video.play(),e._finishLoading())})},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(C),M=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing=!1},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(C),I={vector:P,raster:T,"raster-dem":A,geojson:k,video:O,image:C,canvas:M},L=function(e,n,r,i){var o=new I[n.type](e,n,r,i);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function R(t,e,n,r,i){var o=i.maxPitchScaleFactor(),a=t.tilesIn(n,o);a.sort(j);for(var s=[],u=0,c=a;u<c.length;u+=1){var l=c[u];s.push({wrappedTileID:l.tileID.wrapped().key,queryResults:l.tile.queryRenderedFeatures(e,t._state,l.queryGeometry,l.scale,r,i,o,t.transform.calculatePosMatrix(l.tileID.toUnwrapped()))})}var f=function(t){for(var e={},n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.queryResults,s=o.wrappedTileID,u=n[s]=n[s]||{};for(var c in a)for(var l=a[c],f=u[c]=u[c]||{},h=e[c]=e[c]||[],p=0,d=l;p<d.length;p+=1){var v=d[p];f[v.featureIndex]||(f[v.featureIndex]=!0,h.push(v.feature))}}return e}(s);for(var h in f)f[h].forEach(function(e){var n=t.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=n});return f}function j(t,e){var n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var z=function(t,e){this.max=t,this.onRemove=e,this.reset()};z.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var r=n[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},z.prototype.add=function(t,e,n){var r=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout(function(){r.remove(t,o)},n)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},z.prototype.has=function(t){return t.wrapped().key in this.data},z.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},z.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},z.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},z.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this},z.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var D=function(t,e,n){this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};D.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},D.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},D.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var F={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},N=function(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};N.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},N.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},N.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var r=this.attributes[n],i=e.attributes[r.name];void 0!==i&&t.enableVertexAttribArray(i)}},N.prototype.setVertexAttribPointers=function(t,e,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[F[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}},N.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var B=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};B.prototype.get=function(){return this.current},B.prototype.set=function(t){},B.prototype.getDefault=function(){return this.default},B.prototype.setDefault=function(){this.set(this.default)};var U=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(B),V=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(B),G=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(B),q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(B),W=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(B),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(B),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(B),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(B),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(B),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(B),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(B),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(B),$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(B),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(B),et=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return t.Color.transparent},n.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},n}(B),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(B),rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(B),it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(B),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(B),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(B),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(B),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(B),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(B),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(B),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(B),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(B),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(B),dt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(B),vt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(B),gt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(B),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(B),yt=function(t){function e(e,n){t.call(this,e),this.context=e,this.parent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDefault=function(){return null},e}(B),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(yt),bt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(yt),xt=function(t,e,n){this.context=t,this.width=e,this.height=n;var r=t.gl,i=this.framebuffer=r.createFramebuffer();this.colorAttachment=new _t(t,i),this.depthAttachment=new bt(t,i)};xt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n),t.deleteFramebuffer(this.framebuffer)};var wt=function(t,e,n){this.func=t,this.mask=e,this.range=n};wt.ReadOnly=!1,wt.ReadWrite=!0,wt.disabled=new wt(519,wt.ReadOnly,[0,1]);var Et=function(t,e,n,r,i,o){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o};Et.disabled=new Et({func:519,mask:0},0,0,7680,7680,7680);var St=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};St.disabled=new St(St.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),St.unblended=new St(St.Replace,t.Color.transparent,[!0,!0,!0,!0]),St.alphaBlended=new St([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Pt=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};Pt.disabled=new Pt(!1,1029,2305),Pt.backCCW=new Pt(!0,1029,2305);var Tt=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new U(this),this.clearDepth=new V(this),this.clearStencil=new G(this),this.colorMask=new q(this),this.depthMask=new W(this),this.stencilMask=new Z(this),this.stencilFunc=new X(this),this.stencilOp=new H(this),this.stencilTest=new Y(this),this.depthRange=new K(this),this.depthTest=new J(this),this.depthFunc=new Q(this),this.blend=new $(this),this.blendFunc=new tt(this),this.blendColor=new et(this),this.blendEquation=new nt(this),this.cullFace=new rt(this),this.cullFaceSide=new it(this),this.frontFace=new ot(this),this.program=new at(this),this.activeTexture=new st(this),this.viewport=new ut(this),this.bindFramebuffer=new ct(this),this.bindRenderbuffer=new lt(this),this.bindTexture=new ft(this),this.bindVertexBuffer=new ht(this),this.bindElementBuffer=new pt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new dt(this),this.pixelStoreUnpack=new vt(this),this.pixelStoreUnpackPremultiplyAlpha=new gt(this),this.pixelStoreUnpackFlipY=new mt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};Tt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Tt.prototype.createIndexBuffer=function(t,e){return new D(this,t,e)},Tt.prototype.createVertexBuffer=function(t,e,n){return new N(this,t,e,n)},Tt.prototype.createRenderbuffer=function(t,e,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i},Tt.prototype.createFramebuffer=function(t,e){return new xt(this,t,e)},Tt.prototype.clear=function(t){var e=t.color,n=t.depth,r=this.gl,i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)},Tt.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},Tt.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Tt.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Tt.prototype.setColorMode=function(e){t.isEqual(e.blendFunction,St.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},Tt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var At=function(e){function n(n,r,i){var o=this;e.call(this),this.id=n,this.dispatcher=i,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))}),this.on("error",function(){o._sourceErrored=!0}),this._source=L(n,r,i,this),this._tiles={},this._cache=new z(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles)this._tiles[e].upload(t)},n.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(kt)},n.prototype.getRenderableIds=function(e){var n=this,r=[];for(var i in n._tiles)n._isIdRenderable(+i,e)&&r.push(+i);return e?r.sort(function(e,r){var i=n._tiles[e].tileID,o=n._tiles[r].tileID,a=new t.Point(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x}):r.sort(kt)},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){var i=this.getTileByID(r);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},n.prototype._retainLoadedChildren=function(t,e,n,r){for(var i in this._tiles){var o=this._tiles[i];if(!(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var u=a;u.overscaledZ>e;)if(t[(u=u.scaledTo(u.overscaledZ-1)).key]){r[a.key]=a;break}}}},n.prototype.findLoadedParent=function(t,e){for(var n=t.overscaledZ-1;n>=e;n--){var r=t.scaledTo(n);if(!r)return;var i=String(r.key),o=this._tiles[i];if(o&&o.hasData())return o;if(this._cache.has(r))return this._cache.get(r)}},n.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),n=Math.floor(5*e),r="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(r)},n.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,n=Math.round(e);if(this._prevLng=t,n){var r={};for(var i in this._tiles){var o=this._tiles[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+n),r[o.tileID.key]=o}for(var a in this._tiles=r,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var u=this._tiles[s];this._setTileReloadTimer(s,u)}}},n.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(t){return r._source.hasTile(t)}))):i=[];var o=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),a=Math.max(o-n.maxOverzooming,this._source.minzoom),s=Math.max(o+n.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(i,o);if(Ct(this._source.type)){for(var c={},l={},f=0,h=Object.keys(u);f<h.length;f+=1){var p=h[f],d=u[p],v=r._tiles[p];if(v&&!(v.fadeEndTime&&v.fadeEndTime<=t.browser.now())){var g=r.findLoadedParent(d,a);g&&(r._addTile(g.tileID),c[g.tileID.key]=g.tileID),l[p]=d}}for(var m in this._retainLoadedChildren(l,o,s,u),c)u[m]||(r._coveredTiles[m]=!0,u[m]=c[m])}for(var y in u)r._tiles[y].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,u);_<b.length;_+=1){var x=b[_],w=r._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(r.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||r._removeTile(x)}}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s={},u=0,c=t;u<c.length;u+=1){var l=c[u],f=this._addTile(l);r[l.key]=l,f.hasData()||e<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,e,a,r);for(var h=0,p=t;h<p.length;h+=1){var d=p[h],v=this._tiles[d.key];if(!v.hasData()){if(e+1>this._source.maxzoom){var g=d.children(this._source.maxzoom)[0],m=this.getTile(g);if(m&&m.hasData()){r[g.key]=g;continue}}else{var y=d.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}for(var _=v.wasRequested(),b=d.overscaledZ-1;b>=o;--b){var x=d.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(v=this.getTile(x))&&_&&(v=this._addTile(x)),v&&(r[x.key]=x,_=v.wasRequested(),v.hasData()))break}}}return r},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var r=Boolean(n);return r||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout(function(){n._reloadTile(t,"expired"),delete n._timers[t]},r))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n){for(var r=[],i=this.getIds(),o=1/0,a=1/0,s=-1/0,u=-1/0,c=0;c<e.length;c++){var l=e[c];o=Math.min(o,l.x),a=Math.min(a,l.y),s=Math.max(s,l.x),u=Math.max(u,l.y)}for(var f=0;f<i.length;f++){var h=this._tiles[i[f]];if(!h.holdingForFade()){var p=h.tileID,d=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),v=n*h.queryPadding*t.EXTENT/h.tileSize/d,g=[p.getTilePoint(new t.MercatorCoordinate(o,a)),p.getTilePoint(new t.MercatorCoordinate(s,u))];if(g[0].x-v<t.EXTENT&&g[0].y-v<t.EXTENT&&g[1].x+v>=0&&g[1].y+v>=0){for(var m=[],y=0;y<e.length;y++)m.push(p.getTilePoint(e[y]));r.push({tile:h,tileID:p,queryGeometry:[m],scale:d})}}}return r},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map(function(t){return e._tiles[t].tileID}),r=0,i=n;r<i.length;r+=1){var o=i[r];o.posMatrix=e.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ct(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){t=t||"_geojsonTileLayer",this._state.updateState(t,e,n)},n.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},n}(t.Evented);function kt(t,e){return t%32-e%32||e-t}function Ct(t){return"raster"===t||"image"===t||"video"===t}function Ot(){return new t.window.Worker(Hr.workerUrl)}At.maxOverzooming=10,At.maxUnderzooming=3;var Mt=function(){this.active={}};Mt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Mt.workerCount;)this.workers.push(new Ot);return this.active[t]=!0,this.workers.slice()},Mt.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)};var It,Lt=Math.floor(t.browser.hardwareConcurrency/2);function Rt(e,n){var r={};for(var i in e)"ref"!==i&&(r[i]=e[i]);return t.refProperties.forEach(function(t){t in n&&(r[t]=n[t])}),r}function jt(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Rt(t[r],e[t[r].ref]));return t}Mt.workerCount=Math.max(Math.min(Lt,6),1);var zt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Dt(t,e,n){n.push({command:zt.addSource,args:[t,e[t]]})}function Ft(t,e,n){e.push({command:zt.removeSource,args:[t]}),n[t]=!0}function Nt(t,e,n,r){Ft(t,n,r),Dt(t,e,n)}function Bt(e,n,r){var i;for(i in e[r])if(e[r].hasOwnProperty(i)&&"data"!==i&&!t.isEqual(e[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!t.isEqual(e[r][i],n[r][i]))return!1;return!0}function Ut(e,n,r,i,o,a){var s;for(s in n=n||{},e=e||{})e.hasOwnProperty(s)&&(t.isEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.isEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}))}function Vt(t){return t.id}function Gt(t,e){return t[e.id]=e,t}var qt=function(t,e,n){var r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};qt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},qt.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},qt.prototype.insertCircle=function(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)},qt.prototype._insertBoxCell=function(t,e,n,r,i,o){this.boxCells[i].push(o)},qt.prototype._insertCircleCell=function(t,e,n,r,i,o){this.circleCells[i].push(o)},qt.prototype._query=function(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[3*u],l=this.circles[3*u+1],f=this.circles[3*u+2];a.push({key:this.circleKeys[u],x1:c-f,y1:l-f,x2:c+f,y2:l+f})}return o?a.filter(o):a}var h={hitTest:i,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,n,r,this._queryCell,a,h,o),i?a.length>0:a},qt.prototype._queryCircle=function(t,e,n,r,i){var o=t-n,a=t+n,s=e-n,u=e+n;if(a<0||o>this.width||u<0||s>this.height)return!r&&[];var c=[],l={hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,u,this._queryCellCircle,c,l,i),r?c.length>0:c},qt.prototype.query=function(t,e,n,r,i){return this._query(t,e,n,r,!1,i)},qt.prototype.hitTest=function(t,e,n,r,i){return this._query(t,e,n,r,!0,i)},qt.prototype.hitTestCircle=function(t,e,n,r){return this._queryCircle(t,e,n,!0,r)},qt.prototype._queryCell=function(t,e,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var l=this.bboxes,f=0,h=c;f<h.length;f+=1){var p=h[f];if(!u.box[p]){u.box[p]=!0;var d=4*p;if(t<=l[d+2]&&e<=l[d+3]&&n>=l[d+0]&&r>=l[d+1]&&(!s||s(this.boxKeys[p]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[p],x1:l[d],y1:l[d+1],x2:l[d+2],y2:l[d+3]})}}}var v=this.circleCells[i];if(null!==v)for(var g=this.circles,m=0,y=v;m<y.length;m+=1){var _=y[m];if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(g[b],g[b+1],g[b+2],t,e,n,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=g[b],w=g[b+1],E=g[b+2];o.push({key:this.circleKeys[_],x1:x-E,y1:w-E,x2:x+E,y2:w+E})}}}},qt.prototype._queryCellCircle=function(t,e,n,r,i,o,a,s){var u=a.circle,c=a.seenUids,l=this.boxCells[i];if(null!==l)for(var f=this.bboxes,h=0,p=l;h<p.length;h+=1){var d=p[h];if(!c.box[d]){c.box[d]=!0;var v=4*d;if(this._circleAndRectCollide(u.x,u.y,u.radius,f[v+0],f[v+1],f[v+2],f[v+3])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}var g=this.circleCells[i];if(null!==g)for(var m=this.circles,y=0,_=g;y<_.length;y+=1){var b=_[y];if(!c.circle[b]){c.circle[b]=!0;var x=3*b;if(this._circlesCollide(m[x],m[x+1],m[x+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},qt.prototype._forEachCell=function(t,e,n,r,i,o,a,s){for(var u=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),l=this._convertToXCellCoord(n),f=this._convertToYCellCoord(r),h=u;h<=l;h++)for(var p=c;p<=f;p++){var d=this.xCellCount*p+h;if(i.call(this,t,e,n,r,d,o,a,s))return}},qt.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},qt.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},qt.prototype._circlesCollide=function(t,e,n,r,i,o){var a=r-t,s=i-e,u=n+o;return u*u>a*a+s*s},qt.prototype._circleAndRectCollide=function(t,e,n,r,i,o,a){var s=(o-r)/2,u=Math.abs(t-(r+s));if(u>s+n)return!1;var c=(a-i)/2,l=Math.abs(e-(i+c));if(l>c+n)return!1;if(u<=s||l<=c)return!0;var f=u-s,h=l-c;return f*f+h*h<=n*n};var Wt=t.properties.layout;function Zt(e,n,r,i,o){var a=t.identity(new Float32Array(16));return n?(t.identity(a),t.scale(a,a,[1/o,1/o,1]),r||t.rotateZ(a,a,i.angle)):(t.scale(a,a,[i.width/2,-i.height/2,1]),t.translate(a,a,[1,-1,0]),t.multiply(a,a,e)),a}function Xt(e,n,r,i,o){var a=t.identity(new Float32Array(16));return n?(t.multiply(a,a,e),t.scale(a,a,[o,o,1]),r||t.rotateZ(a,a,-i.angle)):(t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/i.width,2/i.height,1])),a}function Ht(e,n){var r=[e.x,e.y,0,1];ie(r,r,n);var i=r[3];return{point:new t.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function Yt(t,e){var n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function Kt(e,n,r,i,o,a,s,u){var c=i?e.textSizeData:e.iconSizeData,l=t.evaluateSizeForZoom(c,r.transform.zoom,Wt.properties[i?"text-size":"icon-size"]),f=[256/r.width*2+1,256/r.height*2+1],h=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;h.clear();for(var p=e.lineVertexArray,d=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=r.transform.width/r.transform.height,g=!1,m=0;m<d.length;m++){var y=d.get(m);if(y.hidden||y.writingMode===t.WritingMode.vertical&&!g)re(y.numGlyphs,h);else{g=!1;var _=[y.anchorX,y.anchorY,0,1];if(t.transformMat4(_,_,n),Yt(_,f)){var b=.5+_[3]/r.transform.cameraToCenterDistance*.5,x=t.evaluateSizeForFeature(c,l,y),w=s?x*b:x/b,E=new t.Point(y.anchorX,y.anchorY),S=Ht(E,o).point,P={},T=$t(y,w,!1,u,n,o,a,e.glyphOffsetArray,p,h,S,E,P,v);g=T.useVertical,(T.notEnoughRoom||g||T.needsFlipping&&$t(y,w,!0,u,n,o,a,e.glyphOffsetArray,p,h,S,E,P,v).notEnoughRoom)&&re(y.numGlyphs,h)}else re(y.numGlyphs,h)}}i?e.text.dynamicLayoutVertexBuffer.updateData(h):e.icon.dynamicLayoutVertexBuffer.updateData(h)}function Jt(t,e,n,r,i,o,a,s,u,c,l,f){var h=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,v=e.getoffsetX(s.glyphStartIndex),g=e.getoffsetX(h-1),m=ee(t*v,n,r,i,o,a,s.segment,p,d,u,c,l,f);if(!m)return null;var y=ee(t*g,n,r,i,o,a,s.segment,p,d,u,c,l,f);return y?{first:m,last:y}:null}function Qt(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function $t(e,n,r,i,o,a,s,u,c,l,f,h,p,d){var v,g=n/24,m=e.lineOffsetX*n,y=e.lineOffsetY*n;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=Jt(g,u,m,y,r,f,h,e,c,a,p,!1);if(!w)return{notEnoughRoom:!0};var E=Ht(w.first.point,s).point,S=Ht(w.last.point,s).point;if(i&&!r){var P=Qt(e.writingMode,E,S,d);if(P)return P}v=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)v.push(ee(g*u.getoffsetX(T),m,y,r,f,h,e.segment,b,x,c,a,p,!1));v.push(w.last)}else{if(i&&!r){var A=Ht(h,o).point,k=e.lineStartIndex+e.segment+1,C=new t.Point(c.getx(k),c.gety(k)),O=Ht(C,o),M=O.signedDistanceFromCamera>0?O.point:te(h,C,A,1,o),I=Qt(e.writingMode,A,M,d);if(I)return I}var L=ee(g*u.getoffsetX(e.glyphStartIndex),m,y,r,f,h,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,p,!1);if(!L)return{notEnoughRoom:!0};v=[L]}for(var R=0,j=v;R<j.length;R+=1){var z=j[R];t.addDynamicAttributes(l,z.point,z.angle)}return{}}function te(t,e,n,r,i){var o=Ht(t.add(t.sub(e)._unit()),i).point,a=n.sub(o);return n.add(a._mult(r/a.mag()))}function ee(e,n,r,i,o,a,s,u,c,l,f,h,p){var d=i?e-n:e+n,v=d>0?1:-1,g=0;i&&(v*=-1,g=Math.PI),v<0&&(g+=Math.PI);for(var m=v>0?u+s:u+s+1,y=m,_=o,b=o,x=0,w=0,E=Math.abs(d);x+w<=E;){if((m+=v)<u||m>=c)return null;if(b=_,void 0===(_=h[m])){var S=new t.Point(l.getx(m),l.gety(m)),P=Ht(S,f);if(P.signedDistanceFromCamera>0)_=h[m]=P.point;else{var T=m-v;_=te(0===x?a:new t.Point(l.getx(T),l.gety(T)),S,b,E-x+1,f)}}x+=w,w=b.dist(_)}var A=(E-x)/w,k=_.sub(b),C=k.mult(A)._add(b);return C._add(k._unit()._perp()._mult(r*v)),{point:C,angle:g+Math.atan2(_.y-b.y,_.x-b.x),tileDistance:p?{prevTileDistance:m-v===y?0:l.gettileUnitDistanceFromAnchor(m-v),lastSegmentViewportDistance:E-x}:null}}var ne=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function re(t,e){for(var n=0;n<t;n++){var r=e.length;e.resize(r+4),e.float32.set(ne,3*r)}}function ie(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}var oe=function(t,e,n){void 0===e&&(e=new qt(t.width+200,t.height+200,25)),void 0===n&&(n=new qt(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function ae(t,e,n){t[e+4]=n?1:0}function se(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}oe.prototype.placeCollisionBox=function(t,e,n,r,i){var o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,s=t.x1*a+o.point.x,u=t.y1*a+o.point.y,c=t.x2*a+o.point.x,l=t.y2*a+o.point.y;return!this.isInsideGrid(s,u,c,l)||!e&&this.grid.hitTest(s,u,c,l,i)?{box:[],offscreen:!1}:{box:[s,u,c,l],offscreen:this.isOffscreen(s,u,c,l)}},oe.prototype.approximateTileDistance=function(t,e,n,r,i){var o=i?1:r/this.pitchfactor,a=t.lastSegmentViewportDistance*n;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},oe.prototype.placeCollisionCircles=function(e,n,r,i,o,a,s,u,c,l,f,h,p){var d=[],v=this.projectAnchor(c,o.anchorX,o.anchorY),g=u/24,m=o.lineOffsetX*u,y=o.lineOffsetY*u,_=new t.Point(o.anchorX,o.anchorY),b=Jt(g,s,m,y,!1,Ht(_,l).point,_,o,a,l,{},!0),x=!1,w=!1,E=!0,S=v.perspectiveRatio*i,P=1/(i*r),T=0,A=0;b&&(T=this.approximateTileDistance(b.first.tileDistance,b.first.angle,P,v.cameraDistance,h),A=this.approximateTileDistance(b.last.tileDistance,b.last.angle,P,v.cameraDistance,h));for(var k=0;k<e.length;k+=5){var C=e[k],O=e[k+1],M=e[k+2],I=e[k+3];if(!b||I<-T||I>A)ae(e,k,!1);else{var L=this.projectPoint(c,C,O),R=M*S;if(d.length>0){var j=L.x-d[d.length-4],z=L.y-d[d.length-3];if(R*R*2>j*j+z*z&&k+8<e.length){var D=e[k+8];if(D>-T&&D<A){ae(e,k,!1);continue}}}var F=k/5;d.push(L.x,L.y,R,F),ae(e,k,!0);var N=L.x-R,B=L.y-R,U=L.x+R,V=L.y+R;if(E=E&&this.isOffscreen(N,B,U,V),w=w||this.isInsideGrid(N,B,U,V),!n&&this.grid.hitTestCircle(L.x,L.y,R,p)){if(!f)return{circles:[],offscreen:!1};x=!0}}}return{circles:x||!w?[]:d,offscreen:E}},oe.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=e;s<u.length;s+=1){var c=u[s],l=new t.Point(c.x+100,c.y+100);r=Math.min(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y),n.push(l)}for(var f={},h={},p=0,d=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a));p<d.length;p+=1){var v=d[p],g=v.key;if(void 0===f[g.bucketInstanceId]&&(f[g.bucketInstanceId]={}),!f[g.bucketInstanceId][g.featureIndex]){var m=[new t.Point(v.x1,v.y1),new t.Point(v.x2,v.y1),new t.Point(v.x2,v.y2),new t.Point(v.x1,v.y2)];t.polygonIntersectsPolygon(n,m)&&(f[g.bucketInstanceId][g.featureIndex]=!0,void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]=[]),h[g.bucketInstanceId].push(g.featureIndex))}}return h},oe.prototype.insertCollisionBox=function(t,e,n,r,i){var o={bucketInstanceId:n,featureIndex:r,collisionGroupID:i};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},oe.prototype.insertCollisionCircles=function(t,e,n,r,i){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:i},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},oe.prototype.projectAnchor=function(t,e,n){var r=[e,n,0,1];return ie(r,r,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5,cameraDistance:r[3]}},oe.prototype.projectPoint=function(e,n,r){var i=[n,r,0,1];return ie(i,i,e),new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},oe.prototype.projectAndGetPerspectiveRatio=function(e,n,r){var i=[n,r,0,1];return ie(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},oe.prototype.isOffscreen=function(t,e,n,r){return n<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},oe.prototype.isInsideGrid=function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary};var ue=function(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n};ue.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var ce=function(t,e,n,r,i){this.text=new ue(t?t.text:null,e,n,i),this.icon=new ue(t?t.icon:null,e,r,i)};ce.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var le=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},fe=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};fe.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var he=function(t,e,n){this.transform=t.clone(),this.collisionIndex=new oe(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new fe(n)};function pe(t,e,n){t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0)}he.prototype.placeLayerTile=function(e,n,r,i){var o=n.getBucket(e),a=n.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=n.collisionBoxArray,u=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),l=n.tileSize/t.EXTENT,f=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),h=Zt(f,"map"===u.get("text-pitch-alignment"),"map"===u.get("text-rotation-alignment"),this.transform,se(n,1,this.transform.zoom)),p=Zt(f,"map"===u.get("icon-pitch-alignment"),"map"===u.get("icon-rotation-alignment"),this.transform,se(n,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i}(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID),this.placeLayerBucket(o,f,h,p,c,l,r,n.holdingForFade(),i,s)}},he.prototype.placeLayerBucket=function(e,n,r,i,o,a,s,u,c,l){var f=e.layers[0].layout,h=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,t.properties.layout.properties["text-size"]),p=f.get("text-optional"),d=f.get("icon-optional"),v=f.get("text-allow-overlap"),g=f.get("icon-allow-overlap"),m=v&&(g||!e.hasIconData()||d),y=g&&(v||!e.hasTextData()||p),_=this.collisionGroups.get(e.sourceID);!e.collisionArrays&&l&&e.deserializeCollisionBoxes(l);for(var b=0;b<e.symbolInstances.length;b++){var x=e.symbolInstances.get(b);if(!c[x.crossTileID]){if(u){this.placements[x.crossTileID]=new le(!1,!1,!1);continue}var w=!1,E=!1,S=!0,P=null,T=null,A=null,k=0,C=0,O=e.collisionArrays[b];O.textFeatureIndex&&(k=O.textFeatureIndex),O.textBox&&(w=(P=this.collisionIndex.placeCollisionBox(O.textBox,f.get("text-allow-overlap"),a,n,_.predicate)).box.length>0,S=S&&P.offscreen);var M=O.textCircles;if(M){var I=e.text.placedSymbolArray.get(x.horizontalPlacedTextSymbolIndex),L=t.evaluateSizeForFeature(e.textSizeData,h,I);T=this.collisionIndex.placeCollisionCircles(M,f.get("text-allow-overlap"),o,a,I,e.lineVertexArray,e.glyphOffsetArray,L,n,r,s,"map"===f.get("text-pitch-alignment"),_.predicate),w=f.get("text-allow-overlap")||T.circles.length>0,S=S&&T.offscreen}O.iconFeatureIndex&&(C=O.iconFeatureIndex),O.iconBox&&(E=(A=this.collisionIndex.placeCollisionBox(O.iconBox,f.get("icon-allow-overlap"),a,n,_.predicate)).box.length>0,S=S&&A.offscreen);var R=p||0===x.numGlyphVertices&&0===x.numVerticalGlyphVertices,j=d||0===x.numIconVertices;R||j?j?R||(E=E&&w):w=E&&w:E=w=E&&w,w&&P&&this.collisionIndex.insertCollisionBox(P.box,f.get("text-ignore-placement"),e.bucketInstanceId,k,_.ID),E&&A&&this.collisionIndex.insertCollisionBox(A.box,f.get("icon-ignore-placement"),e.bucketInstanceId,C,_.ID),w&&T&&this.collisionIndex.insertCollisionCircles(T.circles,f.get("text-ignore-placement"),e.bucketInstanceId,k,_.ID),this.placements[x.crossTileID]=new le(w||m,E||y,S||e.justReloaded),c[x.crossTileID]=!0}}e.justReloaded=!1},he.prototype.commit=function(t,e){this.commitTime=e;var n=!1,r=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,i=t?t.opacities:{};for(var o in this.placements){var a=this.placements[o],s=i[o];s?(this.opacities[o]=new ce(s,r,a.text,a.icon),n=n||a.text!==s.text.placed||a.icon!==s.icon.placed):(this.opacities[o]=new ce(null,r,a.text,a.icon,a.skipFade),n=n||a.text||a.icon)}for(var u in i){var c=i[u];if(!this.opacities[u]){var l=new ce(c,r,!1,!1);l.isHidden()||(this.opacities[u]=l,n=n||c.text.placed||c.icon.placed)}}n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},he.prototype.updateLayerOpacities=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1){var o=i[r],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},he.prototype.updateBucketOpacities=function(t,e,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();var r=t.layers[0].layout,i=new ce(null,0,!1,!1,!0),o=r.get("text-allow-overlap"),a=r.get("icon-allow-overlap"),s=new ce(null,0,o&&(a||!t.hasIconData()||r.get("icon-optional")),a&&(o||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasCollisionBoxData()||t.hasCollisionCircleData())&&t.deserializeCollisionBoxes(n);for(var u=0;u<t.symbolInstances.length;u++){var c=t.symbolInstances.get(u),l=e[c.crossTileID],f=this.opacities[c.crossTileID];l?f=i:f||(f=s,this.opacities[c.crossTileID]=f),e[c.crossTileID]=!0;var h=c.numGlyphVertices>0||c.numVerticalGlyphVertices>0,p=c.numIconVertices>0;if(h){for(var d=xe(f.text),v=(c.numGlyphVertices+c.numVerticalGlyphVertices)/4,g=0;g<v;g++)t.text.opacityVertexArray.emplaceBack(d);t.text.placedSymbolArray.get(c.horizontalPlacedTextSymbolIndex).hidden=f.text.isHidden(),c.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).hidden=f.text.isHidden())}if(p){for(var m=xe(f.icon),y=0;y<c.numIconVertices/4;y++)t.icon.opacityVertexArray.emplaceBack(m);t.icon.placedSymbolArray.get(u).hidden=f.icon.isHidden()}if(t.hasCollisionBoxData()||t.hasCollisionCircleData()){var _=t.collisionArrays[u];if(_){_.textBox&&pe(t.collisionBox.collisionVertexArray,f.text.placed,!1),_.iconBox&&pe(t.collisionBox.collisionVertexArray,f.icon.placed,!1);var b=_.textCircles;if(b&&t.hasCollisionCircleData())for(var x=0;x<b.length;x+=5){var w=l||0===b[x+4];pe(t.collisionCircle.collisionVertexArray,f.text.placed,w)}}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},he.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},he.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},he.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},he.prototype.setStale=function(){this.stale=!0};var de=Math.pow(2,25),ve=Math.pow(2,24),ge=Math.pow(2,17),me=Math.pow(2,16),ye=Math.pow(2,9),_e=Math.pow(2,8),be=Math.pow(2,1);function xe(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*de+e*ve+n*ge+e*me+n*ye+e*_e+n*be+e}var we=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};we.prototype.continuePlacement=function(t,e,n,r,i){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(r,o,n,this._seenCrossTileIDs),this._currentTileIndex++,i())return!0}};var Ee=function(t,e,n,r,i,o){this.placement=new he(t,i,o),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1};Ee.prototype.isDone=function(){return this._done},Ee.prototype.continuePlacement=function(e,n,r){for(var i=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[i._currentPlacementIndex]],u=i.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(i._inProgressLayer||(i._inProgressLayer=new we),i._inProgressLayer.continuePlacement(r[s.source],i.placement,i._showCollisionBoxes,s,a))return;delete i._inProgressLayer}i._currentPlacementIndex--}this._done=!0},Ee.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var Se=512/t.EXTENT/2,Pe=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<e.length;r++){var i=e.get(r),o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};Pe.prototype.getScaledCoordinates=function(e,n){var r=n.canonical.z-this.tileID.canonical.z,i=Se/Math.pow(2,r);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}},Pe.prototype.findMatches=function(t,e,n){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var o=t.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),u=0,c=a;u<c.length;u+=1){var l=c[u];if(Math.abs(l.coord.x-s.x)<=r&&Math.abs(l.coord.y-s.y)<=r&&!n[l.crossTileID]){n[l.crossTileID]=!0,o.crossTileID=l.crossTileID;break}}}}};var Te=function(){this.maxCrossTileID=0};Te.prototype.generate=function(){return++this.maxCrossTileID};var Ae=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ae.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var r=this.indexes[n],i={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[n]=i}this.lng=t},Ae.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var u=a[s];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,i)}else{var c=a[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,i)}}for(var l=0;l<e.symbolInstances.length;l++){var f=e.symbolInstances.get(l);f.crossTileID||(f.crossTileID=n.generate(),i[f.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Pe(t,e.symbolInstances,e.bucketInstanceId),!0},Ae.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var r=0,i=e.indexedSymbolInstances[n];r<i.length;r+=1){var o=i[r];delete this.usedCrossTileIDs[t][o.crossTileID]}},Ae.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e};var ke=function(){this.layerIndexes={},this.crossTileIDs=new Te,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ke.prototype.addLayer=function(t,e,n){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Ae);var i=!1,o={};r.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(i=!0),o[c.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i},ke.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var Ce=function(e,n){return t.emitValidationErrors(e,n&&n.filter(function(t){return"source.canvas"!==t.identifier}))},Oe=t.pick(zt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Me=t.pick(zt,["setCenter","setZoom","setBearing","setPitch"]),Ie=function(e){function n(r,i){var o=this;void 0===i&&(i={}),e.call(this),this.map=r,this.dispatcher=new w((It||(It=new Mt),It),this),this.imageManager=new f,this.glyphManager=new m(r._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new x(256,512),this.crossTileSymbolIndex=new ke,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var a=this;this._rtlTextPluginCallback=n.registerForPluginAvailability(function(t){for(var e in a.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),a.sourceCaches)a.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var r in o._layers){var i=o._layers[r];i.source===n.id&&o._validateLayer(i)}}}})}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadURL=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!t.isMapboxURL(e);e=t.normalizeStyleURL(e,n.accessToken);var o=this.map._transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,function(e,n){r._request=null,e?r.fire(new t.ErrorEvent(e)):n&&r._load(n,i)})},n.prototype.loadJSON=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame(function(){r._request=null,r._load(e,!1!==n.validate)})},n.prototype._load=function(e,n){var r=this;if(!n||!Ce(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)r.addSource(i,e.sources[i],{validate:!1});e.sprite?this._spriteRequest=function(e,n,r){var i,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",u=t.getJSON(n(t.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),function(t,e){u=null,a||(a=t,i=e,l())}),c=t.getImage(n(t.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),function(t,e){c=null,a||(a=t,o=e,l())});function l(){if(a)r(a);else if(i&&o){var e=t.browser.getImageData(o),n={};for(var s in i){var u=i[s],c=u.width,l=u.height,f=u.x,h=u.y,p=u.sdf,d=u.pixelRatio,v=new t.RGBAImage({width:c,height:l});t.RGBAImage.copy(e,v,{x:f,y:h},{x:0,y:0},{width:c,height:l}),n[s]={data:v,pixelRatio:d,sdf:p}}r(null,n)}}return{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(e.sprite,this.map._transformRequest,function(e,n){if(r._spriteRequest=null,e)r.fire(new t.ErrorEvent(e));else if(n)for(var i in n)r.imageManager.addImage(i,n[i]);r.imageManager.setLoaded(!0),r.fire(new t.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=jt(this.stylesheet.layers);this._order=o.map(function(t){return t.id}),this._layers={};for(var a=0,s=o;a<s.length;a+=1){var u=s[a];(u=t.createStyleLayer(u)).setEventedParent(r,{layer:{id:u.id}}),r._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new b(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var r=e.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=r[n],o=this._layers[i];"custom"!==o.type&&e.push(o.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){var n=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var o in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}for(var u in this.sourceCaches)this.sourceCaches[u].used=!1;for(var c=0,l=this._order;c<l.length;c+=1){var f=l[c],h=this._layers[f];h.recalculate(e),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.Event("data",{dataType:"style"}))}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),Ce(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=jt(e.layers);var r=function(e,n){if(!e)return[{command:zt.setStyle,args:[n]}];var r=[];try{if(!t.isEqual(e.version,n.version))return[{command:zt.setStyle,args:[n]}];t.isEqual(e.center,n.center)||r.push({command:zt.setCenter,args:[n.center]}),t.isEqual(e.zoom,n.zoom)||r.push({command:zt.setZoom,args:[n.zoom]}),t.isEqual(e.bearing,n.bearing)||r.push({command:zt.setBearing,args:[n.bearing]}),t.isEqual(e.pitch,n.pitch)||r.push({command:zt.setPitch,args:[n.pitch]}),t.isEqual(e.sprite,n.sprite)||r.push({command:zt.setSprite,args:[n.sprite]}),t.isEqual(e.glyphs,n.glyphs)||r.push({command:zt.setGlyphs,args:[n.glyphs]}),t.isEqual(e.transition,n.transition)||r.push({command:zt.setTransition,args:[n.transition]}),t.isEqual(e.light,n.light)||r.push({command:zt.setLight,args:[n.light]});var i={},o=[];!function(e,n,r,i){var o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||Ft(o,r,i));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.isEqual(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&Bt(e,n,o)?r.push({command:zt.setGeoJSONSourceData,args:[o,n[o].data]}):Nt(o,n,r,i)):Dt(o,n,r))}(e.sources,n.sources,o,i);var a=[];e.layers&&e.layers.forEach(function(t){i[t.source]?r.push({command:zt.removeLayer,args:[t.id]}):a.push(t)}),r=r.concat(o),function(e,n,r){n=n||[];var i,o,a,s,u,c,l,f=(e=e||[]).map(Vt),h=n.map(Vt),p=e.reduce(Gt,{}),d=n.reduce(Gt,{}),v=f.slice(),g=Object.create(null);for(i=0,o=0;i<f.length;i++)a=f[i],d.hasOwnProperty(a)?o++:(r.push({command:zt.removeLayer,args:[a]}),v.splice(v.indexOf(a,o),1));for(i=0,o=0;i<h.length;i++)a=h[h.length-1-i],v[v.length-1-i]!==a&&(p.hasOwnProperty(a)?(r.push({command:zt.removeLayer,args:[a]}),v.splice(v.lastIndexOf(a,v.length-o),1)):o++,c=v[v.length-i],r.push({command:zt.addLayer,args:[d[a],c]}),v.splice(v.length-i,0,a),g[a]=!0);for(i=0;i<h.length;i++)if(s=p[a=h[i]],u=d[a],!g[a]&&!t.isEqual(s,u))if(t.isEqual(s.source,u.source)&&t.isEqual(s["source-layer"],u["source-layer"])&&t.isEqual(s.type,u.type)){for(l in Ut(s.layout,u.layout,r,a,null,zt.setLayoutProperty),Ut(s.paint,u.paint,r,a,null,zt.setPaintProperty),t.isEqual(s.filter,u.filter)||r.push({command:zt.setFilter,args:[a,u.filter]}),t.isEqual(s.minzoom,u.minzoom)&&t.isEqual(s.maxzoom,u.maxzoom)||r.push({command:zt.setLayerZoomRange,args:[a,u.minzoom,u.maxzoom]}),s)s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Ut(s[l],u[l],r,a,l.slice(6),zt.setPaintProperty):t.isEqual(s[l],u[l])||r.push({command:zt.setLayerProperty,args:[a,l,u[l]]}));for(l in u)u.hasOwnProperty(l)&&!s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Ut(s[l],u[l],r,a,l.slice(6),zt.setPaintProperty):t.isEqual(s[l],u[l])||r.push({command:zt.setLayerProperty,args:[a,l,u[l]]}))}else r.push({command:zt.removeLayer,args:[a]}),c=v[v.lastIndexOf(a)+1],r.push({command:zt.addLayer,args:[u,c]})}(a,n.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:zt.setStyle,args:[n]}]}return r}(this.serialize(),e).filter(function(t){return!(t.command in Me)});if(0===r.length)return!1;var i=r.filter(function(t){return!(t.command in Oe)});if(i.length>0)throw new Error("Unimplemented: "+i.map(function(t){return t.command}).join(", ")+".");return r.forEach(function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)}),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,r){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,r))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new At(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:e}}),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,r){this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var o;if("custom"===e.type){if(Ce(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var r=this._order.indexOf(e);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.setLayerZoomRange=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n){this._checkLoaded();var r=this.getLayer(e);if(r){if(!t.isEqual(r.filter,n))return null==n?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(t.validateStyle.filter,"layers."+r.id+".filter",n)||(r.filter=t.clone(n),this._updateLayer(r)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?t.isEqual(i.getLayoutProperty(n),r)||(i.setLayoutProperty(n,r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},n.prototype.setPaintProperty=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?t.isEqual(i.getPaintProperty(n),r)||(i.setPaintProperty(n,r)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=e.sourceLayer,o=this.sourceCaches[r],a=parseInt(e.id,10);void 0!==o?"vector"!==o.getSource().type||i?isNaN(a)||a<0?this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):o.setFeatureState(i,a,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))):this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,r=e.sourceLayer,i=this.sourceCaches[n],o=parseInt(e.id,10);if(void 0!==i)if("vector"!==i.getSource().type||r){if(!(isNaN(o)||o<0))return i.getFeatureState(r,o);this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._serializeLayers(this._order)},function(t){return void 0!==t})},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenRenderedFeatures=function(t){for(var e=[],n=this._order.length-1;n>=0;n--)for(var r=this._order[n],i=0,o=t;i<o.length;i+=1){var a=o[i][r];if(a)for(var s=0,u=a;s<u.length;s+=1){var c=u[s];e.push(c)}}return e},n.prototype.queryRenderedFeatures=function(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],u=this._layers[s];if(!u)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[u.source]=!0}}var c=[],l=e.map(function(t){return r.pointCoordinate(t)});for(var f in this.sourceCaches)n.layers&&!i[f]||c.push(R(this.sourceCaches[f],this._layers,l,n,r));return this.placement&&c.push(function(t,e,n,r,i,o){for(var a={},s=i.queryRenderedSymbols(n),u=[],c=0,l=Object.keys(s).map(Number);c<l.length;c+=1){var f=l[c];u.push(o[f])}u.sort(j);for(var h=function(){var e=d[p],n=e.featureIndex.lookupSymbolFeatures(s[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,r.filter,r.layers,t);for(var i in n){var o=a[i]=a[i]||[],u=n[i];u.sort(function(t,n){var r=e.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(n.featureIndex)-i}return n.featureIndex-t.featureIndex});for(var c=0,l=u;c<l.length;c+=1){var f=l[c];o.push(f.feature)}}},p=0,d=u;p<d.length;p+=1)h();var v=function(n){a[n].forEach(function(r){var i=t[n],o=e[i.source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=o})};for(var g in a)v(g);return a}(this._layers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(c)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter);var r=this.sourceCaches[e];return r?function(t,e){for(var n=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),r=[],i={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(r,e))}return r}(r,n):[]},n.prototype.addSourceType=function(t,e,r){return n.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e){this._checkLoaded();var n=this.light.getLight(),r=!1;for(var i in e)if(!t.isEqual(e[i],n[i])){r=!0;break}if(r){var o={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(o)}},n.prototype._validate=function(e,n,r,i,o){return(!o||!1!==o.validate)&&Ce(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.styleSpec},i)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,r,i){for(var o=!1,a=!1,s={},u=0,c=this._order;u<c.length;u+=1){var l=c[u],f=this._layers[l];if("symbol"===f.type){if(!s[f.source]){var h=this.sourceCaches[f.source];s[f.source]=h.getRenderableIds(!0).map(function(t){return h.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var p=this.crossTileSymbolIndex.addLayer(f,s[f.source],e.center.lng);o=o||p}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var d=this._layerOrderChanged;if((d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now()))&&(this.pauseablePlacement=new Ee(e,this._order,d,n,r,i),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,t.browser.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var v=0,g=this._order;v<g.length;v+=1){var m=g[v],y=this._layers[m];"symbol"===y.type&&this.placement.updateLayerOpacities(y,s[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n}(t.Evented);Ie.getSourceType=function(t){return I[t]},Ie.setSourceType=function(t,e){I[t]=e},Ie.registerForPluginAvailability=t.registerForPluginAvailability;var Le=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Re=sn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),je=sn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ze=sn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),De=sn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvarying vec3 v_data;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvarying vec3 v_data;void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/DEVICE_PIXEL_RATIO/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Fe=sn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ne=sn("#pragma mapbox: define highp float weight\nuniform highp float u_intensity;varying vec2 v_extrude;\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;const highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Be=sn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ue=sn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=a_extrude*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Ve=sn("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),Ge=sn("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),qe=sn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),We=sn("#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvarying vec2 v_pos;void main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ze=sn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Xe=sn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),He=sn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);}"),Ye=sn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));}"),Ke=sn("uniform sampler2D u_image;uniform float u_opacity;varying vec2 v_pos;void main() {gl_FragColor=texture2D(u_image,v_pos)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Je=sn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;return (data.r+data.g*256.0+data.b*256.0*256.0)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(a_texture_pos/8192.0)/2.0+0.25;}"),Qe=sn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),$e=sn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvarying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\n#define scale 0.015873016\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_gl_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),tn=sn("#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nuniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;void main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\n#define scale 0.015873016\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_gl_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),en=sn("uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_gl_units_to_pixels;uniform mediump float u_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),nn=sn("uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/DEVICE_PIXEL_RATIO)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\n#define ANTIALIASING 1.0/DEVICE_PIXEL_RATIO/2.0\nattribute vec4 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_gl_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nvec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=a_pos_normal.xy;mediump vec2 normal=a_pos_normal.zw;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_gl_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),rn=sn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),on=sn("uniform sampler2D u_texture;\n#pragma mapbox: define lowp float opacity\nvarying vec2 v_tex;varying float v_fade_opacity;void main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;\n#pragma mapbox: define lowp float opacity\nuniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_gl_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;void main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_gl_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),an=sn("#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;void main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nuniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_gl_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;void main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_gl_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=vec2(tex.x,tex.y);v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}");function sn(t,e){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r={};return{fragmentSource:t=t.replace(n,function(t,e,n,i,o){return r[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"}),vertexSource:e=e.replace(n,function(t,e,n,i,o){var a="float"===i?"vec2":"vec4",s=o.match(/color/)?"color":a;return r[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"})}}var un=Object.freeze({prelude:Re,background:je,backgroundPattern:ze,circle:De,clippingMask:Fe,heatmap:Ne,heatmapTexture:Be,collisionBox:Ue,collisionCircle:Ve,debug:Ge,fill:qe,fillOutline:We,fillOutlinePattern:Ze,fillPattern:Xe,fillExtrusion:He,fillExtrusionPattern:Ye,extrusionTexture:Ke,hillshadePrepare:Je,hillshade:Qe,line:$e,lineGradient:tn,linePattern:en,lineSDF:nn,raster:rn,symbolIcon:on,symbolSDF:an}),cn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};cn.prototype.bind=function(t,e,n,r,i,o,a,s){this.context=t;for(var u=this.boundPaintVertexBuffers.length!==r.length,c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);var l=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||l?this.freshBind(e,n,r,i,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind())},cn.prototype.freshBind=function(t,e,n,r,i,o,a){var s,u=t.numAttributes,c=this.context,l=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var f=u;f<s;f++)l.disableVertexAttribArray(f)}e.enableAttributes(l,t);for(var h=0,p=n;h<p.length;h+=1)p[h].enableAttributes(l,t);o&&o.enableAttributes(l,t),a&&a.enableAttributes(l,t),e.bind(),e.setVertexAttribPointers(l,t,i);for(var d=0,v=n;d<v.length;d+=1){var g=v[d];g.bind(),g.setVertexAttribPointers(l,t,i)}o&&(o.bind(),o.setVertexAttribPointers(l,t,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(l,t,i)),c.currentNumAttributes=u},cn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ln=function(e,n,r,i,o){var a=e.gl;this.program=a.createProgram();var s=r.defines().concat("#define DEVICE_PIXEL_RATIO "+t.browser.devicePixelRatio.toFixed(1));o&&s.push("#define OVERDRAW_INSPECTOR;");var u=s.concat(Re.fragmentSource,n.fragmentSource).join("\n"),c=s.concat(Re.vertexSource,n.vertexSource).join("\n"),l=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(l,u),a.compileShader(l),a.attachShader(this.program,l);var f=a.createShader(a.VERTEX_SHADER);a.shaderSource(f,c),a.compileShader(f),a.attachShader(this.program,f);for(var h=r.layoutAttributes||[],p=0;p<h.length;p++)a.bindAttribLocation(this.program,p,h[p].name);a.linkProgram(this.program),this.numAttributes=a.getProgramParameter(this.program,a.ACTIVE_ATTRIBUTES),this.attributes={};for(var d={},v=0;v<this.numAttributes;v++){var g=a.getActiveAttrib(this.program,v);g&&(this.attributes[g.name]=a.getAttribLocation(this.program,g.name))}for(var m=a.getProgramParameter(this.program,a.ACTIVE_UNIFORMS),y=0;y<m;y++){var _=a.getActiveUniform(this.program,y);_&&(d[_.name]=a.getUniformLocation(this.program,_.name))}this.fixedUniforms=i(e,d),this.binderUniforms=r.getUniforms(e,d)};function fn(e,n,r){var i=1/se(r,1,n.transform.tileZoom),o=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,n.transform.tileZoom)/o,s=a*(r.tileID.canonical.x+r.tileID.wrap*o),u=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[t.browser.devicePixelRatio,i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,u>>16],u_pixel_coord_lower:[65535&s,65535&u]}}ln.prototype.draw=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p,d,v){var g,m=t.gl;for(var y in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[y].set(a[y]);p&&p.setUniforms(t,this.binderUniforms,f,{zoom:h});for(var _=(g={},g[m.LINES]=2,g[m.TRIANGLES]=3,g[m.LINE_STRIP]=1,g)[e],b=0,x=l.get();b<x.length;b+=1){var w=x[b],E=w.vaos||(w.vaos={});(E[s]||(E[s]=new cn)).bind(t,this,u,p?p.getPaintVertexBuffers():[],c,w.vertexOffset,d,v),m.drawElements(e,w.primitiveLength*_,m.UNSIGNED_SHORT,w.primitiveOffset*_*2)}};var hn=function(e,n,r){var i=n.style.light,o=i.properties.get("position"),a=[o.x,o.y,o.z],s=t.create$2();"viewport"===i.properties.get("anchor")&&t.fromRotation(s,-n.transform.angle),t.transformMat3(a,a,s);var u=i.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r}},pn=function(e,n,r,i,o,a){return t.extend(hn(e,n,r),fn(o,n,a),{u_height_factor:-Math.pow(2,i.overscaledZ)/a.tileSize/8})},dn=function(e,n,r){var i=t.create();t.ortho(i,0,e.width,e.height,0,0,1);var o=e.context.gl;return{u_matrix:i,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:r,u_opacity:n}},vn=function(t){return{u_matrix:t}},gn=function(e,n,r,i){return t.extend(vn(e),fn(r,n,i))},mn=function(t,e){return{u_matrix:t,u_world:e}},yn=function(e,n,r,i,o){return t.extend(gn(e,n,r,i),{u_world:o})},_n=function(t,e,n,r){var i,o,a=t.transform;if("map"===r.paint.get("circle-pitch-alignment")){var s=se(n,1,a.zoom);i=!0,o=[s,s]}else i=!1,o=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+i,u_extrude_scale:o}},bn=function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},xn=function(t,e,n){var r=se(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},wn=function(t,e){return{u_matrix:t,u_color:e}},En=function(t){return{u_matrix:t}},Sn=function(t,e,n,r){return{u_matrix:t,u_extrude_scale:se(e,1,n),u_intensity:r}},Pn=function(e,n,r){var i,o,a,s=r.paint.get("hillshade-shadow-color"),u=r.paint.get("hillshade-highlight-color"),c=r.paint.get("hillshade-accent-color"),l=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return"viewport"===r.paint.get("hillshade-illumination-anchor")&&(l-=e.transform.angle),{u_matrix:e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),!0),u_image:0,u_latrange:(i=n.tileID,o=Math.pow(2,i.canonical.z),a=i.canonical.y,[new t.MercatorCoordinate(0,a/o).toLngLat().lat,new t.MercatorCoordinate(0,(a+1)/o).toLngLat().lat]),u_light:[r.paint.get("hillshade-exaggeration"),l],u_shadow:s,u_highlight:u,u_accent:c}},Tn=function(e,n){var r=e.dem.dim,i=t.create();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[2*r,2*r],u_zoom:e.tileID.overscaledZ,u_maxzoom:n}},An=function(t,e,n){var r=t.transform;return{u_matrix:In(t,e,n),u_ratio:1/se(e,1,r.zoom),u_gl_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},kn=function(e,n,r){return t.extend(An(e,n,r),{u_image:0})},Cn=function(e,n,r,i){var o=e.transform,a=Mn(n,o);return{u_matrix:In(e,n,r),u_texsize:n.imageAtlasTexture.size,u_ratio:1/se(n,1,o.zoom),u_image:0,u_scale:[t.browser.devicePixelRatio,a,i.fromScale,i.toScale],u_fade:i.t,u_gl_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},On=function(e,n,r,i,o){var a=e.transform,s=e.lineAtlas,u=Mn(n,a),c="round"===r.layout.get("line-cap"),l=s.getDash(i.from,c),f=s.getDash(i.to,c),h=l.width*o.fromScale,p=f.width*o.toScale;return t.extend(An(e,n,r),{u_patternscale_a:[u/h,-l.height/2],u_patternscale_b:[u/p,-f.height/2],u_sdfgamma:s.width/(256*Math.min(h,p)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:f.y,u_mix:o.t})};function Mn(t,e){return 1/se(t,1,e.tileZoom)}function In(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Ln=function(t,e,n,r,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:function(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}(i.paint.get("raster-hue-rotate"))};var o,a},Rn=function(t,e,n,r,i,o,a,s,u,c){var l=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:l.cameraToCenterDistance,u_pitch:l.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:l.width/l.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_gl_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},jn=function(e,n,r,i,o,a,s,u,c,l,f){var h=o.transform;return t.extend(Rn(e,n,r,i,o,a,s,u,c,l),{u_gamma_scale:i?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_is_halo:+f})},zn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Dn=function(e,n,r,i,o,a){return t.extend(function(t,e,n,r){var i=n.imageManager.getPattern(t.from),o=n.imageManager.getPattern(t.to),a=n.imageManager.getPixelSize(),s=a.width,u=a.height,c=Math.pow(2,r.tileID.overscaledZ),l=r.tileSize*Math.pow(2,n.transform.tileZoom)/c,f=l*(r.tileID.canonical.x+r.tileID.wrap*c),h=l*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,u],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/se(r,1,n.transform.tileZoom),u_pixel_coord_upper:[f>>16,h>>16],u_pixel_coord_lower:[65535&f,65535&h]}}(i,a,r,o),{u_matrix:e,u_opacity:n})},Fn={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},extrusionTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:bn,collisionCircle:bn,debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_maxzoom:new t.Uniform1f(e,n.u_maxzoom)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_image:new t.Uniform1i(e,n.u_image),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_gl_coord_matrix:new t.UniformMatrix4f(e,n.u_gl_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_gl_coord_matrix:new t.UniformMatrix4f(e,n.u_gl_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_is_halo:new t.Uniform1f(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Nn(e,n){for(var r=e.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),i=0;i<r.length;i++){var o={},a=r[i],s=r.slice(i+1);Bn(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,n)}}function Bn(e,n,r,i,o){for(var a=0;a<r.length;a++){var s=r[a];if(i.isLessThan(s.tileID))break;if(n.key===s.tileID.key)return;if(s.tileID.isChildOf(n)){for(var u=n.children(1/0),c=0;c<u.length;c++)Bn(e,u[c],r.slice(a),i,o);return}}var l=n.overscaledZ-e.overscaledZ,f=new t.CanonicalTileID(l,n.canonical.x-(e.canonical.x<<l),n.canonical.y-(e.canonical.y<<l));o[f.key]=o[f.key]||f}function Un(t,e,n,r,i){for(var o=t.context,a=o.gl,s=i?t.useProgram("collisionCircle"):t.useProgram("collisionBox"),u=0;u<r.length;u++){var c=r[u],l=e.getTile(c),f=l.getBucket(n);if(f){var h=i?f.collisionCircle:f.collisionBox;h&&s.draw(o,i?a.TRIANGLES:a.LINES,wt.disabled,Et.disabled,t.colorModeForRenderPass(),Pt.disabled,xn(c.posMatrix,t.transform,l),n.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,t.transform.zoom,null,null,h.collisionVertexBuffer)}}}var Vn=t.identity(new Float32Array(16)),Gn=t.properties.layout;function qn(e,n,r,i,o,a,s,u,c,l,f,h){for(var p,d,v=e.context,g=v.gl,m=e.transform,y="map"===u,_="map"===c,b=y&&"point"!==r.layout.get("symbol-placement"),x=y&&!_&&!b,w=_?e.depthModeForSublayer(0,wt.ReadOnly):wt.disabled,E=0,S=i;E<S.length;E+=1){var P=S[E],T=n.getTile(P),A=T.getBucket(r);if(A){var k=o?A.text:A.icon;if(k&&k.segments.get().length){var C=k.programConfigurations.get(r.id),O=o||A.sdfIcons,M=o?A.textSizeData:A.iconSizeData;p||(p=e.useProgram(O?"symbolSDF":"symbolIcon",C),d=t.evaluateSizeForZoom(M,m.zoom,Gn.properties[o?"text-size":"icon-size"])),v.activeTexture.set(g.TEXTURE0);var I=void 0;if(o)T.glyphAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),I=T.glyphAtlasTexture.size;else{var L=1!==r.layout.get("icon-size").constantOr(0)||A.iconsNeedLinear,R=_||0!==m.pitch;T.imageAtlasTexture.bind(O||e.options.rotating||e.options.zooming||L||R?g.LINEAR:g.NEAREST,g.CLAMP_TO_EDGE),I=T.imageAtlasTexture.size}var j=se(T,1,e.transform.zoom),z=Zt(P.posMatrix,_,y,e.transform,j),D=Xt(P.posMatrix,_,y,e.transform,j);b&&Kt(A,P.posMatrix,e,o,z,D,_,l);var F=e.translatePosMatrix(P.posMatrix,T,a,s),N=b?Vn:z,B=e.translatePosMatrix(D,T,a,s,!0),U=void 0;if(O){var V=0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);U=jn(M.functionType,d,x,_,e,F,N,B,o,I,!0),V&&Wn(k,r,e,p,w,f,h,U),U.u_is_halo=0}else U=Rn(M.functionType,d,x,_,e,F,N,B,o,I);Wn(k,r,e,p,w,f,h,U)}}}}function Wn(t,e,n,r,i,o,a,s){var u=n.context,c=u.gl;r.draw(u,c.TRIANGLES,i,o,a,Pt.disabled,s,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,e.paint,n.transform.zoom,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Zn(t,e,n,r,i,o,a){var s,u,c,l,f,h=t.context.gl,p=n.paint.get("fill-pattern"),d=p&&p.constantOr(1),v=n.getCrossfadeParameters();a?(u=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=h.LINES):(u=d?"fillPattern":"fill",s=h.TRIANGLES);for(var g=0,m=r;g<m.length;g+=1){var y=m[g],_=e.getTile(y);if(!d||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=t.useProgram(u,x);d&&(t.context.activeTexture.set(h.TEXTURE0),_.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),x.updatePatternPaintBuffers(v));var E=p.constantOr(null);if(E&&_.imageAtlas){var S=_.imageAtlas.patternPositions[E.to],P=_.imageAtlas.patternPositions[E.from];S&&P&&x.setConstantPatternPositions(S,P)}var T=t.translatePosMatrix(y.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){l=b.indexBuffer2,f=b.segments2;var A=[h.drawingBufferWidth,h.drawingBufferHeight];c="fillOutlinePattern"===u&&d?yn(T,t,v,_,A):mn(T,A)}else l=b.indexBuffer,f=b.segments,c=d?gn(T,t,v,_):vn(T);w.draw(t.context,s,i,t.stencilModeForClipping(y),o,Pt.disabled,c,n.id,b.layoutVertexBuffer,l,f,n.paint,t.transform.zoom,x)}}}}function Xn(e,n){var r=e.context,i=r.gl,o=n.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new t.Texture(r,{width:e.width,height:e.height,data:null},i.RGBA);a.bind(i.LINEAR,i.CLAMP_TO_EDGE),(o=n.viewportFrame=r.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}r.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(r.clear({depth:1}),e.depthRboNeedsClear=!1),r.clear({color:t.Color.transparent}),r.setStencilMode(Et.disabled),r.setDepthMode(new wt(i.LEQUAL,wt.ReadWrite,[0,1])),r.setColorMode(e.colorModeForRenderPass())}function Hn(t,e,n){var r=e.viewportFrame;if(r){var i=t.context,o=i.gl;i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),t.useProgram("extrusionTexture").draw(i,o.TRIANGLES,wt.disabled,Et.disabled,t.colorModeForRenderPass(),Pt.disabled,dn(t,n,0),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}function Yn(t,e,n,r,i,o){var a=t.context,s=a.gl,u=e.fbo;if(u){var c=t.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u.colorAttachment.get());var l=Pn(t,e,n);e.maskedBoundsBuffer&&e.maskedIndexBuffer&&e.segments?c.draw(a,s.TRIANGLES,r,i,o,Pt.disabled,l,n.id,e.maskedBoundsBuffer,e.maskedIndexBuffer,e.segments):c.draw(a,s.TRIANGLES,r,i,o,Pt.disabled,l,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function Kn(e,n,r,i,o,a,s){var u=e.context,c=u.gl;if(n.dem&&n.dem.data){var l=n.dem.dim,f=n.dem.getPixels();if(u.activeTexture.set(c.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(n.tileSize),n.demTexture){var h=n.demTexture;h.update(f,{premultiply:!1}),h.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(u,f,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);u.activeTexture.set(c.TEXTURE0);var p=n.fbo;if(!p){var d=new t.Texture(u,{width:l,height:l,data:null},c.RGBA);d.bind(c.LINEAR,c.CLAMP_TO_EDGE),(p=n.fbo=u.createFramebuffer(l,l)).colorAttachment.set(d.texture)}u.bindFramebuffer.set(p.framebuffer),u.viewport.set([0,0,l,l]),e.useProgram("hillshadePrepare").draw(u,c.TRIANGLES,o,a,s,Pt.disabled,Tn(n,i),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Jn(e,n,r,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),u=(s-e.timeAdded)/a,c=n?(s-n.timeAdded)/a:-1,l=r.getSource(),f=o.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-f)>Math.abs(e.tileID.overscaledZ-f),p=h&&e.refreshedUponExpiration?1:t.clamp(h?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}function Qn(e,n,r){var i=e.context,o=i.gl,a=r.posMatrix,s=e.useProgram("debug"),u=wt.disabled,c=Et.disabled,l=e.colorModeForRenderPass(),f="$debug";s.draw(i,o.LINE_STRIP,u,c,l,Pt.disabled,wn(a,t.Color.red),f,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);for(var h=function(t,e,n,r){r=r||1;var i,o,a,s,u,c,l,f,h=[];for(i=0,o=t.length;i<o;i++)if(u=$n[t[i]]){for(f=null,a=0,s=u[1].length;a<s;a+=2)-1===u[1][a]&&-1===u[1][a+1]?f=null:(c=e+u[1][a]*r,l=200-u[1][a+1]*r,f&&h.push(f.x,f.y,c,l),f={x:c,y:l});e+=u[0]*r}return h}(r.toString(),50,0,5),p=new t.StructArrayLayout2i4,d=new t.StructArrayLayout2ui4,v=0;v<h.length;v+=2)p.emplaceBack(h[v],h[v+1]),d.emplaceBack(v,v+1);for(var g=i.createVertexBuffer(p,Le.members),m=i.createIndexBuffer(d),y=t.SegmentVector.simpleSegment(0,0,p.length/2,p.length/2),_=n.getTile(r).tileSize,b=t.EXTENT/(Math.pow(2,e.transform.zoom-r.overscaledZ)*_),x=[[-1,-1],[-1,1],[1,-1],[1,1]],w=0;w<x.length;w++){var E=x[w];s.draw(i,o.LINES,u,c,l,Pt.disabled,wn(t.translate([],a,[b*E[0],b*E[1],0]),t.Color.white),f,g,m,y)}s.draw(i,o.LINES,u,c,l,Pt.disabled,wn(a,t.Color.black),f,g,m,y)}var $n={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},tr={symbol:function(t,e,n,r){if("translucent"===t.renderPass){var i=Et.disabled,o=t.colorModeForRenderPass();0!==n.paint.get("icon-opacity").constantOr(1)&&qn(t,e,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),i,o),0!==n.paint.get("text-opacity").constantOr(1)&&qn(t,e,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),i,o),e.map.showCollisionBoxes&&function(t,e,n,r){Un(t,e,n,r,!1),Un(t,e,n,r,!0)}(t,e,n,r)}},circle:function(t,e,n,r){if("translucent"===t.renderPass){var i=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),a=n.paint.get("circle-stroke-opacity");if(0!==i.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1))for(var s=t.context,u=s.gl,c=t.depthModeForSublayer(0,wt.ReadOnly),l=Et.disabled,f=t.colorModeForRenderPass(),h=0;h<r.length;h++){var p=r[h],d=e.getTile(p),v=d.getBucket(n);if(v){var g=v.programConfigurations.get(n.id);t.useProgram("circle",g).draw(s,u.TRIANGLES,c,l,f,Pt.disabled,_n(t,p,d,n),n.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,n.paint,t.transform.zoom,g)}}}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=e.depthModeForSublayer(0,wt.ReadOnly),u=Et.disabled,c=new St([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),function t(e,n,r,i){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n.width/4,n.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(r),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,i.colorAttachment.setDirty(),t(e,n,r,i))}(t,e,o,i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4))}}(o,e,r),o.clear({color:t.Color.transparent});for(var l=0;l<i.length;l++){var f=i[l];if(!n.hasRenderableParent(f)){var h=n.getTile(f),p=h.getBucket(r);if(p){var d=p.programConfigurations.get(r.id),v=e.useProgram("heatmap",d),g=e.transform.zoom;v.draw(o,a.TRIANGLES,s,u,c,Pt.disabled,Sn(f.posMatrix,h,g,r.paint.get("heatmap-intensity")),r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var r=e.context,i=r.gl,o=n.heatmapFbo;if(o){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.Texture(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,wt.disabled,Et.disabled,e.colorModeForRenderPass(),Pt.disabled,function(e,n,r,i){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:n.paint.get("heatmap-opacity")}}(e,n,0,1),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,r))},line:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=e.depthModeForSublayer(0,wt.ReadOnly),u=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),l=r.paint.get("line-pattern"),f=l.constantOr(1),h=r.paint.get("line-gradient"),p=r.getCrossfadeParameters(),d=c?"lineSDF":f?"linePattern":h?"lineGradient":"line",v=e.context,g=v.gl,m=!0;if(h){v.activeTexture.set(g.TEXTURE0);var y=r.gradientTexture;if(!r.gradient)return;y||(y=r.gradientTexture=new t.Texture(v,r.gradient,g.RGBA)),y.bind(g.LINEAR,g.CLAMP_TO_EDGE)}for(var _=0,b=i;_<b.length;_+=1){var x=b[_],w=n.getTile(x);if(!f||w.patternsLoaded()){var E=w.getBucket(r);if(E){var S=E.programConfigurations.get(r.id),P=e.context.program.get(),T=e.useProgram(d,S),A=m||T.program!==P,k=l.constantOr(null);if(k&&w.imageAtlas){var C=w.imageAtlas.patternPositions[k.to],O=w.imageAtlas.patternPositions[k.from];C&&O&&S.setConstantPatternPositions(C,O)}var M=c?On(e,w,r,c,p):f?Cn(e,w,r,p):h?kn(e,w,r):An(e,w,r);c&&(A||e.lineAtlas.dirty)?(v.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(v)):f&&(v.activeTexture.set(g.TEXTURE0),w.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),S.updatePatternPaintBuffers(p)),T.draw(v,g.TRIANGLES,s,e.stencilModeForClipping(x),u,Pt.disabled,M,r.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,r.paint,e.transform.zoom,S),m=!1}}}}}},fill:function(e,n,r,i){var o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),u=r.paint.get("fill-pattern").constantOr(1)||1!==o.constantOr(t.Color.transparent).a||1!==a.constantOr(0)?"translucent":"opaque";e.renderPass===u&&Zn(e,n,r,i,e.depthModeForSublayer(1,"opaque"===e.renderPass?wt.ReadWrite:wt.ReadOnly),s,!1),"translucent"===e.renderPass&&r.paint.get("fill-antialias")&&Zn(e,n,r,i,e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,wt.ReadOnly),s,!0)}},"fill-extrusion":function(t,e,n,r){0!==n.paint.get("fill-extrusion-opacity")&&("offscreen"===t.renderPass?(Xn(t,n),function(t,e,n,r,i,o,a){for(var s=t.context,u=s.gl,c=n.paint.get("fill-extrusion-pattern"),l=c.constantOr(1),f=n.getCrossfadeParameters(),h=0,p=r;h<p.length;h+=1){var d=p[h],v=e.getTile(d),g=v.getBucket(n);if(g){var m=g.programConfigurations.get(n.id),y=t.useProgram(l?"fillExtrusionPattern":"fillExtrusion",m);l&&(t.context.activeTexture.set(u.TEXTURE0),v.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),m.updatePatternPaintBuffers(f));var _=c.constantOr(null);if(_&&v.imageAtlas){var b=v.imageAtlas.patternPositions[_.to],x=v.imageAtlas.patternPositions[_.from];b&&x&&m.setConstantPatternPositions(b,x)}var w=t.translatePosMatrix(d.posMatrix,v,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),E=n.paint.get("fill-extrusion-vertical-gradient"),S=l?pn(w,t,E,d,f,v):hn(w,t,E);y.draw(s,s.gl.TRIANGLES,i,o,a,Pt.backCCW,S,n.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,n.paint,t.transform.zoom,m)}}}(t,e,n,r,new wt(t.context.gl.LEQUAL,wt.ReadWrite,[0,1]),Et.disabled,t.colorModeForRenderPass())):"translucent"===t.renderPass&&Hn(t,n,n.paint.get("fill-extrusion-opacity")))},hillshade:function(t,e,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var i=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,wt.ReadOnly),s=Et.disabled,u=t.colorModeForRenderPass(),c=0,l=r;c<l.length;c+=1){var f=l[c],h=e.getTile(f);h.needsHillshadePrepare&&"offscreen"===t.renderPass?Kn(t,h,n,o,a,s,u):"translucent"===t.renderPass&&Yn(t,h,n,a,s,u)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,r){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity"))for(var i=t.context,o=i.gl,a=e.getSource(),s=t.useProgram("raster"),u=Et.disabled,c=t.colorModeForRenderPass(),l=r.length&&r[0].overscaledZ,f=0,h=r;f<h.length;f+=1){var p=h[f],d=t.depthModeForSublayer(p.overscaledZ-l,1===n.paint.get("raster-opacity")?wt.ReadWrite:wt.ReadOnly,o.LESS),v=e.getTile(p),g=t.transform.calculatePosMatrix(p.toUnwrapped(),!0);v.registerFadeDuration(n.paint.get("raster-fade-duration"));var m=e.findLoadedParent(p,0),y=Jn(v,m,e,n,t.transform),_=void 0,b=void 0,x="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),v.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),m?(m.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),_=Math.pow(2,m.tileID.overscaledZ-v.tileID.overscaledZ),b=[v.tileID.canonical.x*_%1,v.tileID.canonical.y*_%1]):v.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var w=Ln(g,b||[0,0],_||1,y,n);a instanceof C?s.draw(i,o.TRIANGLES,d,u,c,Pt.disabled,w,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):v.maskedBoundsBuffer&&v.maskedIndexBuffer&&v.segments?s.draw(i,o.TRIANGLES,d,u,c,Pt.disabled,w,n.id,v.maskedBoundsBuffer,v.maskedIndexBuffer,v.segments,n.paint,t.transform.zoom):s.draw(i,o.TRIANGLES,d,u,c,Pt.disabled,w,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var r=n.paint.get("background-color"),i=n.paint.get("background-opacity");if(0!==i){var o=t.context,a=o.gl,s=t.transform,u=s.tileSize,c=n.paint.get("background-pattern");if(!t.isPatternMissing(c)){var l=c||1!==r.a||1!==i?"translucent":"opaque";if(t.renderPass===l){var f=Et.disabled,h=t.depthModeForSublayer(0,"opaque"===l?wt.ReadWrite:wt.ReadOnly),p=t.colorModeForRenderPass(),d=t.useProgram(c?"backgroundPattern":"background"),v=s.coveringTiles({tileSize:u});c&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var g=n.getCrossfadeParameters(),m=0,y=v;m<y.length;m+=1){var _=y[m],b=t.transform.calculatePosMatrix(_.toUnwrapped()),x=c?Dn(b,i,t,c,{tileID:_,tileSize:u},g):zn(b,i,r);d.draw(o,a.TRIANGLES,h,f,p,Pt.disabled,x,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var r=0;r<n.length;r++)Qn(t,e,n[r])},custom:function(t,e,n){var r=t.context,i=n.implementation;if("offscreen"===t.renderPass){var o=i.prerender;o&&(t.setCustomLayerDefaults(),o.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState()),"3d"===i.renderingMode&&(t.setCustomLayerDefaults(),Xn(t,n),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass)if("3d"===i.renderingMode)Hn(t,n,1);else{t.setCustomLayerDefaults(),r.setStencilMode(Et.disabled);var a=t.depthModeForSublayer(0,wt.ReadOnly);r.setDepthMode(a),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},er=function(e,n){this.context=new Tt(e),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=At.maxUnderzooming+At.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.ProgramConfiguration,this.crossTileSymbolIndex=new ke};function nr(t,e){if(t.y>e.y){var n=t;t=e,e=n}return{x0:t.x,y0:t.y,x1:e.x,y1:e.y,dx:e.x-t.x,dy:e.y-t.y}}function rr(t,e,n,r,i){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(r,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,c=e.dx/e.dy,l=t.dx>0,f=e.dx<0,h=o;h<a;h++){var p=u*Math.max(0,Math.min(t.dy,h+l-t.y0))+t.x0,d=c*Math.max(0,Math.min(e.dy,h+f-e.y0))+e.x0;i(Math.floor(d),Math.ceil(p),h)}}function ir(t,e,n,r,i,o){var a,s=nr(t,e),u=nr(e,n),c=nr(n,t);s.dy>u.dy&&(a=s,s=u,u=a),s.dy>c.dy&&(a=s,s=c,c=a),u.dy>c.dy&&(a=u,u=c,c=a),s.dy&&rr(c,s,r,i,o),u.dy&&rr(c,u,r,i,o)}er.prototype.resize=function(e,n){var r=this.context.gl;if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,o=this.style._order;i<o.length;i+=1){var a=o[i];this.style._layers[a].resize()}this.depthRbo&&(r.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},er.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,Le.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,Le.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,t.rasterBoundsAttributes.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,Le.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);var u=this.context.gl;this.stencilClearMode=new Et({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)},er.prototype.clearStencil=function(){var e=this.context,n=e.gl,r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,wt.disabled,this.stencilClearMode,St.disabled,Pt.disabled,En(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},er.prototype._renderTileClippingMasks=function(t){var e=this.context,n=e.gl;e.setColorMode(St.disabled),e.setDepthMode(wt.disabled);var r=this.useProgram("clippingMask"),i=1;this._tileClippingMaskIDs={};for(var o=0,a=t;o<a.length;o+=1){var s=a[o],u=this._tileClippingMaskIDs[s.key]=i++;r.draw(e,n.TRIANGLES,wt.disabled,new Et({func:n.ALWAYS,mask:0},u,255,n.KEEP,n.KEEP,n.REPLACE),St.disabled,Pt.disabled,En(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}},er.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Et({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},er.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new St([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?St.unblended:St.alphaBlended},er.prototype.depthModeForSublayer=function(t,e,n){var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,i=r-1+this.depthRange;return new wt(n||this.context.gl.LEQUAL,e,[i,r])},er.prototype.render=function(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now());var r=this.style._order,i=this.style.sourceCaches;for(var o in i){var a=i[o];a.used&&a.prepare(this.context)}var s,u={},c={},l={};for(var f in i){var h=i[f];u[f]=h.getVisibleCoordinates(),c[f]=u[f].slice().reverse(),l[f]=h.getVisibleCoordinates(!0).reverse()}for(var p in i){var d=i[p],v=d.getSource();if("raster"===v.type||"raster-dem"===v.type){for(var g=[],m=0,y=u[p];m<y.length;m+=1){var _=y[m];g.push(d.getTile(_))}Nn(g,this.context)}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var b=0,x=r;b<x.length;b+=1){var w=x[b],E=this.style._layers[w];if(E.hasOffscreenPass()&&!E.isHidden(this.transform.zoom)){var S=c[E.source];("custom"===E.type||S.length)&&this.renderLayer(this,i[E.source],E,S)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){var P=this.style._layers[r[this.currentLayer]],T=i[P.source],A=u[P.source];P.source!==s&&T&&(this.clearStencil(),T.getSource().isTileClipped&&this._renderTileClippingMasks(A)),this.renderLayer(this,T,P,A),s=P.source}for(this.renderPass="translucent",this.currentLayer=0,s=null;this.currentLayer<r.length;this.currentLayer++){var k=this.style._layers[r[this.currentLayer]],C=i[k.source],O=("symbol"===k.type?l:c)[k.source];k.source!==s&&C&&(this.clearStencil(),C.getSource().isTileClipped&&this._renderTileClippingMasks(u[k.source])),this.renderLayer(this,C,k,O),s=k.source}if(this.options.showTileBoundaries)for(var M in i){tr.debug(this,i[M],u[M]);break}this.setCustomLayerDefaults()},er.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},er.prototype.renderLayer=function(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||r.length)&&(this.id=n.id,tr[n.type](t,e,n,r))},er.prototype.translatePosMatrix=function(e,n,r,i,o){if(!r[0]&&!r[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),u=Math.cos(a);r=[r[0]*u-r[1]*s,r[0]*s+r[1]*u]}var c=[o?r[0]:se(n,r[0],this.transform.zoom),o?r[1]:se(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,c),l},er.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},er.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},er.prototype.isPatternMissing=function(t){if(!t)return!1;var e=this.imageManager.getPattern(t.from),n=this.imageManager.getPattern(t.to);return!e||!n},er.prototype.useProgram=function(t,e){void 0===e&&(e=this.emptyProgramConfiguration),this.cache=this.cache||{};var n=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new ln(this.context,un[t],e,Fn[t],this._showOverdrawInspector)),this.cache[n]},er.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},er.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)};var or=function(e,n,r){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===r||r,this._minZoom=e||0,this._maxZoom=n||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},ar={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};or.prototype.clone=function(){var t=new or(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},ar.minZoom.get=function(){return this._minZoom},ar.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},ar.maxZoom.get=function(){return this._maxZoom},ar.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},ar.renderWorldCopies.get=function(){return this._renderWorldCopies},ar.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},ar.worldSize.get=function(){return this.tileSize*this.scale},ar.centerPoint.get=function(){return this.size._div(2)},ar.size.get=function(){return new t.Point(this.width,this.height)},ar.bearing.get=function(){return-this.angle/Math.PI*180},ar.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$4(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ar.pitch.get=function(){return this._pitch/Math.PI*180},ar.pitch.set=function(e){var n=t.clamp(e,0,60)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},ar.fov.get=function(){return this._fov/Math.PI*180},ar.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},ar.zoom.get=function(){return this._zoom},ar.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},ar.center.get=function(){return this._center},ar.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},or.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},or.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.Point(0,0)),i=this.pointCoordinate(new t.Point(this.width,0)),o=this.pointCoordinate(new t.Point(this.width,this.height)),a=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),u=Math.floor(Math.max(r.x,i.x,o.x,a.x)),c=s-1;c<=u+1;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e));return n},or.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),r=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var i=t.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,n),a=new t.Point(o*i.x-.5,o*i.y-.5);return function(e,n,r,i){void 0===i&&(i=!0);var o=1<<e,a={};function s(n,s,u){var c,l,f,h;if(u>=0&&u<=o)for(c=n;c<s;c++)l=Math.floor(c/o),f=(c%o+o)%o,0!==l&&!0!==i||(h=new t.OverscaledTileID(r,l,e,f,u),a[h.key]=h)}var u=n.map(function(e){return new t.Point(e.x,e.y)._mult(o)});return ir(u[0],u[1],u[2],0,o,s),ir(u[2],u[3],u[0],0,o,s),Object.keys(a).map(function(t){return a[t]})}(n,[this.pointCoordinate(new t.Point(0,0)),this.pointCoordinate(new t.Point(this.width,0)),this.pointCoordinate(new t.Point(this.width,this.height)),this.pointCoordinate(new t.Point(0,this.height))],e.reparseOverscaled?r:n,this._renderWorldCopies).sort(function(t,e){return a.dist(t.canonical)-a.dist(e.canonical)})},or.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},ar.unmodified.get=function(){return this._unmodified},or.prototype.zoomScale=function(t){return Math.pow(2,t)},or.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},or.prototype.project=function(e){var n=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(n)*this.worldSize)},or.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},ar.point.get=function(){return this.project(this.center)},or.prototype.setLocationAtPoint=function(e,n){var r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},or.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},or.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},or.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},or.prototype.coordinateLocation=function(t){return t.toLngLat()},or.prototype.pointCoordinate=function(e){var n=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.transformMat4(n,n,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse);var i=n[3],o=r[3],a=n[0]/i,s=r[0]/o,u=n[1]/i,c=r[1]/o,l=n[2]/i,f=r[2]/o,h=l===f?0:(0-l)/(f-l);return new t.MercatorCoordinate(t.number(a,s,h)/this.worldSize,t.number(u,c,h)/this.worldSize)},or.prototype.coordinatePoint=function(e){var n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix),new t.Point(n[0]/n[3],n[1]/n[3])},or.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},or.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},or.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},or.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,u=t.identity(new Float64Array(16));return t.translate(u,u,[s*a,o.y*a,0]),t.scale(u,u,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(u,n?this.alignedProjMatrix:this.projMatrix,u),i[r]=new Float32Array(u),i[r]},or.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},or.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,r,i,o=-90,a=90,s=-180,u=180,c=this.size,l=this._unmodified;if(this.latRange){var f=this.latRange;o=t.mercatorYfromLat(f[1])*this.worldSize,e=(a=t.mercatorYfromLat(f[0])*this.worldSize)-o<c.y?c.y/(a-o):0}if(this.lngRange){var h=this.lngRange;s=t.mercatorXfromLng(h[0])*this.worldSize,n=(u=t.mercatorXfromLng(h[1])*this.worldSize)-s<c.x?c.x/(u-s):0}var p=this.point,d=Math.max(n||0,e||0);if(d)return this.center=this.unproject(new t.Point(n?(u+s)/2:p.x,e?(a+o)/2:p.y)),this.zoom+=this.scaleZoom(d),this._unmodified=l,void(this._constraining=!1);if(this.latRange){var v=p.y,g=c.y/2;v-g<o&&(i=o+g),v+g>a&&(i=a-g)}if(this.lngRange){var m=p.x,y=c.x/2;m-y<s&&(r=s+y),m+y>u&&(r=u-y)}void 0===r&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==r?r:p.x,void 0!==i?i:p.y))),this._unmodified=l,this._constraining=!1}},or.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,n=Math.PI/2+this._pitch,r=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-n-e),i=this.point,o=i.x,a=i.y,s=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),u=new Float64Array(16);t.perspective(u,this._fov,this.width/this.height,1,s),t.scale(u,u,[1,-1,1]),t.translate(u,u,[0,0,-this.cameraToCenterDistance]),t.rotateX(u,u,this._pitch),t.rotateZ(u,u,this.angle),t.translate(u,u,[-o,-a,0]),this.mercatorMatrix=t.scale([],u,[this.worldSize,this.worldSize,this.worldSize]),t.scale(u,u,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=u;var c=this.width%2/2,l=this.height%2/2,f=Math.cos(this.angle),h=Math.sin(this.angle),p=o-Math.round(o)+f*c+h*l,d=a-Math.round(a)+f*l+h*c,v=new Float64Array(u);if(t.translate(v,v,[p>.5?p-1:p,d>.5?d-1:d,0]),this.alignedProjMatrix=v,u=t.create(),t.scale(u,u,[this.width/2,-this.height/2,1]),t.translate(u,u,[1,-1,0]),this.pixelMatrix=t.multiply(new Float64Array(16),u,this.projMatrix),!(u=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={}}},or.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(or.prototype,ar);var sr=function(){var e,n,r,i;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),n=!1,r=0,i=function(){r=0,n&&(e(),r=setTimeout(i,300),n=!1)},function(){return n=!0,r||i(),r})};sr.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},sr.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},sr.prototype.getHashString=function(t){var e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,r),o=Math.round(e.lng*i)/i,a=Math.round(e.lat*i)/i,s=this._map.getBearing(),u=this._map.getPitch(),c="";return c+=t?"#/"+o+"/"+a+"/"+n:"#"+n+"/"+a+"/"+o,(s||u)&&(c+="/"+Math.round(10*s)/10),u&&(c+="/"+Math.round(u)),c},sr.prototype._onHashChange=function(){var e=t.window.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},sr.prototype._updateHashUnthrottled=function(){var e=this.getHashString();try{t.window.history.replaceState(t.window.history.state,"",e)}catch(t){}};var ur=function(e){function r(r,i,o,a){void 0===a&&(a={});var s=n.mousePos(i.getCanvasContainer(),o),u=i.unproject(s);e.call(this,r,t.extend({point:s,lngLat:u,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),cr=function(e){function r(r,i,o){var a=n.touchPos(i.getCanvasContainer(),o),s=a.map(function(t){return i.unproject(t)}),u=a.reduce(function(t,e,n,r){return t.add(e.div(r.length))},new t.Point(0,0)),c=i.unproject(u);e.call(this,r,{points:a,point:u,lngLats:s,lngLat:c,originalEvent:o}),this._defaultPrevented=!1}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),lr=function(t){function e(e,n,r){t.call(this,e,{originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),fr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};fr.prototype.isEnabled=function(){return!!this._enabled},fr.prototype.isActive=function(){return!!this._active},fr.prototype.isZooming=function(){return!!this._zooming},fr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},fr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},fr.prototype.onWheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this.isActive()||this._start(e)),e.preventDefault()}},fr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},fr.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._zooming=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var r=n.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},fr.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:n.zoom,s=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&s&&u){var l=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),f=u(l);n.zoom=t.number(s,a,f),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):c=!0}else n.zoom=a,c=!0;n.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),c&&(this._active=!1,this._finishTimeout=setTimeout(function(){e._zooming=!1,e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom},200))}},fr.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var r=this._prevEase,i=(t.browser.now()-r.start)/r.duration,o=r.easing(i+.01)-r.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n};var hr=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1,t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};hr.prototype.isEnabled=function(){return!!this._enabled},hr.prototype.isActive=function(){return!!this._active},hr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},hr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},hr.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.window.document.addEventListener("mousemove",this._onMouseMove,!1),t.window.document.addEventListener("keydown",this._onKeyDown,!1),t.window.document.addEventListener("mouseup",this._onMouseUp,!1),n.disableDrag(),this._startPos=this._lastPos=n.mousePos(this._el,e),this._active=!0)},hr.prototype._onMouseMove=function(t){var e=n.mousePos(this._el,t);if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=e,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(r.x,e.x),o=Math.max(r.x,e.x),a=Math.min(r.y,e.y),s=Math.max(r.y,e.y);n.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}},hr.prototype._onMouseUp=function(e){if(0===e.button){var r=this._startPos,i=n.mousePos(this._el,e);this._finish(),n.suppressClick(),r.x===i.x&&r.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e}))}},hr.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},hr.prototype._finish=function(){this._active=!1,t.window.document.removeEventListener("mousemove",this._onMouseMove,!1),t.window.document.removeEventListener("keydown",this._onKeyDown,!1),t.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},hr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var pr=t.bezier(0,0,.25,1),dr=function(e,n){this._map=e,this._el=n.element||e.getCanvasContainer(),this._state="disabled",this._button=n.button||"right",this._bearingSnap=n.bearingSnap||0,this._pitchWithRotate=!1!==n.pitchWithRotate,t.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};dr.prototype.isEnabled=function(){return"disabled"!==this._state},dr.prototype.isActive=function(){return"active"===this._state},dr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},dr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},dr.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=n.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==n.mouseButton(e))return;this._eventButton=0}n.disableDrag(),t.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.addEventListener("mouseup",this._onMouseUp),t.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[t.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=n.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},dr.prototype._onMouseMove=function(t){var e=n.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},dr.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var n=this._map.transform,r=this._startPos,i=this._lastPos,o=.8*(r.x-i.x),a=-.5*(r.y-i.y),s=n.bearing-o,u=n.pitch-a,c=this._inertia,l=c[c.length-1];this._drainInertiaBuffer(),c.push([t.browser.now(),this._map._normalizeBearing(s,l[1])]),n.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",e),n.pitch=u),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._startPos=this._lastPos}},dr.prototype._onMouseUp=function(t){if(n.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},dr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},dr.prototype._unbind=function(){t.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.removeEventListener("mouseup",this._onMouseUp),t.window.removeEventListener("blur",this._onBlur),n.enableDrag()},dr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},dr.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var n=this._map,r=n.getBearing(),i=this._inertia,o=function(){Math.abs(r)<e._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(i.length<2)o();else{var a=i[0],s=i[i.length-1],u=i[i.length-2],c=n._normalizeBearing(r,u[1]),l=s[1]-a[1],f=l<0?-1:1,h=(s[0]-a[0])/1e3;if(0!==l&&0!==h){var p=Math.abs(l*(.25/h));p>180&&(p=180);var d=p/180;c+=f*p*(d/2),Math.abs(n._normalizeBearing(c,0))<this._bearingSnap&&(c=n._normalizeBearing(0,c)),n.rotateTo(c,{duration:1e3*d,easing:pr,noMoveStart:!0},{originalEvent:t})}else o()}},dr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},dr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>0&&n-e[0][0]>160;)e.shift()};var vr=t.bezier(0,0,.3,1),gr=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",this._clickTolerance=n.clickTolerance||1,t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};gr.prototype.isEnabled=function(){return"disabled"!==this._state},gr.prototype.isActive=function(){return"active"===this._state},gr.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},gr.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},gr.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==n.mouseButton(e)||(n.addEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),n.addEventListener(t.window.document,"mouseup",this._onMouseUp),this._start(e)))},gr.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(n.addEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.addEventListener(t.window.document,"touchend",this._onTouchEnd),this._start(e)))},gr.prototype._start=function(e){t.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=n.mousePos(this._el,e),this._inertia=[[t.browser.now(),this._startPos]]},gr.prototype._onMove=function(e){e.preventDefault();var r=n.mousePos(this._el,e);this._lastPos.equals(r)||"pending"===this._state&&r.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=e,this._lastPos=r,this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},gr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._startPos=this._lastPos,delete this._lastMoveEvent}},gr.prototype._onMouseUp=function(t){if(0===n.mouseButton(t))switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},gr.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},gr.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},gr.prototype._unbind=function(){n.removeEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.removeEventListener(t.window.document,"touchend",this._onTouchEnd),n.removeEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),n.removeEventListener(t.window.document,"mouseup",this._onMouseUp),n.removeEventListener(t.window,"blur",this._onBlur)},gr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},gr.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var n=e[e.length-1],r=e[0],i=n[1].sub(r[1]),o=(n[0]-r[0])/1e3;if(0===o||n[1].equals(r[1]))this._fireEvent("moveend",t);else{var a=i.mult(.3/o),s=a.mag();s>1400&&(s=1400,a._unit()._mult(s));var u=s/750,c=a.mult(-u/2);this._map.panBy(c,{duration:1e3*u,easing:vr,noMoveStart:!0},{originalEvent:t})}}},gr.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},gr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>0&&n-e[0][0]>160;)e.shift()};var mr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function yr(t){return t*(2-t)}mr.prototype.isEnabled=function(){return!!this._enabled},mr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},mr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},mr.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,n=0,r=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?r=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),u={duration:300,delayEndEvents:500,easing:yr,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*r,offset:[100*-i,100*-o],center:a.getCenter()};a.easeTo(u,{originalEvent:t})}};var _r=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};_r.prototype.isEnabled=function(){return!!this._enabled},_r.prototype.isActive=function(){return!!this._active},_r.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},_r.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},_r.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout(function(){e._tapped=null},300)))},_r.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},_r.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},_r.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var br=t.bezier(0,0,.15,1),xr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};xr.prototype.isEnabled=function(){return!!this._enabled},xr.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},xr.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},xr.prototype.disableRotation=function(){this._rotationDisabled=!0},xr.prototype.enableRotation=function(){this._rotationDisabled=!1},xr.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var r=n.mousePos(this._el,e.touches[0]),i=n.mousePos(this._el,e.touches[1]),o=r.add(i).div(2);this._startVec=r.sub(i),this._startAround=this._map.transform.pointLocation(o),this._gestureIntent=void 0,this._inertia=[],n.addEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),n.addEventListener(t.window.document,"touchend",this._onEnd)}},xr.prototype._getTouchEventData=function(t){var e=n.mousePos(this._el,t.touches[0]),r=n.mousePos(this._el,t.touches[1]),i=e.sub(r);return{vec:i,center:e.add(r).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},xr.prototype._onMove=function(e){if(2===e.touches.length){var n=this._getTouchEventData(e),r=n.vec,i=n.scale,o=n.bearing;if(!this._gestureIntent){var a=Math.abs(1-i)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=r)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},xr.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var n=this._map.transform;this._startScale||(this._startScale=n.scale,this._startBearing=n.bearing);var r=this._getTouchEventData(this._lastTouchEvent),i=r.center,o=r.bearing,a=r.scale,s=n.pointLocation(i),u=n.locationPoint(s);"rotate"===e&&(n.bearing=this._startBearing+o),n.zoom=n.scaleZoom(this._startScale*a),n.setLocationAtPoint(this._startAround,u),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),a,i])}},xr.prototype._onEnd=function(e){n.removeEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),n.removeEventListener(t.window.document,"touchend",this._onEnd);var r=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,r){this._map.fire(new t.Event(r+"end",{originalEvent:e})),this._drainInertiaBuffer();var o=this._inertia,a=this._map;if(o.length<2)a.snapToNorth({},{originalEvent:e});else{var s=o[o.length-1],u=o[0],c=a.transform.scaleZoom(i*s[1]),l=a.transform.scaleZoom(i*u[1]),f=c-l,h=(s[0]-u[0])/1e3,p=s[2];if(0!==h&&c!==l){var d=.15*f/h;Math.abs(d)>2.5&&(d=d>0?2.5:-2.5);var v=1e3*Math.abs(d/(12*.15)),g=c+d*v/2e3;g<0&&(g=0),a.easeTo({zoom:g,duration:v,easing:br,around:this._aroundCenter?a.getCenter():a.unproject(p),noMoveStart:!0},{originalEvent:e})}else a.snapToNorth({},{originalEvent:e})}}},xr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>2&&n-e[0][0]>160;)e.shift()};var wr={scrollZoom:fr,boxZoom:hr,dragRotate:dr,dragPan:gr,keyboard:mr,doubleClickZoom:_r,touchZoomRotate:xr},Er=function(e){function n(n,r){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getCenter=function(){return this.transform.center},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)},n.prototype.panTo=function(e,n,r){return this.easeTo(t.extend({center:e},n),r)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.rotateTo=function(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(e,n){return e=t.LngLatBounds.convert(e),this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),0,n)},n.prototype._cameraForBoxAndBearing=function(e,n,r,i){if("number"==typeof(i=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var o=i.padding;i.padding={top:o,bottom:o,right:o,left:o}}if(t.isEqual(Object.keys(i.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"])){var a=[(i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2],s=Math.min(i.padding.right,i.padding.left),u=Math.min(i.padding.top,i.padding.bottom);i.offset=[i.offset[0]+a[0],i.offset[1]+a[1]];var c=this.transform,l=c.project(t.LngLat.convert(e)),f=c.project(t.LngLat.convert(n)),h=l.rotate(-r*Math.PI/180),p=f.rotate(-r*Math.PI/180),d=new t.Point(Math.max(h.x,p.x),Math.max(h.y,p.y)),v=new t.Point(Math.min(h.x,p.x),Math.min(h.y,p.y)),g=t.Point.convert(i.offset),m=d.sub(v),y=(c.width-2*s-2*Math.abs(g.x))/m.x,_=(c.height-2*u-2*Math.abs(g.y))/m.y;if(!(_<0||y<0))return i.center=c.unproject(l.add(f).div(2)),i.zoom=Math.min(c.scaleZoom(c.scale*Math.min(y,_)),i.maxZoom),i.bearing=r,i;t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),r,i),i,o)},n.prototype._fitInternal=function(e,n,r){return e?(n=t.extend(e,n)).linear?this.easeTo(n,r):this.flyTo(n,r):this},n.prototype.jumpTo=function(e,n){this.stop();var r=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(a=!0,r.pitch=+e.pitch),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var r=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u="zoom"in e?+e.zoom:o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,l="pitch"in e?+e.pitch:s,f=i.centerPoint.add(t.Point.convert(e.offset)),h=i.pointLocation(f),p=t.LngLat.convert(e.center||h);this._normalizeCenter(p);var d,v,g=i.project(h),m=i.project(p).sub(g),y=i.zoomScale(u-o);return e.around&&(d=t.LngLat.convert(e.around),v=i.locationPoint(d)),this._zooming=u!==o,this._rotating=a!==c,this._pitching=l!==s,this._prepareEase(n,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(e){if(r._zooming&&(i.zoom=t.number(o,u,e)),r._rotating&&(i.bearing=t.number(a,c,e)),r._pitching&&(i.pitch=t.number(s,l,e)),d)i.setLocationAtPoint(d,v);else{var h=i.zoomScale(i.zoom-o),p=u>o?Math.min(2,y):Math.max(.5,y),_=Math.pow(p,1-e),b=i.unproject(g.add(m.mult(e*_)).mult(h));i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,f)}r._fireMoveEvents(n)},function(){e.delayEndEvents?r._easeEndTimeoutID=setTimeout(function(){return r._afterEase(n)},e.delayEndEvents):r._afterEase(n)},e),this},n.prototype._prepareEase=function(e,n){this._moving=!0,n||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e){var n=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,n&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},n.prototype.flyTo=function(e,n){var r=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u="zoom"in e?t.clamp(+e.zoom,i.minZoom,i.maxZoom):o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,l="pitch"in e?+e.pitch:s,f=i.zoomScale(u-o),h=i.centerPoint.add(t.Point.convert(e.offset)),p=i.pointLocation(h),d=t.LngLat.convert(e.center||p);this._normalizeCenter(d);var v=i.project(p),g=i.project(d).sub(v),m=e.curve,y=Math.max(i.width,i.height),_=y/f,b=g.mag();if("minZoom"in e){var x=t.clamp(Math.min(e.minZoom,o,u),i.minZoom,i.maxZoom),w=y/i.zoomScale(x-o);m=Math.sqrt(w/b*2)}var E=m*m;function S(t){var e=(_*_-y*y+(t?-1:1)*E*E*b*b)/(2*(t?_:y)*E*b);return Math.log(Math.sqrt(e*e+1)-e)}function P(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}var A=S(0),k=function(t){return T(A)/T(A+m*t)},C=function(t){return y*((T(A)*(P(e=A+m*t)/T(e))-P(A))/E)/b;var e},O=(S(1)-A)/m;if(Math.abs(b)<1e-6||!isFinite(O)){if(Math.abs(y-_)<1e-6)return this.easeTo(e,n);var M=_<y?-1:1;O=Math.abs(Math.log(_/y))/m,C=function(){return 0},k=function(t){return Math.exp(M*m*t)}}if("duration"in e)e.duration=+e.duration;else{var I="screenSpeed"in e?+e.screenSpeed/m:+e.speed;e.duration=1e3*O/I}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=a!==c,this._pitching=l!==s,this._prepareEase(n,!1),this._ease(function(e){var f=e*O,p=1/k(f);i.zoom=1===e?u:o+i.scaleZoom(p),r._rotating&&(i.bearing=t.number(a,c,e)),r._pitching&&(i.pitch=t.number(s,l,e));var m=1===e?d:i.unproject(v.add(g.mult(C(f))).mult(p));i.setLocationAtPoint(i.renderWorldCopies?m.wrap():m,h),r._fireMoveEvents(n)},function(){return r._afterEase(n)},e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},n.prototype._ease=function(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),Sr=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Sr.prototype.getDefaultPosition=function(){return"bottom-right"},Sr.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Sr.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},Sr.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:t.config.ACCESS_TOKEN}];if(e){var r=n.reduce(function(t,e,r){return e.value&&(t+=e.key+"="+e.value+(r<n.length-1?"&":"")),t},"?");e.href="https://www.mapbox.com/feedback/"+r+(this._map._hash?this._map._hash.getHashString(!0):"")}},Sr.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},Sr.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(function(t){return"string"!=typeof t?"":"<p>"+t+"</p>"})):"string"==typeof this.options.customAttribution&&t.push("<p>"+this.options.customAttribution+"</p>")),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r];if(i.used){var o=i.getSource();o.attribution&&t.indexOf(o.attribution)<0&&t.push(o.attribution)}}t.sort(function(t,e){return t.length-e.length}),(t=t.filter(function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join("<p> | </p>"),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},Sr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Pr=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};Pr.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),e.setAttribute("rel","noopener"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Pr.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Pr.prototype.getDefaultPosition=function(){return"bottom-left"},Pr.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Pr.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},Pr.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var Tr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Tr.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},Tr.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,r=e?this._queue.concat(e):this._queue;n<r.length;n+=1){var i=r[n];if(i.id===t)return void(i.cancelled=!0)}},Tr.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(!r.cancelled&&(r.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Tr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ar=t.window.HTMLImageElement,kr=t.window.HTMLElement,Cr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Or=function(r){function i(e){var i=this;if(null!=(e=t.extend({},Cr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var o=new or(e.minZoom,e.maxZoom,e.renderWorldCopies);r.call(this,o,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new Tr,this._controls=[],this._mapId=t.uniqueId();var a=e.transformRequest;if(this._transformRequest=a?function(t,e){return a(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof kr))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return i._update(!1)}),this.on("zoom",function(){return i._update(!0)}),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var r=t.getCanvasContainer(),i=null,o=!1,a=null;for(var s in wr)t[s]=new wr[s](t,e),e.interactive&&e[s]&&t[s].enable(e[s]);n.addEventListener(r,"mouseout",function(e){t.fire(new ur("mouseout",t,e))}),n.addEventListener(r,"mousedown",function(i){o=!0,a=n.mousePos(r,i);var s=new ur("mousedown",t,i);t.fire(s),s.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(i),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(i),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(i))}),n.addEventListener(r,"mouseup",function(e){var n=t.dragRotate.isActive();i&&!n&&t.fire(new ur("contextmenu",t,i)),i=null,o=!1,t.fire(new ur("mouseup",t,e))}),n.addEventListener(r,"mousemove",function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var n=e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new ur("mousemove",t,e))}}),n.addEventListener(r,"mouseover",function(e){for(var n=e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new ur("mouseover",t,e))}),n.addEventListener(r,"touchstart",function(n){var r=new cr("touchstart",t,n);t.fire(r),r.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(n),t.touchZoomRotate.onStart(n),t.doubleClickZoom.onTouchStart(r))},{passive:!1}),n.addEventListener(r,"touchmove",function(e){t.fire(new cr("touchmove",t,e))},{passive:!1}),n.addEventListener(r,"touchend",function(e){t.fire(new cr("touchend",t,e))}),n.addEventListener(r,"touchcancel",function(e){t.fire(new cr("touchcancel",t,e))}),n.addEventListener(r,"click",function(i){var o=n.mousePos(r,i);(o.equals(a)||o.dist(a)<e.clickTolerance)&&t.fire(new ur("click",t,i))}),n.addEventListener(r,"dblclick",function(e){var n=new ur("dblclick",t,e);t.fire(n),n.defaultPrevented||t.doubleClickZoom.onDblClick(n)}),n.addEventListener(r,"contextmenu",function(e){var n=t.dragRotate.isActive();o||n?o&&(i=e):t.fire(new ur("contextmenu",t,e)),(t.dragRotate.isEnabled()||t.listens("contextmenu"))&&e.preventDefault()}),n.addEventListener(r,"wheel",function(n){e.interactive&&t.stop();var r=new lr("wheel",t,n);t.fire(r),r.defaultPrevented||t.scrollZoom.onWheel(n)},{passive:!1})}(this,e),this._hash=e.hash&&(new sr).addTo(this),this._hash&&this._hash._onHashChange()||(e.bounds?(this.resize(),this.fitBounds(e.bounds,{duration:0})):this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch})),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Sr({customAttribution:e.customAttribution})),this.addControl(new Pr,e.logoPosition),this.on("style.load",function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)}),this.on("data",function(e){i._update("style"===e.dataType),i.fire(new t.Event(e.dataType+"data",e))}),this.on("dataloading",function(e){i.fire(new t.Event(e.dataType+"dataloading",e))})}r&&(i.__proto__=r),i.prototype=Object.create(r&&r.prototype),i.prototype.constructor=i;var o={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(e,n){if(void 0===n&&e.getDefaultPosition&&(n=e.getDefaultPosition()),void 0===n&&(n="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},i.prototype.resize=function(e){var n=this._containerDimensions(),r=n[0],i=n[1];return this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},i.prototype.setMinZoom=function(t){if((t=null==t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype.on=function(t,e,n){var i,o=this;if(void 0===n)return r.prototype.on.call(this,t,e);var a=function(){if("mouseenter"===t||"mouseover"===t){var r=!1;return{layer:e,listener:n,delegates:{mousemove:function(i){var a=o.getLayer(e)?o.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?r||(r=!0,n.call(o,new ur(t,o,i.originalEvent,{features:a}))):r=!1},mouseout:function(){r=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){(o.getLayer(e)?o.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,n.call(o,new ur(t,o,r.originalEvent)))},mouseout:function(e){a&&(a=!1,n.call(o,new ur(t,o,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(i={},i[t]=function(t){var r=o.getLayer(e)?o.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(o,t),delete t.features)},i)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(a),a.delegates)o.on(s,a.delegates[s]);return this},i.prototype.off=function(t,e,n){if(void 0===n)return r.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var i=this._delegatedListeners[t],o=0;o<i.length;o++){var a=i[o];if(a.layer===e&&a.listener===n){for(var s in a.delegates)this.off(s,a.delegates[s]);return i.splice(o,1),this}}return this},i.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var r;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])r=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),o=t.Point.convert(e[1]);r=[i,new t.Point(o.x,i.y),o,new t.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,n){if((!n||!1!==n.diff&&!n.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Ie(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,n){return this.style.addSourceType(t,e,n)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,n,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var o=r.sdf;if(void 0===o&&(o=!1),n instanceof Ar){var a=t.browser.getImageData(n),s=a.width,u=a.height,c=a.data;this.style.addImage(e,{data:new t.RGBAImage({width:s,height:u},c),pixelRatio:i,sdf:o})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var l=n.width,f=n.height,h=n.data;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:f},new Uint8Array(h)),pixelRatio:i,sdf:o})}},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,n){t.getImage(this._transformRequest(e,t.ResourceType.Image),n)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0)},i.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,n){return this.style.setPaintProperty(t,e,n),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,n){return this.style.setLayoutProperty(t,e,n),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=n.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=n.create("div","mapboxgl-ctrl-"+t,i)})},i.prototype._resizeCanvas=function(e,n){var r=t.window.devicePixelRatio||1;this._canvas.width=r*e,this._canvas.height=r*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},e.webGLContextAttributes),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?this.painter=new er(r,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var n=this.transform.zoom,r=t.browser.now();this.style.zoomHistory.update(n,r);var i=new t.EvaluationParameters(n,{now:r,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=i.crossFadingFactor();1===o&&o===this._crossFadingFactor||(e=!0,this._crossFadingFactor=o),this.style.update(i)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this.triggerRepaint(),this},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Mr(this._canvasContainer),Mr(this._controlContainer),Mr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},i.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame(function(){e._frame=null,e._render()}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint=t,this._update()},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},Object.defineProperties(i.prototype,o),i}(Er);function Mr(t){t.parentNode&&t.parentNode.removeChild(t)}var Ir={showCompass:!0,showZoom:!0},Lr=function(e){var r=this;this.options=t.extend({},Ir,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(){return r._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(){return r._map.zoomOut()})),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(){return r._map.resetNorth()}),this._compassArrow=n.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function Rr(e,n,r){if(e=new t.LngLat(e.lng,e.lat),n){var i=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<a?e=i:r.locationPoint(o).distSqr(n)<a&&(e=o)}for(;Math.abs(e.lng-r.center.lng)>180;){var s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}Lr.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},Lr.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new dr(t,{button:"left",element:this._compass}),n.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},Lr.prototype.onRemove=function(){n.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),n.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},Lr.prototype._createButton=function(t,e,r){var i=n.create("button",t,this._container);return i.type="button",i.title=e,i.setAttribute("aria-label",e),i.addEventListener("click",r),i};var jr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zr(t,e,n){var r=t.classList;for(var i in jr)r.remove("mapboxgl-"+n+"-anchor-"+i);r.add("mapboxgl-"+n+"-anchor-"+e)}var Dr,Fr=function(e){function r(r){if(e.call(this),(arguments[0]instanceof t.window.HTMLElement||2===arguments.length)&&(r=t.extend({element:r},arguments[1])),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._draggable=r&&r.draggable||!1,this._state="inactive",r&&r.element)this._element=r.element,this._offset=t.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div");var i=n.createNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"height","41px"),i.setAttributeNS(null,"width","27px"),i.setAttributeNS(null,"viewBox","0 0 27 41");var o=n.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");var a=n.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");for(var u=0,c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];u<c.length;u+=1){var l=c[u],f=n.createNS("http://www.w3.org/2000/svg","ellipse");f.setAttributeNS(null,"opacity","0.04"),f.setAttributeNS(null,"cx","10.5"),f.setAttributeNS(null,"cy","5.80029008"),f.setAttributeNS(null,"rx",l.rx),f.setAttributeNS(null,"ry",l.ry),s.appendChild(f)}var h=n.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);var p=n.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(p);var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");var v=n.createNS("http://www.w3.org/2000/svg","path");v.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(v);var g=n.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(6.0, 7.0)"),g.setAttributeNS(null,"fill","#FFFFFF");var m=n.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");var y=n.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#000000"),y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962");var _=n.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),m.appendChild(y),m.appendChild(_),a.appendChild(s),a.appendChild(h),a.appendChild(d),a.appendChild(g),a.appendChild(m),i.appendChild(a),this._element.appendChild(i),this._offset=t.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},r.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},r.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=Rr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,jr[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),zr(this._element,this._anchor,"marker"))},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},r.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r}(t.Evented),Nr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},Br=function(e){function r(n){e.call(this),this.options=t.extend({},Nr,n),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Dr?r(Dr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(function(t){Dr="denied"!==t.state,r(Dr)}):(Dr=!!t.window.navigator.geolocation,r(Dr)),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),n.remove(this._container),this._map=void 0},r.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},r.prototype._updateCamera=function(e){var n=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy;this._map.fitBounds(n.toBounds(r),this.options.fitBoundsOptions,{geolocateSource:!0})},r.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},r.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;!1!==e?(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Fr(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(e){e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))})):t.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),Ur={maxWidth:100,unit:"metric"},Vr=function(e){this.options=t.extend({},Ur,e),t.bindAll(["_onMove","setUnit"],this)};function Gr(t,e,n){var r,i,o,a,s,u,c=n&&n.maxWidth||100,l=t._container.clientHeight/2,f=(r=t.unproject([0,l]),i=t.unproject([c,l]),o=Math.PI/180,a=r.lat*o,s=i.lat*o,u=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((i.lng-r.lng)*o),6371e3*Math.acos(Math.min(u,1)));if(n&&"imperial"===n.unit){var h=3.2808*f;h>5280?qr(e,c,h/5280,"mi"):qr(e,c,h,"ft")}else n&&"nautical"===n.unit?qr(e,c,f/1852,"nm"):qr(e,c,f,"m")}function qr(t,e,n,r){var i,o,a,s=(i=n,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(a))),u=s/n;"m"===r&&s>=1e3&&(s/=1e3,r="km"),t.style.width=e*u+"px",t.innerHTML=s+r}Vr.prototype.getDefaultPosition=function(){return"bottom-left"},Vr.prototype._onMove=function(){Gr(this._map,this._container,this.options)},Vr.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vr.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vr.prototype.setUnit=function(t){this.options.unit=t,Gr(this._map,this._container,this.options)};var Wr=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Wr.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=n.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},Wr.prototype.onRemove=function(){n.remove(this._container),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Wr.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},Wr.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Wr.prototype._isFullscreen=function(){return this._fullscreen},Wr.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Wr.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var Zr={closeButton:!0,closeOnClick:!0,className:""},Xr=function(e){function r(n){e.call(this),this.options=t.extend(Object.create(Zr),n),t.bindAll(["_update","_onClickClose"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._update(),this},r.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},r.prototype.setHTML=function(e){var n,r=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;n=i.firstChild;)r.appendChild(n);return this.setDOMContent(r)},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},r.prototype._update=function(){var e=this;if(this._map&&this._lngLat&&this._content){this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)})),this._map.transform.renderWorldCopies&&(this._lngLat=Rr(this._lngLat,this._pos,this._map.transform));var r=this._pos=this._map.project(this._lngLat),i=this.options.anchor,o=function e(n){if(n){if("number"==typeof n){var r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-n),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var i=t.Point.convert(n);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!i){var a,s=this._container.offsetWidth,u=this._container.offsetHeight;a=r.y+o.bottom.y<u?["top"]:r.y>this._map.transform.height-u?["bottom"]:[],r.x<s/2?a.push("left"):r.x>this._map.transform.width-s/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}var c=r.add(o[i]).round();n.setTransform(this._container,jr[i]+" translate("+c.x+"px,"+c.y+"px)"),zr(this._container,i,"popup")}},r.prototype._onClickClose=function(){this.remove()},r}(t.Evented),Hr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,Map:Or,NavigationControl:Lr,GeolocateControl:Br,AttributionControl:Sr,ScaleControl:Vr,FullscreenControl:Wr,Popup:Xr,Marker:Fr,Style:Ie,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get workerCount(){return Mt.workerCount},set workerCount(t){Mt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},workerUrl:""};return Hr}),n}()},function(t,e,n){"use strict";var r=n(62),i=n(125),o=n(114),a=(e.a={name:"lighting",dependencies:[r.a],vs:"#define MAX_NUM_OF_LIGHTS 5\n\n// TODO these should be using lighting_ prefix\nuniform vec3 lighting_lightPositions[MAX_NUM_OF_LIGHTS];\nuniform vec2 lighting_lightStrengths[MAX_NUM_OF_LIGHTS];\nuniform float lighting_ambientRatio;\nuniform float lighting_diffuseRatio;\nuniform float lighting_specularRatio;\nuniform int lighting_numberOfLights;\n\nfloat lighting_getLightWeight(vec3 position_worldspace_vec3, vec3 normals_worldspace) {\n  float lightWeight = 0.0;\n\n  vec3 normals_worldspace_vec3 = normals_worldspace.xyz;\n\n  vec3 camera_pos_worldspace = project_uCameraPosition;\n  vec3 view_direction = normalize(camera_pos_worldspace - position_worldspace_vec3);\n\n  for (int i = 0; i < MAX_NUM_OF_LIGHTS; i++) {\n    if (i >= lighting_numberOfLights) {\n      break;\n    }\n    vec3 light_position_worldspace = lighting_lightPositions[i];\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace_vec3);\n\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normals_worldspace_vec3);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normals_worldspace_vec3, halfway_direction), 0.0);\n      specular = pow(specular_angle, 32.0);\n    }\n    lambertian = max(lambertian, 0.0);\n    lightWeight += (lighting_ambientRatio + lambertian * lighting_diffuseRatio + specular * lighting_specularRatio) *\n      lighting_lightStrengths[i].x;\n  }\n\n  return lightWeight;\n}\n\n// DEPRECATED - Backwards compatibility\n\nfloat getLightWeight(vec3 position_worldspace_vec3, vec3 normals_worldspace) {\n  return lighting_getLightWeight(position_worldspace_vec3, normals_worldspace);\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if(!t.lightSettings)return{};var e=t.coordinateSystem,n=t.coordinateOrigin,r=t.lightSettings,i=r.numberOfLights,o=void 0===i?1:i,p=r.lightsPosition,d=void 0===p?s:p,v=r.lightsStrength,g=void 0===v?u:v,m=r.coordinateSystem,y=r.coordinateOrigin,_=r.modelMatrix,b=void 0===_?null:_,x=r.ambientRatio,w=void 0===x?c:x,E=r.diffuseRatio,S=void 0===E?l:E,P=r.specularRatio,T=void 0===P?f:P;return{lighting_lightPositions:h({lightsPosition:d,numberOfLights:o,viewport:t.viewport,modelMatrix:b,coordinateSystem:e,coordinateOrigin:n,fromCoordinateSystem:m,fromCoordinateOrigin:y}),lighting_lightStrengths:g,lighting_ambientRatio:w,lighting_diffuseRatio:S,lighting_specularRatio:T,lighting_numberOfLights:o}},deprecations:[{type:"function",old:"getLightWeight",new:"lighting_getLightWeight",deprecated:!0}]},{}),s=[-122.45,37.75,8e3],u=[2,0],c=.4,l=.6,f=.8,h=Object(o.a)(function(t){for(var e=t.lightsPosition,n=t.numberOfLights,r=t.viewport,o=t.modelMatrix,a=t.coordinateSystem,s=t.coordinateOrigin,u=t.fromCoordinateSystem,c=t.fromCoordinateOrigin,l={viewport:r,modelMatrix:o,coordinateSystem:a,coordinateOrigin:s,fromCoordinateSystem:u,fromCoordinateOrigin:c},f=[],h=0;h<n;h++){var p=Object(i.b)(e.slice(3*h,3*h+3),l);f[3*h]=p[0],f[3*h+1]=p[1],f[3*h+2]=p[2]}return f})},function(t,e,n){"use strict";var r=n(11),i=n(62),o=n(114),a=r.t.fp64ify,s=r.t.fp64ifyMatrix4,u=(e.a={name:"project64",dependencies:[i.a,r.t],vs:"\nconst vec2 WORLD_SCALE_FP64 = vec2(81.4873275756836, 0.0000032873668232014097);\n\nuniform vec2 project64_uScale;\nuniform vec2 project_uViewProjectionMatrixFP64[16];\n\n// longitude: lnglat_fp64.xy; latitude: lnglat_fp64.zw\nvoid mercatorProject_fp64(vec4 lnglat_fp64, out vec2 out_val[2]) {\n\n#if defined(NVIDIA_FP64_WORKAROUND)\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64 * ONE);\n#else\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64);\n#endif\n  out_val[1] = sub_fp64(PI_FP64,\n    log_fp64(tan_fp64(sum_fp64(PI_4_FP64, radians_fp64(lnglat_fp64.zw) / 2.0))));\n  return;\n}\n\nvoid project_position_fp64(vec4 position_fp64, out vec2 out_val[2]) {\n  vec2 pos_fp64[2];\n  mercatorProject_fp64(position_fp64, pos_fp64);\n  vec2 x_fp64 = mul_fp64(pos_fp64[0], project64_uScale);\n  vec2 y_fp64 = mul_fp64(pos_fp64[1], project64_uScale);\n  out_val[0] = mul_fp64(x_fp64, WORLD_SCALE_FP64);\n  out_val[1] = mul_fp64(y_fp64, WORLD_SCALE_FP64);\n\n  return;\n}\n\nvoid project_position_fp64(vec2 position, vec2 position64xyLow, out vec2 out_val[2]) {\n  vec4 position64xy = vec4(\n    position.x, position64xyLow.x,\n    position.y, position64xyLow.y);\n\n  project_position_fp64(position64xy, out_val);\n}\n\nvec4 project_to_clipspace_fp64(vec2 vertex_pos_modelspace[4]) {\n  vec2 vertex_pos_clipspace[4];\n  mat4_vec4_mul_fp64(project_uViewProjectionMatrixFP64, vertex_pos_modelspace,\n    vertex_pos_clipspace);\n  return vec4(\n    vertex_pos_clipspace[0].x,\n    vertex_pos_clipspace[1].x,\n    vertex_pos_clipspace[2].x,\n    vertex_pos_clipspace[3].x\n    );\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset, out vec4 worldPosition\n) {\n  // This is the local offset to the instance position\n  vec2 offset64[4];\n  vec4_fp64(vec4(offset, 0.0), offset64);\n\n  float z = project_scale(position.z);\n\n  // Apply web mercator projection (depends on coordinate system imn use)\n  vec2 projectedPosition64xy[2];\n  project_position_fp64(position.xy, position64xyLow, projectedPosition64xy);\n\n  vec2 worldPosition64[4];\n  worldPosition64[0] = sum_fp64(offset64[0], projectedPosition64xy[0]);\n  worldPosition64[1] = sum_fp64(offset64[1], projectedPosition64xy[1]);\n  worldPosition64[2] = sum_fp64(offset64[2], vec2(z, 0.0));\n  worldPosition64[3] = vec2(1.0, 0.0);\n\n  worldPosition = vec4(projectedPosition64xy[0].x, projectedPosition64xy[1].x, z, 1.0);\n\n  return project_to_clipspace_fp64(worldPosition64);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset\n) {\n  vec4 worldPosition;\n  return project_position_to_clipspace(\n    position, position64xyLow, offset, worldPosition\n  );\n}\n",getUniforms:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.project_uViewProjectionMatrix,n=t.project_uScale;if(e&&n)return u({project_uViewProjectionMatrix:e,project_uScale:n});return{}},deprecations:[{type:"uniform vec2",old:"projectionFP64[16]",new:"project_uViewProjectionMatrixFP64"},{type:"uniform vec2",old:"projectionScaleFP64",new:"project64_uScale"}]},Object(o.a)(function(t){var e=t.project_uViewProjectionMatrix,n=t.project_uScale,r=s(e),i=a(n);return{project_uViewProjectionMatrixFP64:r,project64_uViewProjectionMatrix:r,project64_uScale:i}}))},function(t,e,n){"use strict";n.d(e,"a",function(){return h}),n.d(e,"b",function(){return p});var r=n(21),i=n(147),o=n(56),a=n.n(o),s=n(260),u=n.n(s),c=n(178);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=l(t,3),i=r[0],o=r[1],a=r[2],s=void 0===a?0:a,u=l(e.projectFlat(t),2);return[u[0],u[1],s*(n?Object(c.b)({longitude:i,latitude:o,scale:e.scale}):e.getDistanceScales()).pixelsPerMeter[2]]}function h(t,e){var n=e.viewport,i=e.modelMatrix,o=e.coordinateSystem,s=e.coordinateOrigin,u=e.offsetMode,h=l(t,3),p=h[0],d=h[1],v=h[2];if(i){var g=l(a()([],[p,d,v,1],i),3);p=g[0],d=g[1],v=g[2]}switch(o){case r.a.LNGLAT:case r.a.LNGLAT_DEPRECATED:return f([p,d,v],n,u);case r.a.LNGLAT_OFFSETS:return f([p+s[0],d+s[1],v+(s[2]||0)],n,u);case r.a.METER_OFFSETS:return f(Object(c.a)(s,[p,d,v]),n,u);case r.a.IDENTITY:default:return[p,d,v]}}function p(t,e){var n=function(t){var e=Object.assign({},t),n=t.viewport,o=t.coordinateSystem,a=t.coordinateOrigin,s=t.fromCoordinateSystem,u=t.fromCoordinateOrigin;return void 0===s&&(e.fromCoordinateSystem=o),void 0===u&&(e.fromCoordinateOrigin=a),o===r.a.LNGLAT&&n.zoom>=i.a&&(e.coordinateSystem=r.a.LNGLAT_OFFSETS,e.coordinateOrigin=[Math.fround(n.longitude),Math.fround(n.latitude)]),e}(e),o=n.viewport,a=n.coordinateSystem,s=n.coordinateOrigin,c=n.modelMatrix,l=n.fromCoordinateSystem,p=n.fromCoordinateOrigin;switch(a){case r.a.LNGLAT_OFFSETS:case r.a.METER_OFFSETS:var d=h(t,{viewport:o,modelMatrix:c,coordinateSystem:l,coordinateOrigin:p,offsetMode:!0}),v=f(s,o,!0);return u()(d,d,v),d;case r.a.LNGLAT:case r.a.LNGLAT_DEPRECATED:case r.a.IDENTITY:default:return h(t,{viewport:o,modelMatrix:c,coordinateSystem:l,coordinateOrigin:p,offsetMode:!1})}}},,function(t,e,n){var r=n(64),i=n(20),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(84)?"pure":"global",copyright:" 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(58),i=n(36),o=n(97);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),l=o(a,c);if(t&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(66);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(24),i=n(66),o=n(26)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(26)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(19);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(51),i=n(52),o=n(23),a=n(72),s=n(26);t.exports=function(t,e,n){var u=s(t),c=n(a,u,""[t]),l=c[0],f=c[1];o(function(){var e={};return e[u]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,l),r(RegExp.prototype,u,2==e?function(t,e){return f.call(t,this,e)}:function(t){return f.call(t,this)}))}},function(t,e,n){var r=n(19),i=n(46),o=n(26)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||void 0==(n=r(a)[o])?e:i(n)}},function(t,e,n){var r=n(20).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";var r=n(20),i=n(7),o=n(52),a=n(103),s=n(83),u=n(102),c=n(101),l=n(24),f=n(23),h=n(132),p=n(106),d=n(159);t.exports=function(t,e,n,v,g,m){var y=r[t],_=y,b=g?"set":"add",x=_&&_.prototype,w={},E=function(t){var e=x[t];o(x,t,"delete"==t?function(t){return!(m&&!l(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!l(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(m||x.forEach&&!f(function(){(new _).entries().next()}))){var S=new _,P=S[b](m?{}:-0,1)!=S,T=f(function(){S.has(1)}),A=h(function(t){new _(t)}),k=!m&&f(function(){for(var t=new _,e=5;e--;)t[b](e,e);return!t.has(-0)});A||((_=e(function(e,n){c(e,_,t);var r=d(new y,e,_);return void 0!=n&&u(n,g,r[b],r),r})).prototype=x,x.constructor=_),(T||k)&&(E("delete"),E("has"),g&&E("get")),(k||P)&&E(b),m&&x.clear&&delete x.clear}else _=v.getConstructor(e,t,g,b),a(_.prototype,n),s.NEED=!0;return p(_,t),w[t]=_,i(i.G+i.W+i.F*(_!=y),w),m||v.setStrong(_,t,g),_}},function(t,e,n){for(var r,i=n(20),o=n(51),a=n(95),s=a("typed_array"),u=a("view"),c=!(!i.ArrayBuffer||!i.DataView),l=c,f=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=i[h[f++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):l=!1;t.exports={ABV:c,CONSTR:l,TYPED:s,VIEW:u}},function(t,e,n){"use strict";t.exports=n(84)||!n(23)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(20)[t]})},function(t,e,n){"use strict";var r=n(7);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var r=n(7),i=n(46),o=n(65),a=n(102);t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,s,u=arguments[1];return i(this),(e=void 0!==u)&&i(u),void 0==t?new this:(n=[],e?(r=0,s=o(u,arguments[2],2),a(t,!1,function(t){n.push(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r=n(1),i=n(9),o=n(8),a=n(2),s=n(10),u=n(3),c=n(12),l=n(27),f=n(54),h=n(25),p=function(t){function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),Object(c.d)(t),(n=Object(i.a)(this,Object(o.a)(e).call(this,t,Object.assign({},a,{target:a.target||32879})))).width=null,n.height=null,n.depth=null,Object.seal(Object(u.a)(Object(u.a)(n))),n.setImageData(a),a.generateMipmap&&n.generateMipmap(),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"isSupported",value:function(t){return Object(c.n)(t)}}]),Object(a.a)(e,[{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.opts=Object.assign({},this.opts,e);var n=this.opts,r=n.pixels,i=n.settings;i&&(Object(l.c)(i,function(){r&&t.setImage3D(t.opts)}),this.setParameters(e))}},{key:"setImage3D",value:function(t){var e=t.level,n=void 0===e?0:e,r=t.internalformat,i=void 0===r?6408:r,o=t.width,a=t.height,s=t.depth,u=void 0===s?1:s,c=t.border,l=void 0===c?0:c,f=t.format,p=t.type,d=void 0===p?5121:p,v=t.offset,g=void 0===v?0:v,m=t.pixels;ArrayBuffer.isView(m)?this.gl.texImage3D(this.target,n,i,o,a,u,l,f,d,m):m instanceof h.a&&(this.gl.bindBuffer(35052,m.handle),this.gl.texImage3D(this.target,n,i,o,a,u,l,f,d,g),this.gl.bindBuffer(35052,m.handle))}}]),e}(f.a)},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var r=n(29),i=n(144);function o(){return!("object"===(void 0===t?"undefined":Object(r.a)(t))&&"[object process]"===String(t)&&!t.browser)||Object(i.a)()}}).call(this,n(68))},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return i});var r=n(29);function i(e){if("undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type)return!0;if(void 0!==t&&"object"===Object(r.a)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,i=e||n;return!!(i&&i.indexOf("Electron")>=0)}}).call(this,n(68))},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(104);var c=function(t){function e(){return Object(r.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:"set",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toString",value:function(){return this.formatString(u.c)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(u.f)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(u.e)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"inverse",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"validate",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=t&&t.length===this.ELEMENTS,n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(t[n]);return e}},{key:"check",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;if(u.c.debug&&!this.validate(t))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){return this.scale(t)}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}}]),e}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array))},function(t,e,n){"use strict";n.d(e,"a",function(){return m}),n.d(e,"b",function(){return _});var r=n(33),i=n.n(r),o=n(56),a=n.n(o),s=n(21),u=n(114),c=n(17),l=n(16),f=n(40),h=[0,0,0,0],p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],v=[0,0,0],g=[0,0,0],m=12,y=Object(u.a)(function(t){var e=t.viewport,n=t.devicePixelRatio,r=t.coordinateSystem,o=t.coordinateOrigin,u=t.wrapLongitude,c=e.zoom;Object(l.a)(c>=0);var d=function(t){var e,n=t.viewport,r=t.coordinateSystem,o=t.coordinateOrigin,u=t.coordinateZoom,c=n.viewMatrixUncentered,l=n.viewMatrix,d=n.projectionMatrix,v=n.viewProjectionMatrix,g=function(t){switch(t){case s.a.LNGLAT:case s.a.LNGLAT_EXPERIMENTAL:default:return f.a.LNGLAT_AUTO_OFFSET;case s.a.LNGLAT_DEPRECATED:return f.a.LNG_LAT;case s.a.METER_OFFSETS:case s.a.METERS:return f.a.METER_OFFSETS;case s.a.LNGLAT_OFFSETS:return f.a.LNGLAT_OFFSETS;case s.a.IDENTITY:return f.a.IDENTITY}}(r),y=o;if(g===f.a.LNGLAT_AUTO_OFFSET)if(u<m)g=f.a.LNG_LAT;else{var _=Math.fround(n.longitude),b=Math.fround(n.latitude);y=[_,b]}switch(g){case f.a.IDENTITY:case f.a.LNG_LAT:e=h;break;case f.a.LNGLAT_OFFSETS:case f.a.METER_OFFSETS:case f.a.LNGLAT_AUTO_OFFSET:var x=n.projectFlat(y,Math.pow(2,u));e=a()([],[x[0],x[1],0,1],v),l=c||l,v=i()([],d,l),v=i()([],v,p);break;default:throw new Error("Unknown projection mode")}return{viewMatrix:l,viewProjectionMatrix:v,projectionCenter:e,cameraPos:n.cameraPosition,shaderCoordinateSystem:g,shaderCoordinateOrigin:y}}({coordinateSystem:r,coordinateOrigin:o,coordinateZoom:c,viewport:e}),g=d.projectionCenter,y=d.viewProjectionMatrix,_=d.cameraPos,b=d.shaderCoordinateSystem,x=d.shaderCoordinateOrigin;Object(l.a)(y,"Viewport missing modelViewProjectionMatrix");var w=e.getDistanceScales(),E=[e.width*n,e.height*n],S={project_uCoordinateSystem:b,project_uCenter:g,project_uWrapLongitude:u,project_uAntimeridian:(e.longitude||0)-180,project_uViewportSize:E,project_uDevicePixelRatio:n,project_uFocalDistance:e.focalDistance||1,project_uPixelsPerMeter:w.pixelsPerMeter,project_uPixelsPerDegree:w.pixelsPerDegree,project_uPixelsPerUnit:w.pixelsPerMeter,project_uPixelsPerUnit2:v,project_uScale:e.scale,project_uViewProjectionMatrix:y,project_uCameraPosition:_},P=e.getDistanceScales(x);switch(b){case f.a.METER_OFFSETS:S.project_uPixelsPerUnit=P.pixelsPerMeter,S.project_uPixelsPerUnit2=P.pixelsPerMeter2;break;case f.a.LNGLAT_AUTO_OFFSET:S.project_coordinate_origin=x;case f.a.LNGLAT_OFFSETS:S.project_uPixelsPerUnit=P.pixelsPerDegree,S.project_uPixelsPerUnit2=P.pixelsPerDegree2}return S});function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.viewport,n=t.devicePixelRatio,r=void 0===n?1:n,i=t.modelMatrix,o=void 0===i?null:i,a=t.coordinateSystem,u=void 0===a?s.a.LNGLAT:a,f=t.coordinateOrigin,h=void 0===f?g:f,p=t.wrapLongitude,v=void 0!==p&&p,m=t.projectionMode,_=t.positionOrigin;return Object(l.a)(e),void 0!==m&&c.a.removed("projectionMode","coordinateSystem")(),void 0!==_&&c.a.removed("positionOrigin","coordinateOrigin")(),Object.assign({project_uModelMatrix:o||d},y({viewport:e,devicePixelRatio:r,coordinateSystem:u,coordinateOrigin:h,wrapLongitude:v}))}},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t}},function(t,e,n){"use strict";n.r(e);var r=n(111),i=n(30),o=n(44);n(220);n.d(e,"global",function(){return i.a});var a="6.2.0-beta.4";if(i.a.luma&&i.a.luma.VERSION!==a)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(i.a.luma.VERSION," vs ").concat(a));i.a.luma||(r.a&&o.a.log(0,"luma.gl ".concat(a," - ").concat("set luma.log.priority=1 (or higher) to trace rendering"))(),i.a.luma=i.a.luma||{VERSION:a,version:a,log:o.a,stats:{},globals:{modules:{},nodeIO:{}}});e.default=i.a.luma},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i,o,a,s){if(!t){var u;if(void 0===e)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,o,a,s],l=0;(u=new Error(e.replace(/%s/g,function(){return c[l++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return p});var r=n(1),i=n(2),o=n(0),a=n(4),s=n.n(a),u=n(79);function c(){}var l={container:s.a.object,gl:s.a.object,mapboxApiAccessToken:s.a.string,attributionControl:s.a.bool,preserveDrawingBuffer:s.a.bool,reuseMaps:s.a.bool,transformRequest:s.a.func,mapOptions:s.a.object,mapStyle:s.a.oneOfType([s.a.string,s.a.object]),visible:s.a.bool,onLoad:s.a.func,onError:s.a.func,width:s.a.number,height:s.a.number,viewState:s.a.object,longitude:s.a.number,latitude:s.a.number,zoom:s.a.number,bearing:s.a.number,pitch:s.a.number,altitude:s.a.number},f={container:u.a.body,mapboxApiAccessToken:function(){var e=null;if("undefined"!=typeof window&&window.location){var n=window.location.search.match(/access_token=([^&\/]*)/);e=n&&n[1]}e||void 0===t||(e=e||t.env.MapboxAccessToken||t.env.REACT_APP_MAPBOX_ACCESS_TOKEN);return e||"no-token"}(),preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,onLoad:c,onError:c,width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0};function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&s.a.checkPropTypes(l,t,"prop",e)}var p=function(){function t(e){if(Object(r.a)(this,t),Object(o.a)(this,"mapboxgl",void 0),Object(o.a)(this,"props",f),Object(o.a)(this,"_map",null),Object(o.a)(this,"width",0),Object(o.a)(this,"height",0),!e.mapboxgl)throw new Error("Mapbox not available");if(this.mapboxgl=e.mapboxgl,!t.initialized&&console.debug){t.initialized=!0;console.debug("react-map-gl: ".concat("4.0.0"," using mapbox-gl v").concat(this.mapboxgl.version)),this._checkStyleSheet(this.mapboxgl.version)}this._initialize(e)}return Object(i.a)(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"resize",value:function(){return this._map.resize(),this._map.isStyleLoaded()&&this._map._render(),this}},{key:"getMap",value:function(){return this._map}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(e.mapStyle),e.onLoad()}else{if(e.gl){var i=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=i,e.gl}}var o={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,style:e.mapStyle,interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(o.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},o,e.mapOptions)),this._map.once("load",e.onLoad),this._map.on("error",e.onError)}return this}},{key:"_destroy",value:function(){this._map&&(t.savedMap?this._map.remove():t.savedMap=this._map,this._map=null)}},{key:"_initialize",value:function(t){var e=this;h(t=Object.assign({},f,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||f.mapboxApiAccessToken,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){this._map&&(h(e=Object.assign({},this.props,e),"Mapbox"),this._updateMapViewport(t,e),this._updateMapSize(t,e),this.props=e)}},{key:"_updateMapSize",value:function(t,e){(t.width!==e.width||t.height!==e.height)&&(this.width=e.width,this.height=e.height,this.resize())}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e);(r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude)&&(this._map.jumpTo(this._getMapboxViewStateProps(e)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude))}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,o=e.pitch,a=e.bearing,s=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:o,bearing:a,altitude:void 0===s?1.5:s}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if(void 0!==u.a)try{var e=u.a.createElement("div");if(e.className="mapboxgl-map",e.style.display="none",u.a.body.append(e),!("static"!==window.getComputedStyle(e).position)){var n=u.a.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),u.a.head.append(n)}}catch(t){}}},{key:"_getMapboxViewStateProps",value:function(t){var e=this._getViewState(t);return{center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}}}]),t}();Object(o.a)(p,"initialized",!1),Object(o.a)(p,"propTypes",l),Object(o.a)(p,"defaultProps",f),Object(o.a)(p,"savedMap",null)}).call(this,n(68))},function(t,e,n){var r=n(24),i=n(20).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(20),i=n(64),o=n(84),a=n(186),s=n(35).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var r=n(127)("keys"),i=n(95);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(20).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(24),i=n(19),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(65)(Function.call,n(59).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(t,e,n){var r=n(24),i=n(157).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";var r=n(73),i=n(72);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){var r=n(73),i=n(72);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(84),i=n(7),o=n(52),a=n(51),s=n(108),u=n(165),c=n(106),l=n(60),f=n(26)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,d,v,g,m){u(n,e,d);var y,_,b,x=function(t){if(!h&&t in P)return P[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},w=e+" Iterator",E="values"==v,S=!1,P=t.prototype,T=P[f]||P["@@iterator"]||v&&P[v],A=T||x(v),k=v?E?x("entries"):A:void 0,C="Array"==e&&P.entries||T;if(C&&(b=l(C.call(new t)))!==Object.prototype&&b.next&&(c(b,w,!0),r||"function"==typeof b[f]||a(b,f,p)),E&&T&&"values"!==T.name&&(S=!0,A=function(){return T.call(this)}),r&&!m||!h&&!S&&P[f]||a(P,f,A),s[e]=A,s[w]=p,v)if(y={values:E?A:x("values"),keys:g?A:x("keys"),entries:k},m)for(_ in y)_ in P||o(P,_,y[_]);else i(i.P+i.F*(h||S),e,y);return y}},function(t,e,n){"use strict";var r=n(98),i=n(94),o=n(106),a={};n(51)(a,n(26)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(131),i=n(72);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(26)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(108),i=n(26)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(35),i=n(94);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(121),i=n(26)("iterator"),o=n(108);t.exports=n(64).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(364);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){"use strict";var r=n(42),i=n(97),o=n(36);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(85),i=n(202),o=n(108),a=n(58);t.exports=n(164)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){var r,i,o,a=n(65),s=n(192),u=n(156),c=n(152),l=n(20),f=l.process,h=l.setImmediate,p=l.clearImmediate,d=l.MessageChannel,v=l.Dispatch,g=0,m={},y=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},_=function(t){y.call(t.data)};h&&p||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++g]=function(){s("function"==typeof t?t:Function(t),e)},r(g),g},p=function(t){delete m[t]},"process"==n(66)(f)?r=function(t){f.nextTick(a(y,t,1))}:v&&v.now?r=function(t){v.now(a(y,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=_,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",_,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:h,clear:p}},function(t,e,n){var r=n(20),i=n(174).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(66)(a);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var f=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=f=!f}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";var r=n(46);t.exports.f=function(t){return new function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}(t)}},function(t,e,n){"use strict";var r=n(20),i=n(34),o=n(84),a=n(138),s=n(51),u=n(103),c=n(23),l=n(101),f=n(73),h=n(36),p=n(211),d=n(99).f,v=n(35).f,g=n(172),m=n(106),y="prototype",_="Wrong index!",b=r.ArrayBuffer,x=r.DataView,w=r.Math,E=r.RangeError,S=r.Infinity,P=b,T=w.abs,A=w.pow,k=w.floor,C=w.log,O=w.LN2,M=i?"_b":"buffer",I=i?"_l":"byteLength",L=i?"_o":"byteOffset";function R(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,c=u>>1,l=23===e?A(2,-24)-A(2,-77):0,f=0,h=t<0||0===t&&1/t<0?1:0;for((t=T(t))!=t||t===S?(i=t!=t?1:0,r=u):(r=k(C(t)/O),t*(o=A(2,-r))<1&&(r--,o*=2),(t+=r+c>=1?l/o:l*A(2,1-c))*o>=2&&(r++,o/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(t*o-1)*A(2,e),r+=c):(i=t*A(2,c-1)*A(2,e),r=0));e>=8;a[f++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[f++]=255&r,r/=256,s-=8);return a[--f]|=128*h,a}function j(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=t[u--],l=127&c;for(c>>=7;s>0;l=256*l+t[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-S:S;r+=A(2,e),l-=a}return(c?-1:1)*r*A(2,l-e)}function z(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function D(t){return[255&t]}function F(t){return[255&t,t>>8&255]}function N(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function B(t){return R(t,52,8)}function U(t){return R(t,23,4)}function V(t,e,n){v(t[y],e,{get:function(){return this[n]}})}function G(t,e,n,r){var i=p(+n);if(i+e>t[I])throw E(_);var o=t[M]._b,a=i+t[L],s=o.slice(a,a+e);return r?s:s.reverse()}function q(t,e,n,r,i,o){var a=p(+n);if(a+e>t[I])throw E(_);for(var s=t[M]._b,u=a+t[L],c=r(+i),l=0;l<e;l++)s[u+l]=c[o?l:e-l-1]}if(a.ABV){if(!c(function(){b(1)})||!c(function(){new b(-1)})||c(function(){return new b,new b(1.5),new b(NaN),"ArrayBuffer"!=b.name})){for(var W,Z=(b=function(t){return l(this,b),new P(p(t))})[y]=P[y],X=d(P),H=0;X.length>H;)(W=X[H++])in b||s(b,W,P[W]);o||(Z.constructor=b)}var Y=new x(new b(2)),K=x[y].setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||u(x[y],{setInt8:function(t,e){K.call(this,t,e<<24>>24)},setUint8:function(t,e){K.call(this,t,e<<24>>24)}},!0)}else b=function(t){l(this,b,"ArrayBuffer");var e=p(t);this._b=g.call(new Array(e),0),this[I]=e},x=function(t,e,n){l(this,x,"DataView"),l(t,b,"DataView");var r=t[I],i=f(e);if(i<0||i>r)throw E("Wrong offset!");if(i+(n=void 0===n?r-i:h(n))>r)throw E("Wrong length!");this[M]=t,this[L]=i,this[I]=n},i&&(V(b,"byteLength","_l"),V(x,"buffer","_b"),V(x,"byteLength","_l"),V(x,"byteOffset","_o")),u(x[y],{getInt8:function(t){return G(this,1,t)[0]<<24>>24},getUint8:function(t){return G(this,1,t)[0]},getInt16:function(t){var e=G(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=G(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return z(G(this,4,t,arguments[1]))},getUint32:function(t){return z(G(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return j(G(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return j(G(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){q(this,1,t,D,e)},setUint8:function(t,e){q(this,1,t,D,e)},setInt16:function(t,e){q(this,2,t,F,e,arguments[2])},setUint16:function(t,e){q(this,2,t,F,e,arguments[2])},setInt32:function(t,e){q(this,4,t,N,e,arguments[2])},setUint32:function(t,e){q(this,4,t,N,e,arguments[2])},setFloat32:function(t,e){q(this,4,t,U,e,arguments[2])},setFloat64:function(t,e){q(this,8,t,B,e,arguments[2])}});m(b,"ArrayBuffer"),m(x,"DataView"),s(x[y],a.VIEW,!0),e.ArrayBuffer=b,e.DataView=x},function(t,e,n){"use strict";n.d(e,"l",function(){return T}),n.d(e,"i",function(){return A}),n.d(e,"g",function(){return k}),n.d(e,"j",function(){return C}),n.d(e,"c",function(){return O}),n.d(e,"b",function(){return M}),n.d(e,"a",function(){return I}),n.d(e,"f",function(){return L}),n.d(e,"e",function(){return R}),n.d(e,"d",function(){return j}),n.d(e,"k",function(){return z}),n.d(e,"h",function(){return D});var r=n(18),i=n(221),o=n(45),a=n(76),s=n.n(a),u=n(49),c=n.n(u),l=n(55),f=n.n(l),h=n(89),p=n.n(h),d=n(90),v=n.n(d),g=n(261),m=n.n(g),y=n(93),_=Math.PI,b=_/4,x=_/180,w=180/_,E=512,S=4003e4,P=1.5;function T(t){return Math.pow(2,t)}function A(t){return Math.log2(t)}function k(t,e){var n=Object(r.a)(t,2),i=n[0],o=n[1]*x;return[(e*=E)*(i*x+_)/(2*_),e*(_-Math.log(Math.tan(b+.5*o)))/(2*_)]}function C(t,e){var n=Object(r.a)(t,2),i=n[0],o=n[1],a=i/(e*=E)*(2*_)-_,s=2*(Math.atan(Math.exp(_-o/e*(2*_)))-b);return[a*w,s*w]}function O(t){var e=t.latitude;Object(y.a)(Number.isFinite(e));var n=Math.cos(e*x);return A(S*n)-9}function M(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:T(r),Object(y.a)(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=E*i,c=Math.cos(e*x),l=u/360,f=l/c,h=u/S/c;if(s.pixelsPerMeter=[h,-h,h],s.metersPerPixel=[1/h,-1/h,1/h],s.pixelsPerDegree=[l,-f,h],s.degreesPerPixel=[1/l,-1/f,1/h],a){var p=x*Math.tan(e*x)/c,d=l*p/2,v=u/S*p,g=v/f*h;s.pixelsPerDegree2=[0,-d,v],s.pixelsPerMeter2=[g,0,g]}return s}function I(t,e){var n=Object(r.a)(t,3),i=n[0],o=n[1],a=n[2],s=Object(r.a)(e,3),u=s[0],c=s[1],l=s[2],f=M({longitude:i,latitude:o,scale:1,highPrecision:!0}),h=f.pixelsPerMeter,p=f.pixelsPerMeter2,d=k(t,1);d[0]+=u*(h[0]+p[0]*c),d[1]+=c*(h[1]+p[1]*c);var v=C(d,1),g=(a||0)+(l||0);return Number.isFinite(a)||Number.isFinite(l)?[v[0],v[1],g]:v}function L(t){var e=t.height,n=t.pitch,r=t.bearing,a=t.altitude,s=t.center,u=void 0===s?null:s,l=t.flipY,h=void 0!==l&&l,d=Object(o.a)();return f()(d,d,[0,0,-a]),c()(d,d,[1,1,1/e]),p()(d,d,-n*x),v()(d,d,r*x),h&&c()(d,d,[1,-1,1]),u&&f()(d,d,new i.a(u).negate()),d}function R(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?P:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,u=void 0===s?1:s,c=t.farZMultiplier,l=void 0===c?1:c,f=a*x,h=Math.atan(.5/i),p=Math.sin(h)*i/Math.sin(Math.PI/2-f-h),d=Math.cos(Math.PI/2-f)*p+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:u,far:d*l}}function j(t){var e=t.width,n=t.height,r=t.pitch,i=R({width:e,height:n,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),o=i.fov,a=i.aspect,u=i.near,c=i.far;return s()([],o,a,u,c)}function z(t,e){var n=Object(r.a)(t,3),i=n[0],a=n[1],s=n[2],u=void 0===s?0:s;return Object(y.a)(Number.isFinite(i)&&Number.isFinite(a)&&Number.isFinite(u)),Object(o.d)(e,[i,a,u,1])}function D(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(r.a)(t,3),a=i[0],s=i[1],u=i[2];if(Object(y.a)(Number.isFinite(a)&&Number.isFinite(s)),Number.isFinite(u))return Object(o.d)(e,[a,s,u,1]);var c=Object(o.d)(e,[a,s,0,1]),l=Object(o.d)(e,[a,s,1,1]),f=c[2],h=l[2],p=f===h?0:((n||0)-f)/(h-f);return m()([],c,l,p)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DeckGL",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"autobind",{enumerable:!0,get:function(){return i.default}});var r=o(n(509)),i=o(n(223));function o(t){return t&&t.__esModule?t:{default:t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.tooltipStyle={position:"absolute",padding:"2px",background:"rgba(0, 0, 0, 0.8)",color:"#fff",maxWidth:"300px",fontSize:"12px",zIndex:9,pointerEvents:"none"},e.clickedIconStyle={position:"absolute",padding:"2px",background:"#fff",color:"rgba(0, 0, 0, 0.8)",maxWidth:"300px",fontSize:"12px",zIndex:9,pointerEvents:"none"},e.layerControl={borderRadius:3,boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",fontFamily:'ff-clan-web-pro, "Helvetica Neue", Helvetica, sans-serif !important',fontSize:"12px",lineHeight:1.833,width:200,position:"absolute",top:"20px",right:"20px",padding:"20px",zIndex:100,color:"#fff",background:"rgb(105, 105, 105)",opacity:"75%"},e.charts={background:"white",borderRadius:3,boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",fontFamily:'ff-clan-web-pro, "Helvetica Neue", Helvetica, sans-serif !important',fontSize:"12px",lineHeight:1.833,height:210,padding:"10px",position:"absolute",left:20,top:20,width:500,zIndex:100},e.spinner={animation:"linear 2s infinite",background:"#1EACC7",borderRadius:"50%",height:10,width:10,opacity:.4,position:"absolute",top:70,left:60,transformOrigin:"20px 20px",zIndex:110}},function(t,e,n){"use strict";(function(e){var r=n(61),i=n(515),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=n(227):void 0!==e&&(t=n(227)),t}(),transformRequest:[function(t,e){return i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],function(t){s.headers[t]={}}),r.forEach(["post","put","patch"],function(t){s.headers[t]=r.merge(o)}),t.exports=s}).call(this,n(68))},function(t,e,n){var r=Array.prototype.slice,i=n(538),o=n(539),a=t.exports=function(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:function(t,e,n){var c,l;if(s(t)||s(e))return!1;if(t.prototype!==e.prototype)return!1;if(o(t))return!!o(e)&&(t=r.call(t),e=r.call(e),a(t,e,n));if(u(t)){if(!u(e))return!1;if(t.length!==e.length)return!1;for(c=0;c<t.length;c++)if(t[c]!==e[c])return!1;return!0}try{var f=i(t),h=i(e)}catch(t){return!1}if(f.length!=h.length)return!1;for(f.sort(),h.sort(),c=f.length-1;c>=0;c--)if(f[c]!=h[c])return!1;for(c=f.length-1;c>=0;c--)if(l=f[c],!a(t[l],e[l],n))return!1;return typeof t==typeof e}(t,e,n))};function s(t){return null===t||void 0===t}function u(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}},function(t,e,n){"use strict";n.r(e),n.d(e,"createStore",function(){return s}),n.d(e,"combineReducers",function(){return c}),n.d(e,"bindActionCreators",function(){return f}),n.d(e,"applyMiddleware",function(){return d}),n.d(e,"compose",function(){return p}),n.d(e,"__DO_NOT_USE__ActionTypes",function(){return o});var r=n(184),i=function(){return Math.random().toString(36).substring(7).split("").join(".")},o={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function a(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function s(t,e,n){var i;if("function"==typeof e&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof e&&void 0===n&&(n=e,e=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(s)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var u=t,c=e,l=[],f=l,h=!1;function p(){f===l&&(f=l.slice())}function d(){if(h)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function v(t){if("function"!=typeof t)throw new Error("Expected the listener to be a function.");if(h)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var e=!0;return p(),f.push(t),function(){if(e){if(h)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");e=!1,p();var n=f.indexOf(t);f.splice(n,1)}}}function g(t){if(!a(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(h)throw new Error("Reducers may not dispatch actions.");try{h=!0,c=u(c,t)}finally{h=!1}for(var e=l=f,n=0;n<e.length;n++){(0,e[n])()}return t}return g({type:o.INIT}),(i={dispatch:g,subscribe:v,getState:d,replaceReducer:function(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");u=t,g({type:o.REPLACE})}})[r.a]=function(){var t,e=v;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");function n(){t.next&&t.next(d())}return n(),{unsubscribe:e(n)}}})[r.a]=function(){return this},t},i}function u(t,e){var n=e&&e.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function c(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var i=e[r];0,"function"==typeof t[i]&&(n[i]=t[i])}var a,s=Object.keys(n);try{!function(t){Object.keys(t).forEach(function(e){var n=t[e];if(void 0===n(void 0,{type:o.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:o.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+o.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(t){a=t}return function(t,e){if(void 0===t&&(t={}),a)throw a;for(var r=!1,i={},o=0;o<s.length;o++){var c=s[o],l=n[c],f=t[c],h=l(f,e);if(void 0===h){var p=u(c,e);throw new Error(p)}i[c]=h,r=r||h!==f}return r?i:t}}function l(t,e){return function(){return e(t.apply(this,arguments))}}function f(t,e){if("function"==typeof t)return l(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(t),r={},i=0;i<n.length;i++){var o=n[i],a=t[o];"function"==typeof a&&(r[o]=l(a,e))}return r}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}function d(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(){var n=t.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=e.map(function(t){return t(i)});return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){h(t,e,n[e])})}return t}({},n,{dispatch:r=p.apply(void 0,o)(n.dispatch)})}}}},function(t,e,n){"use strict";(function(t,r){var i,o=n(243);i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:r;var a=Object(o.a)(i);e.a=a}).call(this,n(41),n(482)(t))},function(t,e,n){t.exports=!n(34)&&!n(23)(function(){return 7!=Object.defineProperty(n(152)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(26)},function(t,e,n){var r=n(57),i=n(58),o=n(128)(!1),a=n(154)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(35),i=n(19),o=n(96);t.exports=n(34)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var r=n(58),i=n(99).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var r=n(96),i=n(129),o=n(120),a=n(42),s=n(119),u=Object.assign;t.exports=!u||n(23)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=a(t),u=arguments.length,c=1,l=i.f,f=o.f;u>c;)for(var h,p=s(arguments[c++]),d=l?r(p).concat(l(p)):r(p),v=d.length,g=0;v>g;)f.call(p,h=d[g++])&&(n[h]=p[h]);return n}:u},function(t,e,n){"use strict";var r=n(46),i=n(24),o=n(192),a=[].slice,s={};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),u=function(){var r=n.concat(a.call(arguments));return this instanceof u?function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)}(e,r.length,r):o(e,r,t)};return i(e.prototype)&&(u.prototype=e.prototype),u}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(20).parseInt,i=n(107).trim,o=n(158),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(20).parseFloat,i=n(107).trim;t.exports=1/r(n(158)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(66);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){var r=n(24),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var r=n(161),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=r(t);return i<u?c*function(t){return t+1/o-1/o}(i/u/a)*u*a:(n=(e=(1+a/o)*i)-(e-i))>s||n!=n?c*(1/0):c*n}},function(t,e,n){var r=n(19);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(46),i=n(42),o=n(119),a=n(36);t.exports=function(t,e,n,s,u){r(e);var c=i(t),l=o(c),f=a(c.length),h=u?f-1:0,p=u?-1:1;if(n<2)for(;;){if(h in l){s=l[h],h+=p;break}if(h+=p,u?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;u?h>=0:f>h;h+=p)h in l&&(s=e(s,l[h],h,c));return s}},function(t,e,n){"use strict";var r=n(42),i=n(97),o=n(36);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),c=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===c?a:i(c,a))-u,a-s),f=1;for(u<s&&s<u+l&&(f=-1,u+=l-1,s+=l-1);l-- >0;)u in n?n[s]=n[u]:delete n[s],s+=f,u+=f;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){n(34)&&"g"!=/./g.flags&&n(35).f(RegExp.prototype,"flags",{configurable:!0,get:n(133)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(19),i=n(24),o=n(176);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(207),i=n(109);t.exports=n(137)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(35).f,i=n(98),o=n(103),a=n(65),s=n(101),u=n(102),c=n(164),l=n(202),f=n(100),h=n(34),p=n(83).fastKey,d=n(109),v=h?"_s":"size",g=function(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var l=t(function(t,r){s(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=r&&u(r,n,t[c],t)});return o(l.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=d(this,e),r=g(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[v]--}return!!r},forEach:function(t){d(this,e);for(var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(d(this,e),t)}}),h&&r(l.prototype,"size",{get:function(){return d(this,e)[v]}}),l},def:function(t,e,n){var r,i,o=g(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[v]++,"F"!==i&&(t._i[i]=o)),t},getEntry:g,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=d(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?l(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,l(1))},n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){"use strict";var r=n(207),i=n(109);t.exports=n(137)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r,i=n(75)(0),o=n(52),a=n(83),s=n(190),u=n(210),c=n(24),l=n(23),f=n(109),h=a.getWeak,p=Object.isExtensible,d=u.ufstore,v={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},m={get:function(t){if(c(t)){var e=h(t);return!0===e?d(f(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(f(this,"WeakMap"),t,e)}},y=t.exports=n(137)("WeakMap",g,m,u,!0,!0);l(function(){return 7!=(new y).set((Object.freeze||Object)(v),7).get(v)})&&(s((r=u.getConstructor(g,"WeakMap")).prototype,m),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=y.prototype,n=e[t];o(e,t,function(e,i){if(c(e)&&!p(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)})}))},function(t,e,n){"use strict";var r=n(103),i=n(83).getWeak,o=n(19),a=n(24),s=n(101),u=n(102),c=n(75),l=n(57),f=n(109),h=c(5),p=c(6),d=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},m=function(t,e){return h(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var n=m(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var c=t(function(t,r){s(t,c,e,"_i"),t._t=e,t._i=d++,t._l=void 0,void 0!=r&&u(r,n,t[o],t)});return r(c.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?v(f(this,e)).delete(t):n&&l(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?v(f(this,e)).has(t):n&&l(n,this._i)}}),c},def:function(t,e,n){var r=i(o(e),!0);return!0===r?v(t).set(e,n):r[t._i]=n,t},ufstore:v}},function(t,e,n){var r=n(73),i=n(36);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(99),i=n(129),o=n(19),a=n(20).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var r=n(130),i=n(24),o=n(36),a=n(65),s=n(26)("isConcatSpreadable");t.exports=function t(e,n,u,c,l,f,h,p){for(var d,v,g=l,m=0,y=!!h&&a(h,p,3);m<c;){if(m in u){if(d=y?y(u[m],m,n):u[m],v=!1,i(d)&&(v=void 0!==(v=d[s])?!!v:r(d)),v&&f>0)g=t(e,n,d,o(d.length),g,f-1)-1;else{if(g>=9007199254740991)throw TypeError();e[g]=d}g++}m++}return g}},function(t,e,n){var r=n(36),i=n(160),o=n(72);t.exports=function(t,e,n,a){var s=String(o(t)),u=s.length,c=void 0===n?" ":String(n),l=r(e);if(l<=u||""==c)return s;var f=l-u,h=i.call(c,Math.ceil(f/c.length));return h.length>f&&(h=h.slice(0,f)),a?h+s:s+h}},function(t,e,n){var r=n(96),i=n(58),o=n(120).f;t.exports=function(t){return function(e){for(var n,a=i(e),s=r(a),u=s.length,c=0,l=[];u>c;)o.call(a,n=s[c++])&&l.push(t?[n,a[n]]:a[n]);return l}}},function(t,e,n){var r=n(121),i=n(217);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){var r=n(102);t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,r,i){return 0===arguments.length||t!=t||e!=e||n!=n||r!=r||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-r)/(n-e)+r}},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,s=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var c in n=Object(arguments[u]))i.call(n,c)&&(s[c]=n[c]);if(r){a=r(n);for(var l=0;l<a.length;l++)o.call(n,a[l])&&(s[a[l]]=n[a[l]])}}return s}},function(t,e,n){"use strict";(function(t){var e,r=n(0),i=n(245);function o(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function a(t){return t&&!0}var s=(e={},Object(r.a)(e,"OES_vertex_array_object",{meta:{suffix:"OES"},createVertexArray:function(){o(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),Object(r.a)(e,"ANGLE_instanced_arrays",{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(t,e){o(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),Object(r.a)(e,"WEBGL_draw_buffers",{meta:{suffix:"WEBGL"},drawBuffers:function(){o(!1)}}),Object(r.a)(e,"EXT_disjoint_timer_query",{meta:{suffix:"EXT"},createQuery:function(){o(!1)},deleteQuery:function(){o(!1)},beginQuery:function(){o(!1)},endQuery:function(){},getQuery:function(t,e){return this.getQueryObject(t,e)},getQueryParameter:function(t,e){return this.getQueryObject(t,e)},queryCounter:function(){},getQueryObject:function(){}}),Object(r.a)(e,"EXT_disjoint_timer_query_webgl2",{meta:{suffix:"EXT"},queryCounter:null}),Object(r.a)(e,"OVERRIDES",{readBuffer:function(t,e,n){a(t)&&e(n)},getVertexAttrib:function(t,e,n,r){var i,o=function(t,e){return{webgl2:a(t),ext:t.getExtension(e)}}(t,"ANGLE_instanced_arrays"),s=o.webgl2,u=o.ext;switch(r){case 35069:i=!!s&&void 0;break;case 35070:i=s||u?void 0:0}return void 0!==i?i:e(n,r)},getProgramParameter:function(t,e,n,r){if(!a(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:function(t,e,n,r,i){if(!a(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter:function(t,e,n,r){switch(r){case 34046:var i=t.luma.extensions.EXT_texture_filter_anisotropic;r=i&&i.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:i.a,hint:function(t,e,n,r){return e(n,r)}}),e);function u(t,e){var n=e.extension,r=e.target,i=e.target2,a=s[n];o(a);var u=a.meta,c=(void 0===u?{}:u).suffix,l=void 0===c?"":c,f=t.getExtension(n);Object.keys(a).forEach(function(e){var n="".concat(e).concat(l),o=null;"meta"===e||"function"==typeof t[e]||(f&&"function"==typeof f[n]?o=function(){return f[n].apply(f,arguments)}:"function"==typeof a[e]&&(o=a[e].bind(r))),o&&(r[e]=o,i[e]=o)})}(void 0!==t?t:window).polyfillContext=function(t){if(t.luma=t.luma||{},function(t){t.luma.extensions={};var e=t.getSupportedExtensions(),n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.luma[s]=t.getExtension(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}(t),!t.luma.polyfilled){for(var e in s)"overrides"!==e&&u(t,{extension:e,target:t.luma,target2:t});!function(t,e){var n=e.target,r=e.target2,i=s.OVERRIDES;Object.keys(i).forEach(function(e){if("function"==typeof i[e]){var o=t[e]?t[e].bind(t):function(){},a=i[e].bind(null,t,o);n[e]=a,r[e]=a}})}(t,{target:t.luma,target2:t}),t.luma.polyfilled=!0}return t}}).call(this,n(41))},function(t,e,n){"use strict";n.d(e,"a",function(){return x});var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(112),c=n(104),l=n(246),f=n.n(l),h=n(247),p=n.n(h),d=n(248),v=n.n(d),g=n(249),m=n.n(g),y=n(250),_=n.n(y),b=[0,0,0],x=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i,s),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"angle",value:function(t){return f()(this,t)}},{key:"cross",value:function(t){return p()(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return v()(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return m()(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?b:n;return _()(this,this,r,e),this.check()}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(c.a)(t)}}]),e}(u.a)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inheritsFrom=function(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(e),i=!0,o=!1,a=void 0;try{for(var s,u=function(){var e=s.value;"function"==typeof t[e]&&(r.find(function(t){return e===t})||(t[e]=t[e].bind(t)))},c=n[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(t){o=!0,a=t}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}};var r=["constructor","render","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LayerControls=e.SCATTERPLOT_CONTROLS=e.HEXAGON_CONTROLS=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(15),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=n(180);e.HEXAGON_CONTROLS={showHexagon:{displayName:"Show Horde Density Heatmap",type:"boolean",value:!1},radius:{displayName:"Heatmap Radius",type:"range",value:250,step:50,min:50,max:1e3},coverage:{displayName:"Heatmap Coverage",type:"range",value:.7,step:.1,min:0,max:1},upperPercentile:{displayName:"Heatmap Upper Percentile",type:"range",value:95,step:.1,min:80,max:100},radiusScale:{displayName:"Horde Radius",type:"range",value:25,step:5,min:10,max:200}},e.SCATTERPLOT_CONTROLS={radiusScale:{displayName:"Horde Radius",type:"range",value:30,step:10,min:10,max:200},showHexagon:{displayName:"Show Hexagonasdfa",type:"boolean",value:!1}},e.LayerControls=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"_onValueChange",value:function(t,e){if(this.props.settings[t]!==e){var n=r({},this.props.settings,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,e));this.props.onChange(n)}}},{key:"render",value:function(){var t=this,e=this.props,n=e.title,r=e.settings,i=e.propTypes,o=void 0===i?{}:i;return a.default.createElement("div",{className:"layer-controls",style:s.layerControl},n&&a.default.createElement("h4",null,n),Object.keys(r).map(function(e){return a.default.createElement("div",{key:e},a.default.createElement("label",null,o[e].displayName),a.default.createElement("div",{style:{display:"inline-block",float:"right"}},r[e]),a.default.createElement(u,{settingName:e,value:r[e],propType:o[e],onChange:t._onValueChange.bind(t)}))}))}}]),e}();var u=function(t){var e=t.propType;if(e&&e.type)switch(e.type){case"range":return a.default.createElement(l,t);case"boolean":return a.default.createElement(c,t);default:return a.default.createElement("input",t)}},c=function(t){var e=t.settingName,n=t.value,r=t.onChange;return a.default.createElement("div",{key:e},a.default.createElement("div",{className:"input-group"},a.default.createElement("input",{type:"checkbox",id:e,checked:n,onChange:function(t){return r(e,t.target.checked)}})))},l=function(t){var e=t.settingName,n=t.value,r=t.propType,i=t.onChange,o=r.max,s=void 0===o?100:o;return a.default.createElement("div",{key:e},a.default.createElement("div",{className:"input-group"},a.default.createElement("div",null,a.default.createElement("input",{type:"range",id:e,min:0,max:s,step:s/100,value:n,onChange:function(t){return i(e,Number(t.target.value))}}))))}},function(t,e,n){t.exports=n(512)},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e,n){"use strict";var r=n(61),i=n(516),o=n(518),a=n(519),s=n(520),u=n(228),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(521);t.exports=function(t){return new Promise(function(e,l){var f=t.data,h=t.headers;r.isFormData(f)&&delete h["Content-Type"];var p=new XMLHttpRequest,d="onreadystatechange",v=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||s(t.url)||(p=new window.XDomainRequest,d="onload",v=!0,p.onprogress=function(){},p.ontimeout=function(){}),t.auth){var g=t.auth.username||"",m=t.auth.password||"";h.Authorization="Basic "+c(g+":"+m)}if(p.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),p.timeout=t.timeout,p[d]=function(){if(p&&(4===p.readyState||v)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?p.response:p.responseText,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:t,request:p};i(e,l,r),p=null}},p.onerror=function(){l(u("Network Error",t,null,p)),p=null},p.ontimeout=function(){l(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var y=n(522),_=(t.withCredentials||s(t.url))&&t.xsrfCookieName?y.read(t.xsrfCookieName):void 0;_&&(h[t.xsrfHeaderName]=_)}if("setRequestHeader"in p&&r.forEach(h,function(t,e){void 0===f&&"content-type"===e.toLowerCase()?delete h[e]:p.setRequestHeader(e,t)}),t.withCredentials&&(p.withCredentials=!0),t.responseType)try{p.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&p.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){p&&(p.abort(),l(t),p=null)}),void 0===f&&(f=null),p.send(f)})}},function(t,e,n){"use strict";var r=n(517);t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,e,n){t.exports=function(){"use strict";var t,e,n;function r(r,i){if(t)if(e){var o="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",a={};t(a),(n=i(a)).workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else e=i;else t=i}return r(0,function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=r;function r(t,e,n,r){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},r.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},r.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},r.prototype.solveCurveX=function(t,e){var n,r,i,o,a;for(void 0===e&&(e=1e-6),i=t,a=0;a<8;a++){if(o=this.sampleCurveX(i)-t,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if(r=1,(i=t)<(n=0))return n;if(i>r)return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-t)<e)return i;t>o?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=function(t,e,n){this.column=t,this.row=e,this.zoom=n};i.prototype.clone=function(){return new i(this.column,this.row,this.zoom)},i.prototype.zoomTo=function(t){return this.clone()._zoomTo(t)},i.prototype.sub=function(t){return this.clone()._sub(t)},i.prototype._zoomTo=function(t){var e=Math.pow(2,t-this.zoom);return this.column*=e,this.row*=e,this.zoom=t,this},i.prototype._sub=function(t){return t=t.zoomTo(this.zoom),this.column-=t.column,this.row-=t.row,this};var o=a;function a(t,e){this.x=t,this.y=e}function s(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!s(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!s(t[r],e[r]))return!1;return!0}return t===e}function u(t,e,r,i){var o=new n(t,e,r,i);return function(t){return o.solve(t)}}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=e*this.x-n*this.y,i=n*this.x+e*this.y;return this.x=r,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),r=Math.sin(t),i=e.x+n*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+n*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t};var c=u(.25,.1,.25,1);function l(t,e,n){return Math.min(n,Math.max(e,t))}function f(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}var h=1;function p(){return h++}function d(t,e){t.forEach(function(t){e[t]&&(e[t]=e[t].bind(e))})}function v(t,e){return-1!==t.indexOf(e,t.length-e.length)}function g(t,e,n){var r={};for(var i in t)r[i]=e.call(n||this,t[i],i,t);return r}function m(t,e,n){var r={};for(var i in t)e.call(n||this,t[i],i,t)&&(r[i]=t[i]);return r}function y(t){return Array.isArray(t)?t.map(y):"object"==typeof t&&t?g(t,y):t}var _={};function b(t){_[t]||("undefined"!=typeof console&&console.warn(t),_[t]=!0)}function x(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function w(t){for(var e=0,n=0,r=t.length,i=r-1,o=void 0,a=void 0;n<r;i=n++)o=t[n],e+=((a=t[i]).x-o.x)*(o.y+a.y);return e}var E=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),S=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,P=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,T={now:E,frame:function(t){var e=S(t);return{cancel:function(){return P(e)}}},getImageData:function(t){var e=self.document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(0,0,t.width,t.height)},resolveURL:function(t){var e=self.document.createElement("a");return e.href=t,e.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},supportsWebp:!1};if(self.document){var A=self.document.createElement("img");A.onload=function(){T.supportsWebp=!0},A.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var k={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(k);var C=function(t){function e(e,n,r){t.call(this,e),this.status=n,this.url=r,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error);function O(t){var e=new self.XMLHttpRequest;for(var n in e.open(t.method||"GET",t.url,!0),t.headers)e.setRequestHeader(n,t.headers[n]);return e.withCredentials="include"===t.credentials,e}var M=function(t,e){var n=O(t);return n.responseType="arraybuffer",n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){var r=n.response;if(0===r.byteLength&&200===n.status)return e(new Error("http status 200 returned without content."));(n.status>=200&&n.status<300||0===n.status)&&n.response?e(null,{data:r,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):e(new C(n.statusText,n.status,t.url))},n.send(),{cancel:function(){return n.abort()}}};function I(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function L(t,e,n){if(n&&n[t]){var r=n[t].indexOf(e);-1!==r&&n[t].splice(r,1)}}var R=function(t,e){void 0===e&&(e={}),f(this,e),this.type=t},j=function(t){function e(e,n){void 0===n&&(n={}),t.call(this,"error",f({error:e},n))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(R),z=function(){};z.prototype.on=function(t,e){return this._listeners=this._listeners||{},I(t,e,this._listeners),this},z.prototype.off=function(t,e){return L(t,e,this._listeners),L(t,e,this._oneTimeListeners),this},z.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},I(t,e,this._oneTimeListeners),this},z.prototype.fire=function(t){"string"==typeof t&&(t=new R(t,arguments[1]||{}));var e=t.type;if(this.listens(e)){t.target=this;for(var n=0,r=this._listeners&&this._listeners[e]?this._listeners[e].slice():[];n<r.length;n+=1)r[n].call(this,t);for(var i=0,o=this._oneTimeListeners&&this._oneTimeListeners[e]?this._oneTimeListeners[e].slice():[];i<o.length;i+=1){var a=o[i];L(e,a,this._oneTimeListeners),a.call(this,t)}var s=this._eventedParent;s&&(f(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(t))}else t instanceof j&&console.error(t.error);return this},z.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},z.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var D={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-z-order":{type:"enum",values:{"viewport-y":{},source:{}},default:"viewport-y",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},F=function(t,e,n,r){this.message=(t?t+": ":"")+n,r&&(this.identifier=r),null!==e&&void 0!==e&&e.__line__&&(this.line=e.__line__)};function N(t){var e=t.key,n=t.value;return n?[new F(e,n,"constants have been deprecated as of v8")]:[]}function B(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)t[a]=o[a]}return t}function U(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function V(t){return Array.isArray(t)?t.map(V):U(t)}var G=function(t){function e(e,n){t.call(this,n),this.message=n,this.key=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),q=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,r=e;n<r.length;n+=1){var i=r[n],o=i[0],a=i[1];this.bindings[o]=a}};q.prototype.concat=function(t){return new q(this,t)},q.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},q.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var W={kind:"null"},Z={kind:"number"},X={kind:"string"},H={kind:"boolean"},Y={kind:"color"},K={kind:"object"},J={kind:"value"},Q={kind:"collator"},$={kind:"formatted"};function tt(t,e){return{kind:"array",itemType:t,N:e}}function et(t){if("array"===t.kind){var e=et(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var nt=[W,Z,X,H,Y,$,K,tt(J)];function rt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!rt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,r=nt;n<r.length;n+=1)if(!rt(r[n],e))return null}return"Expected "+et(t)+" but found "+et(e)+" instead."}var it=e(function(t,e){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return t<0?0:t>1?1:t}function o(t){return"%"===t[t.length-1]?r(parseFloat(t)/100*255):r(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in n)return n[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=i.indexOf("("),c=i.indexOf(")");if(-1!==u&&c+1===i.length){var l=i.substr(0,u),f=i.substr(u+1,c-(u+1)).split(","),h=1;switch(l){case"rgba":if(4!==f.length)return null;h=a(f.pop());case"rgb":return 3!==f.length?null:[o(f[0]),o(f[1]),o(f[2]),h];case"hsla":if(4!==f.length)return null;h=a(f.pop());case"hsl":if(3!==f.length)return null;var p=(parseFloat(f[0])%360+360)%360/360,d=a(f[1]),v=a(f[2]),g=v<=.5?v*(d+1):v+d-v*d,m=2*v-g;return[r(255*s(m,g,p+1/3)),r(255*s(m,g,p)),r(255*s(m,g,p-1/3)),h];default:return null}}return null}}catch(t){}}).parseCSSColor,ot=function(t,e,n,r){void 0===r&&(r=1),this.r=t,this.g=e,this.b=n,this.a=r};ot.parse=function(t){if(t){if(t instanceof ot)return t;if("string"==typeof t){var e=it(t);if(e)return new ot(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},ot.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],r=t[2],i=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(r)+","+i+")"},ot.prototype.toArray=function(){var t=this.r,e=this.g,n=this.b,r=this.a;return 0===r?[0,0,0,0]:[255*t/r,255*e/r,255*n/r,r]},ot.black=new ot(0,0,0,1),ot.white=new ot(1,1,1,1),ot.transparent=new ot(0,0,0,0),ot.red=new ot(1,0,0,1);var at=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};at.prototype.compare=function(t,e){return this.collator.compare(t,e)},at.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var st=function(t,e,n){this.text=t,this.scale=e,this.fontStack=n},ut=function(t){this.sections=t};function ct(t,e,n,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[t,e,n,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,e,n,r]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function lt(t){if(null===t)return W;if("string"==typeof t)return X;if("boolean"==typeof t)return H;if("number"==typeof t)return Z;if(t instanceof ot)return Y;if(t instanceof at)return Q;if(t instanceof ut)return $;if(Array.isArray(t)){for(var e,n=t.length,r=0,i=t;r<i.length;r+=1){var o=lt(i[r]);if(e){if(e===o)continue;e=J;break}e=o}return tt(e||J,n)}return K}function ft(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ot||t instanceof ut?t.toString():JSON.stringify(t)}ut.fromString=function(t){return new ut([new st(t,null,null)])},ut.prototype.toString=function(){return this.sections.map(function(t){return t.text}).join("")},ut.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.text);var i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),t.push(i)}return t};var ht=function(t,e){this.type=t,this.value=e};ht.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof ot)return!0;if(e instanceof at)return!0;if(e instanceof ut)return!0;if(Array.isArray(e)){for(var n=0,r=e;n<r.length;n+=1)if(!t(r[n]))return!1;return!0}if("object"==typeof e){for(var i in e)if(!t(e[i]))return!1;return!0}return!1}(t[1]))return e.error("invalid value");var n=t[1],r=lt(n),i=e.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new ht(r,n)},ht.prototype.evaluate=function(){return this.value},ht.prototype.eachChild=function(){},ht.prototype.possibleOutputs=function(){return[this.value]},ht.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ot?["rgba"].concat(this.value.toArray()):this.value instanceof ut?this.value.serialize():this.value};var pt=function(t){this.name="ExpressionEvaluationError",this.message=t};pt.prototype.toJSON=function(){return this.message};var dt={string:X,number:Z,boolean:H,object:K},vt=function(t,e){this.type=t,this.args=e};vt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,r=1,i=t[0];if("array"===i){var o,a;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in dt)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=dt[s],r++}else o=J;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}n=tt(o,a)}else n=dt[i];for(var u=[];r<t.length;r++){var c=e.parse(t[r],r,J);if(!c)return null;u.push(c)}return new vt(n,u)},vt.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!rt(this.type,lt(n)))return n;if(e===this.args.length-1)throw new pt("Expected value to be of type "+et(this.type)+", but found "+et(lt(n))+" instead.")}return null},vt.prototype.eachChild=function(t){this.args.forEach(t)},vt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},vt.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var r=t.N;("number"==typeof r||this.args.length>1)&&e.push(r)}}return e.concat(this.args.map(function(t){return t.serialize()}))};var gt=function(t){this.type=$,this.sections=t};gt.parse=function(t,e){if(t.length<3)return e.error("Expected at least two arguments.");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");for(var n=[],r=1;r<t.length-1;r+=2){var i=e.parse(t[r],1,J);if(!i)return null;var o=i.type.kind;if("string"!==o&&"value"!==o&&"null"!==o)return e.error("Formatted text type must be 'string', 'value', or 'null'.");var a=t[r+1];if("object"!=typeof a||Array.isArray(a))return e.error("Format options argument must be an object.");var s=null;if(a["font-scale"]&&!(s=e.parse(a["font-scale"],1,Z)))return null;var u=null;if(a["text-font"]&&!(u=e.parse(a["text-font"],1,tt(X))))return null;n.push({text:i,scale:s,font:u})}return new gt(n)},gt.prototype.evaluate=function(t){return new ut(this.sections.map(function(e){return new st(ft(e.text.evaluate(t)),e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null)}))},gt.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t(r.text),r.scale&&t(r.scale),r.font&&t(r.font)}},gt.prototype.possibleOutputs=function(){return[void 0]},gt.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var r=n[e];t.push(r.text.serialize());var i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),t.push(i)}return t};var mt={"to-boolean":H,"to-color":Y,"to-number":Z,"to-string":X},yt=function(t,e){this.type=t,this.args=e};yt.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var r=mt[n],i=[],o=1;o<t.length;o++){var a=e.parse(t[o],o,J);if(!a)return null;i.push(a)}return new yt(r,i)},yt.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,r=0,i=this.args;r<i.length;r+=1){if(n=null,(e=i[r].evaluate(t))instanceof ot)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ct(e[0],e[1],e[2],e[3])))return new ot(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new pt(n||"Could not parse color from value '"+("string"==typeof e?e:JSON.stringify(e))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(t)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new pt("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?ut.fromString(ft(this.args[0].evaluate(t))):ft(this.args[0].evaluate(t))},yt.prototype.eachChild=function(t){this.args.forEach(t)},yt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},yt.prototype.serialize=function(){if("formatted"===this.type.kind)return new gt([{text:this.args[0],scale:null,font:null}]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var _t=["Unknown","Point","LineString","Polygon"],bt=function(){this.globals=null,this.feature=null,this.featureState=null,this._parseColorCache={}};bt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},bt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?_t[this.feature.type]:this.feature.type:null},bt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},bt.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ot.parse(t)),e};var xt=function(t,e,n,r){this.name=t,this.type=e,this._evaluate=n,this.args=r};xt.prototype.evaluate=function(t){return this._evaluate(t,this.args)},xt.prototype.eachChild=function(t){this.args.forEach(t)},xt.prototype.possibleOutputs=function(){return[void 0]},xt.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},xt.parse=function(t,e){var n=t[0],r=xt.definitions[n];if(!r)return e.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(r)?r[0]:r.type,o=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=o.filter(function(e){var n=e[0];return!Array.isArray(n)||n.length===t.length-1}),s=null,u=0,c=a;u<c.length;u+=1){var l=c[u],f=l[0],h=l[1];s=new At(e.registry,e.path,null,e.scope);for(var p=[],d=!1,v=1;v<t.length;v++){var g=t[v],m=Array.isArray(f)?f[v-1]:f.type,y=s.parse(g,1+p.length,m);if(!y){d=!0;break}p.push(y)}if(!d)if(Array.isArray(f)&&f.length!==p.length)s.error("Expected "+f.length+" arguments, but found "+p.length+" instead.");else{for(var _=0;_<p.length;_++){var b=Array.isArray(f)?f[_]:f.type,x=p[_];s.concat(_+1).checkSubtype(b,x.type)}if(0===s.errors.length)return new xt(n,i,h,p)}}if(1===a.length)e.errors.push.apply(e.errors,s.errors);else{for(var w=(a.length?a:o).map(function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(et).join(", ")+")":"("+et(e.type)+"...)"}).join(" | "),E=[],S=1;S<t.length;S++){var P=e.parse(t[S],1+E.length);if(!P)return null;E.push(et(P.type))}e.error("Expected arguments of type "+w+", but found ("+E.join(", ")+") instead.")}return null},xt.register=function(t,e){for(var n in xt.definitions=e,e)t[n]=xt};var wt=function(t,e,n){this.type=Q,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function Et(t){if(t instanceof xt){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!Et(t)&&(e=!1)}),e}function St(t){if(t instanceof xt&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild(function(t){e&&!St(t)&&(e=!1)}),e}function Pt(t,e){if(t instanceof xt&&e.indexOf(t.name)>=0)return!1;var n=!0;return t.eachChild(function(t){n&&!Pt(t,e)&&(n=!1)}),n}wt.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var r=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,H);if(!r)return null;var i=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,H);if(!i)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,X))?null:new wt(r,i,o)},wt.prototype.evaluate=function(t){return new at(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},wt.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},wt.prototype.possibleOutputs=function(){return[void 0]},wt.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Tt=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Tt.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new Tt(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},Tt.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Tt.prototype.eachChild=function(){},Tt.prototype.possibleOutputs=function(){return[void 0]},Tt.prototype.serialize=function(){return["var",this.name]};var At=function(t,e,n,r,i){void 0===e&&(e=[]),void 0===r&&(r=new q),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=r,this.errors=i,this.expectedType=n};function kt(t,e){for(var n,r,i=0,o=t.length-1,a=0;i<=o;){if(n=t[a=Math.floor((i+o)/2)],r=t[a+1],e===n||e>n&&e<r)return a;if(n<e)i=a+1;else{if(!(n>e))throw new pt("Input is not a number.");o=a-1}}return Math.max(a-1,0)}At.prototype.parse=function(t,e,n,r,i){return void 0===i&&(i={}),e?this.concat(e,n,r)._parse(t,i):this._parse(t,i)},At.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new vt(e,[t]):"coerce"===n?new yt(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[r];if(i){var o=i.parse(t,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,e.typeAnnotation||"coerce");else o=n(o,a,e.typeAnnotation||"assert")}if(!(o instanceof ht)&&function t(e){if(e instanceof Tt)return t(e.boundExpression);if(e instanceof xt&&"error"===e.name)return!1;if(e instanceof wt)return!1;var n=e instanceof yt||e instanceof vt,r=!0;return e.eachChild(function(e){r=n?r&&t(e):r&&e instanceof ht}),!!r&&Et(e)&&Pt(e,["zoom","heatmap-density","line-progress","is-supported-script"])}(o)){var u=new bt;try{o=new ht(o.type,o.evaluate(u))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},At.prototype.concat=function(t,e,n){var r="number"==typeof t?this.path.concat(t):this.path,i=n?this.scope.concat(n):this.scope;return new At(this.registry,r,e||null,i,this.errors)},At.prototype.error=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var r=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new G(r,t))},At.prototype.checkSubtype=function(t,e){var n=rt(t,e);return n&&this.error(n),n};var Ct=function(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var r=0,i=n;r<i.length;r+=1){var o=i[r],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};function Ot(t,e,n){return t*(1-n)+e*n}Ct.parse=function(t,e){var n=t[1],r=t.slice(2);if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(n=e.parse(n,1,Z)))return null;var i=[],o=null;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType),r.unshift(-1/0);for(var a=0;a<r.length;a+=2){var s=r[a],u=r[a+1],c=a+1,l=a+2;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(i.length&&i[i.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',c);var f=e.parse(u,l,o);if(!f)return null;o=o||f.type,i.push([s,f])}return new Ct(o,n,i)},Ct.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;return r>=e[i-1]?n[i-1].evaluate(t):n[kt(e,r)].evaluate(t)},Ct.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Ct.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Ct.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var Mt=Object.freeze({number:Ot,color:function(t,e,n){return new ot(Ot(t.r,e.r,n),Ot(t.g,e.g,n),Ot(t.b,e.b,n),Ot(t.a,e.a,n))},array:function(t,e,n){return t.map(function(t,r){return Ot(t,e[r],n)})}}),It=.95047,Lt=1,Rt=1.08883,jt=4/29,zt=6/29,Dt=3*zt*zt,Ft=zt*zt*zt,Nt=Math.PI/180,Bt=180/Math.PI;function Ut(t){return t>Ft?Math.pow(t,1/3):t/Dt+jt}function Vt(t){return t>zt?t*t*t:Dt*(t-jt)}function Gt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function qt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Wt(t){var e=qt(t.r),n=qt(t.g),r=qt(t.b),i=Ut((.4124564*e+.3575761*n+.1804375*r)/It),o=Ut((.2126729*e+.7151522*n+.072175*r)/Lt);return{l:116*o-16,a:500*(i-o),b:200*(o-Ut((.0193339*e+.119192*n+.9503041*r)/Rt)),alpha:t.a}}function Zt(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,r=isNaN(t.b)?e:e-t.b/200;return e=Lt*Vt(e),n=It*Vt(n),r=Rt*Vt(r),new ot(Gt(3.2404542*n-1.5371385*e-.4985314*r),Gt(-.969266*n+1.8760108*e+.041556*r),Gt(.0556434*n-.2040259*e+1.0572252*r),t.alpha)}var Xt={forward:Wt,reverse:Zt,interpolate:function(t,e,n){return{l:Ot(t.l,e.l,n),a:Ot(t.a,e.a,n),b:Ot(t.b,e.b,n),alpha:Ot(t.alpha,e.alpha,n)}}},Ht={forward:function(t){var e=Wt(t),n=e.l,r=e.a,i=e.b,o=Math.atan2(i,r)*Bt;return{h:o<0?o+360:o,c:Math.sqrt(r*r+i*i),l:n,alpha:t.a}},reverse:function(t){var e=t.h*Nt,n=t.c;return Zt({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:function(t,e,n){var r=e-t;return t+n*(r>180||r<-180?r-360*Math.round(r/360):r)}(t.h,e.h,n),c:Ot(t.c,e.c,n),l:Ot(t.l,e.l,n),alpha:Ot(t.alpha,e.alpha,n)}}},Yt=Object.freeze({lab:Xt,hcl:Ht}),Kt=function(t,e,n,r,i){this.type=t,this.operator=e,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[0],c=s[1];this.labels.push(u),this.outputs.push(c)}};function Jt(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}Kt.interpolationFactor=function(t,e,r,i){var o=0;if("exponential"===t.name)o=Jt(e,t.base,r,i);else if("linear"===t.name)o=Jt(e,1,r,i);else if("cubic-bezier"===t.name){var a=t.controlPoints;o=new n(a[0],a[1],a[2],a[3]).solve(Jt(e,1,r,i))}return o},Kt.parse=function(t,e){var n=t[0],r=t[1],i=t[2],o=t.slice(3);if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return e.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some(function(t){return"number"!=typeof t||t<0||t>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,Z)))return null;var u=[],c=null;"interpolate-hcl"===n||"interpolate-lab"===n?c=Y:e.expectedType&&"value"!==e.expectedType.kind&&(c=e.expectedType);for(var l=0;l<o.length;l+=2){var f=o[l],h=o[l+1],p=l+3,d=l+4;if("number"!=typeof f)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(u.length&&u[u.length-1][0]>=f)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);var v=e.parse(h,d,c);if(!v)return null;c=c||v.type,u.push([f,v])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new Kt(c,n,r,i,u):e.error("Type "+et(c)+" is not interpolatable.")},Kt.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var r=this.input.evaluate(t);if(r<=e[0])return n[0].evaluate(t);var i=e.length;if(r>=e[i-1])return n[i-1].evaluate(t);var o=kt(e,r),a=e[o],s=e[o+1],u=Kt.interpolationFactor(this.interpolation,r,a,s),c=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?Mt[this.type.kind.toLowerCase()](c,l,u):"interpolate-hcl"===this.operator?Ht.reverse(Ht.interpolate(Ht.forward(c),Ht.forward(l),u)):Xt.reverse(Xt.interpolate(Xt.forward(c),Xt.forward(l),u))},Kt.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1)t(n[e])},Kt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}));var t},Kt.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};var Qt=function(t,e){this.type=t,this.args=e};Qt.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,r=e.expectedType;r&&"value"!==r.kind&&(n=r);for(var i=[],o=0,a=t.slice(1);o<a.length;o+=1){var s=a[o],u=e.parse(s,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!u)return null;n=n||u.type,i.push(u)}var c=r&&i.some(function(t){return rt(r,t.type)});return new Qt(c?J:n,i)},Qt.prototype.evaluate=function(t){for(var e=null,n=0,r=this.args;n<r.length&&null===(e=r[n].evaluate(t));n+=1);return e},Qt.prototype.eachChild=function(t){this.args.forEach(t)},Qt.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}));var t},Qt.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var $t=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};$t.prototype.evaluate=function(t){return this.result.evaluate(t)},$t.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1)t(n[e][1]);t(this.result)},$t.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],r=1;r<t.length-1;r+=2){var i=t[r];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}var a=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return a?new $t(n,a):null},$t.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},$t.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];t.push(i,o.serialize())}return t.push(this.result.serialize()),t};var te=function(t,e,n){this.type=t,this.index=e,this.input=n};te.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,Z),r=e.parse(t[2],2,tt(e.expectedType||J));if(!n||!r)return null;var i=r.type;return new te(i.itemType,n,r)},te.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new pt("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new pt("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new pt("Array index must be an integer, but found "+e+" instead.");return n[e]},te.prototype.eachChild=function(t){t(this.index),t(this.input)},te.prototype.possibleOutputs=function(){return[void 0]},te.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ee=function(t,e,n,r,i,o){this.inputType=t,this.type=e,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o};ee.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var i={},o=[],a=2;a<t.length-1;a+=2){var s=t[a],u=t[a+1];Array.isArray(s)||(s=[s]);var c=e.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var l=0,f=s;l<f.length;l+=1){var h=f[l];if("number"!=typeof h&&"string"!=typeof h)return c.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,lt(h)))return null}else n=lt(h);if(void 0!==i[String(h)])return c.error("Branch labels must be unique.");i[String(h)]=o.length}var p=e.parse(u,a,r);if(!p)return null;r=r||p.type,o.push(p)}var d=e.parse(t[1],1,J);if(!d)return null;var v=e.parse(t[t.length-1],t.length-1,r);return v?"value"!==d.type.kind&&e.concat(1).checkSubtype(n,d.type)?null:new ee(n,r,d,i,o,v):null},ee.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(lt(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},ee.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},ee.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},ee.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],n=[],r={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i],s=r[t.cases[a]];void 0===s?(r[t.cases[a]]=n.length,n.push([t.cases[a],[a]])):n[s][1].push(a)}for(var u=function(e){return"number"===t.inputType.kind?Number(e):e},c=0,l=n;c<l.length;c+=1){var f=l[c],h=f[0],p=f[1];1===p.length?e.push(u(p[0])):e.push(p.map(u)),e.push(t.outputs[h].serialize())}return e.push(this.otherwise.serialize()),e};var ne=function(t,e,n){this.type=t,this.branches=e,this.otherwise=n};function re(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function ie(t,e,n,r){return 0===r.compare(e,n)}function oe(t,e,n){var r="=="!==t&&"!="!==t;return function(){function i(t,e,n){this.type=H,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],o=e.parse(t[1],1,J);if(!o)return null;if(!re(n,o.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+et(o.type)+"'.");var a=e.parse(t[2],2,J);if(!a)return null;if(!re(n,a.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+et(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot compare types '"+et(o.type)+"' and '"+et(a.type)+"'.");r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new vt(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new vt(o.type,[a])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Q)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var s=lt(o),u=lt(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new pt('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var c=lt(o),l=lt(a);if("string"!==c.kind||"string"!==l.kind)return e(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):e(i,o,a)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.possibleOutputs=function(){return[!0,!1]},i.prototype.serialize=function(){var e=[t];return this.eachChild(function(t){e.push(t.serialize())}),e},i}()}ne.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var r=[],i=1;i<t.length-1;i+=2){var o=e.parse(t[i],i,H);if(!o)return null;var a=e.parse(t[i+1],i+1,n);if(!a)return null;r.push([o,a]),n=n||a.type}var s=e.parse(t[t.length-1],t.length-1,n);return s?new ne(n,r,s):null},ne.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];if(i.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},ne.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var r=n[e],i=r[0],o=r[1];t(i),t(o)}t(this.otherwise)},ne.prototype.possibleOutputs=function(){return(t=[]).concat.apply(t,this.branches.map(function(t){return t[0],t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t},ne.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var ae=oe("==",function(t,e,n){return e===n},ie),se=oe("!=",function(t,e,n){return e!==n},function(t,e,n,r){return!ie(0,e,n,r)}),ue=oe("<",function(t,e,n){return e<n},function(t,e,n,r){return r.compare(e,n)<0}),ce=oe(">",function(t,e,n){return e>n},function(t,e,n,r){return r.compare(e,n)>0}),le=oe("<=",function(t,e,n){return e<=n},function(t,e,n,r){return r.compare(e,n)<=0}),fe=oe(">=",function(t,e,n){return e>=n},function(t,e,n,r){return r.compare(e,n)>=0}),he=function(t){this.type=Z,this.input=t};he.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+et(n.type)+" instead."):new he(n):null},he.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new pt("Expected value to be of type string or array, but found "+et(lt(e))+" instead.")},he.prototype.eachChild=function(t){t(this.input)},he.prototype.possibleOutputs=function(){return[void 0]},he.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var pe={"==":ae,"!=":se,">":ce,"<":ue,">=":fe,"<=":le,array:vt,at:te,boolean:vt,case:ne,coalesce:Qt,collator:wt,format:gt,interpolate:Kt,"interpolate-hcl":Kt,"interpolate-lab":Kt,length:he,let:$t,literal:ht,match:ee,number:vt,object:vt,step:Ct,string:vt,"to-boolean":yt,"to-color":yt,"to-number":yt,"to-string":yt,var:Tt};function de(t,e){var n=e[0],r=e[1],i=e[2],o=e[3];n=n.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);var a=o?o.evaluate(t):1,s=ct(n,r,i,a);if(s)throw new pt(s);return new ot(n/255*a,r/255*a,i/255*a,a)}function ve(t,e){return t in e}function ge(t,e){var n=e[t];return void 0===n?null:n}function me(t){return{type:t}}function ye(t){return{result:"success",value:t}}function _e(t){return{result:"error",value:t}}function be(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function xe(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function we(t){return!!t.expression&&t.expression.interpolated}function Ee(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Se(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Pe(t){return t}function Te(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Ae(t,e,n,r,i){return Te(typeof n===i?r[n]:void 0,t.default,e.default)}function ke(t,e,n){if("number"!==Ee(n))return Te(t.default,e.default);var r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];var i=Me(t.stops,n);return t.stops[i][1]}function Ce(t,e,n){var r=void 0!==t.base?t.base:1;if("number"!==Ee(n))return Te(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];var o=Me(t.stops,n),a=function(t,e,n,r){var i=r-n,o=t-n;return 0===i?0:1===e?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}(n,r,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],u=t.stops[o+1][1],c=Mt[e.type]||Pe;if(t.colorSpace&&"rgb"!==t.colorSpace){var l=Yt[t.colorSpace];c=function(t,e){return l.reverse(l.interpolate(l.forward(t),l.forward(e),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=s.evaluate.apply(void 0,t),r=u.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==r)return c(n,r,a)}}:c(s,u,a)}function Oe(t,e,n){return"color"===e.type?n=ot.parse(n):"formatted"===e.type?n=ut.fromString(n.toString()):Ee(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),Te(n,t.default,e.default)}function Me(t,e){for(var n,r,i=0,o=t.length-1,a=0;i<=o;){if(n=t[a=Math.floor((i+o)/2)][0],r=t[a+1][0],e===n||e>n&&e<r)return a;n<e?i=a+1:n>e&&(o=a-1)}return Math.max(a-1,0)}xt.register(pe,{error:[{kind:"error"},[X],function(t,e){var n=e[0];throw new pt(n.evaluate(t))}],typeof:[X,[J],function(t,e){return et(lt(e[0].evaluate(t)))}],"to-rgba":[tt(Z,4),[Y],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Y,[Z,Z,Z],de],rgba:[Y,[Z,Z,Z,Z],de],has:{type:H,overloads:[[[X],function(t,e){return ve(e[0].evaluate(t),t.properties())}],[[X,K],function(t,e){var n=e[0],r=e[1];return ve(n.evaluate(t),r.evaluate(t))}]]},get:{type:J,overloads:[[[X],function(t,e){return ge(e[0].evaluate(t),t.properties())}],[[X,K],function(t,e){var n=e[0],r=e[1];return ge(n.evaluate(t),r.evaluate(t))}]]},"feature-state":[J,[X],function(t,e){return ge(e[0].evaluate(t),t.featureState||{})}],properties:[K,[],function(t){return t.properties()}],"geometry-type":[X,[],function(t){return t.geometryType()}],id:[J,[],function(t){return t.id()}],zoom:[Z,[],function(t){return t.globals.zoom}],"heatmap-density":[Z,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Z,[],function(t){return t.globals.lineProgress||0}],"+":[Z,me(Z),function(t,e){for(var n=0,r=0,i=e;r<i.length;r+=1)n+=i[r].evaluate(t);return n}],"*":[Z,me(Z),function(t,e){for(var n=1,r=0,i=e;r<i.length;r+=1)n*=i[r].evaluate(t);return n}],"-":{type:Z,overloads:[[[Z,Z],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)-r.evaluate(t)}],[[Z],function(t,e){return-e[0].evaluate(t)}]]},"/":[Z,[Z,Z],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)/r.evaluate(t)}],"%":[Z,[Z,Z],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)%r.evaluate(t)}],ln2:[Z,[],function(){return Math.LN2}],pi:[Z,[],function(){return Math.PI}],e:[Z,[],function(){return Math.E}],"^":[Z,[Z,Z],function(t,e){var n=e[0],r=e[1];return Math.pow(n.evaluate(t),r.evaluate(t))}],sqrt:[Z,[Z],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[Z,[Z],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN10}],ln:[Z,[Z],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[Z,[Z],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN2}],sin:[Z,[Z],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[Z,[Z],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[Z,[Z],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[Z,[Z],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[Z,[Z],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[Z,[Z],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[Z,me(Z),function(t,e){return Math.min.apply(Math,e.map(function(e){return e.evaluate(t)}))}],max:[Z,me(Z),function(t,e){return Math.max.apply(Math,e.map(function(e){return e.evaluate(t)}))}],abs:[Z,[Z],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[Z,[Z],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Z,[Z],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[Z,[Z],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[H,[X,J],function(t,e){var n=e[0],r=e[1];return t.properties()[n.value]===r.value}],"filter-id-==":[H,[J],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[H,[X],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[H,[X,J],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<o}],"filter-id-<":[H,[J],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[H,[X,J],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>o}],"filter-id->":[H,[J],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[H,[X,J],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[H,[J],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[H,[X,J],function(t,e){var n=e[0],r=e[1],i=t.properties()[n.value],o=r.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[H,[J],function(t,e){var n=e[0],r=t.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[H,[J],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[H,[],function(t){return null!==t.id()}],"filter-type-in":[H,[tt(X)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[H,[tt(J)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[H,[X,tt(J)],function(t,e){var n=e[0];return e[1].value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[H,[X,tt(J)],function(t,e){var n=e[0],r=e[1];return function(t,e,n,r){for(;n<=r;){var i=n+r>>1;if(e[i]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1}(t.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:H,overloads:[[[H,H],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)&&r.evaluate(t)}],[me(H),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(!r[n].evaluate(t))return!1;return!0}]]},any:{type:H,overloads:[[[H,H],function(t,e){var n=e[0],r=e[1];return n.evaluate(t)||r.evaluate(t)}],[me(H),function(t,e){for(var n=0,r=e;n<r.length;n+=1)if(r[n].evaluate(t))return!0;return!1}]]},"!":[H,[H],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[H,[X],function(t,e){var n=e[0],r=t.globals&&t.globals.isSupportedScript;return!r||r(n.evaluate(t))}],upcase:[X,[X],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[X,[X],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[X,me(J),function(t,e){return e.map(function(e){return ft(e.evaluate(t))}).join("")}],"resolved-locale":[X,[Q],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Ie=function(t,e){var n;this.expression=t,this._warningHistory={},this._evaluator=new bt,this._defaultValue="color"===(n=e).type&&Se(n.default)?new ot(0,0,0,0):"color"===n.type?ot.parse(n.default)||null:void 0===n.default?null:n.default,this._enumValues="enum"===e.type?e.values:null};function Le(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in pe}function Re(t,e){var n=new At(pe,[],function(t){var e={color:Y,string:X,number:Z,enum:X,boolean:H,formatted:$};return"array"===t.type?tt(e[t.value]||J,t.length):e[t.type]}(e)),r=n.parse(t,void 0,void 0,void 0,"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?ye(new Ie(r,e)):_e(n.errors)}Ie.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this.expression.evaluate(this._evaluator)},Ie.prototype.evaluate=function(t,e,n){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null;try{var r=this.expression.evaluate(this._evaluator);if(null===r||void 0===r)return this._defaultValue;if(this._enumValues&&!(r in this._enumValues))throw new pt("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(r)+" instead.");return r}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var je=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!St(e.expression)};je.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n)},je.prototype.evaluate=function(t,e,n){return this._styleExpression.evaluate(t,e,n)};var ze=function(t,e,n){this.kind=t,this.zoomStops=n.labels,this._styleExpression=e,this.isStateDependent="camera"!==t&&!St(e.expression),n instanceof Kt&&(this._interpolationType=n.interpolation)};function De(t,e){if("error"===(t=Re(t,e)).result)return t;var n=t.value.expression,r=Et(n);if(!r&&!be(e))return _e([new G("","data expressions not supported")]);var i=Pt(n,["zoom"]);if(!i&&!xe(e))return _e([new G("","zoom expressions not supported")]);var o=function t(e){var n=null;if(e instanceof $t)n=t(e.result);else if(e instanceof Qt)for(var r=0,i=e.args;r<i.length;r+=1){var o=i[r];if(n=t(o))break}else(e instanceof Ct||e instanceof Kt)&&e.input instanceof xt&&"zoom"===e.input.name&&(n=e);return n instanceof G?n:(e.eachChild(function(e){var r=t(e);r instanceof G?n=r:!n&&r?n=new G("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new G("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n)}(n);return o||i?o instanceof G?_e([o]):o instanceof Kt&&!we(e)?_e([new G("",'"interpolate" expressions cannot be used with this property')]):ye(o?new ze(r?"camera":"composite",t.value,o):new je(r?"constant":"source",t.value)):_e([new G("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}ze.prototype.evaluateWithoutErrorHandling=function(t,e,n){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n)},ze.prototype.evaluate=function(t,e,n){return this._styleExpression.evaluate(t,e,n)},ze.prototype.interpolationFactor=function(t,e,n){return this._interpolationType?Kt.interpolationFactor(this._interpolationType,t,e,n):0};var Fe=function(t,e){this._parameters=t,this._specification=e,B(this,function t(e,n){var r,i,o,a="color"===n.type,s=e.stops&&"object"==typeof e.stops[0][0],u=s||void 0!==e.property,c=s||!u,l=e.type||(we(n)?"exponential":"interval");if(a&&((e=B({},e)).stops&&(e.stops=e.stops.map(function(t){return[t[0],ot.parse(t[1])]})),e.default?e.default=ot.parse(e.default):e.default=ot.parse(n.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Yt[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===l)r=Ce;else if("interval"===l)r=ke;else if("categorical"===l){r=Ae,i=Object.create(null);for(var f=0,h=e.stops;f<h.length;f+=1){var p=h[f];i[p[0]]=p[1]}o=typeof e.stops[0][0]}else{if("identity"!==l)throw new Error('Unknown function type "'+l+'"');r=Oe}if(s){for(var d={},v=[],g=0;g<e.stops.length;g++){var m=e.stops[g],y=m[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:e.type,property:e.property,default:e.default,stops:[]},v.push(y)),d[y].stops.push([m[0].value,m[1]])}for(var _=[],b=0,x=v;b<x.length;b+=1){var w=x[b];_.push([d[w].zoom,t(d[w],n)])}return{kind:"composite",interpolationFactor:Kt.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:_.map(function(t){return t[0]}),evaluate:function(t,r){var i=t.zoom;return Ce({stops:_,base:e.base},n,i).evaluate(i,r)}}}return c?{kind:"camera",interpolationFactor:"exponential"===l?Kt.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==e.base?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(t){return t[0]}),evaluate:function(t){var a=t.zoom;return r(e,n,a,i,o)}}:{kind:"source",evaluate:function(t,a){var s=a&&a.properties?a.properties[e.property]:void 0;return void 0===s?Te(e.default,n.default):r(e,n,s,i,o)}}}(this._parameters,this._specification))};function Ne(t,e){if(Se(t))return new Fe(t,e);if(Le(t)){var n=De(t,e);if("error"===n.result)throw new Error(n.value.map(function(t){return t.key+": "+t.message}).join(", "));return n.value}var r=t;return"string"==typeof t&&"color"===e.type&&(r=ot.parse(t)),{kind:"constant",evaluate:function(){return r}}}function Be(t){var e=t.key,n=t.value,r=t.valueSpec||{},i=t.objectElementValidators||{},o=t.style,a=t.styleSpec,s=[],u=Ee(n);if("object"!==u)return[new F(e,n,"object expected, "+u+" found")];for(var c in n){var l=c.split(".")[0],f=r[l]||r["*"],h=void 0;if(i[l])h=i[l];else if(r[l])h=fn;else if(i["*"])h=i["*"];else{if(!r["*"]){s.push(new F(e,n[c],'unknown property "'+c+'"'));continue}h=fn}s=s.concat(h({key:(e?e+".":e)+c,value:n[c],valueSpec:f,style:o,styleSpec:a,object:n,objectKey:c},n))}for(var p in r)i[p]||r[p].required&&void 0===r[p].default&&void 0===n[p]&&s.push(new F(e,n,'missing required property "'+p+'"'));return s}function Ue(t){var e=t.value,n=t.valueSpec,r=t.style,i=t.styleSpec,o=t.key,a=t.arrayElementValidator||fn;if("array"!==Ee(e))return[new F(o,e,"array expected, "+Ee(e)+" found")];if(n.length&&e.length!==n.length)return[new F(o,e,"array length "+n.length+" expected, length "+e.length+" found")];if(n["min-length"]&&e.length<n["min-length"])return[new F(o,e,"array length at least "+n["min-length"]+" expected, length "+e.length+" found")];var s={type:n.value};i.$version<7&&(s.function=n.function),"object"===Ee(n.value)&&(s=n.value);for(var u=[],c=0;c<e.length;c++)u=u.concat(a({array:e,arrayIndex:c,value:e[c],valueSpec:s,style:r,styleSpec:i,key:o+"["+c+"]"}));return u}function Ve(t){var e=t.key,n=t.value,r=t.valueSpec,i=Ee(n);return"number"!==i?[new F(e,n,"number expected, "+i+" found")]:"minimum"in r&&n<r.minimum?[new F(e,n,n+" is less than the minimum value "+r.minimum)]:"maximum"in r&&n>r.maximum?[new F(e,n,n+" is greater than the maximum value "+r.maximum)]:[]}function Ge(t){var e,n,r,i=t.valueSpec,o=U(t.value.type),a={},s="categorical"!==o&&void 0===t.value.property,u=!s,c="array"===Ee(t.value.stops)&&"array"===Ee(t.value.stops[0])&&"object"===Ee(t.value.stops[0][0]),l=Be({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===o)return[new F(t.key,t.value,'identity function may not have a "stops" property')];var e=[],n=t.value;return e=e.concat(Ue({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:f})),"array"===Ee(n)&&0===n.length&&e.push(new F(t.key,n,"array must have at least one stop")),e},default:function(t){return fn({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===o&&s&&l.push(new F(t.key,t.value,'missing required property "property"')),"identity"===o||t.value.stops||l.push(new F(t.key,t.value,'missing required property "stops"')),"exponential"===o&&t.valueSpec.expression&&!we(t.valueSpec)&&l.push(new F(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!be(t.valueSpec)?l.push(new F(t.key,t.value,"property functions not supported")):s&&!xe(t.valueSpec)&&l.push(new F(t.key,t.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==t.value.property||l.push(new F(t.key,t.value,'"property" property is required')),l;function f(t){var e=[],o=t.value,s=t.key;if("array"!==Ee(o))return[new F(s,o,"array expected, "+Ee(o)+" found")];if(2!==o.length)return[new F(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==Ee(o[0]))return[new F(s,o,"object expected, "+Ee(o[0])+" found")];if(void 0===o[0].zoom)return[new F(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new F(s,o,"object stop key must have value")];if(r&&r>U(o[0].zoom))return[new F(s,o[0].zoom,"stop zoom values must appear in ascending order")];U(o[0].zoom)!==r&&(r=U(o[0].zoom),n=void 0,a={}),e=e.concat(Be({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Ve,value:h}}))}else e=e.concat(h({key:s+"[0]",value:o[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},o));return e.concat(fn({key:s+"[1]",value:o[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function h(t,r){var s=Ee(t.value),u=U(t.value),c=null!==t.value?t.value:r;if(e){if(s!==e)return[new F(t.key,c,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new F(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var l="number expected, "+s+" found";return be(i)&&void 0===o&&(l+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new F(t.key,c,l)]}return"categorical"!==o||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==o&&"number"===s&&void 0!==n&&u<n?[new F(t.key,c,"stop domain values must appear in ascending order")]:(n=u,"categorical"===o&&u in a?[new F(t.key,c,"stop domain values must be unique")]:(a[u]=!0,[])):[new F(t.key,c,"integer expected, found "+u)]}}function qe(t){var e=("property"===t.expressionContext?De:Re)(V(t.value),t.valueSpec);return"error"===e.result?e.value.map(function(e){return new F(""+t.key+e.key,t.value,e.message)}):"property"===t.expressionContext&&"text-font"===t.propertyKey&&-1!==e.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new F(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')]:"property"!==t.expressionContext||"layout"!==t.propertyType||St(e.value._styleExpression.expression)?[]:[new F(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')]}function We(t){var e=t.key,n=t.value,r=t.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(U(n))&&i.push(new F(e,n,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(r.values).indexOf(U(n))&&i.push(new F(e,n,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}function Ze(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,n=t.slice(1);e<n.length;e+=1){var r=n[e];if(!Ze(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}Fe.deserialize=function(t){return new Fe(t._parameters,t._specification)},Fe.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var Xe={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function He(t){if(null===t||void 0===t)return function(){return!0};Ze(t)||(t=Ke(t));var e=Re(t,Xe);if("error"===e.result)throw new Error(e.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,n){return e.value.evaluate(t,n)}}function Ye(t,e){return t<e?-1:t>e?1:0}function Ke(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?Je(t[1],t[2],"=="):"!="===n?tn(Je(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?Je(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(Ke))):"all"===n?["all"].concat(t.slice(1).map(Ke)):"none"===n?["all"].concat(t.slice(1).map(Ke).map(tn)):"in"===n?Qe(t[1],t.slice(2)):"!in"===n?tn(Qe(t[1],t.slice(2))):"has"===n?$e(t[1]):"!has"!==n||tn($e(t[1]))}function Je(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function Qe(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Ye)]]:["filter-in-small",t,["literal",e]]}}function $e(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function tn(t){return["!",t]}function en(t){return Ze(V(t.value))?qe(B({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var n=e.value,r=e.key;if("array"!==Ee(n))return[new F(r,n,"array expected, "+Ee(n)+" found")];var i,o=e.styleSpec,a=[];if(n.length<1)return[new F(r,n,"filter array must have at least 1 element")];switch(a=a.concat(We({key:r+"[0]",value:n[0],valueSpec:o.filter_operator,style:e.style,styleSpec:e.styleSpec})),U(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===U(n[1])&&a.push(new F(r,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new F(r,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(i=Ee(n[1]))&&a.push(new F(r+"[1]",n[1],"string expected, "+i+" found"));for(var s=2;s<n.length;s++)i=Ee(n[s]),"$type"===U(n[1])?a=a.concat(We({key:r+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new F(r+"["+s+"]",n[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var u=1;u<n.length;u++)a=a.concat(t({key:r+"["+u+"]",value:n[u],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Ee(n[1]),2!==n.length?a.push(new F(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new F(r+"[1]",n[1],"string expected, "+i+" found"))}return a}(t)}function nn(t,e){var n=t.key,r=t.style,i=t.styleSpec,o=t.value,a=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var u=a.match(/^(.*)-transition$/);if("paint"===e&&u&&s[u[1]]&&s[u[1]].transition)return fn({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});var c,l=t.valueSpec||s[a];if(!l)return[new F(n,o,'unknown property "'+a+'"')];if("string"===Ee(o)&&be(l)&&!l.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new F(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var f=[];return"symbol"===t.layerType&&("text-field"===a&&r&&!r.glyphs&&f.push(new F(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Se(V(o))&&"identity"===U(o.type)&&f.push(new F(n,o,'"text-font" does not support identity functions'))),f.concat(fn({key:t.key,value:o,valueSpec:l,style:r,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:a}))}function rn(t){return nn(t,"paint")}function on(t){return nn(t,"layout")}function an(t){var e=[],n=t.value,r=t.key,i=t.style,o=t.styleSpec;n.type||n.ref||e.push(new F(r,n,'either "type" or "ref" is required'));var a,s=U(n.type),u=U(n.ref);if(n.id)for(var c=U(n.id),l=0;l<t.arrayIndex;l++){var f=i.layers[l];U(f.id)===c&&e.push(new F(r,n.id,'duplicate layer id "'+n.id+'", previously used at line '+f.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach(function(t){t in n&&e.push(new F(r,n[t],'"'+t+'" is prohibited for ref layers'))}),i.layers.forEach(function(t){U(t.id)===u&&(a=t)}),a?a.ref?e.push(new F(r,n.ref,"ref cannot reference another ref layer")):s=U(a.type):e.push(new F(r,n.ref,'ref layer "'+u+'" not found'));else if("background"!==s)if(n.source){var h=i.sources&&i.sources[n.source],p=h&&U(h.type);h?"vector"===p&&"raster"===s?e.push(new F(r,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===p&&"raster"!==s?e.push(new F(r,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==p||n["source-layer"]?"raster-dem"===p&&"hillshade"!==s?e.push(new F(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===p&&h.lineMetrics||e.push(new F(r,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new F(r,n,'layer "'+n.id+'" must specify a "source-layer"')):e.push(new F(r,n.source,'source "'+n.source+'" not found'))}else e.push(new F(r,n,'missing required property "source"'));return e=e.concat(Be({key:r,value:n,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return fn({key:r+".type",value:n.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"})},filter:en,layout:function(t){return Be({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return on(B({layerType:s},t))}}})},paint:function(t){return Be({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return rn(B({layerType:s},t))}}})}}}))}function sn(t){var e=t.value,n=t.key,r=t.styleSpec,i=t.style;if(!e.type)return[new F(n,e,'"type" is required')];var o=U(e.type),a=[];switch(o){case"vector":case"raster":case"raster-dem":if(a=a.concat(Be({key:n,value:e,valueSpec:r["source_"+o.replace("-","_")],style:t.style,styleSpec:r})),"url"in e)for(var s in e)["type","url","tileSize"].indexOf(s)<0&&a.push(new F(n+"."+s,e[s],'a source with a "url" property may not include a "'+s+'" property'));return a;case"geojson":return Be({key:n,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r});case"video":return Be({key:n,value:e,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return Be({key:n,value:e,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return a.push(new F(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),a;default:return We({key:n+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function un(t){var e=t.value,n=t.styleSpec,r=n.light,i=t.style,o=[],a=Ee(e);if(void 0===e)return o;if("object"!==a)return o.concat([new F("light",e,"object expected, "+a+" found")]);for(var s in e){var u=s.match(/^(.*)-transition$/);o=u&&r[u[1]]&&r[u[1]].transition?o.concat(fn({key:s,value:e[s],valueSpec:n.transition,style:i,styleSpec:n})):r[s]?o.concat(fn({key:s,value:e[s],valueSpec:r[s],style:i,styleSpec:n})):o.concat([new F(s,e[s],'unknown property "'+s+'"')])}return o}function cn(t){var e=t.value,n=t.key,r=Ee(e);return"string"!==r?[new F(n,e,"string expected, "+r+" found")]:[]}var ln={"*":function(){return[]},array:Ue,boolean:function(t){var e=t.value,n=t.key,r=Ee(e);return"boolean"!==r?[new F(n,e,"boolean expected, "+r+" found")]:[]},number:Ve,color:function(t){var e=t.key,n=t.value,r=Ee(n);return"string"!==r?[new F(e,n,"color expected, "+r+" found")]:null===it(n)?[new F(e,n,'color expected, "'+n+'" found')]:[]},constants:N,enum:We,filter:en,function:Ge,layer:an,object:Be,source:sn,light:un,string:cn,formatted:function(t){return 0===cn(t).length?[]:qe(t)}};function fn(t){var e=t.value,n=t.valueSpec,r=t.styleSpec;return n.expression&&Se(U(e))?Ge(t):n.expression&&Le(V(e))?qe(t):n.type&&ln[n.type]?ln[n.type](t):Be(B({},t,{valueSpec:n.type?r[n.type]:n}))}function hn(t){var e=t.value,n=t.key,r=cn(t);return r.length?r:(-1===e.indexOf("{fontstack}")&&r.push(new F(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new F(n,e,'"glyphs" url must include a "{range}" token')),r)}function pn(t,e){e=e||D;var n=[];return n=n.concat(fn({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:hn,"*":function(){return[]}}})),t.constants&&(n=n.concat(N({key:"constants",value:t.constants,style:t,styleSpec:e}))),dn(n)}function dn(t){return[].concat(t).sort(function(t,e){return t.line-e.line})}function vn(t){return function(){return dn(t.apply(this,arguments))}}pn.source=vn(sn),pn.light=vn(un),pn.layer=vn(an),pn.filter=vn(en),pn.paintProperty=vn(rn),pn.layoutProperty=vn(on);var gn=pn,mn=pn.light,yn=pn.paintProperty,_n=pn.layoutProperty;function bn(t,e){var n=!1;if(e&&e.length)for(var r=0,i=e;r<i.length;r+=1){var o=i[r];t.fire(new j(new Error(o.message))),n=!0}return n}var xn=En,wn=3;function En(t,e,n){var r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],e=i[1],n=i[2],this.d=e+2*n;for(var o=0;o<this.d*this.d;o++){var a=i[wn+o],s=i[wn+o+1];r.push(a===s?null:i.subarray(a,s))}var u=i[wn+r.length],c=i[wn+r.length+1];this.keys=i.subarray(u,c),this.bboxes=i.subarray(c),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var l=0;l<this.d*this.d;l++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var f=n/e*t;this.min=-f,this.max=t+f}En.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},En.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},En.prototype._insertCell=function(t,e,n,r,i,o){this.cells[i].push(o)},En.prototype.query=function(t,e,n,r){var i=this.min,o=this.max;if(t<=i&&e<=i&&o<=n&&o<=r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(t,e,n,r,this._queryCell,a,{}),a},En.prototype._queryCell=function(t,e,n,r,i,o,a){var s=this.cells[i];if(null!==s)for(var u=this.keys,c=this.bboxes,l=0;l<s.length;l++){var f=s[l];if(void 0===a[f]){var h=4*f;t<=c[h+2]&&e<=c[h+3]&&n>=c[h+0]&&r>=c[h+1]?(a[f]=!0,o.push(u[f])):a[f]=!1}}},En.prototype._forEachCell=function(t,e,n,r,i,o,a){for(var s=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(n),l=this._convertToCellCoord(r),f=s;f<=c;f++)for(var h=u;h<=l;h++){var p=this.d*h+f;if(i.call(this,t,e,n,r,p,o,a))return}},En.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},En.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=wn+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];i[wn+a]=o,i.set(s,o),o+=s.length}return i[wn+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[wn+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var Sn=self.ImageData,Pn={};function Tn(t,e,n){void 0===n&&(n={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Pn[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}for(var An in Tn("Object",Object),xn.serialize=function(t,e){var n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},xn.deserialize=function(t){return new xn(t.buffer)},Tn("Grid",xn),Tn("Color",ot),Tn("Error",Error),Tn("StylePropertyFunction",Fe),Tn("StyleExpression",Ie,{omit:["_evaluator"]}),Tn("ZoomDependentExpression",ze),Tn("ZoomConstantExpression",je),Tn("CompoundExpression",xt,{omit:["_evaluate"]}),pe)pe[An]._classRegistryKey||Tn("Expression_"+An,pe[An]);function kn(t,e){if(null===t||void 0===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(t instanceof ArrayBuffer)return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var n=t;return e&&e.push(n.buffer),n}if(t instanceof Sn)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var r=[],i=0,o=t;i<o.length;i+=1){var a=o[i];r.push(kn(a,e))}return r}if("object"==typeof t){var s=t.constructor,u=s._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");var c=s.serialize?s.serialize(t,e):{};if(!s.serialize){for(var l in t)if(t.hasOwnProperty(l)&&!(Pn[u].omit.indexOf(l)>=0)){var f=t[l];c[l]=Pn[u].shallow.indexOf(l)>=0?f:kn(f,e)}t instanceof Error&&(c.message=t.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(c.$name=u),c}throw new Error("can't serialize object of type "+typeof t)}function Cn(t){if(null===t||void 0===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||t instanceof Sn)return t;if(Array.isArray(t))return t.map(Cn);if("object"==typeof t){var e=t.$name||"Object",n=Pn[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(t);for(var r=Object.create(n.prototype),i=0,o=Object.keys(t);i<o.length;i+=1){var a=o[i];if("$name"!==a){var s=t[a];r[a]=Pn[e].shallow.indexOf(a)>=0?s:Cn(s)}}return r}throw new Error("can't deserialize object of type "+typeof t)}var On=function(){this.first=!0};On.prototype.update=function(t,e){var n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))};var Mn={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function In(t){for(var e=0,n=t;e<n.length;e+=1)if(Rn(n[e].charCodeAt(0)))return!0;return!1}function Ln(t){return!(Mn.Arabic(t)||Mn["Arabic Supplement"](t)||Mn["Arabic Extended-A"](t)||Mn["Arabic Presentation Forms-A"](t)||Mn["Arabic Presentation Forms-B"](t))}function Rn(t){return!(746!==t&&747!==t&&(t<4352||!(Mn["Bopomofo Extended"](t)||Mn.Bopomofo(t)||Mn["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Mn["CJK Compatibility Ideographs"](t)||Mn["CJK Compatibility"](t)||Mn["CJK Radicals Supplement"](t)||Mn["CJK Strokes"](t)||!(!Mn["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Mn["CJK Unified Ideographs Extension A"](t)||Mn["CJK Unified Ideographs"](t)||Mn["Enclosed CJK Letters and Months"](t)||Mn["Hangul Compatibility Jamo"](t)||Mn["Hangul Jamo Extended-A"](t)||Mn["Hangul Jamo Extended-B"](t)||Mn["Hangul Jamo"](t)||Mn["Hangul Syllables"](t)||Mn.Hiragana(t)||Mn["Ideographic Description Characters"](t)||Mn.Kanbun(t)||Mn["Kangxi Radicals"](t)||Mn["Katakana Phonetic Extensions"](t)||Mn.Katakana(t)&&12540!==t||!(!Mn["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Mn["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Mn["Unified Canadian Aboriginal Syllabics"](t)||Mn["Unified Canadian Aboriginal Syllabics Extended"](t)||Mn["Vertical Forms"](t)||Mn["Yijing Hexagram Symbols"](t)||Mn["Yi Syllables"](t)||Mn["Yi Radicals"](t))))}function jn(t){return!(Rn(t)||function(t){return!!(Mn["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Mn["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Mn["Letterlike Symbols"](t)||Mn["Number Forms"](t)||Mn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Mn["Control Pictures"](t)&&9251!==t||Mn["Optical Character Recognition"](t)||Mn["Enclosed Alphanumerics"](t)||Mn["Geometric Shapes"](t)||Mn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Mn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Mn["CJK Symbols and Punctuation"](t)||Mn.Katakana(t)||Mn["Private Use Area"](t)||Mn["CJK Compatibility Forms"](t)||Mn["Small Form Variants"](t)||Mn["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function zn(t,e){return!(!e&&(t>=1424&&t<=2303||Mn["Arabic Presentation Forms-A"](t)||Mn["Arabic Presentation Forms-B"](t))||t>=2304&&t<=3583||t>=3840&&t<=4255||Mn.Khmer(t))}var Dn,Fn=!1,Nn=null,Bn=!1,Un=new z,Vn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Bn||null!=Vn.applyArabicShaping}},Gn=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new On,this.transition={})};Gn.prototype.isSupportedScript=function(t){return function(t,e){for(var n=0,r=t;n<r.length;n+=1)if(!zn(r[n].charCodeAt(0),e))return!1;return!0}(t,Vn.isLoaded())},Gn.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Gn.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}};var qn=function(t,e){this.property=t,this.value=e,this.expression=Ne(void 0===e?t.specification.default:e,t.specification)};qn.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},qn.prototype.possiblyEvaluate=function(t){return this.property.possiblyEvaluate(this,t)};var Wn=function(t){this.property=t,this.value=new qn(t,void 0)};Wn.prototype.transitioned=function(t,e){return new Xn(this.property,this.value,e,f({},t.transition,this.transition),t.now)},Wn.prototype.untransitioned=function(){return new Xn(this.property,this.value,null,{},0)};var Zn=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};Zn.prototype.getValue=function(t){return y(this._values[t].value.value)},Zn.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Wn(this._values[t].property)),this._values[t].value=new qn(this._values[t].property,null===e?void 0:y(e))},Zn.prototype.getTransition=function(t){return y(this._values[t].transition)},Zn.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new Wn(this._values[t].property)),this._values[t].transition=y(e)||void 0},Zn.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i);var o=this.getTransition(r);void 0!==o&&(t[r+"-transition"]=o)}return t},Zn.prototype.transitioned=function(t,e){for(var n=new Hn(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].transitioned(t,e._values[o])}return n},Zn.prototype.untransitioned=function(){for(var t=new Hn(this._properties),e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e];t._values[r]=this._values[r].untransitioned()}return t};var Xn=function(t,e,n,r,i){this.property=t,this.value=e,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=n)};Xn.prototype.possiblyEvaluate=function(t){var e=t.now||0,n=this.value.possiblyEvaluate(t),r=this.prior;if(r){if(e>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(e<this.begin)return r.possiblyEvaluate(t);var i=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(r.possiblyEvaluate(t),n,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(i))}return n};var Hn=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Hn.prototype.possiblyEvaluate=function(t){for(var e=new Jn(this._properties),n=0,r=Object.keys(this._values);n<r.length;n+=1){var i=r[n];e._values[i]=this._values[i].possiblyEvaluate(t)}return e},Hn.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1){var n=e[t];if(this._values[n].prior)return!0}return!1};var Yn=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Yn.prototype.getValue=function(t){return y(this._values[t].value)},Yn.prototype.setValue=function(t,e){this._values[t]=new qn(this._values[t].property,null===e?void 0:y(e))},Yn.prototype.serialize=function(){for(var t={},e=0,n=Object.keys(this._values);e<n.length;e+=1){var r=n[e],i=this.getValue(r);void 0!==i&&(t[r]=i)}return t},Yn.prototype.possiblyEvaluate=function(t){for(var e=new Jn(this._properties),n=0,r=Object.keys(this._values);n<r.length;n+=1){var i=r[n];e._values[i]=this._values[i].possiblyEvaluate(t)}return e};var Kn=function(t,e,n){this.property=t,this.value=e,this.parameters=n};Kn.prototype.isConstant=function(){return"constant"===this.value.kind},Kn.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},Kn.prototype.evaluate=function(t,e){return this.property.evaluate(this.value,this.parameters,t,e)};var Jn=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Jn.prototype.get=function(t){return this._values[t]};var Qn=function(t){this.specification=t};Qn.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Qn.prototype.interpolate=function(t,e,n){var r=Mt[this.specification.type];return r?r(t,e,n):t};var $n=function(t){this.specification=t};$n.prototype.possiblyEvaluate=function(t,e){return"constant"===t.expression.kind||"camera"===t.expression.kind?new Kn(this,{kind:"constant",value:t.expression.evaluate(e)},e):new Kn(this,t.expression,e)},$n.prototype.interpolate=function(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Kn(this,{kind:"constant",value:void 0},t.parameters);var r=Mt[this.specification.type];return r?new Kn(this,{kind:"constant",value:r(t.value.value,e.value.value,n)},t.parameters):t},$n.prototype.evaluate=function(t,e,n,r){return"constant"===t.kind?t.value:t.evaluate(e,n,r)};var tr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(t,e){if(void 0===t.value)return new Kn(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var n=t.expression.evaluate(e),r=this._calculate(n,n,n,e);return new Kn(this,{kind:"constant",value:r},e)}if("camera"===t.expression.kind){var i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Kn(this,{kind:"constant",value:i},e)}return new Kn(this,t.expression,e)},e.prototype.evaluate=function(t,e,n,r){if("source"===t.kind){var i=t.evaluate(e,n,r);return this._calculate(i,i,i,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,r),t.evaluate({zoom:Math.floor(e.zoom)},n,r),t.evaluate({zoom:Math.floor(e.zoom)+1},n,r),e):t.value},e.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},e.prototype.interpolate=function(t){return t},e}($n),er=function(t){this.specification=t};er.prototype.possiblyEvaluate=function(t,e){if(void 0!==t.value){if("constant"===t.expression.kind){var n=t.expression.evaluate(e);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new Gn(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Gn(Math.floor(e.zoom),e)),t.expression.evaluate(new Gn(Math.floor(e.zoom+1),e)),e)}},er.prototype._calculate=function(t,e,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}},er.prototype.interpolate=function(t){return t};var nr=function(t){this.specification=t};nr.prototype.possiblyEvaluate=function(t,e){return!!t.expression.evaluate(e)},nr.prototype.interpolate=function(){return!1};var rr=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},t){var n=t[e],r=this.defaultPropertyValues[e]=new qn(n,void 0),i=this.defaultTransitionablePropertyValues[e]=new Wn(n);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}};Tn("DataDrivenProperty",$n),Tn("DataConstantProperty",Qn),Tn("CrossFadedDataDrivenProperty",tr),Tn("CrossFadedProperty",er),Tn("ColorRampProperty",nr);var ir=function(t){function e(e,n){if(t.call(this),this.id=e.id,this.type=e.type,this.visibility="visible",this._featureFilter=function(){return!0},"custom"!==e.type&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Yn(n.layout)),n.paint)){for(var r in this._transitionablePaint=new Zn(n.paint),e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,n){if(null!==e&&void 0!==e){var r="layers."+this.id+".layout."+t;if(this._validate(_n,r,t,e,n))return}"visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility="none"===e?e:"visible"},e.prototype.getPaintProperty=function(t){return v(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,n){if(null!==e&&void 0!==e){var r="layers."+this.id+".paint."+t;if(this._validate(yn,r,t,e,n))return!1}if(v(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var i=this._transitionablePaint._values[t],o="cross-faded-data-driven"===i.property.specification["property-type"]&&!i.value.value&&e,a=this._transitionablePaint._values[t].value.isDataDriven();this._transitionablePaint.setValue(t,e);var s=this._transitionablePaint._values[t].value.isDataDriven();return this._handleSpecialPaintPropertyUpdate(t),s||a||o},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t)),this.paint=this._transitioningPaint.possiblyEvaluate(t)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(t.layout=t.layout||{},t.layout.visibility="none"),m(t,function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)})},e.prototype._validate=function(t,e,n,r,i){return(!i||!1!==i.validate)&&bn(this,t.call(gn,{key:e,layerType:this.type,objectKey:n,value:r,styleSpec:D,style:{glyphs:!0,sprite:!0}}))},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof Kn&&be(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(z),or={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ar=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},sr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ur(t,e){void 0===e&&(e=1);var n=0,r=0;return{members:t.map(function(t){var i,o=(i=t.type,or[i].BYTES_PER_ELEMENT),a=n=cr(n,Math.max(e,o)),s=t.components||1;return r=Math.max(r,o),n+=o*s,{name:t.name,type:t.type,components:s,offset:a}}),size:cr(n,Math.max(r,e)),alignment:e}}function cr(t,e){return Math.ceil(t/e)*e}sr.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},sr.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},sr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},sr.prototype.clear=function(){this.length=0},sr.prototype.resize=function(t){this.reserve(t),this.length=t},sr.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},sr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var lr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var r=2*n;return this.int16[r+0]=t,this.int16[r+1]=e,n},e.prototype.emplace=function(t,e,n){var r=2*t;return this.int16[r+0]=e,this.int16[r+1]=n,t},e}(sr);lr.prototype.bytesPerElement=4,Tn("StructArrayLayout2i4",lr);var fr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;this.resize(i+1);var o=4*i;return this.int16[o+0]=t,this.int16[o+1]=e,this.int16[o+2]=n,this.int16[o+3]=r,i},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,t},e}(sr);fr.prototype.bytesPerElement=8,Tn("StructArrayLayout4i8",fr);var hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=n,this.int16[s+3]=r,this.int16[s+4]=i,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(sr);hr.prototype.bytesPerElement=12,Tn("StructArrayLayout2i4i12",hr);var pr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;this.resize(u+1);var c=6*u,l=12*u;return this.int16[c+0]=t,this.int16[c+1]=e,this.int16[c+2]=n,this.int16[c+3]=r,this.uint8[l+8]=i,this.uint8[l+9]=o,this.uint8[l+10]=a,this.uint8[l+11]=s,u},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=6*t,l=12*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.uint8[l+8]=o,this.uint8[l+9]=a,this.uint8[l+10]=s,this.uint8[l+11]=u,t},e}(sr);pr.prototype.bytesPerElement=12,Tn("StructArrayLayout4i4ub12",pr);var dr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;this.resize(u+1);var c=8*u;return this.uint16[c+0]=t,this.uint16[c+1]=e,this.uint16[c+2]=n,this.uint16[c+3]=r,this.uint16[c+4]=i,this.uint16[c+5]=o,this.uint16[c+6]=a,this.uint16[c+7]=s,u},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=8*t;return this.uint16[c+0]=e,this.uint16[c+1]=n,this.uint16[c+2]=r,this.uint16[c+3]=i,this.uint16[c+4]=o,this.uint16[c+5]=a,this.uint16[c+6]=s,this.uint16[c+7]=u,t},e}(sr);dr.prototype.bytesPerElement=16,Tn("StructArrayLayout8ui16",dr);var vr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s){var u=this.length;this.resize(u+1);var c=8*u;return this.int16[c+0]=t,this.int16[c+1]=e,this.int16[c+2]=n,this.int16[c+3]=r,this.uint16[c+4]=i,this.uint16[c+5]=o,this.uint16[c+6]=a,this.uint16[c+7]=s,u},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u){var c=8*t;return this.int16[c+0]=e,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.uint16[c+4]=o,this.uint16[c+5]=a,this.uint16[c+6]=s,this.uint16[c+7]=u,t},e}(sr);vr.prototype.bytesPerElement=16,Tn("StructArrayLayout4i4ui16",vr);var gr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;this.resize(r+1);var i=3*r;return this.float32[i+0]=t,this.float32[i+1]=e,this.float32[i+2]=n,r},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=n,this.float32[i+2]=r,t},e}(sr);gr.prototype.bytesPerElement=12,Tn("StructArrayLayout3f12",gr);var mr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.uint32[n+0]=t,e},e.prototype.emplace=function(t,e){var n=1*t;return this.uint32[n+0]=e,t},e}(sr);mr.prototype.bytesPerElement=4,Tn("StructArrayLayout1ul4",mr);var yr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l){var f=this.length;this.resize(f+1);var h=12*f,p=6*f;return this.int16[h+0]=t,this.int16[h+1]=e,this.int16[h+2]=n,this.int16[h+3]=r,this.int16[h+4]=i,this.int16[h+5]=o,this.uint32[p+3]=a,this.uint16[h+8]=s,this.uint16[h+9]=u,this.int16[h+10]=c,this.int16[h+11]=l,f},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f){var h=12*t,p=6*t;return this.int16[h+0]=e,this.int16[h+1]=n,this.int16[h+2]=r,this.int16[h+3]=i,this.int16[h+4]=o,this.int16[h+5]=a,this.uint32[p+3]=s,this.uint16[h+8]=u,this.uint16[h+9]=c,this.int16[h+10]=l,this.int16[h+11]=f,t},e}(sr);yr.prototype.bytesPerElement=24,Tn("StructArrayLayout6i1ul2ui2i24",yr);var _r=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o){var a=this.length;this.resize(a+1);var s=6*a;return this.int16[s+0]=t,this.int16[s+1]=e,this.int16[s+2]=n,this.int16[s+3]=r,this.int16[s+4]=i,this.int16[s+5]=o,a},e.prototype.emplace=function(t,e,n,r,i,o,a){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,t},e}(sr);_r.prototype.bytesPerElement=12,Tn("StructArrayLayout2i2i2i12",_r);var br=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var r=4*n;return this.uint8[r+0]=t,this.uint8[r+1]=e,n},e.prototype.emplace=function(t,e,n){var r=4*t;return this.uint8[r+0]=e,this.uint8[r+1]=n,t},e}(sr);br.prototype.bytesPerElement=4,Tn("StructArrayLayout2ub4",br);var xr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p){var d=this.length;this.resize(d+1);var v=20*d,g=10*d,m=40*d;return this.int16[v+0]=t,this.int16[v+1]=e,this.uint16[v+2]=n,this.uint16[v+3]=r,this.uint32[g+2]=i,this.uint32[g+3]=o,this.uint32[g+4]=a,this.uint16[v+10]=s,this.uint16[v+11]=u,this.uint16[v+12]=c,this.float32[g+7]=l,this.float32[g+8]=f,this.uint8[m+36]=h,this.uint8[m+37]=p,d},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p,d){var v=20*t,g=10*t,m=40*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.uint16[v+2]=r,this.uint16[v+3]=i,this.uint32[g+2]=o,this.uint32[g+3]=a,this.uint32[g+4]=s,this.uint16[v+10]=u,this.uint16[v+11]=c,this.uint16[v+12]=l,this.float32[g+7]=f,this.float32[g+8]=h,this.uint8[m+36]=p,this.uint8[m+37]=d,t},e}(sr);xr.prototype.bytesPerElement=40,Tn("StructArrayLayout2i2ui3ul3ui2f2ub40",xr);var wr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p){var d=this.length;this.resize(d+1);var v=16*d,g=8*d;return this.int16[v+0]=t,this.int16[v+1]=e,this.int16[v+2]=n,this.int16[v+3]=r,this.uint16[v+4]=i,this.uint16[v+5]=o,this.uint16[v+6]=a,this.uint16[v+7]=s,this.uint16[v+8]=u,this.uint16[v+9]=c,this.uint16[v+10]=l,this.uint16[v+11]=f,this.uint16[v+12]=h,this.uint32[g+7]=p,d},e.prototype.emplace=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p,d){var v=16*t,g=8*t;return this.int16[v+0]=e,this.int16[v+1]=n,this.int16[v+2]=r,this.int16[v+3]=i,this.uint16[v+4]=o,this.uint16[v+5]=a,this.uint16[v+6]=s,this.uint16[v+7]=u,this.uint16[v+8]=c,this.uint16[v+9]=l,this.uint16[v+10]=f,this.uint16[v+11]=h,this.uint16[v+12]=p,this.uint32[g+7]=d,t},e}(sr);wr.prototype.bytesPerElement=32,Tn("StructArrayLayout4i9ui1ul32",wr);var Er=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.float32[n+0]=t,e},e.prototype.emplace=function(t,e){var n=1*t;return this.float32[n+0]=e,t},e}(sr);Er.prototype.bytesPerElement=4,Tn("StructArrayLayout1f4",Er);var Sr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;this.resize(r+1);var i=3*r;return this.int16[i+0]=t,this.int16[i+1]=e,this.int16[i+2]=n,r},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=n,this.int16[i+2]=r,t},e}(sr);Sr.prototype.bytesPerElement=6,Tn("StructArrayLayout3i6",Sr);var Pr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;this.resize(r+1);var i=2*r,o=4*r;return this.uint32[i+0]=t,this.uint16[o+2]=e,this.uint16[o+3]=n,r},e.prototype.emplace=function(t,e,n,r){var i=2*t,o=4*t;return this.uint32[i+0]=e,this.uint16[o+2]=n,this.uint16[o+3]=r,t},e}(sr);Pr.prototype.bytesPerElement=8,Tn("StructArrayLayout1ul2ui8",Pr);var Tr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n){var r=this.length;this.resize(r+1);var i=3*r;return this.uint16[i+0]=t,this.uint16[i+1]=e,this.uint16[i+2]=n,r},e.prototype.emplace=function(t,e,n,r){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,this.uint16[i+2]=r,t},e}(sr);Tr.prototype.bytesPerElement=6,Tn("StructArrayLayout3ui6",Tr);var Ar=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var r=2*n;return this.uint16[r+0]=t,this.uint16[r+1]=e,n},e.prototype.emplace=function(t,e,n){var r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,t},e}(sr);Ar.prototype.bytesPerElement=4,Tn("StructArrayLayout2ui4",Ar);var kr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;this.resize(e+1);var n=1*e;return this.uint16[n+0]=t,e},e.prototype.emplace=function(t,e){var n=1*t;return this.uint16[n+0]=e,t},e}(sr);kr.prototype.bytesPerElement=2,Tn("StructArrayLayout1ui2",kr);var Cr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var n=this.length;this.resize(n+1);var r=2*n;return this.float32[r+0]=t,this.float32[r+1]=e,n},e.prototype.emplace=function(t,e,n){var r=2*t;return this.float32[r+0]=e,this.float32[r+1]=n,t},e}(sr);Cr.prototype.bytesPerElement=8,Tn("StructArrayLayout2f8",Cr);var Or=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,n,r){var i=this.length;this.resize(i+1);var o=4*i;return this.float32[o+0]=t,this.float32[o+1]=e,this.float32[o+2]=n,this.float32[o+3]=r,i},e.prototype.emplace=function(t,e,n,r,i){var o=4*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,t},e}(sr);Or.prototype.bytesPerElement=16,Tn("StructArrayLayout4f16",Or);var Mr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorPointY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.x1.set=function(t){this._structArray.int16[this._pos2+2]=t},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.y1.set=function(t){this._structArray.int16[this._pos2+3]=t},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.x2.set=function(t){this._structArray.int16[this._pos2+4]=t},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.y2.set=function(t){this._structArray.int16[this._pos2+5]=t},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.radius.get=function(){return this._structArray.int16[this._pos2+10]},n.radius.set=function(t){this._structArray.int16[this._pos2+10]=t},n.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},n.signedDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+11]=t},n.anchorPoint.get=function(){return new o(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,n),e}(ar);Mr.prototype.size=24;var Ir=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Mr(this,t)},e}(yr);Tn("CollisionBoxArray",Ir);var Lr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.glyphStartIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.numGlyphs.set=function(t){this._structArray.uint16[this._pos2+3]=t},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.vertexStartIndex.set=function(t){this._structArray.uint32[this._pos4+2]=t},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineStartIndex.set=function(t){this._structArray.uint32[this._pos4+3]=t},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.lineLength.set=function(t){this._structArray.uint32[this._pos4+4]=t},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.segment.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.lowerSize.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.upperSize.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetX.set=function(t){this._structArray.float32[this._pos4+7]=t},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.lineOffsetY.set=function(t){this._structArray.float32[this._pos4+8]=t},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.writingMode.set=function(t){this._structArray.uint8[this._pos1+36]=t},n.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},n.hidden.set=function(t){this._structArray.uint8[this._pos1+37]=t},Object.defineProperties(e.prototype,n),e}(ar);Lr.prototype.size=40;var Rr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Lr(this,t)},e}(xr);Tn("PlacedSymbolArray",Rr);var jr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},horizontalPlacedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorX.set=function(t){this._structArray.int16[this._pos2+0]=t},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.anchorY.set=function(t){this._structArray.int16[this._pos2+1]=t},n.horizontalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.horizontalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+2]=t},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.verticalPlacedTextSymbolIndex.set=function(t){this._structArray.int16[this._pos2+3]=t},n.key.get=function(){return this._structArray.uint16[this._pos2+4]},n.key.set=function(t){this._structArray.uint16[this._pos2+4]=t},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+5]},n.textBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+5]=t},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+6]},n.textBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+6]=t},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},n.iconBoxStartIndex.set=function(t){this._structArray.uint16[this._pos2+7]=t},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.iconBoxEndIndex.set=function(t){this._structArray.uint16[this._pos2+8]=t},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.featureIndex.set=function(t){this._structArray.uint16[this._pos2+9]=t},n.numGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+10]},n.numGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+10]=t},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+11]},n.numVerticalGlyphVertices.set=function(t){this._structArray.uint16[this._pos2+11]=t},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+12]},n.numIconVertices.set=function(t){this._structArray.uint16[this._pos2+12]=t},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+7]},n.crossTileID.set=function(t){this._structArray.uint32[this._pos4+7]=t},Object.defineProperties(e.prototype,n),e}(ar);jr.prototype.size=32;var zr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new jr(this,t)},e}(wr);Tn("SymbolInstanceArray",zr);var Dr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={offsetX:{configurable:!0}};return n.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},n.offsetX.set=function(t){this._structArray.float32[this._pos4+0]=t},Object.defineProperties(e.prototype,n),e}(ar);Dr.prototype.size=4;var Fr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e.prototype.get=function(t){return new Dr(this,t)},e}(Er);Tn("GlyphOffsetArray",Fr);var Nr=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return n.x.get=function(){return this._structArray.int16[this._pos2+0]},n.x.set=function(t){this._structArray.int16[this._pos2+0]=t},n.y.get=function(){return this._structArray.int16[this._pos2+1]},n.y.set=function(t){this._structArray.int16[this._pos2+1]=t},n.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},n.tileUnitDistanceFromAnchor.set=function(t){this._structArray.int16[this._pos2+2]=t},Object.defineProperties(e.prototype,n),e}(ar);Nr.prototype.size=6;var Br=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e.prototype.get=function(t){return new Nr(this,t)},e}(Sr);Tn("SymbolLineVertexArray",Br);var Ur=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.featureIndex.set=function(t){this._structArray.uint32[this._pos4+0]=t},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.sourceLayerIndex.set=function(t){this._structArray.uint16[this._pos2+2]=t},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},n.bucketIndex.set=function(t){this._structArray.uint16[this._pos2+3]=t},Object.defineProperties(e.prototype,n),e}(ar);Ur.prototype.size=8;var Vr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return new Ur(this,t)},e}(Pr);Tn("FeatureIndexArray",Vr);var Gr=ur([{name:"a_pos",components:2,type:"Int16"}],4),qr=Gr.members,Wr=(Gr.size,Gr.alignment,function(t){void 0===t&&(t=[]),this.segments=t});Wr.prototype.prepareSegment=function(t,e,n){var r=this.segments[this.segments.length-1];return t>Wr.MAX_VERTEX_ARRAY_LENGTH&&b("Max vertices per segment is "+Wr.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!r||r.vertexLength+t>Wr.MAX_VERTEX_ARRAY_LENGTH)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},this.segments.push(r)),r},Wr.prototype.get=function(){return this.segments},Wr.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var n=e[t];for(var r in n.vaos)n.vaos[r].destroy()}},Wr.simpleSegment=function(t,e,n,r){return new Wr([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:r,vaos:{}}])},Wr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Tn("SegmentVector",Wr);var Zr=function(t,e){return 256*(t=l(Math.floor(t),0,255))+l(Math.floor(e),0,255)},Xr=function(){this.ids=[],this.positions=[],this.indexed=!1};function Hr(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}Xr.prototype.add=function(t,e,n,r){this.ids.push(t),this.positions.push(e,n,r)},Xr.prototype.getPositions=function(t){for(var e=0,n=this.ids.length-1;e<n;){var r=e+n>>1;this.ids[r]>=t?n=r:e=r+1}for(var i=[];this.ids[e]===t;){var o=this.positions[3*e],a=this.positions[3*e+1],s=this.positions[3*e+2];i.push({index:o,start:a,end:s}),e++}return i},Xr.serialize=function(t,e){var n=new Float64Array(t.ids),r=new Uint32Array(t.positions);return function t(e,n,r,i){if(!(r>=i)){for(var o=e[r+i>>1],a=r-1,s=i+1;;){do{a++}while(e[a]<o);do{s--}while(e[s]>o);if(a>=s)break;Hr(e,a,s),Hr(n,3*a,3*s),Hr(n,3*a+1,3*s+1),Hr(n,3*a+2,3*s+2)}t(e,n,r,s),t(e,n,s+1,i)}}(n,r,0,n.length-1),e.push(n.buffer,r.buffer),{ids:n,positions:r}},Xr.deserialize=function(t){var e=new Xr;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e},Tn("FeaturePositionMap",Xr);var Yr=function(t,e){this.gl=t.gl,this.location=e},Kr=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(Yr),Jr=function(t){function e(e,n){t.call(this,e,n),this.current=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(Yr),Qr=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(Yr),$r=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(Yr),ti=function(t){function e(e,n){t.call(this,e,n),this.current=[0,0,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(Yr),ei=function(t){function e(e,n){t.call(this,e,n),this.current=ot.transparent}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(Yr),ni=new Float32Array(16),ri=function(t){function e(e,n){t.call(this,e,n),this.current=ni}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(Yr);function ii(t){return[Zr(255*t.r,255*t.g),Zr(255*t.b,255*t.a)]}var oi=function(t,e,n){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=n,this.maxValue=-1/0};oi.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},oi.prototype.setConstantPatternPositions=function(){},oi.prototype.populatePaintArray=function(){},oi.prototype.updatePaintArray=function(){},oi.prototype.upload=function(){},oi.prototype.destroy=function(){},oi.prototype.setUniforms=function(t,e,n,r){e.set(r.constantOr(this.value))},oi.prototype.getBinding=function(t,e){return"color"===this.type?new ei(t,e):new Jr(t,e)},oi.serialize=function(t){var e=t.value,n=t.names,r=t.type;return{value:kn(e),names:n,type:r}},oi.deserialize=function(t){var e=t.value,n=t.names,r=t.type;return new oi(Cn(e),n,r)};var ai=function(t,e,n){this.value=t,this.names=e,this.uniformNames=this.names.map(function(t){return"u_"+t}),this.type=n,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};ai.prototype.defines=function(){return this.names.map(function(t){return"#define HAS_UNIFORM_u_"+t})},ai.prototype.populatePaintArray=function(){},ai.prototype.updatePaintArray=function(){},ai.prototype.upload=function(){},ai.prototype.destroy=function(){},ai.prototype.setConstantPatternPositions=function(t,e){this.patternPositions.patternTo=t.tlbr,this.patternPositions.patternFrom=e.tlbr},ai.prototype.setUniforms=function(t,e,n,r,i){var o=this.patternPositions;"u_pattern_to"===i&&o.patternTo&&e.set(o.patternTo),"u_pattern_from"===i&&o.patternFrom&&e.set(o.patternFrom)},ai.prototype.getBinding=function(t,e){return new ti(t,e)};var si=function(t,e,n,r){this.expression=t,this.names=e,this.type=n,this.uniformNames=this.names.map(function(t){return"a_"+t}),this.maxValue=-1/0,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?2:1,offset:0}}),this.paintVertexArray=new r};si.prototype.defines=function(){return[]},si.prototype.setConstantPatternPositions=function(){},si.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,r=n.length;n.reserve(t);var i=this.expression.evaluate(new Gn(0),e,{});if("color"===this.type)for(var o=ii(i),a=r;a<t;a++)n.emplaceBack(o[0],o[1]);else{for(var s=r;s<t;s++)n.emplaceBack(i);this.maxValue=Math.max(this.maxValue,i)}},si.prototype.updatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:0},n,r);if("color"===this.type)for(var a=ii(o),s=t;s<e;s++)i.emplace(s,a[0],a[1]);else{for(var u=t;u<e;u++)i.emplace(u,o);this.maxValue=Math.max(this.maxValue,o)}},si.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},si.prototype.setUniforms=function(t,e){e.set(0)},si.prototype.getBinding=function(t,e){return new Jr(t,e)};var ui=function(t,e,n,r,i,o){this.expression=t,this.names=e,this.uniformNames=this.names.map(function(t){return"a_"+t+"_t"}),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=-1/0;var a=o;this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Float32",components:"color"===n?4:2,offset:0}}),this.paintVertexArray=new a};ui.prototype.defines=function(){return[]},ui.prototype.setConstantPatternPositions=function(){},ui.prototype.populatePaintArray=function(t,e){var n=this.paintVertexArray,r=n.length;n.reserve(t);var i=this.expression.evaluate(new Gn(this.zoom),e,{}),o=this.expression.evaluate(new Gn(this.zoom+1),e,{});if("color"===this.type)for(var a=ii(i),s=ii(o),u=r;u<t;u++)n.emplaceBack(a[0],a[1],s[0],s[1]);else{for(var c=r;c<t;c++)n.emplaceBack(i,o);this.maxValue=Math.max(this.maxValue,i,o)}},ui.prototype.updatePaintArray=function(t,e,n,r){var i=this.paintVertexArray,o=this.expression.evaluate({zoom:this.zoom},n,r),a=this.expression.evaluate({zoom:this.zoom+1},n,r);if("color"===this.type)for(var s=ii(o),u=ii(a),c=t;c<e;c++)i.emplace(c,s[0],s[1],u[0],u[1]);else{for(var l=t;l<e;l++)i.emplace(l,o,a);this.maxValue=Math.max(this.maxValue,o,a)}},ui.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ui.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ui.prototype.interpolationFactor=function(t){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1):this.expression.interpolationFactor(t,this.zoom,this.zoom+1)},ui.prototype.setUniforms=function(t,e,n){e.set(this.interpolationFactor(n.zoom))},ui.prototype.getBinding=function(t,e){return new Jr(t,e)};var ci=function(t,e,n,r,i,o,a){this.expression=t,this.names=e,this.type=n,this.uniformNames=this.names.map(function(t){return"a_"+t+"_t"}),this.useIntegerZoom=r,this.zoom=i,this.maxValue=-1/0,this.layerId=a,this.paintVertexAttributes=e.map(function(t){return{name:"a_"+t,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};ci.prototype.defines=function(){return[]},ci.prototype.setConstantPatternPositions=function(){},ci.prototype.populatePaintArray=function(t,e,n){var r=this.zoomInPaintVertexArray,i=this.zoomOutPaintVertexArray,o=this.layerId,a=r.length;if(r.reserve(t),i.reserve(t),n&&e.patterns&&e.patterns[o]){var s=e.patterns[o],u=s.min,c=s.mid,l=s.max,f=n[u],h=n[c],p=n[l];if(!f||!h||!p)return;for(var d=a;d<t;d++)r.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1]),i.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1])}},ci.prototype.updatePaintArray=function(t,e,n,r,i){var o=this.zoomInPaintVertexArray,a=this.zoomOutPaintVertexArray,s=this.layerId;if(i&&n.patterns&&n.patterns[s]){var u=n.patterns[s],c=u.min,l=u.mid,f=u.max,h=i[c],p=i[l],d=i[f];if(!h||!p||!d)return;for(var v=t;v<e;v++)o.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1]),a.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}},ci.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ci.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},ci.prototype.setUniforms=function(t,e){e.set(0)},ci.prototype.getBinding=function(t,e){return new Jr(t,e)};var li=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new Xr,this._bufferOffset=0};li.createDynamic=function(t,e,n){var r=new li,i=[];for(var o in t.paint._values)if(n(o)){var a=t.paint.get(o);if(a instanceof Kn&&be(a.property.specification)){var s=hi(o,t.type),u=a.property.specification.type,c=a.property.useIntegerZoom;if("cross-faded"===a.property.specification["property-type"]||"cross-faded-data-driven"===a.property.specification["property-type"])if("constant"===a.value.kind)r.binders[o]=new ai(a.value.value,s,u),i.push("/u_"+o);else{var l=pi(o,u,"source");r.binders[o]=new ci(a.value,s,u,c,e,l,t.id),i.push("/a_"+o)}else if("constant"===a.value.kind)r.binders[o]=new oi(a.value.value,s,u),i.push("/u_"+o);else if("source"===a.value.kind){var f=pi(o,u,"source");r.binders[o]=new si(a.value,s,u,f),i.push("/a_"+o)}else{var h=pi(o,u,"composite");r.binders[o]=new ui(a.value,s,u,c,e,h),i.push("/z_"+o)}}}return r.cacheKey=i.sort().join(""),r},li.prototype.populatePaintArrays=function(t,e,n,r){for(var i in this.binders)this.binders[i].populatePaintArray(t,e,r);void 0!==e.id&&this._featureMap.add(+e.id,n,this._bufferOffset,t),this._bufferOffset=t},li.prototype.setConstantPatternPositions=function(t,e){for(var n in this.binders)this.binders[n].setConstantPatternPositions(t,e)},li.prototype.updatePaintArrays=function(t,e,n,r){var i=!1;for(var o in t)for(var a=0,s=this._featureMap.getPositions(+o);a<s.length;a+=1){var u=s[a],c=e.feature(u.index);for(var l in this.binders){var f=this.binders[l];if(!(f instanceof oi||f instanceof ai)&&!0===f.expression.isStateDependent){var h=n.paint.get(l);f.expression=h.value,f.updatePaintArray(u.start,u.end,c,t[o],r),i=!0}}}return i},li.prototype.defines=function(){var t=[];for(var e in this.binders)t.push.apply(t,this.binders[e].defines());return t},li.prototype.getPaintVertexBuffers=function(){return this._buffers},li.prototype.getUniforms=function(t,e){var n={};for(var r in this.binders)for(var i=this.binders[r],o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];n[s]=i.getBinding(t,e[s])}return n},li.prototype.setUniforms=function(t,e,n,r){for(var i in this.binders)for(var o=this.binders[i],a=0,s=o.uniformNames;a<s.length;a+=1){var u=s[a];o.setUniforms(t,e[u],r,n.get(i),u)}},li.prototype.updatePatternPaintBuffers=function(t){var e=[];for(var n in this.binders){var r=this.binders[n];if(r instanceof ci){var i=2===t.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;i&&e.push(i)}else(r instanceof si||r instanceof ui)&&r.paintVertexBuffer&&e.push(r.paintVertexBuffer)}this._buffers=e},li.prototype.upload=function(t){for(var e in this.binders)this.binders[e].upload(t);var n=[];for(var r in this.binders){var i=this.binders[r];(i instanceof si||i instanceof ui)&&i.paintVertexBuffer&&n.push(i.paintVertexBuffer)}this._buffers=n},li.prototype.destroy=function(){for(var t in this.binders)this.binders[t].destroy()};var fi=function(t,e,n,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,o=e;i<o.length;i+=1){var a=o[i];this.programConfigurations[a.id]=li.createDynamic(a,n,r),this.programConfigurations[a.id].layoutAttributes=t}this.needsUpload=!1};function hi(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function pi(t,e,n){var r={color:{source:Cr,composite:Or},number:{source:Er,composite:Cr}},i=function(t){return{"line-pattern":{source:dr,composite:dr},"fill-pattern":{source:dr,composite:dr},"fill-extrusion-pattern":{source:dr,composite:dr}}[t]}(t);return i&&i[n]||r[e][n]}fi.prototype.populatePaintArrays=function(t,e,n,r){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,n,r);this.needsUpload=!0},fi.prototype.updatePaintArrays=function(t,e,n,r){for(var i=0,o=n;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(t,e,a,r)||this.needsUpload}},fi.prototype.get=function(t){return this.programConfigurations[t]},fi.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},fi.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Tn("ConstantBinder",oi),Tn("CrossFadedConstantBinder",ai),Tn("SourceExpressionBinder",si),Tn("CrossFadedCompositeBinder",ci),Tn("CompositeExpressionBinder",ui),Tn("ProgramConfiguration",li,{omit:["_buffers"]}),Tn("ProgramConfigurationSet",fi);var di=8192,vi={min:-1*Math.pow(2,15),max:Math.pow(2,15)-1};function gi(t){for(var e=di/t.extent,n=t.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],o=0;o<i.length;o++){var a=i[o];a.x=Math.round(a.x*e),a.y=Math.round(a.y*e),(a.x<vi.min||a.x>vi.max||a.y<vi.min||a.y>vi.max)&&b("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return n}function mi(t,e,n,r,i){t.emplaceBack(2*e+(r+1)/2,2*n+(i+1)/2)}var yi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new lr,this.indexArray=new Tr,this.segments=new Wr,this.programConfigurations=new fi(qr,t.layers,t.zoom)};function _i(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];if(ki(i,e))return!0;if(Pi(e,i,n))return!0}return!1}function bi(t,e){if(1===t.length&&1===t[0].length)return Ai(e,t[0][0]);for(var n=0;n<e.length;n++)for(var r=e[n],i=0;i<r.length;i++)if(Ai(t,r[i]))return!0;for(var o=0;o<t.length;o++){for(var a=t[o],s=0;s<a.length;s++)if(Ai(e,a[s]))return!0;for(var u=0;u<e.length;u++)if(Ei(a,e[u]))return!0}return!1}function xi(t,e,n){for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<t.length;o++){var a=t[o];if(a.length>=3)for(var s=0;s<i.length;s++)if(ki(a,i[s]))return!0;if(wi(a,i,n))return!0}return!1}function wi(t,e,n){if(t.length>1){if(Ei(t,e))return!0;for(var r=0;r<e.length;r++)if(Pi(e[r],t,n))return!0}for(var i=0;i<t.length;i++)if(Pi(t[i],e,n))return!0;return!1}function Ei(t,e){if(0===t.length||0===e.length)return!1;for(var n=0;n<t.length-1;n++)for(var r=t[n],i=t[n+1],o=0;o<e.length-1;o++)if(Si(r,i,e[o],e[o+1]))return!0;return!1}function Si(t,e,n,r){return x(t,n,r)!==x(e,n,r)&&x(t,e,n)!==x(t,e,r)}function Pi(t,e,n){var r=n*n;if(1===e.length)return t.distSqr(e[0])<r;for(var i=1;i<e.length;i++)if(Ti(t,e[i-1],e[i])<r)return!0;return!1}function Ti(t,e,n){var r=e.distSqr(n);if(0===r)return t.distSqr(e);var i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/r;return i<0?t.distSqr(e):i>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(i)._add(e))}function Ai(t,e){for(var n,r,i,o=!1,a=0;a<t.length;a++)for(var s=0,u=(n=t[a]).length-1;s<n.length;u=s++)r=n[s],i=n[u],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(o=!o);return o}function ki(t,e){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++){var o=t[r],a=t[i];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function Ci(t,e,n){var r=e.paint.get(t).value;return"constant"===r.kind?r.value:n.programConfigurations.get(e.id).binders[t].maxValue}function Oi(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Mi(t,e,n,r,i){if(!e[0]&&!e[1])return t;var a=o.convert(e);"viewport"===n&&a._rotate(-r);for(var s=[],u=0;u<t.length;u++){for(var c=t[u],l=[],f=0;f<c.length;f++)l.push(c[f].sub(a._mult(i)));s.push(l)}return s}yi.prototype.populate=function(t,e){for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gn(this.zoom),o)){var u=gi(o);this.addFeature(o,u,a),e.featureIndex.insert(o,u,a,s,this.index)}}},yi.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},yi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},yi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yi.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qr),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},yi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},yi.prototype.addFeature=function(t,e,n){for(var r=0,i=e;r<i.length;r+=1)for(var o=0,a=i[r];o<a.length;o+=1){var s=a[o],u=s.x,c=s.y;if(!(u<0||u>=di||c<0||c>=di)){var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),f=l.vertexLength;mi(this.layoutVertexArray,u,c,-1,-1),mi(this.layoutVertexArray,u,c,1,-1),mi(this.layoutVertexArray,u,c,1,1),mi(this.layoutVertexArray,u,c,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),l.vertexLength+=4,l.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{})},Tn("CircleBucket",yi,{omit:["layers"]});var Ii={paint:new rr({"circle-radius":new $n(D.paint_circle["circle-radius"]),"circle-color":new $n(D.paint_circle["circle-color"]),"circle-blur":new $n(D.paint_circle["circle-blur"]),"circle-opacity":new $n(D.paint_circle["circle-opacity"]),"circle-translate":new Qn(D.paint_circle["circle-translate"]),"circle-translate-anchor":new Qn(D.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Qn(D.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Qn(D.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $n(D.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $n(D.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $n(D.paint_circle["circle-stroke-opacity"])})},Li="undefined"!=typeof Float32Array?Float32Array:Array;function Ri(){var t=new Li(9);return Li!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ji(){var t=new Li(3);return Li!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function zi(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Di(t,e,n){var r=new Li(3);return r[0]=t,r[1]=e,r[2]=n,r}Math.PI;var Fi,Ni=zi,Bi=(Fi=ji(),function(t,e,n,r,i,o){var a,s=void 0;for(e||(e=3),n||(n=0),a=r?Math.min(r*e+n,t.length):t.length,s=n;s<a;s+=e)Fi[0]=t[s],Fi[1]=t[s+1],Fi[2]=t[s+2],i(Fi,Fi,o),t[s]=Fi[0],t[s+1]=Fi[1],t[s+2]=Fi[2];return t});function Ui(){var t=new Li(4);return Li!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Vi(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t}function Gi(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}var qi=function(){var t=Ui();return function(e,n,r,i,o,a){var s,u=void 0;for(n||(n=4),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}();function Wi(){var t=new Li(4);return Li!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}ji(),Di(1,0,0),Di(0,1,0),Wi(),Wi(),Ri(),function(){var t;t=new Li(2),Li!=Float32Array&&(t[0]=0,t[1]=0)}();var Zi=function(t){function e(e){t.call(this,e,Ii)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new yi(t)},e.prototype.queryRadius=function(t){var e=t;return Ci("circle-radius",this,e)+Ci("circle-stroke-width",this,e)+Oi(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a,s){for(var u=Mi(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),l="map"===this.paint.get("circle-pitch-alignment"),f=l?u:function(t,e,n){return u.map(function(t){return t.map(function(t){return Xi(t,e,n)})})}(0,s,o),h=l?c*a:c,p=0,d=r;p<d.length;p+=1)for(var v=0,g=d[p];v<g.length;v+=1){var m=g[v],y=l?m:Xi(m,s,o),_=h,b=Gi([],[m.x,m.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),_i(f,y,_))return!0}return!1},e}(ir);function Xi(t,e,n){var r=Gi([],[t.x,t.y,0,1],e);return new o((r[0]/r[3]+1)*n.width*.5,(r[1]/r[3]+1)*n.height*.5)}var Hi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(yi);function Yi(t,e,n,r){var i=e.width,o=e.height;if(r){if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return t.width=i,t.height=o,t.data=r,t}function Ki(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var o=Yi({},{width:r,height:i},n);Ji(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=o.data}}function Ji(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,u=0;u<i.height;u++)for(var c=((n.y+u)*t.width+n.x)*o,l=((r.y+u)*e.width+r.x)*o,f=0;f<i.width*o;f++)s[l+f]=a[c+f];return e}Tn("HeatmapBucket",Hi,{omit:["layers"]});var Qi=function(t,e){Yi(this,t,1,e)};Qi.prototype.resize=function(t){Ki(this,t,1)},Qi.prototype.clone=function(){return new Qi({width:this.width,height:this.height},new Uint8Array(this.data))},Qi.copy=function(t,e,n,r,i){Ji(t,e,n,r,i,1)};var $i=function(t,e){Yi(this,t,4,e)};$i.prototype.resize=function(t){Ki(this,t,4)},$i.prototype.clone=function(){return new $i({width:this.width,height:this.height},new Uint8Array(this.data))},$i.copy=function(t,e,n,r,i){Ji(t,e,n,r,i,4)},Tn("AlphaImage",Qi),Tn("RGBAImage",$i);var to={paint:new rr({"heatmap-radius":new $n(D.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $n(D.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Qn(D.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nr(D.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Qn(D.paint_heatmap["heatmap-opacity"])})};function eo(t,e){for(var n=new Uint8Array(1024),r={},i=0,o=0;i<256;i++,o+=4){r[e]=i/255;var a=t.evaluate(r);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new $i({width:256,height:1},n)}var no=function(t){function e(e){t.call(this,e,to),this._updateColorRamp()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Hi(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=eo(t,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(ir),ro={paint:new rr({"hillshade-illumination-direction":new Qn(D.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Qn(D.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Qn(D.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Qn(D.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Qn(D.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Qn(D.paint_hillshade["hillshade-accent-color"])})},io=function(t){function e(e){t.call(this,e,ro)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(ir),oo=ur([{name:"a_pos",components:2,type:"Int16"}],4),ao=oo.members,so=(oo.size,oo.alignment,co),uo=co;function co(t,e,n){n=n||2;var r,i,o,a,s,u,c,l=e&&e.length,f=l?e[0]*n:t.length,h=lo(t,0,f,n,!0),p=[];if(!h)return p;if(l&&(h=function(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=lo(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(xo(a));for(s.sort(yo),i=0;i<s.length;i++)_o(s[i],n),n=fo(n,n.next);return n}(t,e,h,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<f;d+=n)s=t[d],u=t[d+1],s<r&&(r=s),u<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return ho(h,p,n,r,i,c),p}function lo(t,e,n,r,i){var o,a;if(i===Io(t,e,n,r)>0)for(o=e;o<n;o+=r)a=Co(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=Co(o,t[o],t[o+1],a);return a&&Po(a,a.next)&&(Oo(a),a=a.next),a}function fo(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Po(r,r.next)&&0!==So(r.prev,r,r.next))r=r.next;else{if(Oo(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function ho(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=bo(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?vo(t,r,i,o):po(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Oo(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?ho(t=go(t,e,n),e,n,r,i,o,2):2===a&&mo(t,e,n,r,i,o):ho(fo(t),e,n,r,i,o,1);break}}}function po(t){var e=t.prev,n=t,r=t.next;if(So(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(wo(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&So(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function vo(t,e,n,r){var i=t.prev,o=t,a=t.next;if(So(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=bo(s,u,e,n,r),h=bo(c,l,e,n,r),p=t.prevZ,d=t.nextZ;p&&p.z>=f&&d&&d.z<=h;){if(p!==t.prev&&p!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&So(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&So(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&So(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==t.prev&&d!==t.next&&wo(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&So(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function go(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Po(i,o)&&To(i,r,r.next,o)&&Ao(i,o)&&Ao(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Oo(r),Oo(r.next),r=t=o),r=r.next}while(r!==t);return r}function mo(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Eo(a,s)){var u=ko(a,s);return a=fo(a,a.next),u=fo(u,u.next),ho(a,e,n,r,i,o),void ho(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function yo(t,e){return t.x-e.x}function _o(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,f=n.y,h=1/0;for(r=n.next;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&wo(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<h||u===h&&r.x>n.x)&&Ao(r,t)&&(n=r,h=u),r=r.next;return n}(t,e)){var n=ko(e,t);fo(n,n.next)}}function bo(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function xo(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function wo(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Eo(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&To(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Ao(t,e)&&Ao(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function So(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Po(t,e){return t.x===e.x&&t.y===e.y}function To(t,e,n,r){return!!(Po(t,e)&&Po(n,r)||Po(t,r)&&Po(n,e))||So(t,e,n)>0!=So(t,e,r)>0&&So(n,r,t)>0!=So(n,r,e)>0}function Ao(t,e){return So(t.prev,t,t.next)<0?So(t,e,t.next)>=0&&So(t,t.prev,e)>=0:So(t,e,t.prev)<0||So(t,t.next,e)<0}function ko(t,e){var n=new Mo(t.i,t.x,t.y),r=new Mo(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Co(t,e,n,r){var i=new Mo(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Oo(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Mo(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Io(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}co.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(Io(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(Io(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;f+=Math.abs((t[h]-t[d])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[d+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},co.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n},so.default=uo;var Lo=e(function(t,e){t.exports=function(){function t(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function e(t,e){return t<e?-1:t>e?1:0}return function(n,r,i,o,a){!function e(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);e(n,r,Math.max(i,Math.floor(r-u*l/s+f)),Math.min(o,Math.floor(r+(s-u)*l/s+f)),a)}var h=n[r],p=i,d=o;for(t(n,i,r),a(n[o],h)>0&&t(n,i,o);p<d;){for(t(n,p,d),p++,d--;a(n[p],h)<0;)p++;for(;a(n[d],h)>0;)d--}0===a(n[i],h)?t(n,i,d):t(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(n,r,i||0,o||n.length-1,a||e)}}()});function Ro(t,e){var n=t.length;if(n<=1)return[t];for(var r,i,o=[],a=0;a<n;a++){var s=w(t[a]);0!==s&&(t[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(r&&o.push(r),r=[t[a]]):r.push(t[a]))}if(r&&o.push(r),e>1)for(var u=0;u<o.length;u++)o[u].length<=e||(Lo(o[u],e,1,o[u].length-1,jo),o[u]=o[u].slice(0,e));return o}function jo(t,e){return e.area-t.area}function zo(t,e,n){for(var r=n.patternDependencies,i=!1,o=0,a=e;o<a.length;o+=1){var s=a[o].paint.get(t+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,r[u.to]=!0,r[u.from]=!0)}return i}function Do(t,e,n,r,i){for(var o=i.patternDependencies,a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.paint.get(t+"-pattern").value;if("constant"!==c.kind){var l=c.evaluate({zoom:r-1},n,{}),f=c.evaluate({zoom:r},n,{}),h=c.evaluate({zoom:r+1},n,{});o[l]=!0,o[f]=!0,o[h]=!0,n.patterns[u.id]={min:l,mid:f,max:h}}}return n}var Fo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new lr,this.indexArray=new Tr,this.indexArray2=new Ar,this.programConfigurations=new fi(ao,t.layers,t.zoom),this.segments=new Wr,this.segments2=new Wr};Fo.prototype.populate=function(t,e){this.features=[],this.hasPattern=zo("fill",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gn(this.zoom),o)){var u=gi(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(Do("fill",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index)}}},Fo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Fo.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},Fo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Fo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ao),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},Fo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Fo.prototype.addFeature=function(t,e,n,r){for(var i=0,o=Ro(e,500);i<o.length;i+=1){for(var a=o[i],s=0,u=0,c=a;u<c.length;u+=1)s+=c[u].length;for(var l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),f=l.vertexLength,h=[],p=[],d=0,v=a;d<v.length;d+=1){var g=v[d];if(0!==g.length){g!==a[0]&&p.push(h.length/2);var m=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),y=m.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(y+g.length-1,y),h.push(g[0].x),h.push(g[0].y);for(var _=1;_<g.length;_++)this.layoutVertexArray.emplaceBack(g[_].x,g[_].y),this.indexArray2.emplaceBack(y+_-1,y+_),h.push(g[_].x),h.push(g[_].y);m.vertexLength+=g.length,m.primitiveLength+=g.length}}for(var b=so(h,p),x=0;x<b.length;x+=3)this.indexArray.emplaceBack(f+b[x],f+b[x+1],f+b[x+2]);l.vertexLength+=s,l.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r)},Tn("FillBucket",Fo,{omit:["layers","features"]});var No={paint:new rr({"fill-antialias":new Qn(D.paint_fill["fill-antialias"]),"fill-opacity":new $n(D.paint_fill["fill-opacity"]),"fill-color":new $n(D.paint_fill["fill-color"]),"fill-outline-color":new $n(D.paint_fill["fill-outline-color"]),"fill-translate":new Qn(D.paint_fill["fill-translate"]),"fill-translate-anchor":new Qn(D.paint_fill["fill-translate-anchor"]),"fill-pattern":new tr(D.paint_fill["fill-pattern"])})},Bo=function(t){function e(e){t.call(this,e,No)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new Fo(t)},e.prototype.queryRadius=function(){return Oi(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a){return bi(Mi(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)},e}(ir),Uo=ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Vo=Uo.members,Go=(Uo.size,Uo.alignment,Math.pow(2,13));function qo(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,2*Math.floor(r*Go)+a,i*Go*2,o*Go*2,Math.round(s))}var Wo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new hr,this.indexArray=new Tr,this.programConfigurations=new fi(Vo,t.layers,t.zoom),this.segments=new Wr};function Zo(t,e){return t.x===e.x&&(t.x<0||t.x>di)||t.y===e.y&&(t.y<0||t.y>di)}function Xo(t){return t.every(function(t){return t.x<0})||t.every(function(t){return t.x>di})||t.every(function(t){return t.y<0})||t.every(function(t){return t.y>di})}Wo.prototype.populate=function(t,e){this.features=[],this.hasPattern=zo("fill-extrusion",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gn(this.zoom),o)){var u=gi(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(Do("fill-extrusion",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index)}}},Wo.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},Wo.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},Wo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Wo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Wo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Vo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Wo.prototype.addFeature=function(t,e,n,r){for(var i=0,o=Ro(e,500);i<o.length;i+=1){for(var a=o[i],s=0,u=0,c=a;u<c.length;u+=1)s+=c[u].length;for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),f=0,h=a;f<h.length;f+=1){var p=h[f];if(0!==p.length&&!Xo(p))for(var d=0,v=0;v<p.length;v++){var g=p[v];if(v>=1){var m=p[v-1];if(!Zo(g,m)){l.vertexLength+4>Wr.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var y=g.sub(m)._perp()._unit(),_=m.dist(g);d+_>32768&&(d=0),qo(this.layoutVertexArray,g.x,g.y,y.x,y.y,0,0,d),qo(this.layoutVertexArray,g.x,g.y,y.x,y.y,0,1,d),d+=_,qo(this.layoutVertexArray,m.x,m.y,y.x,y.y,0,0,d),qo(this.layoutVertexArray,m.x,m.y,y.x,y.y,0,1,d);var b=l.vertexLength;this.indexArray.emplaceBack(b,b+2,b+1),this.indexArray.emplaceBack(b+1,b+2,b+3),l.vertexLength+=4,l.primitiveLength+=2}}}}l.vertexLength+s>Wr.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray));for(var x=[],w=[],E=l.vertexLength,S=0,P=a;S<P.length;S+=1){var T=P[S];if(0!==T.length){T!==a[0]&&w.push(x.length/2);for(var A=0;A<T.length;A++){var k=T[A];qo(this.layoutVertexArray,k.x,k.y,0,0,1,1,0),x.push(k.x),x.push(k.y)}}}for(var C=so(x,w),O=0;O<C.length;O+=3)this.indexArray.emplaceBack(E+C[O],E+C[O+2],E+C[O+1]);l.primitiveLength+=C.length/3,l.vertexLength+=s}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r)},Tn("FillExtrusionBucket",Wo,{omit:["layers","features"]});var Ho={paint:new rr({"fill-extrusion-opacity":new Qn(D["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $n(D["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Qn(D["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Qn(D["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new tr(D["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $n(D["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $n(D["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Qn(D["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Yo=function(t){function e(e){t.call(this,e,Ho)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createBucket=function(t){return new Wo(t)},e.prototype.queryRadius=function(){return Oi(this.paint.get("fill-extrusion-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,o,a){return bi(Mi(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,a),r)},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e}(ir),Ko=ur([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),Jo=Ko.members,Qo=(Ko.size,Ko.alignment,$o);function $o(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(ta,this,e)}function ta(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function ea(t){for(var e,n,r=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],r+=((n=t[a]).x-e.x)*(e.y+n.y);return r}$o.types=["Unknown","Point","LineString","Polygon"],$o.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,i=0,a=0,s=0,u=[];t.pos<n;){if(i<=0){var c=t.readVarint();r=7&c,i=c>>3}if(i--,1===r||2===r)a+=t.readSVarint(),s+=t.readSVarint(),1===r&&(e&&u.push(e),e=[]),e.push(new o(a,s));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&u.push(e),u},$o.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)i+=t.readSVarint(),o+=t.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},$o.prototype.toGeoJSON=function(t,e,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*t,s=this.extent*e,u=this.loadGeometry(),c=$o.types[this.type];function l(t){for(var e=0;e<t.length;e++){var n=t[e],r=180-360*(n.y+s)/o;t[e]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(r=0;r<u.length;r++)f[r]=u[r][0];l(u=f);break;case 2:for(r=0;r<u.length;r++)l(u[r]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=ea(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n.push(t[o]))}return n&&i.push(n),i}(u),r=0;r<u.length;r++)for(i=0;i<u[r].length;i++)l(u[r][i])}1===u.length?u=u[0]:c="Multi"+c;var h={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(h.id=this.id),h};var na=ra;function ra(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ia,this,e),this.length=this._features.length}function ia(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n))}function oa(t,e,n){if(3===t){var r=new na(n,n.readVarint()+n.pos);r.length&&(e[r.name]=r)}}ra.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Qo(this._pbf,e,this.extent,this._keys,this._values)};var aa={VectorTile:function(t,e){this.layers=t.readFields(oa,{},e)},VectorTileFeature:Qo,VectorTileLayer:na},sa=aa.VectorTileFeature.types,ua=63,ca=Math.cos(Math.PI/180*37.5),la=.5,fa=Math.pow(2,14)/la;function ha(t,e,n,r,i,o,a){t.emplaceBack(e.x,e.y,r?1:0,i?1:-1,Math.round(ua*n.x)+128,Math.round(ua*n.y)+128,1+(0===o?0:o<0?-1:1)|(a*la&63)<<2,a*la>>6)}var pa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.features=[],this.hasPattern=!1,this.layoutVertexArray=new pr,this.indexArray=new Tr,this.programConfigurations=new fi(Jo,t.layers,t.zoom),this.segments=new Wr};function da(t,e){return(t/e.tileTotal*(e.end-e.start)+e.start)*(fa-1)}pa.prototype.populate=function(t,e){this.features=[],this.hasPattern=zo("line",this.layers,e);for(var n=0,r=t;n<r.length;n+=1){var i=r[n],o=i.feature,a=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Gn(this.zoom),o)){var u=gi(o),c={sourceLayerIndex:s,index:a,geometry:u,properties:o.properties,type:o.type,patterns:{}};void 0!==o.id&&(c.id=o.id),this.hasPattern?this.features.push(Do("line",this.layers,c,this.zoom,e)):this.addFeature(c,u,a,{}),e.featureIndex.insert(o,u,a,s,this.index)}}},pa.prototype.update=function(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)},pa.prototype.addFeatures=function(t,e){for(var n=0,r=this.features;n<r.length;n+=1){var i=r[n],o=i.geometry;this.addFeature(i,o,i.index,e)}},pa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},pa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},pa.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Jo),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},pa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},pa.prototype.addFeature=function(t,e,n,r){for(var i=this.layers[0].layout,o=i.get("line-join").evaluate(t,{}),a=i.get("line-cap"),s=i.get("line-miter-limit"),u=i.get("line-round-limit"),c=0,l=e;c<l.length;c+=1){var f=l[c];this.addLine(f,t,o,a,s,u,n,r)}},pa.prototype.addLine=function(t,e,n,r,i,o,a,s){var u=null;e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")&&(u={start:e.properties.mapbox_clip_start,end:e.properties.mapbox_clip_end,tileTotal:void 0});for(var c="Polygon"===sa[e.type],l=t.length;l>=2&&t[l-1].equals(t[l-2]);)l--;for(var f=0;f<l-1&&t[f].equals(t[f+1]);)f++;if(!(l<(c?3:2))){u&&(u.tileTotal=function(t,e,n){for(var r,i,o=0,a=f;a<n-1;a++)r=t[a],i=t[a+1],o+=r.dist(i);return o}(t,0,l)),"bevel"===n&&(i=1.05);var h=di/(512*this.overscaling)*15,p=t[f],d=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var v,g,m,y=r,_=c?"butt":r,b=!0,x=void 0,w=void 0,E=void 0,S=void 0;this.e1=this.e2=this.e3=-1,c&&(v=t[l-2],S=p.sub(v)._unit()._perp());for(var P=f;P<l;P++)if(!(w=c&&P===l-1?t[f+1]:t[P+1])||!t[P].equals(w)){S&&(E=S),v&&(x=v),v=t[P],S=w?w.sub(v)._unit()._perp():E;var T=(E=E||S).add(S);0===T.x&&0===T.y||T._unit();var A=T.x*S.x+T.y*S.y,k=0!==A?1/A:1/0,C=A<ca&&x&&w;if(C&&P>f){var O=v.dist(x);if(O>2*h){var M=v.sub(v.sub(x)._mult(h/O)._round());this.distance+=M.dist(x),this.addCurrentVertex(M,this.distance,E.mult(1),0,0,!1,d,u),x=M}}var I=x&&w,L=I?n:w?y:_;if(I&&"round"===L&&(k<o?L="miter":k<=2&&(L="fakeround")),"miter"===L&&k>i&&(L="bevel"),"bevel"===L&&(k>2&&(L="flipbevel"),k<i&&(L="miter")),x&&(this.distance+=v.dist(x)),"miter"===L)T._mult(k),this.addCurrentVertex(v,this.distance,T,0,0,!1,d,u);else if("flipbevel"===L){if(k>100)T=S.clone().mult(-1);else{var R=E.x*S.y-E.y*S.x>0?-1:1,j=k*E.add(S).mag()/E.sub(S).mag();T._perp()._mult(j*R)}this.addCurrentVertex(v,this.distance,T,0,0,!1,d,u),this.addCurrentVertex(v,this.distance,T.mult(-1),0,0,!1,d,u)}else if("bevel"===L||"fakeround"===L){var z=E.x*S.y-E.y*S.x>0,D=-Math.sqrt(k*k-1);if(z?(m=0,g=D):(g=0,m=D),b||this.addCurrentVertex(v,this.distance,E,g,m,!1,d,u),"fakeround"===L){for(var F=Math.floor(8*(.5-(A-.5))),N=void 0,B=0;B<F;B++)N=S.mult((B+1)/(F+1))._add(E)._unit(),this.addPieSliceVertex(v,this.distance,N,z,d,u);this.addPieSliceVertex(v,this.distance,T,z,d,u);for(var U=F-1;U>=0;U--)N=E.mult((U+1)/(F+1))._add(S)._unit(),this.addPieSliceVertex(v,this.distance,N,z,d,u)}w&&this.addCurrentVertex(v,this.distance,S,-g,-m,!1,d,u)}else"butt"===L?(b||this.addCurrentVertex(v,this.distance,E,0,0,!1,d,u),w&&this.addCurrentVertex(v,this.distance,S,0,0,!1,d,u)):"square"===L?(b||(this.addCurrentVertex(v,this.distance,E,1,1,!1,d,u),this.e1=this.e2=-1),w&&this.addCurrentVertex(v,this.distance,S,-1,-1,!1,d,u)):"round"===L&&(b||(this.addCurrentVertex(v,this.distance,E,0,0,!1,d,u),this.addCurrentVertex(v,this.distance,E,1,1,!0,d,u),this.e1=this.e2=-1),w&&(this.addCurrentVertex(v,this.distance,S,-1,-1,!0,d,u),this.addCurrentVertex(v,this.distance,S,0,0,!1,d,u)));if(C&&P<l-1){var V=v.dist(w);if(V>2*h){var G=v.add(w.sub(v)._mult(h/V)._round());this.distance+=G.dist(v),this.addCurrentVertex(G,this.distance,S.mult(1),0,0,!1,d,u),v=G}}b=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,s)}},pa.prototype.addCurrentVertex=function(t,e,n,r,i,o,a,s){var u,c=this.layoutVertexArray,l=this.indexArray;s&&(e=da(e,s)),u=n.clone(),r&&u._sub(n.perp()._mult(r)),ha(c,t,u,o,!1,r,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(l.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,u=n.mult(-1),i&&u._sub(n.perp()._mult(i)),ha(c,t,u,o,!0,-i,e),this.e3=a.vertexLength++,this.e1>=0&&this.e2>=0&&(l.emplaceBack(this.e1,this.e2,this.e3),a.primitiveLength++),this.e1=this.e2,this.e2=this.e3,e>fa/2&&!s&&(this.distance=0,this.addCurrentVertex(t,this.distance,n,r,i,o,a))},pa.prototype.addPieSliceVertex=function(t,e,n,r,i,o){n=n.mult(r?-1:1);var a=this.layoutVertexArray,s=this.indexArray;o&&(e=da(e,o)),ha(a,t,n,!1,r,0,e),this.e3=i.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),i.primitiveLength++),r?this.e2=this.e3:this.e1=this.e3},Tn("LineBucket",pa,{omit:["layers","features"]});var va=new rr({"line-cap":new Qn(D.layout_line["line-cap"]),"line-join":new $n(D.layout_line["line-join"]),"line-miter-limit":new Qn(D.layout_line["line-miter-limit"]),"line-round-limit":new Qn(D.layout_line["line-round-limit"])}),ga={paint:new rr({"line-opacity":new $n(D.paint_line["line-opacity"]),"line-color":new $n(D.paint_line["line-color"]),"line-translate":new Qn(D.paint_line["line-translate"]),"line-translate-anchor":new Qn(D.paint_line["line-translate-anchor"]),"line-width":new $n(D.paint_line["line-width"]),"line-gap-width":new $n(D.paint_line["line-gap-width"]),"line-offset":new $n(D.paint_line["line-offset"]),"line-blur":new $n(D.paint_line["line-blur"]),"line-dasharray":new er(D.paint_line["line-dasharray"]),"line-pattern":new tr(D.paint_line["line-pattern"]),"line-gradient":new nr(D.paint_line["line-gradient"])}),layout:va},ma=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.possiblyEvaluate=function(e,n){return n=new Gn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),t.prototype.possiblyEvaluate.call(this,e,n)},e.prototype.evaluate=function(e,n,r,i){return n=f({},n,{zoom:Math.floor(n.zoom)}),t.prototype.evaluate.call(this,e,n,r,i)},e}($n))(ga.paint.properties["line-width"].specification);ma.useIntegerZoom=!0;var ya=function(t){function e(e){t.call(this,e,ga)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=eo(t,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),this.paint._values["line-floorwidth"]=ma.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new pa(t)},e.prototype.queryRadius=function(t){var e=t,n=_a(Ci("line-width",this,e),Ci("line-gap-width",this,e)),r=Ci("line-offset",this,e);return n/2+Math.abs(r)+Oi(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,n,r,i,a,s){var u=Mi(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*_a(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),l=this.paint.get("line-offset").evaluate(e,n);return l&&(r=function(t,e){for(var n=[],r=new o(0,0),i=0;i<t.length;i++){for(var a=t[i],s=[],u=0;u<a.length;u++){var c=a[u-1],l=a[u],f=a[u+1],h=0===u?r:l.sub(c)._unit()._perp(),p=u===a.length-1?r:f.sub(l)._unit()._perp(),d=h._add(p)._unit(),v=d.x*p.x+d.y*p.y;d._mult(1/v),s.push(d._mult(e)._add(l))}n.push(s)}return n}(r,l*s)),xi(u,r,c)},e}(ir);function _a(t,e){return e>0?e+2*t:t}var ba=ur([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),xa=ur([{name:"a_projected_pos",components:3,type:"Float32"}],4),wa=(ur([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ur([{name:"a_placed",components:2,type:"Uint8"}],4)),Ea=(ur([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Sa=ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function Pa(t,e,n){return t.sections.forEach(function(t){t.text=function(t,e,n){var r=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),Vn.applyArabicShaping&&(t=Vn.applyArabicShaping(t)),t}(t.text,e,n)}),t}ur([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),ur([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"horizontalPlacedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"}]),ur([{type:"Float32",name:"offsetX"}]),ur([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ta={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Aa=function(t){function e(e,n,r,i){t.call(this,e,n),this.angle=r,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(o);function ka(t,e){var n=e.expression;if("constant"===n.kind)return{functionType:"constant",layoutSize:n.evaluate(new Gn(t+1))};if("source"===n.kind)return{functionType:"source"};for(var r=n.zoomStops,i=0;i<r.length&&r[i]<=t;)i++;for(var o=i=Math.max(0,i-1);o<r.length&&r[o]<t+1;)o++;o=Math.min(r.length-1,o);var a={min:r[i],max:r[o]};return"composite"===n.kind?{functionType:"composite",zoomRange:a,propertyValue:e.value}:{functionType:"camera",layoutSize:n.evaluate(new Gn(t+1)),zoomRange:a,sizeRange:{min:n.evaluate(new Gn(a.min)),max:n.evaluate(new Gn(a.max))},propertyValue:e.value}}Tn("Anchor",Aa);var Ca=aa.VectorTileFeature.types,Oa=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ma(t,e,n,r,i,o,a,s){t.emplaceBack(e,n,Math.round(32*r),Math.round(32*i),o,a,s?s[0]:0,s?s[1]:0)}function Ia(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}var La=function(t){this.layoutVertexArray=new vr,this.indexArray=new Tr,this.programConfigurations=t,this.segments=new Wr,this.dynamicLayoutVertexArray=new gr,this.opacityVertexArray=new mr,this.placedSymbolArray=new Rr};La.prototype.upload=function(t,e,n,r){n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ba.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,xa.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Oa,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(t)},La.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Tn("SymbolBuffers",La);var Ra=function(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Wr,this.collisionVertexArray=new br};Ra.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,wa.members,!0)},Ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Tn("CollisionBuffers",Ra);var ja=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1;var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ka(this.zoom,e["text-size"]),this.iconSizeData=ka(this.zoom,e["icon-size"]);var n=this.layers[0].layout,r="viewport-y"===n.get("symbol-z-order");this.sortFeaturesByY=r&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),this.sourceID=t.sourceID};ja.prototype.createArrays=function(){this.text=new La(new fi(ba.members,this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new La(new fi(ba.members,this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.collisionBox=new Ra(_r,Ea.members,Ar),this.collisionCircle=new Ra(_r,Sa.members,Tr),this.glyphOffsetArray=new Fr,this.lineVertexArray=new Br,this.symbolInstances=new zr},ja.prototype.calculateGlyphDependencies=function(t,e,n,r){for(var i=0;i<t.length;i++)if(e[t.charCodeAt(i)]=!0,n&&r){var o=Ta[t.charAt(i)];o&&(e[o.charCodeAt(0)]=!0)}},ja.prototype.populate=function(t,e){var n=this.layers[0],r=n.layout,i=r.get("text-font"),o=r.get("text-field"),a=r.get("icon-image"),s=("constant"!==o.value.kind||o.value.value.toString().length>0)&&("constant"!==i.value.kind||i.value.value.length>0),u="constant"!==a.value.kind||a.value.value&&a.value.value.length>0;if(this.features=[],s||u){for(var c=e.iconDependencies,l=e.glyphDependencies,f=new Gn(this.zoom),h=0,p=t;h<p.length;h+=1){var d=p[h],v=d.feature,g=d.index,m=d.sourceLayerIndex;if(n._featureFilter(f,v)){var y=void 0;if(s){var _=n.getValueAndResolveTokens("text-field",v);y=Pa(_ instanceof ut?_:ut.fromString(_),n,v)}var b=void 0;if(u&&(b=n.getValueAndResolveTokens("icon-image",v)),y||b){var x={text:y,icon:b,index:g,sourceLayerIndex:m,geometry:gi(v),properties:v.properties,type:Ca[v.type]};if(void 0!==v.id&&(x.id=v.id),this.features.push(x),b&&(c[b]=!0),y)for(var w=i.evaluate(v,{}).join(","),E="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),S=0,P=y.sections;S<P.length;S+=1){var T=P[S],A=In(y.toString()),k=T.fontStack||w,C=l[k]=l[k]||{};this.calculateGlyphDependencies(T.text,C,E,A)}}}}"line"===r.get("symbol-placement")&&(this.features=function(t){var e={},n={},r=[],i=0;function o(e){r.push(t[e]),i++}function a(t,e,i){var o=n[t];return delete n[t],n[e]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(t,n,i){var o=e[n];return delete e[n],e[t]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function u(t,e,n){var r=n?e[0][e[0].length-1]:e[0][0];return t+":"+r.x+":"+r.y}for(var c=0;c<t.length;c++){var l=t[c],f=l.geometry,h=l.text?l.text.toString():null;if(h){var p=u(h,f),d=u(h,f,!0);if(p in n&&d in e&&n[p]!==e[d]){var v=s(p,d,f),g=a(p,d,r[v].geometry);delete e[p],delete n[d],n[u(h,r[g].geometry,!0)]=g,r[v].geometry=null}else p in n?a(p,d,f):d in e?s(p,d,f):(o(c),e[p]=i-1,n[d]=i-1)}else o(c)}return r.filter(function(t){return t.geometry})}(this.features))}},ja.prototype.update=function(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))},ja.prototype.isEmpty=function(){return 0===this.symbolInstances.length},ja.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ja.prototype.upload=function(t){this.uploaded||(this.collisionBox.upload(t),this.collisionCircle.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ja.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},ja.prototype.addToLineVertexArray=function(t,e){var n=this.lineVertexArray.length;if(void 0!==t.segment){for(var r=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),o={},a=t.segment+1;a<e.length;a++)o[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:r},a<e.length-1&&(r+=e[a+1].dist(e[a]));for(var s=t.segment||0;s>=0;s--)o[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var u=0;u<e.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},ja.prototype.addSymbols=function(t,e,n,r,i,o,a,s,u,c){for(var l=t.indexArray,f=t.layoutVertexArray,h=t.dynamicLayoutVertexArray,p=t.segments.prepareSegment(4*e.length,t.layoutVertexArray,t.indexArray),d=this.glyphOffsetArray.length,v=p.vertexLength,g=0,m=e;g<m.length;g+=1){var y=m[g],_=y.tl,b=y.tr,x=y.bl,w=y.br,E=y.tex,S=p.vertexLength,P=y.glyphOffset[1];Ma(f,s.x,s.y,_.x,P+_.y,E.x,E.y,n),Ma(f,s.x,s.y,b.x,P+b.y,E.x+E.w,E.y,n),Ma(f,s.x,s.y,x.x,P+x.y,E.x,E.y+E.h,n),Ma(f,s.x,s.y,w.x,P+w.y,E.x+E.w,E.y+E.h,n),Ia(h,s,0),l.emplaceBack(S,S+1,S+2),l.emplaceBack(S+1,S+2,S+3),p.vertexLength+=4,p.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(y.glyphOffset[0])}t.placedSymbolArray.emplaceBack(s.x,s.y,d,this.glyphOffsetArray.length-d,v,u,c,s.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],a,!1),t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{})},ja.prototype._addCollisionDebugVertex=function(t,e,n,r,i,o){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))},ja.prototype.addCollisionDebugVertices=function(t,e,n,r,i,a,s,u){var c=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),l=c.vertexLength,f=i.layoutVertexArray,h=i.collisionVertexArray,p=s.anchorX,d=s.anchorY;if(this._addCollisionDebugVertex(f,h,a,p,d,new o(t,e)),this._addCollisionDebugVertex(f,h,a,p,d,new o(n,e)),this._addCollisionDebugVertex(f,h,a,p,d,new o(n,r)),this._addCollisionDebugVertex(f,h,a,p,d,new o(t,r)),c.vertexLength+=4,u){var v=i.indexArray;v.emplaceBack(l,l+1,l+2),v.emplaceBack(l,l+2,l+3),c.primitiveLength+=2}else{var g=i.indexArray;g.emplaceBack(l,l+1),g.emplaceBack(l+1,l+2),g.emplaceBack(l+2,l+3),g.emplaceBack(l+3,l),c.primitiveLength+=4}},ja.prototype.addDebugCollisionBoxes=function(t,e,n){for(var r=t;r<e;r++){var i=this.collisionBoxArray.get(r),o=i.x1,a=i.y1,s=i.x2,u=i.y2,c=i.radius>0;this.addCollisionDebugVertices(o,a,s,u,c?this.collisionCircle:this.collisionBox,i.anchorPoint,n,c)}},ja.prototype.generateCollisionDebugBuffers=function(){for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e)}},ja.prototype._deserializeCollisionBoxesForSymbol=function(t,e,n,r,i){for(var o={},a=e;a<n;a++){var s=t.get(a);if(0===s.radius){o.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},o.textFeatureIndex=s.featureIndex;break}o.textCircles||(o.textCircles=[],o.textFeatureIndex=s.featureIndex),o.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var u=r;u<i;u++){var c=t.get(u);if(0===c.radius){o.iconBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},o.iconFeatureIndex=c.featureIndex;break}}return o},ja.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex))}},ja.prototype.hasTextData=function(){return this.text.segments.get().length>0},ja.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ja.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},ja.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},ja.prototype.addIndicesForPlacedTextSymbol=function(t){for(var e=this.text.placedSymbolArray.get(t),n=e.vertexStartIndex+4*e.numGlyphs,r=e.vertexStartIndex;r<n;r+=4)this.text.indexArray.emplaceBack(r,r+1,r+2),this.text.indexArray.emplaceBack(r+1,r+2,r+3)},ja.prototype.sortFeatures=function(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&(this.sortedAngle=t,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var e=[],n=0;n<this.symbolInstances.length;n++)e.push(n);for(var r=Math.sin(t),i=Math.cos(t),o=[],a=[],s=0;s<this.symbolInstances.length;s++){var u=this.symbolInstances.get(s);o.push(0|Math.round(r*u.anchorX+i*u.anchorY)),a.push(u.featureIndex)}e.sort(function(t,e){return o[t]-o[e]||a[e]-a[t]}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,l=e;c<l.length;c+=1){var f=l[c],h=this.symbolInstances.get(f);this.featureSortOrder.push(h.featureIndex),h.horizontalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(h.horizontalPlacedTextSymbolIndex),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(h.verticalPlacedTextSymbolIndex);var p=this.icon.placedSymbolArray.get(f);if(p.numGlyphs){var d=p.vertexStartIndex;this.icon.indexArray.emplaceBack(d,d+1,d+2),this.icon.indexArray.emplaceBack(d+1,d+2,d+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Tn("SymbolBucket",ja,{omit:["layers","collisionBoxArray","features","compareText"]}),ja.MAX_GLYPHS=65535,ja.addDynamicAttributes=Ia;var za=new rr({"symbol-placement":new Qn(D.layout_symbol["symbol-placement"]),"symbol-spacing":new Qn(D.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Qn(D.layout_symbol["symbol-avoid-edges"]),"symbol-z-order":new Qn(D.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Qn(D.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Qn(D.layout_symbol["icon-ignore-placement"]),"icon-optional":new Qn(D.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Qn(D.layout_symbol["icon-rotation-alignment"]),"icon-size":new $n(D.layout_symbol["icon-size"]),"icon-text-fit":new Qn(D.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qn(D.layout_symbol["icon-text-fit-padding"]),"icon-image":new $n(D.layout_symbol["icon-image"]),"icon-rotate":new $n(D.layout_symbol["icon-rotate"]),"icon-padding":new Qn(D.layout_symbol["icon-padding"]),"icon-keep-upright":new Qn(D.layout_symbol["icon-keep-upright"]),"icon-offset":new $n(D.layout_symbol["icon-offset"]),"icon-anchor":new $n(D.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Qn(D.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Qn(D.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Qn(D.layout_symbol["text-rotation-alignment"]),"text-field":new $n(D.layout_symbol["text-field"]),"text-font":new $n(D.layout_symbol["text-font"]),"text-size":new $n(D.layout_symbol["text-size"]),"text-max-width":new $n(D.layout_symbol["text-max-width"]),"text-line-height":new Qn(D.layout_symbol["text-line-height"]),"text-letter-spacing":new $n(D.layout_symbol["text-letter-spacing"]),"text-justify":new $n(D.layout_symbol["text-justify"]),"text-anchor":new $n(D.layout_symbol["text-anchor"]),"text-max-angle":new Qn(D.layout_symbol["text-max-angle"]),"text-rotate":new $n(D.layout_symbol["text-rotate"]),"text-padding":new Qn(D.layout_symbol["text-padding"]),"text-keep-upright":new Qn(D.layout_symbol["text-keep-upright"]),"text-transform":new $n(D.layout_symbol["text-transform"]),"text-offset":new $n(D.layout_symbol["text-offset"]),"text-allow-overlap":new Qn(D.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Qn(D.layout_symbol["text-ignore-placement"]),"text-optional":new Qn(D.layout_symbol["text-optional"])}),Da={paint:new rr({"icon-opacity":new $n(D.paint_symbol["icon-opacity"]),"icon-color":new $n(D.paint_symbol["icon-color"]),"icon-halo-color":new $n(D.paint_symbol["icon-halo-color"]),"icon-halo-width":new $n(D.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $n(D.paint_symbol["icon-halo-blur"]),"icon-translate":new Qn(D.paint_symbol["icon-translate"]),"icon-translate-anchor":new Qn(D.paint_symbol["icon-translate-anchor"]),"text-opacity":new $n(D.paint_symbol["text-opacity"]),"text-color":new $n(D.paint_symbol["text-color"]),"text-halo-color":new $n(D.paint_symbol["text-halo-color"]),"text-halo-width":new $n(D.paint_symbol["text-halo-width"]),"text-halo-blur":new $n(D.paint_symbol["text-halo-blur"]),"text-translate":new Qn(D.paint_symbol["text-translate"]),"text-translate-anchor":new Qn(D.paint_symbol["text-translate-anchor"])}),layout:za},Fa=function(t){function e(e){t.call(this,e,Da)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.recalculate=function(e){t.prototype.recalculate.call(this,e),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},e.prototype.getValueAndResolveTokens=function(t,e){var n,r=this.layout.get(t).evaluate(e,{}),i=this._unevaluatedLayout._values[t];return i.isDataDriven()||Le(i.value)?r:(n=e.properties,r.replace(/{([^{}]+)}/g,function(t,e){return e in n?String(n[e]):""}))},e.prototype.createBucket=function(t){return new ja(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e}(ir),Na={paint:new rr({"background-color":new Qn(D.paint_background["background-color"]),"background-pattern":new er(D.paint_background["background-pattern"]),"background-opacity":new Qn(D.paint_background["background-opacity"])})},Ba=function(t){function e(e){t.call(this,e,Na)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ir),Ua={paint:new rr({"raster-opacity":new Qn(D.paint_raster["raster-opacity"]),"raster-hue-rotate":new Qn(D.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Qn(D.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Qn(D.paint_raster["raster-brightness-max"]),"raster-saturation":new Qn(D.paint_raster["raster-saturation"]),"raster-contrast":new Qn(D.paint_raster["raster-contrast"]),"raster-resampling":new Qn(D.paint_raster["raster-resampling"]),"raster-fade-duration":new Qn(D.paint_raster["raster-fade-duration"])})},Va=function(t){function e(e){t.call(this,e,Ua)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ir),Ga=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender||"3d"===this.implementation.renderingMode},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t)},e}(ir),qa={circle:Zi,heatmap:no,hillshade:io,fill:Bo,"fill-extrusion":Yo,line:ya,symbol:Fa,background:Ba,raster:Va};function Wa(t){for(var e=0,n=0,r=0,i=t;r<i.length;r+=1){var o=i[r];e+=o.w*o.h,n=Math.max(n,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],s=0,u=0,c=0,l=t;c<l.length;c+=1)for(var f=l[c],h=a.length-1;h>=0;h--){var p=a[h];if(!(f.w>p.w||f.h>p.h)){if(f.x=p.x,f.y=p.y,u=Math.max(u,f.y+f.h),s=Math.max(s,f.x+f.w),f.w===p.w&&f.h===p.h){var d=a.pop();h<a.length&&(a[h]=d)}else f.h===p.h?(p.x+=f.w,p.w-=f.w):f.w===p.w?(p.y+=f.h,p.h-=f.h):(a.push({x:p.x+f.w,y:p.y,w:p.w-f.w,h:f.h}),p.y+=f.h,p.h-=f.h);break}}return{w:s,h:u,fill:e/(s*u)||0}}var Za=function(t,e){var n=e.pixelRatio;this.paddedRect=t,this.pixelRatio=n},Xa={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Xa.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Xa.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Xa.tlbr.get=function(){return this.tl.concat(this.br)},Xa.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Za.prototype,Xa);var Ha=function(t,e){var n={},r={},i=[];for(var o in t){var a=t[o],s={x:0,y:0,w:a.data.width+2,h:a.data.height+2};i.push(s),n[o]=new Za(s,a)}for(var u in e){var c=e[u],l={x:0,y:0,w:c.data.width+2,h:c.data.height+2};i.push(l),r[u]=new Za(l,c)}var f=Wa(i),h=f.w,p=f.h,d=new $i({width:h||1,height:p||1});for(var v in t){var g=t[v],m=n[v].paddedRect;$i.copy(g.data,d,{x:0,y:0},{x:m.x+1,y:m.y+1},g.data)}for(var y in e){var _=e[y],b=r[y].paddedRect,x=b.x+1,w=b.y+1,E=_.data.width,S=_.data.height;$i.copy(_.data,d,{x:0,y:0},{x:x,y:w},_.data),$i.copy(_.data,d,{x:0,y:S-1},{x:x,y:w-1},{width:E,height:1}),$i.copy(_.data,d,{x:0,y:0},{x:x,y:w+S},{width:E,height:1}),$i.copy(_.data,d,{x:E-1,y:0},{x:x-1,y:w},{width:1,height:S}),$i.copy(_.data,d,{x:0,y:0},{x:x+E,y:w},{width:1,height:S})}this.image=d,this.iconPositions=n,this.patternPositions=r};Tn("ImagePosition",Za),Tn("ImageAtlas",Ha);var Ya=self.HTMLImageElement,Ka=self.HTMLCanvasElement,Ja=self.HTMLVideoElement,Qa=self.ImageData,$a=function(t,e,n,r){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,r)};$a.prototype.update=function(t,e){var n=t.width,r=t.height,i=!this.size||this.size[0]!==n||this.size[1]!==r,o=this.context,a=o.gl;this.useMipmap=Boolean(e&&e.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!e||!1!==e.premultiply)),i?(this.size=[n,r],t instanceof Ya||t instanceof Ka||t instanceof Ja||t instanceof Qa?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,t):a.texImage2D(a.TEXTURE_2D,0,this.format,n,r,0,this.format,a.UNSIGNED_BYTE,t.data)):t instanceof Ya||t instanceof Ka||t instanceof Ja||t instanceof Qa?a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,t):a.texSubImage2D(a.TEXTURE_2D,0,0,0,n,r,a.RGBA,a.UNSIGNED_BYTE,t.data),this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},$a.prototype.bind=function(t,e,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)},$a.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},$a.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ts=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},es=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*v},ns=rs;function rs(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}function is(t){return t.type===rs.Bytes?t.readVarint()+t.pos:t.pos+1}function os(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function as(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function ss(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function us(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function cs(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function ls(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function fs(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function hs(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function ps(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function ds(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function vs(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function gs(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function ms(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function ys(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}rs.Varint=0,rs.Fixed64=1,rs.Bytes=2,rs.Fixed32=5,rs.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=gs(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ys(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=gs(this.buf,this.pos)+4294967296*gs(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=gs(this.buf,this.pos)+4294967296*ys(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=ts(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ts(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return os(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return os(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return os(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,n){for(var r="",i=e;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var n=is(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=is(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===rs.Varint)for(;this.buf[this.pos++]>127;);else if(e===rs.Bytes)this.pos=this.readVarint()+this.pos;else if(e===rs.Fixed32)this.pos+=4;else{if(e!==rs.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ms(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ms(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ms(this.buf,-1&t,this.pos),ms(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ms(this.buf,-1&t,this.pos),ms(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&as(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),es(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),es(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&as(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,rs.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){this.writeMessage(t,ss,e)},writePackedSVarint:function(t,e){this.writeMessage(t,us,e)},writePackedBoolean:function(t,e){this.writeMessage(t,fs,e)},writePackedFloat:function(t,e){this.writeMessage(t,cs,e)},writePackedDouble:function(t,e){this.writeMessage(t,ls,e)},writePackedFixed32:function(t,e){this.writeMessage(t,hs,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,ps,e)},writePackedFixed64:function(t,e){this.writeMessage(t,ds,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,vs,e)},writeBytesField:function(t,e){this.writeTag(t,rs.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,rs.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,rs.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,rs.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,rs.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,rs.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,rs.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,rs.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,rs.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,rs.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var _s=3;function bs(t,e,n){1===t&&n.readMessage(xs,e)}function xs(t,e,n){if(3===t){var r=n.readMessage(ws,{}),i=r.id,o=r.bitmap,a=r.width,s=r.height,u=r.left,c=r.top,l=r.advance;e.push({id:i,bitmap:new Qi({width:a+2*_s,height:s+2*_s},o),metrics:{width:a,height:s,left:u,top:c,advance:l}})}}function ws(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}var Es=_s,Ss=function(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.callbackID=0,d(["receive"],this),this.target.addEventListener("message",this.receive,!1)};function Ps(t,e,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}Ss.prototype.send=function(t,e,n,r){var i=n?this.mapId+":"+this.callbackID++:null;n&&(this.callbacks[i]=n);var o=[];this.target.postMessage({targetMapId:r,sourceMapId:this.mapId,type:t,id:String(i),data:kn(e,o)},o)},Ss.prototype.receive=function(t){var e,n=this,r=t.data,i=r.id;if(!r.targetMapId||this.mapId===r.targetMapId){var o=function(t,e){var r=[];n.target.postMessage({sourceMapId:n.mapId,type:"<response>",id:String(i),error:t?kn(t):null,data:kn(e,r)},r)};if("<response>"===r.type)e=this.callbacks[r.id],delete this.callbacks[r.id],e&&r.error?e(Cn(r.error)):e&&e(null,Cn(r.data));else if(void 0!==r.id&&this.parent[r.type])this.parent[r.type](r.sourceMapId,Cn(r.data),o);else if(void 0!==r.id&&this.parent.getWorkerSource){var a=r.type.split("."),s=Cn(r.data);this.parent.getWorkerSource(r.sourceMapId,a[0],s.source)[a[1]](s,o)}else this.parent[r.type](Cn(r.data))}},Ss.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Ts=function(t,e,n){this.z=t,this.x=e,this.y=n,this.key=Cs(0,t,e,n)};Ts.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ts.prototype.url=function(t,e){var n,r,i,o,a,s=(n=this.x,r=this.y,i=this.z,o=Ps(256*n,256*(r=Math.pow(2,i)-r-1),i),a=Ps(256*(n+1),256*(r+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),u=function(t,e,n){for(var r,i="",o=t;o>0;o--)i+=(e&(r=1<<o-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)};var As=function(t,e){this.wrap=t,this.canonical=e,this.key=Cs(t,e.z,e.x,e.y)},ks=function(t,e,n,r,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Ts(n,+r,+i),this.key=Cs(e,t,r,i)};function Cs(t,e,n,r){(t*=2)<0&&(t=-1*t-1);var i=1<<e;return 32*(i*i*t+i*r+n)+e}ks.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},ks.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new ks(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ks(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},ks.prototype.isChildOf=function(t){var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},ks.prototype.children=function(t){if(this.overscaledZ>=t)return[new ks(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new ks(e,this.wrap,e,n,r),new ks(e,this.wrap,e,n+1,r),new ks(e,this.wrap,e,n,r+1),new ks(e,this.wrap,e,n+1,r+1)]},ks.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},ks.prototype.wrapped=function(){return new ks(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ks.prototype.unwrapTo=function(t){return new ks(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},ks.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ks.prototype.toUnwrapped=function(){return new As(this.wrap,this.canonical)},ks.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ks.prototype.toCoordinate=function(){return new i(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},Tn("CanonicalTileID",Ts),Tn("OverscaledTileID",ks,{omit:["posMatrix"]});var Os=function(t,e,n){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return b('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var r=this.dim=e.height;this.border=Math.max(Math.ceil(e.height/2),1),this.stride=this.dim+2*this.border,this.data=new Int32Array(this.stride*this.stride);for(var i=e.data,o="terrarium"===n?this._unpackTerrarium:this._unpackMapbox,a=0;a<r;a++)for(var s=0;s<r;s++){var u=4*(a*r+s);this.set(s,a,o(i[u],i[u+1],i[u+2]))}for(var c=0;c<r;c++)this.set(-1,c,this.get(0,c)),this.set(r,c,this.get(r-1,c)),this.set(c,-1,this.get(c,0)),this.set(c,r,this.get(c,r-1));this.set(-1,-1,this.get(0,0)),this.set(r,-1,this.get(r-1,0)),this.set(-1,r,this.get(0,r-1)),this.set(r,r,this.get(r-1,r-1))};Os.prototype.set=function(t,e,n){this.data[this._idx(t,e)]=n+65536},Os.prototype.get=function(t,e){return this.data[this._idx(t,e)]-65536},Os.prototype._idx=function(t,e){if(t<-this.border||t>=this.dim+this.border||e<-this.border||e>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(e+this.border)*this.stride+(t+this.border)},Os.prototype._unpackMapbox=function(t,e,n){return(256*t*256+256*e+n)/10-1e4},Os.prototype._unpackTerrarium=function(t,e,n){return 256*t+e+n/256-32768},Os.prototype.getPixels=function(){return new $i({width:this.dim+2*this.border,height:this.dim+2*this.border},new Uint8Array(this.data.buffer))},Os.prototype.backfillBorder=function(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var r=e*this.dim,i=e*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(e){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=l(r,-this.border,this.dim+this.border),u=l(i,-this.border,this.dim+this.border),c=l(o,-this.border,this.dim+this.border),f=l(a,-this.border,this.dim+this.border),h=-e*this.dim,p=-n*this.dim,d=c;d<f;d++)for(var v=s;v<u;v++)this.set(v,d,t.get(v+h,d+p))},Tn("DEMData",Os);var Ms=ur([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Is=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}};Is.prototype.encode=function(t){return this._stringToNumber[t]},Is.prototype.decode=function(t){return this._numberToString[t]};var Ls=function(t,e,n,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=r,this.properties=t.properties,null!=t.id&&(this.id=t.id)},Rs={geometry:{configurable:!0}};Rs.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Rs.geometry.set=function(t){this._geometry=t},Ls.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Ls.prototype,Rs);var js=function(){this.state={},this.stateChanges={}};js.prototype.updateState=function(t,e,n){var r=String(e);this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},f(this.stateChanges[t][r],n)},js.prototype.getState=function(t,e){var n=String(e),r=this.state[t]||{},i=this.stateChanges[t]||{};return f({},r[n],i[n])},js.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},js.prototype.coalesceChanges=function(t,e){var n={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var i={};for(var o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),f(this.state[r][o],this.stateChanges[r][o]),i[o]=this.state[r][o];n[r]=i}if(this.stateChanges={},0!==Object.keys(n).length)for(var a in t)t[a].setFeatureState(n,e)};var zs=function(t,e,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=e||new xn(di,16,0),this.featureIndexArray=n||new Vr};function Ds(t,e){return e-t}zs.prototype.insert=function(t,e,n,r,i){var o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var a=0;a<e.length;a++){for(var s=e[a],u=[1/0,1/0,-1/0,-1/0],c=0;c<s.length;c++){var l=s[c];u[0]=Math.min(u[0],l.x),u[1]=Math.min(u[1],l.y),u[2]=Math.max(u[2],l.x),u[3]=Math.max(u[3],l.y)}u[0]<di&&u[1]<di&&u[2]>=0&&u[3]>=0&&this.grid.insert(o,u[0],u[1],u[2],u[3])}},zs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new aa.VectorTile(new ns(this.rawTileData)).layers,this.sourceLayerCoder=new Is(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},zs.prototype.query=function(t,e,n){var r=this;this.loadVTLayers();for(var i=t.params||{},o=di/t.tileSize/t.scale,a=He(i.filter),s=t.queryGeometry,u=t.queryPadding*o,c=1/0,l=1/0,f=-1/0,h=-1/0,p=0;p<s.length;p++)for(var d=s[p],v=0;v<d.length;v++){var g=d[v];c=Math.min(c,g.x),l=Math.min(l,g.y),f=Math.max(f,g.x),h=Math.max(h,g.y)}var m=this.grid.query(c-u,l-u,f+u,h+u);m.sort(Ds);for(var y,_={},b=function(u){var c=m[u];if(c!==y){y=c;var l=r.featureIndexArray.get(c),f=null;r.loadMatchingFeature(_,l.bucketIndex,l.sourceLayerIndex,l.featureIndex,a,i.layers,e,function(e,i){f||(f=gi(e));var a={};return e.id&&(a=n.getState(i.sourceLayer||"_geojsonTileLayer",e.id)),i.queryIntersectsFeature(s,e,a,f,r.z,t.transform,o,t.posMatrix)})}},x=0;x<m.length;x++)b(x);return _},zs.prototype.loadMatchingFeature=function(t,e,n,r,i,o,a,s){var u=this.bucketLayerIDs[e];if(!o||function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(o,u)){var c=this.sourceLayerCoder.decode(n),l=this.vtLayers[c].feature(r);if(i(new Gn(this.tileID.overscaledZ),l))for(var f=0;f<u.length;f++){var h=u[f];if(!(o&&o.indexOf(h)<0)){var p=a[h];if(p&&(!s||s(l,p))){var d=new Ls(l,this.z,this.x,this.y);d.layer=p.serialize();var v=t[h];void 0===v&&(v=t[h]=[]),v.push({featureIndex:r,feature:d})}}}}},zs.prototype.lookupSymbolFeatures=function(t,e,n,r,i,o){var a={};this.loadVTLayers();for(var s=He(r),u=0,c=t;u<c.length;u+=1){var l=c[u];this.loadMatchingFeature(a,e,n,l,s,i,o)}return a},zs.prototype.hasLayer=function(t){for(var e=0,n=this.bucketLayerIDs;e<n.length;e+=1)for(var r=0,i=n[e];r<i.length;r+=1)if(t===i[r])return!0;return!1},Tn("FeatureIndex",zs,{omit:["rawTileData","sourceLayerCoder"]});var Fs=function(t,e){this.tileID=t,this.uid=p(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};Fs.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<T.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},Fs.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Fs.prototype.loadVectorData=function(t,e,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var r in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var n={};if(!e)return n;for(var r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.layerIds.map(function(t){return e.getLayer(t)}).filter(Boolean);if(0!==a.length){o.layers=a,o.stateDependentLayers=a.filter(function(t){return t.isStateDependent()});for(var s=0,u=a;s<u.length;s+=1)n[u[s].id]=o}}return n}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[r];if(i instanceof ja){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}for(var o in this.queryPadding=0,this.buckets){var a=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(o).queryRadius(a))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Ir},Fs.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Fs.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},Fs.prototype.getBucket=function(t){return this.buckets[t.id]},Fs.prototype.upload=function(t){for(var e in this.buckets){var n=this.buckets[e];n.uploadPending()&&n.upload(t)}var r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new $a(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new $a(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},Fs.prototype.queryRenderedFeatures=function(t,e,n,r,i,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,scale:r,tileSize:this.tileSize,posMatrix:s,transform:o,params:i,queryPadding:this.queryPadding*a},t,e):{}},Fs.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var n=this.latestFeatureIndex.loadVTLayers(),r=e?e.sourceLayer:"",i=n._geojsonTileLayer||n[r];if(i)for(var o=He(e&&e.filter),a=this.tileID.canonical,s=a.z,u=a.x,c=a.y,l={z:s,x:u,y:c},f=0;f<i.length;f++){var h=i.feature(f);if(o(new Gn(this.tileID.overscaledZ),h)){var p=new Ls(h,s,u,c);p.tile=l,t.push(p)}}}},Fs.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},Fs.prototype.setMask=function(t,e){if(!s(this.mask,t)&&(this.mask=t,this.clearMask(),!s(t,{0:!0}))){var n=new fr,r=new Tr;this.segments=new Wr,this.segments.prepareSegment(0,n,r);for(var i=Object.keys(t),a=0;a<i.length;a++){var u=t[i[a]],c=di>>u.z,l=new o(u.x*c,u.y*c),f=new o(l.x+c,l.y+c),h=this.segments.prepareSegment(4,n,r);n.emplaceBack(l.x,l.y,l.x,l.y),n.emplaceBack(f.x,l.y,f.x,l.y),n.emplaceBack(l.x,f.y,l.x,f.y),n.emplaceBack(f.x,f.y,f.x,f.y);var p=h.vertexLength;r.emplaceBack(p,p+1,p+2),r.emplaceBack(p+1,p+2,p+3),h.vertexLength+=4,h.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(n,Ms.members),this.maskedIndexBuffer=e.createIndexBuffer(r)}},Fs.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Fs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Fs.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var n=function(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(t,n,r,i){var o=r||i;return e[n]=!o||o.toLowerCase(),""}),e["max-age"]){var n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var r=Date.now(),i=!1;if(this.expirationTime>r)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var o=this.expirationTime-e;o?this.expirationTime=r+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Fs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Fs.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets){var i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=t[o];a&&s&&0!==Object.keys(s).length&&(i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),e&&e.style&&(this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(r).queryRadius(i))))}}},Fs.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Fs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<T.now()},Fs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Fs.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=T.now()+t};var Ns={horizontal:1,vertical:2,horizontalOnly:3},Bs=function(){this.text="",this.sectionIndex=[],this.sections=[]};Bs.fromFeature=function(t,e){for(var n=new Bs,r=0;r<t.sections.length;r++){var i=t.sections[r];n.sections.push({scale:i.scale||1,fontStack:i.fontStack||e}),n.text+=i.text;for(var o=0;o<i.text.length;o++)n.sectionIndex.push(r)}return n},Bs.prototype.length=function(){return this.text.length},Bs.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Bs.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Bs.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n+1)||null,i=t.charCodeAt(n-1)||null;r&&jn(r)&&!Ta[t[n+1]]||i&&jn(i)&&!Ta[t[n-1]]||!Ta[t[n]]?e+=t[n]:e+=Ta[t[n]]}return e}(this.text)},Bs.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Us[this.text.charCodeAt(e)];e++)t++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=t&&Us[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)},Bs.prototype.substring=function(t,e){var n=new Bs;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n},Bs.prototype.toString=function(){return this.text},Bs.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,n){return Math.max(e,t.sections[n].scale)},0)};var Us={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Vs={};function Gs(t,e,n,r){var i=Math.pow(t-e,2);return r?t<e?i/2:2*i:i+Math.abs(n)*n}function qs(t,e){var n=0;return 10===t&&(n-=1e4),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function Ws(t,e,n,r,i,o){for(var a=null,s=Gs(e,n,i,o),u=0,c=r;u<c.length;u+=1){var l=c[u],f=Gs(e-l.x,n,i,o)+l.badness;f<=s&&(a=l,s=f)}return{index:t,x:e,priorBreak:a,badness:s}}function Zs(t,e,n,r){if(!n)return[];if(!t)return[];for(var i,o=[],a=function(t,e,n,r){for(var i=0,o=0;o<t.length();o++){var a=t.getSection(o),s=r[a.fontStack],u=s&&s[t.getCharCode(o)];u&&(i+=u.metrics.advance*a.scale+e)}return i/Math.max(1,Math.ceil(i/n))}(t,e,n,r),s=0,u=0;u<t.length();u++){var c=t.getSection(u),l=t.getCharCode(u),f=r[c.fontStack],h=f&&f[l];h&&!Us[l]&&(s+=h.metrics.advance*c.scale+e),u<t.length()-1&&(Vs[l]||!((i=l)<11904)&&(Mn["Bopomofo Extended"](i)||Mn.Bopomofo(i)||Mn["CJK Compatibility Forms"](i)||Mn["CJK Compatibility Ideographs"](i)||Mn["CJK Compatibility"](i)||Mn["CJK Radicals Supplement"](i)||Mn["CJK Strokes"](i)||Mn["CJK Symbols and Punctuation"](i)||Mn["CJK Unified Ideographs Extension A"](i)||Mn["CJK Unified Ideographs"](i)||Mn["Enclosed CJK Letters and Months"](i)||Mn["Halfwidth and Fullwidth Forms"](i)||Mn.Hiragana(i)||Mn["Ideographic Description Characters"](i)||Mn["Kangxi Radicals"](i)||Mn["Katakana Phonetic Extensions"](i)||Mn.Katakana(i)||Mn["Vertical Forms"](i)||Mn["Yi Radicals"](i)||Mn["Yi Syllables"](i)))&&o.push(Ws(u+1,s,a,o,qs(l,t.getCharCode(u+1)),!1))}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Ws(t.length(),s,a,o,0,!0))}function Xs(t){var e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Hs(t,e,n,r,i){if(i){var o=t[r],a=e[o.fontStack],s=a&&a[o.glyph];if(s)for(var u=s.metrics.advance*o.scale,c=(t[r].x+u)*i,l=n;l<=r;l++)t[l].x-=c}}Vs[10]=!0,Vs[32]=!0,Vs[38]=!0,Vs[40]=!0,Vs[41]=!0,Vs[43]=!0,Vs[45]=!0,Vs[47]=!0,Vs[173]=!0,Vs[183]=!0,Vs[8203]=!0,Vs[8208]=!0,Vs[8211]=!0,Vs[8231]=!0,t.createCommonjsModule=e,t.Point=o,t.window=self,t.browser=T,t.uuid=function(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()},t.validateUuid=function(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},t.storageAvailable=function(t){try{var e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}},t.warnOnce=b,t.postData=function(t,e,n){var r=O(f(t,{method:"POST"}));return r.onerror=function(){n(new Error(r.statusText))},r.onload=function(){r.status>=200&&r.status<300?n(null,r.response):n(new C(r.statusText,r.status,t.url))},r.send(e),{cancel:function(){return r.abort()}}},t.getJSON=function(t,e){var n=O(t);return n.setRequestHeader("Accept","application/json"),n.onerror=function(){e(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&n.response){var r;try{r=JSON.parse(n.response)}catch(t){return e(t)}e(null,r)}else 401===n.status&&t.url.match(/mapbox.com/)?e(new C(n.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",n.status,t.url)):e(new C(n.statusText,n.status,t.url))},n.send(),{cancel:function(){return n.abort()}}},t.getImage=function(t,e){return M(t,function(t,n){if(t)e(t);else if(n){var r=new self.Image,i=self.URL||self.webkitURL;r.onload=function(){e(null,r),i.revokeObjectURL(r.src)},r.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var o=new self.Blob([new Uint8Array(n.data)],{type:"image/png"});r.cacheControl=n.cacheControl,r.expires=n.expires,r.src=n.data.byteLength?i.createObjectURL(o):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},t.ResourceType=k,t.RGBAImage=$i,t.potpack=Wa,t.ImagePosition=Za,t.Texture=$a,t.getArrayBuffer=M,t.parseGlyphPBF=function(t){return new ns(t).readFields(bs,[])},t.isChar=Mn,t.asyncAll=function(t,e,n){if(!t.length)return n(null,[]);var r=t.length,i=new Array(t.length),o=null;t.forEach(function(t,a){e(t,function(t,e){t&&(o=t),i[a]=e,0==--r&&n(o,i)})})},t.AlphaImage=Qi,t.styleSpec=D,t.endsWith=v,t.extend=f,t.sphericalToCartesian=function(t){var e=t[0],n=t[1],r=t[2];return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(r),y:e*Math.sin(n)*Math.sin(r),z:e*Math.cos(r)}},t.Evented=z,t.validateStyle=gn,t.validateLight=mn,t.emitValidationErrors=bn,t.Color=ot,t.number=Ot,t.Properties=rr,t.Transitionable=Zn,t.Transitioning=Hn,t.PossiblyEvaluated=Jn,t.DataConstantProperty=Qn,t.uniqueId=p,t.Actor=Ss,t.pick=function(t,e){for(var n={},r=0;r<e.length;r++){var i=e[r];i in t&&(n[i]=t[i])}return n},t.wrap=function(t,e,n){var r=n-e,i=((t-e)%r+r)%r+e;return i===e?n:i},t.clamp=l,t.Event=R,t.ErrorEvent=j,t.OverscaledTileID=ks,t.EXTENT=di,t.getCoordinatesCenter=function(t){for(var e=1/0,n=1/0,r=-1/0,o=-1/0,a=0;a<t.length;a++)e=Math.min(e,t[a].column),n=Math.min(n,t[a].row),r=Math.max(r,t[a].column),o=Math.max(o,t[a].row);var s=r-e,u=o-n,c=Math.max(s,u),l=Math.max(0,Math.floor(-Math.log(c)/Math.LN2));return new i((e+r)/2,(n+o)/2,0).zoomTo(l)},t.CanonicalTileID=Ts,t.StructArrayLayout4i8=fr,t.rasterBoundsAttributes=Ms,t.SegmentVector=Wr,t.getVideo=function(t,e){var n,r,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var o=0;o<t.length;o++){var a=self.document.createElement("source");n=t[o],r=void 0,(r=self.document.createElement("a")).href=n,(r.protocol!==self.document.location.protocol||r.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),a.src=t[o],i.appendChild(a)}return{cancel:function(){}}},t.ValidationError=F,t.bindAll=d,t.isEqual=s,t.Tile=Fs,t.Coordinate=i,t.keysDifference=function(t,e){var n=[];for(var r in t)r in e||n.push(r);return n},t.SourceFeatureState=js,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.create=function(){var t=new Li(16);return Li!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],p=e[11],d=e[12],v=e[13],g=e[14],m=e[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,E=i*c-o*u,S=l*v-f*d,P=l*g-h*d,T=l*m-p*d,A=f*g-h*v,k=f*m-p*v,C=h*m-p*g,O=y*C-_*k+b*A+x*T-w*P+E*S;return O?(O=1/O,t[0]=(s*C-u*k+c*A)*O,t[1]=(i*k-r*C-o*A)*O,t[2]=(v*E-g*w+m*x)*O,t[3]=(h*w-f*E-p*x)*O,t[4]=(u*T-a*C-c*P)*O,t[5]=(n*C-i*T+o*P)*O,t[6]=(g*b-d*E-m*_)*O,t[7]=(l*E-h*b+p*_)*O,t[8]=(a*k-s*T+c*S)*O,t[9]=(r*T-n*k-o*S)*O,t[10]=(d*w-v*b+m*y)*O,t[11]=(f*b-l*w-p*y)*O,t[12]=(s*P-a*A-u*S)*O,t[13]=(n*A-r*P+i*S)*O,t[14]=(v*_-d*x-g*y)*O,t[15]=(l*x-f*_+h*y)*O,t):null},t.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],p=e[10],d=e[11],v=e[12],g=e[13],m=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*s+x*f+w*v,t[1]=_*i+b*u+x*h+w*g,t[2]=_*o+b*c+x*p+w*m,t[3]=_*a+b*l+x*d+w*y,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*r+b*s+x*f+w*v,t[5]=_*i+b*u+x*h+w*g,t[6]=_*o+b*c+x*p+w*m,t[7]=_*a+b*l+x*d+w*y,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*r+b*s+x*f+w*v,t[9]=_*i+b*u+x*h+w*g,t[10]=_*o+b*c+x*p+w*m,t[11]=_*a+b*l+x*d+w*y,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*r+b*s+x*f+w*v,t[13]=_*i+b*u+x*h+w*g,t[14]=_*o+b*c+x*p+w*m,t[15]=_*a+b*l+x*d+w*y,t},t.translate=function(t,e,n){var r=n[0],i=n[1],o=n[2],a=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,h=void 0,p=void 0,d=void 0,v=void 0,g=void 0,m=void 0;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],u=e[2],c=e[3],l=e[4],f=e[5],h=e[6],p=e[7],d=e[8],v=e[9],g=e[10],m=e[11],t[0]=a,t[1]=s,t[2]=u,t[3]=c,t[4]=l,t[5]=f,t[6]=h,t[7]=p,t[8]=d,t[9]=v,t[10]=g,t[11]=m,t[12]=a*r+l*i+d*o+e[12],t[13]=s*r+f*i+v*o+e[13],t[14]=u*r+h*i+g*o+e[14],t[15]=c*r+p*i+m*o+e[15]),t},t.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t},t.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t},t.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=void 0;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t},t.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t},t.create$1=Ui,t.normalize=Vi,t.transformMat4=Gi,t.forEach=qi,t.getSizeData=ka,t.evaluateSizeForFeature=function(t,e,n){var r=e;return"source"===t.functionType?n.lowerSize/256:"composite"===t.functionType?Ot(n.lowerSize/256,n.upperSize/256,r.uSizeT):r.uSize},t.evaluateSizeForZoom=function(t,e,n){if("constant"===t.functionType)return{uSizeT:0,uSize:t.layoutSize};if("source"===t.functionType)return{uSizeT:0,uSize:0};if("camera"===t.functionType){var r=t.propertyValue,i=t.zoomRange,o=t.sizeRange,a=l(Ne(r,n.specification).interpolationFactor(e,i.min,i.max),0,1);return{uSizeT:0,uSize:o.min+a*(o.max-o.min)}}var s=t.propertyValue,u=t.zoomRange;return{uSizeT:l(Ne(s,n.specification).interpolationFactor(e,u.min,u.max),0,1),uSize:0}},t.SIZE_PACK_FACTOR=256,t.addDynamicAttributes=Ia,t.properties=Da,t.WritingMode=Ns,t.multiPolygonIntersectsBufferedPoint=_i,t.multiPolygonIntersectsMultiPolygon=bi,t.multiPolygonIntersectsBufferedMultiLine=xi,t.polygonIntersectsPolygon=function(t,e){for(var n=0;n<t.length;n++)if(ki(e,t[n]))return!0;for(var r=0;r<e.length;r++)if(ki(t,e[r]))return!0;return!!Ei(t,e)},t.distToSegmentSquared=Ti,t.SymbolInstanceArray=zr,t.StyleLayer=ir,t.createStyleLayer=function(t){return"custom"===t.type?new Ga(t):new qa[t.type](t)},t.clone=y,t.filterObject=m,t.mapObject=g,t.registerForPluginAvailability=function(t){return Nn?t({pluginURL:Nn,completionCallback:Dn}):Un.once("pluginAvailable",t),t},t.evented=Un,t.ZoomHistory=On,t.validateCustomStyleLayer=function(t){var e=[],n=t.id;return void 0===n&&e.push({message:"layers."+n+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+n+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),e},t.createLayout=ur,t.ProgramConfiguration=li,t.Uniform1i=Kr,t.Uniform1f=Jr,t.Uniform2f=Qr,t.Uniform4f=ti,t.Uniform3f=$r,t.UniformMatrix4f=ri,t.create$2=Ri,t.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.create$3=ji,t.length=zi,t.fromValues=Di,t.normalize$1=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t},t.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},t.len=Ni,t.forEach$1=Bi,t.UniformColor=ei,t.StructArrayLayout2i4=lr,t.StructArrayLayout2ui4=Ar,t.StructArrayLayout3ui6=Tr,t.StructArrayLayout1ui2=kr,t.UnwrappedTileID=As,t.create$4=function(){var t=new Li(4);return Li!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},t.ease=c,t.bezier=u,t.EvaluationParameters=Gn,t.setRTLTextPlugin=function(t,e){if(Fn)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fn=!0,Nn=T.resolveURL(t),Dn=function(t){t?(Fn=!1,Nn=null,e&&e(t)):Bn=!0},Un.fire(new R("pluginAvailable",{pluginURL:Nn,completionCallback:Dn}))},t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.featureFilter=He,t.Anchor=Aa,t.GLYPH_PBF_BORDER=Es,t.shapeText=function(t,e,n,r,i,o,a,s,u,c,l){var f=Bs.fromFeature(t,n);l===Ns.vertical&&f.verticalizePunctuation();var h,p=[],d={positionedGlyphs:p,text:f,top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:l},v=Vn.processBidirectionalText,g=Vn.processStyledBidirectionalText;if(v&&1===f.sections.length){h=[];for(var m=0,y=v(f.toString(),Zs(f,s,r,e));m<y.length;m+=1){var _=y[m],b=new Bs;b.text=_,b.sections=f.sections;for(var x=0;x<_.length;x++)b.sectionIndex.push(0);h.push(b)}}else if(g){h=[];for(var w=0,E=g(f.text,f.sectionIndex,Zs(f,s,r,e));w<E.length;w+=1){var S=E[w],P=new Bs;P.text=S[0],P.sectionIndex=S[1],P.sections=f.sections,h.push(P)}}else h=function(t,e){for(var n=[],r=t.text,i=0,o=0,a=e;o<a.length;o+=1){var s=a[o];n.push(t.substring(i,s)),i=s}return i<r.length&&n.push(t.substring(i,r.length)),n}(f,Zs(f,s,r,e));return function(t,e,n,r,i,o,a,s,u){for(var c=0,l=-17,f=0,h=t.positionedGlyphs,p="right"===o?1:"left"===o?0:.5,d=0,v=n;d<v.length;d+=1){var g=v[d];g.trim();var m=g.getMaxScale();if(g.length()){for(var y=h.length,_=0;_<g.length();_++){var b=g.getSection(_),x=g.getCharCode(_),w=24*(m-b.scale),E=e[b.fontStack],S=E&&E[x];S&&(Rn(x)&&a!==Ns.horizontal?(h.push({glyph:x,x:c,y:w,vertical:!0,scale:b.scale,fontStack:b.fontStack}),c+=u*b.scale+s):(h.push({glyph:x,x:c,y:l+w,vertical:!1,scale:b.scale,fontStack:b.fontStack}),c+=S.metrics.advance*b.scale+s))}if(h.length!==y){var P=c-s;f=Math.max(P,f),Hs(h,e,y,h.length-1,p)}c=0,l+=r*m}else l+=r}var T=Xs(i),A=T.horizontalAlign,k=T.verticalAlign;!function(t,e,n,r,i,o,a){for(var s=(e-n)*i,u=(-r*a+.5)*o,c=0;c<t.length;c++)t[c].x+=s,t[c].y+=u}(h,p,A,k,f,r,n.length);var C=l- -17;t.top+=-k*C,t.bottom=t.top+C,t.left+=-A*f,t.right=t.left+f}(d,e,h,i,o,a,l,s,c),!!p.length&&(d.text=d.text.toString(),d)},t.shapeIcon=function(t,e,n){var r=Xs(n),i=r.horizontalAlign,o=r.verticalAlign,a=e[0],s=e[1],u=a-t.displaySize[0]*i,c=u+t.displaySize[0],l=s-t.displaySize[1]*o;return{image:t,top:l,bottom:l+t.displaySize[1],left:u,right:c}},t.allowsVerticalWritingMode=In,t.allowsLetterSpacing=function(t){for(var e=0,n=t;e<n.length;e+=1)if(!Ln(n[e].charCodeAt(0)))return!1;return!0},t.classifyRings=Ro,t.SymbolBucket=ja,t.register=Tn,t.FeatureIndex=zs,t.CollisionBoxArray=Ir,t.DictionaryCoder=Is,t.LineBucket=pa,t.FillBucket=Fo,t.FillExtrusionBucket=Wo,t.ImageAtlas=Ha,t.mvt=aa,t.Protobuf=ns,t.DEMData=Os,t.vectorTile=aa,t.Point$1=o,t.pbf=ns,t.plugin=Vn}),r(0,function(t){function e(t){var n=typeof t;if("number"===n||"boolean"===n||"string"===n||void 0===t||null===t)return JSON.stringify(t);if(Array.isArray(t)){for(var r="[",i=0,o=t;i<o.length;i+=1)r+=e(o[i])+",";return r+"]"}for(var a=Object.keys(t).sort(),s="{",u=0;u<a.length;u++)s+=JSON.stringify(a[u])+":"+e(t[a[u]])+",";return s+"}"}function n(n){for(var r="",i=0,o=t.refProperties;i<o.length;i+=1)r+="/"+e(n[o[i]]);return r}var r=function(t){t&&this.replace(t)};function i(t,e,n,r,i){if(void 0===e.segment)return!0;for(var o=e,a=e.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;for(var u=[],c=0;s<n/2;){var l=t[a-1],f=t[a],h=t[a+1];if(!h)return!1;var p=l.angleTo(f)-f.angleTo(h);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:p}),c+=p;s-u[0].distance>r;)c-=u.shift().angleDelta;if(c>i)return!1;a++,s+=f.dist(h)}return!0}function o(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function a(t,e,n){return t?.6*e*n:0}function s(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function u(e,n,r,u,c,l){for(var f=a(r,c,l),h=s(r,u)*l,p=0,d=o(e)/2,v=0;v<e.length-1;v++){var g=e[v],m=e[v+1],y=g.dist(m);if(p+y>d){var _=(d-p)/y,b=t.number(g.x,m.x,_),x=t.number(g.y,m.y,_),w=new t.Anchor(b,x,m.angleTo(g),v);return w._round(),!f||i(e,w,h,f,n)?w:void 0}p+=y}}function c(e,n,r,u,c,l,f,h,p){var d=a(u,l,f),v=s(u,c),g=v*f,m=0===e[0].x||e[0].x===p||0===e[0].y||e[0].y===p;return n-g<n/4&&(n=g+n/4),function e(n,r,a,s,u,c,l,f,h){for(var p=c/2,d=o(n),v=0,g=r-a,m=[],y=0;y<n.length-1;y++){for(var _=n[y],b=n[y+1],x=_.dist(b),w=b.angleTo(_);g+a<v+x;){var E=((g+=a)-v)/x,S=t.number(_.x,b.x,E),P=t.number(_.y,b.y,E);if(S>=0&&S<h&&P>=0&&P<h&&g-p>=0&&g+p<=d){var T=new t.Anchor(S,P,w,y);T._round(),s&&!i(n,T,c,s,u)||m.push(T)}}v+=x}return f||m.length||l||(m=e(n,v/2,a,s,u,c,l,!0,h)),m}(e,m?n/2*h%n:(v/2+2*l)*f*h%n,n,d,r,g,m,!1,p)}r.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},r.prototype.update=function(e,r){for(var i=this,o=0,a=e;o<a.length;o+=1){var s=a[o];i._layerConfigs[s.id]=s;var u=i._layers[s.id]=t.createStyleLayer(s);u._featureFilter=t.featureFilter(u.filter)}for(var c=0,l=r;c<l.length;c+=1){var f=l[c];delete i._layerConfigs[f],delete i._layers[f]}this.familiesBySource={};for(var h=0,p=function(t){for(var e={},r=0;r<t.length;r++){var i=n(t[r]),o=e[i];o||(o=e[i]=[]),o.push(t[r])}var a=[];for(var s in e)a.push(e[s]);return a}(t.values(this._layerConfigs));h<p.length;h+=1){var d=p[h].map(function(t){return i._layers[t.id]}),v=d[0];if("none"!==v.visibility){var g=v.source||"",m=i.familiesBySource[g];m||(m=i.familiesBySource[g]={});var y=v.sourceLayer||"_geojsonTileLayer",_=m[y];_||(_=m[y]=[]),_.push(d)}}};var l=function(e,n,r,i,o,a,s,u,c,l,f,h){var p=s.top*u-c,d=s.bottom*u+c,v=s.left*u-c,g=s.right*u+c;if(this.boxStartIndex=e.length,l){var m=d-p,y=g-v;m>0&&(m=Math.max(10*u,m),this._addLineCollisionCircles(e,n,r,r.segment,y,m,i,o,a,f))}else{if(h){var _=new t.Point(v,p),b=new t.Point(g,p),x=new t.Point(v,d),w=new t.Point(g,d),E=h*Math.PI/180;_._rotate(E),b._rotate(E),x._rotate(E),w._rotate(E),v=Math.min(_.x,b.x,x.x,w.x),g=Math.max(_.x,b.x,x.x,w.x),p=Math.min(_.y,b.y,x.y,w.y),d=Math.max(_.y,b.y,x.y,w.y)}e.emplaceBack(r.x,r.y,v,p,g,d,i,o,a,0,0)}this.boxEndIndex=e.length};l.prototype._addLineCollisionCircles=function(t,e,n,r,i,o,a,s,u,c){var l=o/2,f=Math.floor(i/l)||1,h=1+.4*Math.log(c)/Math.LN2,p=Math.floor(f*h/2),d=-o/2,v=n,g=r+1,m=d,y=-i/2,_=y-i/4;do{if(--g<0){if(m>y)return;g=0;break}m-=e[g].dist(v),v=e[g]}while(m>_);for(var b=e[g].dist(e[g+1]),x=-p;x<f+p;x++){var w=x*l,E=y+w;if(w<0&&(E+=w),w>i&&(E+=w-i),!(E<m)){for(;m+b<E;){if(m+=b,++g+1>=e.length)return;b=e[g].dist(e[g+1])}var S=E-m,P=e[g],T=e[g+1].sub(P)._unit()._mult(S)._add(P)._round(),A=Math.abs(E-d)<l?0:.8*(E-d);t.emplaceBack(T.x,T.y,-o/2,-o/2,o/2,o/2,a,s,u,o/2,A)}}};var f=p,h=p;function p(t,e){if(!(this instanceof p))return new p(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||d,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function d(t,e){return t<e?-1:t>e?1:0}function v(e,n,r){void 0===n&&(n=1),void 0===r&&(r=!1);for(var i=1/0,o=1/0,a=-1/0,s=-1/0,u=e[0],c=0;c<u.length;c++){var l=u[c];(!c||l.x<i)&&(i=l.x),(!c||l.y<o)&&(o=l.y),(!c||l.x>a)&&(a=l.x),(!c||l.y>s)&&(s=l.y)}var h=a-i,p=s-o,d=Math.min(h,p),v=d/2,y=new f(null,g);if(0===d)return new t.Point(i,o);for(var _=i;_<a;_+=d)for(var b=o;b<s;b+=d)y.push(new m(_+v,b+v,v,e));for(var x=function(t){for(var e=0,n=0,r=0,i=t[0],o=0,a=i.length,s=a-1;o<a;s=o++){var u=i[o],c=i[s],l=u.x*c.y-c.x*u.y;n+=(u.x+c.x)*l,r+=(u.y+c.y)*l,e+=3*l}return new m(n/e,r/e,0,t)}(e),w=y.length;y.length;){var E=y.pop();(E.d>x.d||!x.d)&&(x=E,r&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,w)),E.max-x.d<=n||(v=E.h/2,y.push(new m(E.p.x-v,E.p.y-v,v,e)),y.push(new m(E.p.x+v,E.p.y-v,v,e)),y.push(new m(E.p.x-v,E.p.y+v,v,e)),y.push(new m(E.p.x+v,E.p.y+v,v,e)),w+=4)}return r&&(console.log("num probes: "+w),console.log("best distance: "+x.d)),x.p}function g(t,e){return e.max-t.max}function m(e,n,r,i){this.p=new t.Point(e,n),this.h=r,this.d=function(e,n){for(var r=!1,i=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,u=a.length,c=u-1;s<u;c=s++){var l=a[s],f=a[c];l.y>e.y!=f.y>e.y&&e.x<(f.x-l.x)*(e.y-l.y)/(f.y-l.y)+l.x&&(r=!r),i=Math.min(i,t.distToSegmentSquared(e,l,f))}return(r?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}p.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,r=e[t];t>0;){var i=t-1>>1,o=e[i];if(n(r,o)>=0)break;e[t]=o,t=i}e[t]=r},_down:function(t){for(var e=this.data,n=this.compare,r=this.length>>1,i=e[t];t<r;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,i)>=0)break;e[t]=s,t=o}e[t]=i}},f.default=h;var y=t.createCommonjsModule(function(t){t.exports=function(t,e){var n,r,i,o,a,s,u,c;for(n=3&t.length,r=t.length-n,i=e,a=3432918353,s=461845907,c=0;c<r;)u=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,n){case 3:u^=(255&t.charCodeAt(c+2))<<16;case 2:u^=(255&t.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&t.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}}),_=y,b=y,x=t.createCommonjsModule(function(t){t.exports=function(t,e){for(var n,r=t.length,i=e^r,o=0;r>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&t.charCodeAt(o+2))<<16;case 2:i^=(255&t.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}});function w(e,n,r,i,o,a){e.createArrays();var s=512*e.overscaling;e.tilePixelRatio=t.EXTENT/s,e.compareText={},e.iconsNeedLinear=!1;var u=e.layers[0].layout,c=e.layers[0]._unevaluatedLayout._values,l={};if("composite"===e.textSizeData.functionType){var f=e.textSizeData.zoomRange,h=f.min,p=f.max;l.compositeTextSizes=[c["text-size"].possiblyEvaluate(new t.EvaluationParameters(h)),c["text-size"].possiblyEvaluate(new t.EvaluationParameters(p))]}if("composite"===e.iconSizeData.functionType){var d=e.iconSizeData.zoomRange,v=d.min,g=d.max;l.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new t.EvaluationParameters(v)),c["icon-size"].possiblyEvaluate(new t.EvaluationParameters(g))]}l.layoutTextSize=c["text-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),l.layoutIconSize=c["icon-size"].possiblyEvaluate(new t.EvaluationParameters(e.zoom+1)),l.textMaxSize=c["text-size"].possiblyEvaluate(new t.EvaluationParameters(18));for(var m=24*u.get("text-line-height"),y="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),_=u.get("text-keep-upright"),b=0,x=e.features;b<x.length;b+=1){var w=x[b],S=u.get("text-font").evaluate(w,{}).join(","),P=r,T={},A=w.text;if(A){var k=A.toString(),C=u.get("text-offset").evaluate(w,{}).map(function(t){return 24*t}),O=24*u.get("text-letter-spacing").evaluate(w,{}),M=t.allowsLetterSpacing(k)?O:0,I=u.get("text-anchor").evaluate(w,{}),L=u.get("text-justify").evaluate(w,{}),R="point"===u.get("symbol-placement")?24*u.get("text-max-width").evaluate(w,{}):0;T.horizontal=t.shapeText(A,n,S,R,m,I,L,M,C,24,t.WritingMode.horizontal),t.allowsVerticalWritingMode(k)&&y&&_&&(T.vertical=t.shapeText(A,n,S,R,m,I,L,M,C,24,t.WritingMode.vertical))}var j=void 0;if(w.icon){var z=i[w.icon];z&&(j=t.shapeIcon(o[w.icon],u.get("icon-offset").evaluate(w,{}),u.get("icon-anchor").evaluate(w,{})),void 0===e.sdfIcons?e.sdfIcons=z.sdf:e.sdfIcons!==z.sdf&&t.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),z.pixelRatio!==e.pixelRatio?e.iconsNeedLinear=!0:0!==u.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0))}(T.horizontal||j)&&E(e,w,T,j,P,l)}a&&e.generateCollisionDebugBuffers()}function E(e,n,r,i,o,a){var s=a.layoutTextSize.evaluate(n,{}),f=a.layoutIconSize.evaluate(n,{}),h=a.textMaxSize.evaluate(n,{});void 0===h&&(h=s);var p=e.layers[0].layout,d=p.get("text-offset").evaluate(n,{}),g=p.get("icon-offset").evaluate(n,{}),m=s/24,y=e.tilePixelRatio*m,b=e.tilePixelRatio*h/24,x=e.tilePixelRatio*f,w=e.tilePixelRatio*p.get("symbol-spacing"),E=p.get("text-padding")*e.tilePixelRatio,A=p.get("icon-padding")*e.tilePixelRatio,k=p.get("text-max-angle")/180*Math.PI,C="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),O="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),M=p.get("symbol-placement"),I=w/2,L=function(s,u){u.x<0||u.x>=t.EXTENT||u.y<0||u.y>=t.EXTENT||function(e,n,r,i,o,a,s,u,c,f,h,p,d,v,g,m,y,b,x,w,E){var T,A,k=e.addToLineVertexArray(n,r),C=0,O=0,M=0,I=_(i.horizontal?i.horizontal.text:""),L=[];if(i.horizontal){var R=a.layout.get("text-rotate").evaluate(x,{});T=new l(s,r,n,u,c,f,i.horizontal,h,p,d,e.overscaling,R),O+=P(e,n,i.horizontal,a,d,x,v,k,i.vertical?t.WritingMode.horizontal:t.WritingMode.horizontalOnly,L,w,E),i.vertical&&(M+=P(e,n,i.vertical,a,d,x,v,k,t.WritingMode.vertical,L,w,E))}var j=T?T.boxStartIndex:e.collisionBoxArray.length,z=T?T.boxEndIndex:e.collisionBoxArray.length;if(o){var D=function(e,n,r,i,o,a){var s,u,c,l,f=n.image,h=r.layout,p=n.top-1/f.pixelRatio,d=n.left-1/f.pixelRatio,v=n.bottom+1/f.pixelRatio,g=n.right+1/f.pixelRatio;if("none"!==h.get("icon-text-fit")&&o){var m=g-d,y=v-p,_=h.get("text-size").evaluate(a,{})/24,b=o.left*_,x=o.right*_,w=o.top*_,E=x-b,S=o.bottom*_-w,P=h.get("icon-text-fit-padding")[0],T=h.get("icon-text-fit-padding")[1],A=h.get("icon-text-fit-padding")[2],k=h.get("icon-text-fit-padding")[3],C="width"===h.get("icon-text-fit")?.5*(S-y):0,O="height"===h.get("icon-text-fit")?.5*(E-m):0,M="width"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?E:m,I="height"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?S:y;s=new t.Point(b+O-k,w+C-P),u=new t.Point(b+O+T+M,w+C-P),c=new t.Point(b+O+T+M,w+C+A+I),l=new t.Point(b+O-k,w+C+A+I)}else s=new t.Point(d,p),u=new t.Point(g,p),c=new t.Point(g,v),l=new t.Point(d,v);var L=r.layout.get("icon-rotate").evaluate(a,{})*Math.PI/180;if(L){var R=Math.sin(L),j=Math.cos(L),z=[j,-R,R,j];s._matMult(z),u._matMult(z),l._matMult(z),c._matMult(z)}return[{tl:s,tr:u,bl:l,br:c,tex:f.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,o,a,0,i.horizontal,x),F=a.layout.get("icon-rotate").evaluate(x,{});A=new l(s,r,n,u,c,f,o,g,m,!1,e.overscaling,F),C=4*D.length;var N=e.iconSizeData,B=null;"source"===N.functionType?(B=[t.SIZE_PACK_FACTOR*a.layout.get("icon-size").evaluate(x,{})])[0]>S&&t.warnOnce(e.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===N.functionType&&((B=[t.SIZE_PACK_FACTOR*E.compositeIconSizes[0].evaluate(x,{}),t.SIZE_PACK_FACTOR*E.compositeIconSizes[1].evaluate(x,{})])[0]>S||B[1]>S)&&t.warnOnce(e.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),e.addSymbols(e.icon,D,B,b,y,x,!1,n,k.lineStartIndex,k.lineLength)}var U=A?A.boxStartIndex:e.collisionBoxArray.length,V=A?A.boxEndIndex:e.collisionBoxArray.length;e.glyphOffsetArray.length>=t.SymbolBucket.MAX_GLYPHS&&t.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),e.symbolInstances.emplaceBack(n.x,n.y,L.length>0?L[0]:-1,L.length>1?L[1]:-1,I,j,z,U,V,u,O,M,C,0)}(e,u,s,r,i,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,y,E,C,d,x,A,O,g,n,o,a)};if("line"===M)for(var R=0,j=function(e,n,r,i,o){for(var a=[],s=0;s<e.length;s++)for(var u=e[s],c=void 0,l=0;l<u.length-1;l++){var f=u[l],h=u[l+1];f.x<0&&h.x<0||(f.x<0?f=new t.Point(0,f.y+(h.y-f.y)*((0-f.x)/(h.x-f.x)))._round():h.x<0&&(h=new t.Point(0,f.y+(h.y-f.y)*((0-f.x)/(h.x-f.x)))._round()),f.y<0&&h.y<0||(f.y<0?f=new t.Point(f.x+(h.x-f.x)*((0-f.y)/(h.y-f.y)),0)._round():h.y<0&&(h=new t.Point(f.x+(h.x-f.x)*((0-f.y)/(h.y-f.y)),0)._round()),f.x>=i&&h.x>=i||(f.x>=i?f=new t.Point(i,f.y+(h.y-f.y)*((i-f.x)/(h.x-f.x)))._round():h.x>=i&&(h=new t.Point(i,f.y+(h.y-f.y)*((i-f.x)/(h.x-f.x)))._round()),f.y>=o&&h.y>=o||(f.y>=o?f=new t.Point(f.x+(h.x-f.x)*((o-f.y)/(h.y-f.y)),o)._round():h.y>=o&&(h=new t.Point(f.x+(h.x-f.x)*((o-f.y)/(h.y-f.y)),o)._round()),c&&f.equals(c[c.length-1])||(c=[f],a.push(c)),c.push(h)))))}return a}(n.geometry,0,0,t.EXTENT,t.EXTENT);R<j.length;R+=1)for(var z=j[R],D=0,F=c(z,w,k,r.vertical||r.horizontal,i,24,b,e.overscaling,t.EXTENT);D<F.length;D+=1){var N=F[D],B=r.horizontal;B&&T(e,B.text,I,N)||L(z,N)}else if("line-center"===M)for(var U=0,V=n.geometry;U<V.length;U+=1){var G=V[U];if(G.length>1){var q=u(G,k,r.vertical||r.horizontal,i,24,b);q&&L(G,q)}}else if("Polygon"===n.type)for(var W=0,Z=t.classifyRings(n.geometry,0);W<Z.length;W+=1){var X=Z[W],H=v(X,16);L(X[0],new t.Anchor(H.x,H.y,0))}else if("LineString"===n.type)for(var Y=0,K=n.geometry;Y<K.length;Y+=1){var J=K[Y];L(J,new t.Anchor(J[0].x,J[0].y,0))}else if("Point"===n.type)for(var Q=0,$=n.geometry;Q<$.length;Q+=1)for(var tt=0,et=$[Q];tt<et.length;tt+=1){var nt=et[tt];L([nt],new t.Anchor(nt.x,nt.y,0))}}_.murmur3=b,_.murmur2=x;var S=65535;function P(e,n,r,i,o,a,s,u,c,l,f,h){var p=function(e,n,r,i,o,a){for(var s=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=r.layout.get("text-offset").evaluate(o,{}).map(function(t){return 24*t}),c=n.positionedGlyphs,l=[],f=0;f<c.length;f++){var h=c[f],p=a[h.fontStack],d=p&&p[h.glyph];if(d){var v=d.rect;if(v){var g=t.GLYPH_PBF_BORDER+1,m=d.metrics.advance*h.scale/2,y=i?[h.x+m,h.y]:[0,0],_=i?[0,0]:[h.x+m+u[0],h.y+u[1]],b=(d.metrics.left-g)*h.scale-m+_[0],x=(-d.metrics.top-g)*h.scale+_[1],w=b+v.w*h.scale,E=x+v.h*h.scale,S=new t.Point(b,x),P=new t.Point(w,x),T=new t.Point(b,E),A=new t.Point(w,E);if(i&&h.vertical){var k=new t.Point(-m,m),C=-Math.PI/2,O=new t.Point(5,0);S._rotateAround(C,k)._add(O),P._rotateAround(C,k)._add(O),T._rotateAround(C,k)._add(O),A._rotateAround(C,k)._add(O)}if(s){var M=Math.sin(s),I=Math.cos(s),L=[I,-M,M,I];S._matMult(L),P._matMult(L),T._matMult(L),A._matMult(L)}l.push({tl:S,tr:P,bl:T,br:A,tex:v,writingMode:n.writingMode,glyphOffset:y})}}}return l}(0,r,i,o,a,f),d=e.textSizeData,v=null;return"source"===d.functionType?(v=[t.SIZE_PACK_FACTOR*i.layout.get("text-size").evaluate(a,{})])[0]>S&&t.warnOnce(e.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===d.functionType&&((v=[t.SIZE_PACK_FACTOR*h.compositeTextSizes[0].evaluate(a,{}),t.SIZE_PACK_FACTOR*h.compositeTextSizes[1].evaluate(a,{})])[0]>S||v[1]>S)&&t.warnOnce(e.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),e.addSymbols(e.text,p,v,s,o,a,c,n,u.lineStartIndex,u.lineLength),l.push(e.text.placedSymbolArray.length-1),4*p.length}function T(t,e,n,r){var i=t.compareText;if(e in i){for(var o=i[e],a=o.length-1;a>=0;a--)if(r.dist(o[a])<n)return!0}else i[e]=[];return i[e].push(r),!1}var A=function(e){var n={},r=[];for(var i in e){var o=e[i],a=n[i]={};for(var s in o){var u=o[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};r.push(c),a[s]={rect:c,metrics:u.metrics}}}}var l=t.potpack(r),f=l.w,h=l.h,p=new t.AlphaImage({width:f||1,height:h||1});for(var d in e){var v=e[d];for(var g in v){var m=v[+g];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var y=n[d][g].rect;t.AlphaImage.copy(m.bitmap,p,{x:0,y:0},{x:y.x+1,y:y.y+1},m.bitmap)}}}this.image=p,this.positions=n};t.register("GlyphAtlas",A);var k=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};function C(e,n){for(var r=new t.EvaluationParameters(n),i=0,o=e;i<o.length;i+=1)o[i].recalculate(r)}k.prototype.parse=function(e,n,r,i){var o=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var a=new t.DictionaryCoder(Object.keys(e.layers).sort()),s=new t.FeatureIndex(this.tileID);s.bucketLayerIDs=[];var u,c,l,f,h={},p={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{}},d=n.familiesBySource[this.source];for(var v in d){var g=e.layers[v];if(g){1===g.version&&t.warnOnce('Vector tile source "'+o.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var m=a.encode(v),y=[],_=0;_<g.length;_++){var b=g.feature(_);y.push({feature:b,index:_,sourceLayerIndex:m})}for(var x=0,E=d[v];x<E.length;x+=1){var S=E[x],P=S[0];P.minzoom&&o.zoom<Math.floor(P.minzoom)||P.maxzoom&&o.zoom>=P.maxzoom||"none"!==P.visibility&&(C(S,o.zoom),(h[P.id]=P.createBucket({index:s.bucketLayerIDs.length,layers:S,zoom:o.zoom,pixelRatio:o.pixelRatio,overscaling:o.overscaling,collisionBoxArray:o.collisionBoxArray,sourceLayerIndex:m,sourceID:o.source})).populate(y,p),s.bucketLayerIDs.push(S.map(function(t){return t.id})))}}}var T=t.mapObject(p.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(T).length?r.send("getGlyphs",{uid:this.uid,stacks:T},function(t,e){u||(u=t,c=e,M.call(o))}):c={};var k=Object.keys(p.iconDependencies);k.length?r.send("getImages",{icons:k},function(t,e){u||(u=t,l=e,M.call(o))}):l={};var O=Object.keys(p.patternDependencies);function M(){if(u)return i(u);if(c&&l&&f){var e=new A(c),n=new t.ImageAtlas(l,f);for(var r in h){var o=h[r];o instanceof t.SymbolBucket?(C(o.layers,this.zoom),w(o,c,e.positions,l,n.iconPositions,this.showCollisionBoxes)):o.hasPattern&&(o instanceof t.LineBucket||o instanceof t.FillBucket||o instanceof t.FillExtrusionBucket)&&(C(o.layers,this.zoom),o.addFeatures(p,n.patternPositions))}this.status="done",i(null,{buckets:t.values(h).filter(function(t){return!t.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:n})}}O.length?r.send("getImages",{icons:O},function(t,e){u||(u=t,f=e,M.call(o))}):f={},M.call(this)};var O="undefined"!=typeof performance,M={getEntriesByName:function(t){return!!(O&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(t)},mark:function(t){return!!(O&&performance&&performance.mark)&&performance.mark(t)},measure:function(t,e,n){return!!(O&&performance&&performance.measure)&&performance.measure(t,e,n)},clearMarks:function(t){return!!(O&&performance&&performance.clearMarks)&&performance.clearMarks(t)},clearMeasures:function(t){return!!(O&&performance&&performance.clearMeasures)&&performance.clearMeasures(t)}},I=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},M.mark(this._marks.start)};function L(e,n){var r=t.getArrayBuffer(e.request,function(e,r){e?n(e):r&&n(null,{vectorTile:new t.mvt.VectorTile(new t.Protobuf(r.data)),rawData:r.data,cacheControl:r.cacheControl,expires:r.expires})});return function(){r.cancel(),n()}}I.prototype.finish=function(){M.mark(this._marks.end);var t=M.getEntriesByName(this._marks.measure);return 0===t.length&&(M.measure(this._marks.measure,this._marks.start,this._marks.end),t=M.getEntriesByName(this._marks.measure),M.clearMarks(this._marks.start),M.clearMarks(this._marks.end),M.clearMeasures(this._marks.measure)),t},M.Performance=I;var R=function(t,e,n){this.actor=t,this.layerIndex=e,this.loadVectorData=n||L,this.loading={},this.loaded={}};R.prototype.loadTile=function(e,n){var r=this,i=e.uid;this.loading||(this.loading={});var o=!!(e&&e.request&&e.request.collectResourceTiming)&&new M.Performance(e.request),a=this.loading[i]=new k(e);a.abort=this.loadVectorData(e,function(e,s){if(delete r.loading[i],e||!s)return a.status="done",r.loaded[i]=a,n(e);var u=s.rawData,c={};s.expires&&(c.expires=s.expires),s.cacheControl&&(c.cacheControl=s.cacheControl);var l={};if(o){var f=o.finish();f&&(l.resourceTiming=JSON.parse(JSON.stringify(f)))}a.vectorTile=s.vectorTile,a.parse(s.vectorTile,r.layerIndex,r.actor,function(e,r){if(e||!r)return n(e);n(null,t.extend({rawTileData:u.slice(0)},r,c,l))}),r.loaded=r.loaded||{},r.loaded[i]=a})},R.prototype.reloadTile=function(t,e){var n=this.loaded,r=t.uid,i=this;if(n&&n[r]){var o=n[r];o.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,n){var r=o.reloadCallback;r&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,i.actor,r)),e(t,n)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.actor,a):a())}},R.prototype.abortTile=function(t,e){var n=this.loading,r=t.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),e()},R.prototype.removeTile=function(t,e){var n=this.loaded,r=t.uid;n&&n[r]&&delete n[r],e()};var j=function(){this.loaded={}};j.prototype.loadTile=function(e,n){var r=e.uid,i=e.encoding,o=e.rawImageData,a=new t.DEMData(r,o,i);this.loaded=this.loaded||{},this.loaded[r]=a,n(null,a)},j.prototype.removeTile=function(t){var e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]};var z={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function D(t){var e=0;if(t&&t.length>0){e+=Math.abs(F(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(F(t[n]))}return e}function F(t){var e,n,r,i,o,a,s=0,u=t.length;if(u>2){for(a=0;a<u;a++)a===u-2?(r=u-2,i=u-1,o=0):a===u-1?(r=u-1,i=0,o=1):(r=a,i=a+1,o=a+2),e=t[r],n=t[i],s+=(N(t[o][0])-N(e[0]))*Math.sin(N(n[1]));s=s*z.RADIUS*z.RADIUS/2}return s}function N(t){return t*Math.PI/180}var B={geometry:function t(e){var n,r=0;switch(e.type){case"Polygon":return D(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)r+=D(e.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)r+=t(e.geometries[n]);return r}},ring:F};function U(t,e){return function(n){return t(n,e)}}function V(t,e){e=!!e,t[0]=G(t[0],e);for(var n=1;n<t.length;n++)t[n]=G(t[n],!e);return t}function G(t,e){return function(t){return B.ring(t)>=0}(t)===e?t:t.reverse()}var q=t.mvt.VectorTileFeature.prototype.toGeoJSON,W=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};W.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],n=0,r=this._feature.geometry;n<r.length;n+=1){var i=r[n];e.push([new t.Point(i[0],i[1])])}return e}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var u=[],c=0,l=s[a];c<l.length;c+=1){var f=l[c];u.push(new t.Point(f[0],f[1]))}o.push(u)}return o},W.prototype.toGeoJSON=function(t,e,n){return q.call(this,t,e,n)};var Z=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};Z.prototype.feature=function(t){return new W(this._features[t])};var X=t.vectorTile.VectorTileFeature,H=Y;function Y(t,e){this.options=e||{},this.features=t,this.length=t.length}function K(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}Y.prototype.feature=function(t){return new K(this.features[t],this.options.extent)},K.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++)i.push(new t.Point$1(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},K.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var u=a[s];e=Math.min(e,u.x),n=Math.max(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.y)}return[e,r,n,i]},K.prototype.toGeoJSON=X.prototype.toGeoJSON;var J=tt,Q=tt,$=H;function tt(e){var n=new t.pbf;return function(t,e){for(var n in t.layers)e.writeMessage(3,et,t.layers[n])}(e,n),n.finish()}function et(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)r.feature=t.feature(n),e.writeMessage(2,nt,r);var i=r.keys;for(n=0;n<i.length;n++)e.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)e.writeMessage(4,st,o[n])}function nt(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,rt,t),e.writeVarintField(3,n.type),e.writeMessage(4,at,n)}function rt(t,e){var n=t.feature,r=t.keys,i=t.values,o=t.keycache,a=t.valuecache;for(var s in n.properties){var u=o[s];void 0===u&&(r.push(s),u=r.length-1,o[s]=u),e.writeVarint(u);var c=n.properties[s],l=typeof c;"string"!==l&&"boolean"!==l&&"number"!==l&&(c=JSON.stringify(c));var f=l+":"+c,h=a[f];void 0===h&&(i.push(c),h=i.length-1,a[f]=h),e.writeVarint(h)}}function it(t,e){return(e<<3)+(7&t)}function ot(t){return t<<1^t>>31}function at(t,e){for(var n=t.loadGeometry(),r=t.type,i=0,o=0,a=n.length,s=0;s<a;s++){var u=n[s],c=1;1===r&&(c=u.length),e.writeVarint(it(1,c));for(var l=3===r?u.length-1:u.length,f=0;f<l;f++){1===f&&1!==r&&e.writeVarint(it(2,l-1));var h=u[f].x-i,p=u[f].y-o;e.writeVarint(ot(h)),e.writeVarint(ot(p)),i+=h,o+=p}3===r&&e.writeVarint(it(7,1))}}function st(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function ut(t,e,n,r){ct(t,n,r),ct(e,2*n,2*r),ct(e,2*n+1,2*r+1)}function ct(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function lt(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}function ft(t,e,n,r,i){return new ht(t,e,n,r,i)}function ht(t,e,n,r,i){e=e||pt,n=n||dt,i=i||Array,this.nodeSize=r||64,this.points=t,this.ids=new i(t.length),this.coords=new i(2*t.length);for(var o=0;o<t.length;o++)this.ids[o]=o,this.coords[2*o]=e(t[o]),this.coords[2*o+1]=n(t[o]);!function t(e,n,r,i,o,a){if(!(o-i<=r)){var s=Math.floor((i+o)/2);!function t(e,n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);t(e,n,r,Math.max(i,Math.floor(r-u*l/s+f)),Math.min(o,Math.floor(r+(s-u)*l/s+f)),a)}var h=n[2*r+a],p=i,d=o;for(ut(e,n,i,r),n[2*o+a]>h&&ut(e,n,i,o);p<d;){for(ut(e,n,p,d),p++,d--;n[2*p+a]<h;)p++;for(;n[2*d+a]>h;)d--}n[2*i+a]===h?ut(e,n,i,d):ut(e,n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(e,n,s,i,o,a%2),t(e,n,r,i,s-1,a+1),t(e,n,r,s+1,o,a+1)}}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function pt(t){return t[0]}function dt(t){return t[1]}function vt(t){this.options=xt(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function gt(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function mt(t){return{type:"Feature",id:t.id,properties:yt(t),geometry:{type:"Point",coordinates:[(r=t.x,360*(r-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,r}function yt(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return xt(xt({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function _t(t){return t/360+.5}function bt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function xt(t,e){for(var n in e)t[n]=e[n];return t}function wt(t){return t.x}function Et(t){return t.y}function St(t,e,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((t-n)*a+(e-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return(a=t-n)*a+(s=e-r)*s}function Pt(t,e,n,r){var i={id:void 0===t?null:t,type:e,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Tt(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<e.length;r++)Tt(t,e[r]);else if("MultiPolygon"===n)for(r=0;r<e.length;r++)for(var i=0;i<e[r].length;i++)Tt(t,e[r][i])}(i),i}function Tt(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function At(t,e,n,r){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)kt(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)kt(i[c],s);else if("LineString"===o)Ct(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<i.length;c++)s=[],Ct(i[c],s,a,!1),t.push(Pt(u,"LineString",s,e.properties));return}Ot(i,s,a,!1)}else if("Polygon"===o)Ot(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<e.geometry.geometries.length;c++)At(t,{id:u,geometry:e.geometry.geometries[c],properties:e.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];Ot(i[c],l,a,!0),s.push(l)}}t.push(Pt(u,o,s,e.properties))}}function kt(t,e){e.push(Mt(t[0])),e.push(It(t[1])),e.push(0)}function Ct(t,e,n,r){for(var i,o,a=0,s=0;s<t.length;s++){var u=Mt(t[s][0]),c=It(t[s][1]);e.push(u),e.push(c),e.push(0),s>0&&(a+=r?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=e.length-3;e[2]=1,function t(e,n,r,i){for(var o,a=i,s=r-n>>1,u=r-n,c=e[n],l=e[n+1],f=e[r],h=e[r+1],p=n+3;p<r;p+=3){var d=St(e[p],e[p+1],c,l,f,h);if(d>a)o=p,a=d;else if(d===a){var v=Math.abs(p-s);v<u&&(o=p,u=v)}}a>i&&(o-n>3&&t(e,n,o,i),e[o+2]=a,r-o>3&&t(e,o,r,i))}(e,0,l,n),e[l+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Ot(t,e,n,r){for(var i=0;i<t.length;i++){var o=[];Ct(t[i],o,n,r),e.push(o)}}function Mt(t){return t/360+.5}function It(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Lt(t,e,n,r,i,o,a,s){if(r/=e,o>=(n/=e)&&a<r)return t;if(a<n||o>=r)return null;for(var u=[],c=0;c<t.length;c++){var l=t[c],f=l.geometry,h=l.type,p=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(p>=n&&d<r)u.push(l);else if(!(d<n||p>=r)){var v=[];if("Point"===h||"MultiPoint"===h)Rt(f,v,n,r,i);else if("LineString"===h)jt(f,v,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===h)Dt(f,v,n,r,i,!1);else if("Polygon"===h)Dt(f,v,n,r,i,!0);else if("MultiPolygon"===h)for(var g=0;g<f.length;g++){var m=[];Dt(f[g],m,n,r,i,!0),m.length&&v.push(m)}if(v.length){if(s.lineMetrics&&"LineString"===h){for(g=0;g<v.length;g++)u.push(Pt(l.id,h,v[g],l.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===v.length?(h="LineString",v=v[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===v.length?"Point":"MultiPoint"),u.push(Pt(l.id,h,v,l.tags))}}}return u.length?u:null}function Rt(t,e,n,r,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];a>=n&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function jt(t,e,n,r,i,o,a){for(var s,u,c=zt(t),l=0===i?Nt:Bt,f=t.start,h=0;h<t.length-3;h+=3){var p=t[h],d=t[h+1],v=t[h+2],g=t[h+3],m=t[h+4],y=0===i?p:d,_=0===i?g:m,b=!1;a&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(d-m,2))),y<n?_>=n&&(u=l(c,p,d,g,m,n),a&&(c.start=f+s*u)):y>=r?_<r&&(u=l(c,p,d,g,m,r),a&&(c.start=f+s*u)):Ft(c,p,d,v),_<n&&y>=n&&(u=l(c,p,d,g,m,n),b=!0),_>r&&y<=r&&(u=l(c,p,d,g,m,r),b=!0),!o&&b&&(a&&(c.end=f+s*u),e.push(c),c=zt(t)),a&&(f+=s)}var x=t.length-3;p=t[x],d=t[x+1],v=t[x+2],(y=0===i?p:d)>=n&&y<=r&&Ft(c,p,d,v),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&Ft(c,c[0],c[1],c[2]),c.length&&e.push(c)}function zt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Dt(t,e,n,r,i,o){for(var a=0;a<t.length;a++)jt(t[a],e,n,r,i,o,!1)}function Ft(t,e,n,r){t.push(e),t.push(n),t.push(r)}function Nt(t,e,n,r,i,o){var a=(o-e)/(r-e);return t.push(o),t.push(n+(i-n)*a),t.push(1),a}function Bt(t,e,n,r,i,o){var a=(o-n)/(i-n);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function Ut(t,e){for(var n=[],r=0;r<t.length;r++){var i,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=Vt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(Vt(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(Vt(o.geometry[s][c],e));i.push(u)}n.push(Pt(o.id,a,i,o.tags))}return n}function Vt(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}function Gt(t,e){if(t.transformed)return t;var n,r,i,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(r=0;r<c.length;r+=2)u.geometry.push(qt(c[r],c[r+1],e,o,a,s));else for(r=0;r<c.length;r++){var f=[];for(i=0;i<c[r].length;i+=2)f.push(qt(c[r][i],c[r][i+1],e,o,a,s));u.geometry.push(f)}}return t.transformed=!0,t}function qt(t,e,n,r,i,o){return[Math.round(n*(t*r-i)),Math.round(n*(e*r-o))]}function Wt(t,e,n,r,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Zt(a,t[s],o,i);var u=t[s].minX,c=t[s].minY,l=t[s].maxX,f=t[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),f>a.maxY&&(a.maxY=f)}return a}function Zt(t,e,n,r){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Xt(a,i,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)Xt(a,i[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)Xt(a,c[s],t,n,!0,0===s)}if(a.length){var l=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var f in l={},e.tags)l[f]=e.tags[f];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var h={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==e.id&&(h.id=e.id),t.features.push(h)}}function Xt(t,e,n,r,i,o){var a=r*r;if(r>0&&e.size<(i?a:r))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===r||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;i&&function(t,e){for(var n=0,r=0,i=t.length,o=i-2;r<i;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(r=0,i=t.length;r<i/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[i-2-r],t[r+1]=t[i-1-r],t[i-2-r]=a,t[i-1-r]=s}}(s,o),t.push(s)}}function Ht(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)At(n,t.features[r],e,r);else"Feature"===t.type?At(n,t,e):At(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(t,e){var n=e.buffer/e.extent,r=t,i=Lt(t,1,-1-n,n,0,-1,2,e),o=Lt(t,1,1-n,2+n,0,-1,2,e);return(i||o)&&(r=Lt(t,1,-n,1+n,0,-1,2,e)||[],i&&(r=Ut(i,1).concat(r)),o&&(r=r.concat(Ut(o,-1)))),r}(r,e)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yt(t,e,n){return 32*((1<<t)*n+e)+t}function Kt(t,e){var n=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return e(null,null);var i=new Z(r.features),o=J(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:i,rawData:o.buffer})}J.fromVectorTileJs=Q,J.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var r in t)n[r]=new H(t[r].features,e),n[r].name=r,n[r].version=e.version,n[r].extent=e.extent;return tt({layers:n})},J.GeoJSONWrapper=$,ht.prototype={range:function(t,e,n,r){return function(t,e,n,r,i,o,a){for(var s,u,c=[0,t.length-1,0],l=[];c.length;){var f=c.pop(),h=c.pop(),p=c.pop();if(h-p<=a)for(var d=p;d<=h;d++)s=e[2*d],u=e[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var v=Math.floor((p+h)/2);s=e[2*v],u=e[2*v+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[v]);var g=(f+1)%2;(0===f?n<=s:r<=u)&&(c.push(p),c.push(v-1),c.push(g)),(0===f?i>=s:o>=u)&&(c.push(v+1),c.push(h),c.push(g))}}return l}(this.ids,this.coords,t,e,n,r,this.nodeSize)},within:function(t,e,n){return function(t,e,n,r,i,o){for(var a=[0,t.length-1,0],s=[],u=i*i;a.length;){var c=a.pop(),l=a.pop(),f=a.pop();if(l-f<=o)for(var h=f;h<=l;h++)lt(e[2*h],e[2*h+1],n,r)<=u&&s.push(t[h]);else{var p=Math.floor((f+l)/2),d=e[2*p],v=e[2*p+1];lt(d,v,n,r)<=u&&s.push(t[p]);var g=(c+1)%2;(0===c?n-i<=d:r-i<=v)&&(a.push(f),a.push(p-1),a.push(g)),(0===c?n+i>=d:r+i>=v)&&(a.push(p+1),a.push(l),a.push(g))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)}},vt.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;for(var r,i,o=[],a=0;a<t.length;a++)t[a].geometry&&o.push((r=a,{x:_t((i=t[a].geometry.coordinates)[0]),y:bt(i[1]),zoom:1/0,index:r,parentId:-1}));this.trees[this.options.maxZoom+1]=ft(o,wt,Et,this.options.nodeSize,Float32Array),e&&console.timeEnd(n);for(var s=this.options.maxZoom;s>=this.options.minZoom;s--){var u=+Date.now();o=this._cluster(o,s),this.trees[s]=ft(o,wt,Et,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",s,o.length,+Date.now()-u)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],e),s=this.getClusters([-180,r,i,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],c=u.range(_t(n),bt(o),_t(i),bt(r)),l=[],f=0;f<c.length;f++){var h=u.points[c[f]];l.push(h.numPoints?mt(h):this.points[h.index])}return l},getChildren:function(t){var e=t>>5,n=t%32,r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),u=[],c=0;c<s.length;c++){var l=i.points[s[c]];l.parentId===t&&u.push(l.numPoints?mt(l):this.points[l.index])}if(0===u.length)throw new Error(r);return u},getLeaves:function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},getTile:function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,s,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,s,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,s,a/i,u),r.points,-1,n,i,c),c.features.length?c:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,r,i){for(var o=this.getChildren(e),a=0;a<o.length;a++){var s=o[a].properties;if(s&&s.cluster?i+s.point_count<=r?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,n,r,i):i<r?i++:t.push(o[a]),t.length===n)break}return i},_addTileFeatures:function(t,e,n,r,i,o){for(var a=0;a<t.length;a++){var s=e[t[a]],u={type:1,geometry:[[Math.round(this.options.extent*(s.x*i-n)),Math.round(this.options.extent*(s.y*i-r))]],tags:s.numPoints?yt(s):this.points[s.index].properties},c=s.numPoints?s.id:this.points[s.index].id;void 0!==c&&(u.id=c),o.features.push(u)}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],r=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var o=t[i];if(!(o.zoom<=e)){o.zoom=e;var a=this.trees[e+1],s=a.within(o.x,o.y,r),u=o.numPoints||1,c=o.x*u,l=o.y*u,f=null;this.options.reduce&&(f=this.options.initial(),this._accumulate(f,o));for(var h=(i<<5)+(e+1),p=0;p<s.length;p++){var d=a.points[s[p]];if(!(d.zoom<=e)){d.zoom=e;var v=d.numPoints||1;c+=d.x*v,l+=d.y*v,u+=v,d.parentId=h,this.options.reduce&&this._accumulate(f,d)}}1===u?n.push(o):(o.parentId=h,n.push(gt(c/u,l/u,h,u,f)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.index].properties);this.options.reduce(t,n)}},Ht.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ht.prototype.splitTile=function(t,e,n,r,i,o,a){for(var s=[t,e,n,r],u=this.options,c=u.debug;s.length;){r=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var l=1<<e,f=Yt(e,n,r),h=this.tiles[f];if(!h&&(c>1&&console.time("creation"),h=this.tiles[f]=Wt(t,e,n,r,u),this.tileCoords.push({z:e,x:n,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=t,i){if(e===u.maxZoom||e===i)continue;var d=1<<i-e;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||h.numPoints<=u.indexMaxPoints)continue;if(h.source=null,0!==t.length){c>1&&console.time("clipping");var v,g,m,y,_,b,x=.5*u.buffer/u.extent,w=.5-x,E=.5+x,S=1+x;v=g=m=y=null,_=Lt(t,l,n-x,n+E,0,h.minX,h.maxX,u),b=Lt(t,l,n+w,n+S,0,h.minX,h.maxX,u),t=null,_&&(v=Lt(_,l,r-x,r+E,1,h.minY,h.maxY,u),g=Lt(_,l,r+w,r+S,1,h.minY,h.maxY,u),_=null),b&&(m=Lt(b,l,r-x,r+E,1,h.minY,h.maxY,u),y=Lt(b,l,r+w,r+S,1,h.minY,h.maxY,u),b=null),c>1&&console.timeEnd("clipping"),s.push(v||[],e+1,2*n,2*r),s.push(g||[],e+1,2*n,2*r+1),s.push(m||[],e+1,2*n+1,2*r),s.push(y||[],e+1,2*n+1,2*r+1)}}},Ht.prototype.getTile=function(t,e,n){var r=this.options,i=r.extent,o=r.debug;if(t<0||t>24)return null;var a=1<<t,s=Yt(t,e=(e%a+a)%a,n);if(this.tiles[s])return Gt(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var u,c=t,l=e,f=n;!u&&c>0;)c--,l=Math.floor(l/2),f=Math.floor(f/2),u=this.tiles[Yt(c,l,f)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,f),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,f,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Gt(this.tiles[s],i):null):null};var Jt=function(e){function n(t,n,r){e.call(this,t,n,Kt),r&&(this.loadGeoJSON=r)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,n=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var r=!!(n&&n.request&&n.request.collectResourceTiming)&&new M.Performance(n.request);this.loadGeoJSON(n,function(i,o){if(i||!o)return e(i);if("object"!=typeof o)return e(new Error("Input data is not a valid GeoJSON object."));!function t(e,n){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(U(t,n)),e;case"Feature":return e.geometry=t(e.geometry,n),e;case"Polygon":case"MultiPolygon":return function(t,e){return"Polygon"===t.type?t.coordinates=V(t.coordinates,e):"MultiPolygon"===t.type&&(t.coordinates=t.coordinates.map(U(V,e))),t}(e,n);default:return e}}(o,!0);try{t._geoJSONIndex=n.cluster?(a=n.superclusterOptions,new vt(a)).load(o.features):new Ht(o,n.geojsonVtOptions)}catch(i){return e(i)}t.loaded={};var a,s={};if(r){var u=r.finish();u&&(s.resourceTiming={},s.resourceTiming[n.source]=JSON.parse(JSON.stringify(u)))}e(null,s)})}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(t,n){var r=this.loaded,i=t.uid;return r&&r[i]?e.prototype.reloadTile.call(this,t,n):this.loadTile(t,n)},n.prototype.loadGeoJSON=function(e,n){if(e.request)t.getJSON(e.request,n);else{if("string"!=typeof e.data)return n(new Error("Input data is not a valid GeoJSON object."));try{return n(null,JSON.parse(e.data))}catch(t){return n(new Error("Input data is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},n.prototype.getClusterExpansionZoom=function(t,e){e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))},n.prototype.getClusterChildren=function(t,e){e(null,this._geoJSONIndex.getChildren(t.clusterId))},n.prototype.getClusterLeaves=function(t,e){e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))},n}(R),Qt=function(e){var n=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.workerSourceTypes={vector:R,geojson:Jt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(n.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');n.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isLoaded())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return Qt.prototype.setLayers=function(t,e,n){this.getLayerIndex(t).replace(e),n()},Qt.prototype.updateLayers=function(t,e,n){this.getLayerIndex(t).update(e.layers,e.removedIds),n()},Qt.prototype.loadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).loadTile(e,n)},Qt.prototype.loadDEMTile=function(t,e,n){this.getDEMWorkerSource(t,e.source).loadTile(e,n)},Qt.prototype.reloadTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).reloadTile(e,n)},Qt.prototype.abortTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).abortTile(e,n)},Qt.prototype.removeTile=function(t,e,n){this.getWorkerSource(t,e.type,e.source).removeTile(e,n)},Qt.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Qt.prototype.removeSource=function(t,e,n){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,n):n()}},Qt.prototype.loadWorkerSource=function(t,e,n){try{this.self.importScripts(e.url),n()}catch(t){n(t.toString())}},Qt.prototype.loadRTLTextPlugin=function(e,n,r){try{t.plugin.isLoaded()||(this.self.importScripts(n),r(t.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+n)))}catch(t){r(t.toString())}},Qt.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new r),e},Qt.prototype.getWorkerSource=function(t,e,n){var r=this;if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){var i={send:function(e,n,i){r.actor.send(e,n,i,t)}};this.workerSources[t][e][n]=new this.workerSourceTypes[e](i,this.getLayerIndex(t))}return this.workerSources[t][e][n]},Qt.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new j),this.demWorkerSources[t][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Qt(self),Qt}),r(0,function(t){var e=t.createCommonjsModule(function(t){function e(t){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(t){return void 0===n[t]&&(n[t]=function(t){var n=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,n.probablySupportsContext?n.probablySupportsContext("webgl",r)||n.probablySupportsContext("experimental-webgl",r):n.supportsContext?n.supportsContext("webgl",r)||n.supportsContext("experimental-webgl",r):n.getContext("webgl",r)||n.getContext("experimental-webgl",r)}(t)),n[t]}(t&&t.failIfMajorPerformanceCaveat))}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var n={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),n={create:function(e,n,r){var i=t.window.document.createElement(e);return n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(e,n){return t.window.document.createElementNS(e,n)}},r=t.window.document?t.window.document.documentElement.style:null;function i(t){if(!r)return null;for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){r&&a&&(o=r[a],r[a]="none")},n.enableDrag=function(){r&&a&&(r[a]=o)};var s=i(["transform","WebkitTransform"]);n.setTransform=function(t,e){t.style[s]=e};var u=!1;try{var c=Object.defineProperty({},"passive",{get:function(){u=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){u=!1}n.addEventListener=function(t,e,n,r){void 0===r&&(r={}),"passive"in r&&u?t.addEventListener(e,n,r):t.addEventListener(e,n,r.capture)},n.removeEventListener=function(t,e,n,r){void 0===r&&(r={}),"passive"in r&&u?t.removeEventListener(e,n,r):t.removeEventListener(e,n,r.capture)};var l=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",l,!0)};n.suppressClick=function(){t.window.addEventListener("click",l,!0),t.window.setTimeout(function(){t.window.removeEventListener("click",l,!0)},0)},n.mousePos=function(e,n){var r=e.getBoundingClientRect();return n=n.touches?n.touches[0]:n,new t.Point(n.clientX-r.left-e.clientLeft,n.clientY-r.top-e.clientTop)},n.touchPos=function(e,n){for(var r=e.getBoundingClientRect(),i=[],o="touchend"===n.type?n.changedTouches:n.touches,a=0;a<o.length;a++)i.push(new t.Point(o[a].clientX-r.left-e.clientLeft,o[a].clientY-r.top-e.clientTop));return i},n.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},n.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var f={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return 0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":"https://events.mapbox.com/events/v2"},REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},h="See https://www.mapbox.com/api-documentation/#access-tokens";function p(t,e){var n=b(f.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"/"!==n.path&&(t.path=""+n.path+t.path),!f.REQUIRE_ACCESS_TOKEN)return x(t);if(!(e=e||f.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+h);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+h);return t.params.push("access_token="+e),x(t)}function d(t){return 0===t.indexOf("mapbox:")}var v=function(t,e){if(!d(t))return t;var n=b(t);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),p(n,e)},g=function(t,e,n,r){var i=b(t);return d(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+n,p(i,r)):(i.path+=""+e+n,x(i))},m=/(\.(png|jpg)\d*)(?=$)/,y=function(e,n,r){if(!n||!d(n))return e;var i=b(e),o=t.browser.devicePixelRatio>=2||512===r?"@2x":"",a=t.browser.supportsWebp?".webp":"$1";return i.path=i.path.replace(m,""+o+a),function(t){for(var e=0;e<t.length;e++)0===t[e].indexOf("access_token=tk.")&&(t[e]="access_token="+(f.ACCESS_TOKEN||""))}(i.params),x(i)},_=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function b(t){var e=t.match(_);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function x(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}var w=function(){this.eventData={anonId:null,lastSuccess:null,accessToken:f.ACCESS_TOKEN},this.queue=[],this.pending=!1,this.pendingRequest=null};w.prototype.postTurnstileEvent=function(t){f.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(t){return/(mapbox\.c)(n|om)/i.test(t)})&&this.queueRequest(Date.now())},w.prototype.queueRequest=function(t){this.queue.push(t),this.processRequests()},w.prototype.processRequests=function(){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var n="mapbox.turnstileEventData:"+(f.ACCESS_TOKEN||""),r=t.storageAvailable("localStorage"),i=!!this.eventData.accessToken&&this.eventData.accessToken!==f.ACCESS_TOKEN;if(i&&(this.eventData.anonId=this.eventData.lastSuccess=null),(!this.eventData.anonId||!this.eventData.lastSuccess)&&r)try{var o=t.window.localStorage.getItem(n);o&&(this.eventData=JSON.parse(o))}catch(e){t.warnOnce("Unable to read from LocalStorage")}t.validateUuid(this.eventData.anonId)||(this.eventData.anonId=t.uuid(),i=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var s=new Date(this.eventData.lastSuccess),u=new Date(a),c=(a-this.eventData.lastSuccess)/864e5;i=i||c>=1||c<-1||s.getDate()!==u.getDate()}if(!i)return this.processRequests();var l=b(f.EVENTS_URL);l.params.push("access_token="+(f.ACCESS_TOKEN||""));var h={url:x(l),headers:{"Content-Type":"text/plain"}},p=JSON.stringify([{event:"appUserTurnstile",created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"0.50.0","enabled.telemetry":!1,userId:this.eventData.anonId}]);this.pendingRequest=t.postData(h,p,function(i){if(e.pendingRequest=null,!i){if(e.eventData.lastSuccess=a,e.eventData.accessToken=f.ACCESS_TOKEN,r)try{t.window.localStorage.setItem(n,JSON.stringify(e.eventData))}catch(e){t.warnOnce("Unable to write to LocalStorage")}e.processRequests()}})}};var E=new w,S=E.postTurnstileEvent.bind(E),P=function(){this.images={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0};P.prototype.isLoaded=function(){return this.loaded},P.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,n=this.requestors;e<n.length;e+=1){var r=n[e],i=r.ids,o=r.callback;this._notify(i,o)}this.requestors=[]}},P.prototype.getImage=function(t){return this.images[t]},P.prototype.addImage=function(t,e){this.images[t]=e},P.prototype.removeImage=function(t){delete this.images[t],delete this.patterns[t]},P.prototype.listImages=function(){return Object.keys(this.images)},P.prototype.getImages=function(t,e){var n=!0;if(!this.isLoaded())for(var r=0,i=t;r<i.length;r+=1){var o=i[r];this.images[o]||(n=!1)}this.isLoaded()||n?this._notify(t,e):this.requestors.push({ids:t,callback:e})},P.prototype._notify=function(t,e){for(var n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=this.images[o];a&&(n[o]={data:a.data.clone(),pixelRatio:a.pixelRatio,sdf:a.sdf})}e(null,n)},P.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},P.prototype.getPattern=function(e){var n=this.patterns[e];if(n)return n.position;var r=this.getImage(e);if(!r)return null;var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new t.ImagePosition(i,r);return this.patterns[e]={bin:i,position:o},this._updatePatternAtlas(),o},P.prototype.bind=function(e){var n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},P.prototype._updatePatternAtlas=function(){var e=[];for(var n in this.patterns)e.push(this.patterns[n].bin);var r=t.potpack(e),i=r.w,o=r.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var u=this.patterns[s].bin,c=u.x+1,l=u.y+1,f=this.images[s].data,h=f.width,p=f.height;t.RGBAImage.copy(f,a,{x:0,y:0},{x:c,y:l},{width:h,height:p}),t.RGBAImage.copy(f,a,{x:0,y:p-1},{x:c,y:l-1},{width:h,height:1}),t.RGBAImage.copy(f,a,{x:0,y:0},{x:c,y:l+p},{width:h,height:1}),t.RGBAImage.copy(f,a,{x:h-1,y:0},{x:c-1,y:l},{width:1,height:p}),t.RGBAImage.copy(f,a,{x:0,y:0},{x:c+h,y:l},{width:1,height:p})}this.dirty=!0};var T=k,A=1e20;function k(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function C(t,e,n,r,i,o,a){for(var s=0;s<e;s++){for(var u=0;u<n;u++)r[u]=t[u*e+s];for(O(r,i,o,a,n),u=0;u<n;u++)t[u*e+s]=i[u]}for(u=0;u<n;u++){for(s=0;s<e;s++)r[s]=t[u*e+s];for(O(r,i,o,a,e),s=0;s<e;s++)t[u*e+s]=Math.sqrt(i[s])}}function O(t,e,n,r,i){n[0]=0,r[0]=-A,r[1]=+A;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=+A}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}k.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=e.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?A:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?A:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(C(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),C(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var o=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(o/this.radius+this.cutoff))))}return n};var M=function(t,e){this.requestTransform=t,this.localIdeographFontFamily=e,this.entries={}};M.prototype.setURL=function(t){this.url=t},M.prototype.getGlyphs=function(e,n){var r=this,i=[];for(var o in e)for(var a=0,s=e[o];a<s.length;a+=1){var u=s[a];i.push({stack:o,id:u})}t.asyncAll(i,function(t,e){var n=t.stack,i=t.id,o=r.entries[n];o||(o=r.entries[n]={glyphs:{},requests:{}});var a=o.glyphs[i];if(void 0===a)if(a=r._tinySDF(o,n,i))e(null,{stack:n,id:i,glyph:a});else{var s=Math.floor(i/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else{var u=o.requests[s];u||(u=o.requests[s]=[],M.loadGlyphRange(n,s,r.url,r.requestTransform,function(t,e){if(e)for(var n in e)o.glyphs[+n]=e[+n];for(var r=0,i=u;r<i.length;r+=1)(0,i[r])(t,e);delete o.requests[s]})),u.push(function(t,r){t?e(t):r&&e(null,{stack:n,id:i,glyph:r[i]||null})})}}else e(null,{stack:n,id:i,glyph:a})},function(t,e){if(t)n(t);else if(e){for(var r={},i=0,o=e;i<o.length;i+=1){var a=o[i],s=a.stack,u=a.id,c=a.glyph;(r[s]||(r[s]={}))[u]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}n(null,r)}})},M.prototype._tinySDF=function(e,n,r){var i=this.localIdeographFontFamily;if(i&&(t.isChar["CJK Unified Ideographs"](r)||t.isChar["Hangul Syllables"](r))){var o=e.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=e.tinySDF=new M.TinySDF(24,3,8,.25,i,a)}return{id:r,bitmap:new t.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},M.loadGlyphRange=function(e,n,r,i,o){var a=256*n,s=a+255,u=i(function(t,e){if(!d(t))return t;var n=b(t);return n.path="/fonts/v1"+n.path,p(n,e)}(r).replace("{fontstack}",e).replace("{range}",a+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(u,function(e,n){if(e)o(e);else if(n){for(var r={},i=0,a=t.parseGlyphPBF(n.data);i<a.length;i+=1){var s=a[i];r[s.id]=s}o(null,r)}})},M.TinySDF=T;var I=function(){this.specification=t.styleSpec.light.position};I.prototype.possiblyEvaluate=function(e,n){return t.sphericalToCartesian(e.expression.evaluate(n))},I.prototype.interpolate=function(e,n,r){return{x:t.number(e.x,n.x,r),y:t.number(e.y,n.y,r),z:t.number(e.z,n.z,r)}};var L=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new I,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),R=function(e){function n(n){e.call(this),this._transitionable=new t.Transitionable(L),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(e){if(!this._validate(t.validateLight,e))for(var n in e){var r=e[n];t.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-"-transition".length),r):this._transitionable.setValue(n,r)}},n.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},n.prototype._validate=function(e,n){return t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},n}(t.Evented),j=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};j.prototype.getDash=function(t,e){var n=t.join(",")+String(e);return this.positions[n]||(this.positions[n]=this.addDash(t,e)),this.positions[n]},j.prototype.addDash=function(e,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<e.length;a++)o+=e[a];for(var s=this.width/o,u=s/2,c=e.length%2==1,l=-r;l<=r;l++)for(var f=this.nextRow+r+l,h=this.width*f,p=c?-e[e.length-1]:0,d=e[0],v=1,g=0;g<this.width;g++){for(;d<g/s;)p=d,d+=e[v],c&&v===e.length-1&&(d+=e[0]),v++;var m=Math.abs(g-p*s),y=Math.abs(g-d*s),_=Math.min(m,y),b=v%2==1,x=void 0;if(n){var w=r?l/r*(u+1):0;if(b){var E=u-Math.abs(w);x=Math.sqrt(_*_+E*E)}else x=u-Math.sqrt(_*_+w*w)}else x=(b?1:-1)*_;this.data[3+4*(h+g)]=Math.max(0,Math.min(255,x+128))}var S={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,S},j.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,this.data))};var z=function e(n,r){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=i[o],s=new e.Actor(a,r,this.id);s.name="Worker "+o,this.actors.push(s)}};function D(e,n,r){var i=function(e,n){if(e)return r(e);if(n){var i=t.pick(n,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);n.vector_layers&&(i.vectorLayers=n.vector_layers,i.vectorLayerIds=i.vectorLayers.map(function(t){return t.id})),r(null,i)}};return e.url?t.getJSON(n(v(e.url),t.ResourceType.Source),i):t.browser.frame(function(){return i(null,e)})}z.prototype.broadcast=function(e,n,r){r=r||function(){},t.asyncAll(this.actors,function(t,r){t.send(e,n,r)},r)},z.prototype.send=function(t,e,n,r){return("number"!=typeof r||isNaN(r))&&(r=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[r].send(t,e,n),r},z.prototype.remove=function(){this.actors.forEach(function(t){t.remove()}),this.actors=[],this.workerPool.release(this.id)},z.Actor=t.Actor;var F=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};F.prototype.wrap=function(){return new F(t.wrap(this.lng,-180,180),this.lat)},F.prototype.toArray=function(){return[this.lng,this.lat]},F.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},F.prototype.toBounds=function(t){var e=360*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return new N(new F(this.lng-n,this.lat-e),new F(this.lng+n,this.lat+e))},F.convert=function(t){if(t instanceof F)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new F(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new F(Number(t.lng),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var N=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};N.prototype.setNorthEast=function(t){return this._ne=t instanceof F?new F(t.lng,t.lat):F.convert(t),this},N.prototype.setSouthWest=function(t){return this._sw=t instanceof F?new F(t.lng,t.lat):F.convert(t),this},N.prototype.extend=function(t){var e,n,r=this._sw,i=this._ne;if(t instanceof F)e=t,n=t;else{if(!(t instanceof N))return Array.isArray(t)?t.every(Array.isArray)?this.extend(N.convert(t)):this.extend(F.convert(t)):this;if(e=t._sw,n=t._ne,!e||!n)return this}return r||i?(r.lng=Math.min(e.lng,r.lng),r.lat=Math.min(e.lat,r.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new F(e.lng,e.lat),this._ne=new F(n.lng,n.lat)),this},N.prototype.getCenter=function(){return new F((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},N.prototype.getSouthWest=function(){return this._sw},N.prototype.getNorthEast=function(){return this._ne},N.prototype.getNorthWest=function(){return new F(this.getWest(),this.getNorth())},N.prototype.getSouthEast=function(){return new F(this.getEast(),this.getSouth())},N.prototype.getWest=function(){return this._sw.lng},N.prototype.getSouth=function(){return this._sw.lat},N.prototype.getEast=function(){return this._ne.lng},N.prototype.getNorth=function(){return this._ne.lat},N.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},N.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},N.prototype.isEmpty=function(){return!(this._sw&&this._ne)},N.convert=function(t){return!t||t instanceof N?t:new N(t)};var B=function(t,e,n){this.bounds=N.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=n||24};B.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},B.prototype.contains=function(t){var e=Math.floor(this.lngX(this.bounds.getWest(),t.z)),n=Math.floor(this.latY(this.bounds.getNorth(),t.z)),r=Math.ceil(this.lngX(this.bounds.getEast(),t.z)),i=Math.ceil(this.latY(this.bounds.getSouth(),t.z));return t.x>=e&&t.x<r&&t.y>=n&&t.y<i},B.prototype.lngX=function(t,e){return(t+180)*(Math.pow(2,e)/360)},B.prototype.latY=function(e,n){var r=t.clamp(Math.sin(Math.PI/180*e),-.9999,.9999),i=Math.pow(2,n)/(2*Math.PI);return Math.pow(2,n-1)+.5*Math.log((1+r)/(1-r))*-i};var U=function(e){function n(n,r,i,o){if(e.call(this),this.id=n,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,t.extend(this,t.pick(r,["url","scheme","tileSize"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._transformRequest,function(n,r){e._tileJSONRequest=null,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new B(r.bounds,e.minzoom,e.maxzoom)),S(r.tiles),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.loadTile=function(e,n){var r=y(e.tileID.canonical.url(this.tiles,this.scheme),this.url),i={request:this.map._transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(t,r){return e.aborted?n(null):t&&404!==t.status?n(t):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),n(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,void 0===e.workerID||"expired"===e.state?e.workerID=this.dispatcher.send("loadTile",i,o.bind(this)):"loading"===e.state?e.reloadCallback=n:this.dispatcher.send("reloadTile",i,o.bind(this),e.workerID)},n.prototype.abortTile=function(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0,t.workerID)},n.prototype.hasTransition=function(){return!1},n}(t.Evented),V=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=D(this._options,this.map._transformRequest,function(n,r){e._tileJSONRequest=null,n?e.fire(new t.ErrorEvent(n)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new B(r.bounds,e.minzoom,e.maxzoom)),S(r.tiles),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return t.extend({},this._options)},n.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},n.prototype.loadTile=function(e,n){var r=this,i=y(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(i,t.ResourceType.Tile),function(i,o){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(i)e.state="errored",n(i);else if(o){r.map._refreshExpiredTiles&&e.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=r.map.painter.context,s=a.gl;e.texture=r.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new t.Texture(a,o,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),e.state="loaded",n(null)}})},n.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},n.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},n.prototype.hasTransition=function(){return!1},n}(t.Evented),G=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({},r),this.encoding=r.encoding||"mapbox"}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(e,n){var r=y(e.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);e.request=t.getImage(this.map._transformRequest(r,t.ResourceType.Tile),function(r,i){if(delete e.request,e.aborted)e.state="unloaded",n(null);else if(r)e.state="errored",n(r);else if(i){this.map._refreshExpiredTiles&&e.setExpiryData(i),delete i.cacheControl,delete i.expires;var o=t.browser.getImageData(i),a={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:o,encoding:this.encoding};e.workerID&&"expired"!==e.state||(e.workerID=this.dispatcher.send("loadDEMTile",a,function(t,r){t&&(e.state="errored",n(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.state="loaded",n(null))}.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},n.prototype._getNeighboringTiles=function(e){var n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?e.wrap-1:e.wrap,a=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,u={};return u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(u[new t.OverscaledTileID(e.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},u[new t.OverscaledTileID(e.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),u},n.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},void 0,t.workerID)},n}(V),q=function(e){function n(n,r,i,o){e.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=i,this.setEventedParent(o),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution);var a=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*a,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*a,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:t.EXTENT,radius:(r.clusterRadius||50)*a,log:!1}},r.workerOptions)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(n){if(n)e.fire(new t.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(r.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",r))}})},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setData=function(e){var n=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)n.fire(new t.ErrorEvent(e));else{var r={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(r.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new t.Event("data",r))}}),this},n.prototype.getClusterExpansionZoom=function(t,e){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e,this.workerID),this},n.prototype.getClusterChildren=function(t,e){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e,this.workerID),this},n.prototype.getClusterLeaves=function(t,e,n,r){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:n},r,this.workerID),this},n.prototype._updateWorkerData=function(e){var n=this,r=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._transformRequest(t.browser.resolveURL(i),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this.workerID=this.dispatcher.send(this.type+".loadData",r,function(t,i){n._removed||i&&i.abandoned||(n._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[n.id]&&(n._resourceTiming=i.resourceTiming[n.id].slice(0)),n.dispatcher.send(n.type+".coalesce",{source:r.source},null,n.workerID),e(t))},this.workerID)},n.prototype.loadTile=function(e,n){var r=this,i=void 0===e.workerID?"loadTile":"reloadTile",o={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(i,o,function(t,o){return e.unloadVectorData(),e.aborted?n(null):t?n(t):(e.loadVectorData(o,r.map.painter,"reloadTile"===i),n(null))},this.workerID)},n.prototype.abortTile=function(t){t.aborted=!0},n.prototype.unloadTile=function(t){t.unloadVectorData(),this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)},n.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},n.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(t.Evented),W=function(e){function n(t,n,r,i){e.call(this),this.id=t,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(e,n){var r=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._transformRequest(this.url,t.ResourceType.Image),function(i,o){i?r.fire(new t.ErrorEvent(i)):o&&(r.image=t.browser.getImageData(o),e&&(r.coordinates=e),n&&n(),r._finishLoading())})},n.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,function(){e.texture=null}),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(t){this.map=t,this.load()},n.prototype.setCoordinates=function(e){this.coordinates=e;var n=this.map,r=e.map(function(t){return n.transform.locationCoordinate(F.convert(t)).zoomTo(0)}),i=this.centerCoord=t.getCoordinatesCenter(r);i.column=Math.floor(i.column),i.row=Math.floor(i.row),this.tileID=new t.CanonicalTileID(i.zoom,i.column,i.row),this.minzoom=this.maxzoom=i.zoom;var o=r.map(function(e){var n=e.zoomTo(i.zoom);return new t.Point(Math.round((n.column-i.column)*t.EXTENT),Math.round((n.row-i.row)*t.EXTENT))});return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(t.Evented),Z=function(e){function n(t,n,r,i){e.call(this,t,n,r,i),this.roundZoom=!0,this.type="video",this.options=n}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){var e=this,n=this.options;this.urls=[];for(var r=0,i=n.urls;r<i.length;r+=1){var o=i[r];e.urls.push(e.map._transformRequest(o,t.ResourceType.Source).url)}t.getVideo(this.urls,function(n,r){n?e.fire(new t.ErrorEvent(n)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",function(){e.map.triggerRepaint()}),e.map&&e.video.play(),e._finishLoading())})},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,n=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(W),X=function(e){function n(n,r,i,o){e.call(this,n,r,i,o),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some(function(t){return!Array.isArray(t)||2!==t.length||t.some(function(t){return"number"!=typeof t})})||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing=!1},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,t.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var n=e[t];if(isNaN(n)||n<=0)return!0}return!1},n}(W),H={vector:U,raster:V,"raster-dem":G,geojson:q,video:Z,image:W,canvas:X},Y=function(e,n,r,i){var o=new H[n.type](e,n,r,i);if(o.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+o.id);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function K(t,e,n,r,i){var o=i.maxPitchScaleFactor(),a=t.tilesIn(n,o);a.sort(J);for(var s=[],u=0,c=a;u<c.length;u+=1){var l=c[u];s.push({wrappedTileID:l.tileID.wrapped().key,queryResults:l.tile.queryRenderedFeatures(e,t._state,l.queryGeometry,l.scale,r,i,o,t.transform.calculatePosMatrix(l.tileID.toUnwrapped()))})}var f=function(t){for(var e={},n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.queryResults,s=o.wrappedTileID,u=n[s]=n[s]||{};for(var c in a)for(var l=a[c],f=u[c]=u[c]||{},h=e[c]=e[c]||[],p=0,d=l;p<d.length;p+=1){var v=d[p];f[v.featureIndex]||(f[v.featureIndex]=!0,h.push(v.feature))}}return e}(s);for(var h in f)f[h].forEach(function(e){var n=t.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source,e.layer["source-layer"]&&(e.sourceLayer=e.layer["source-layer"]),e.state=n});return f}function J(t,e){var n=t.tileID,r=e.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var Q=function(t,e){this.max=t,this.onRemove=e,this.reset()};Q.prototype.reset=function(){for(var t in this.data)for(var e=0,n=this.data[t];e<n.length;e+=1){var r=n[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},Q.prototype.add=function(t,e,n){var r=this,i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:e,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout(function(){r.remove(t,o)},n)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Q.prototype.has=function(t){return t.wrapped().key in this.data},Q.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},Q.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},Q.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},Q.prototype.remove=function(t,e){if(!this.has(t))return this;var n=t.wrapped().key,r=void 0===e?0:this.data[n].indexOf(e),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this},Q.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this};var $=function(t,e,n){this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};$.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},$.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},$.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var tt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},et=function(t,e,n,r){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;var i=t.gl;this.buffer=i.createBuffer(),t.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};et.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},et.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},et.prototype.enableAttributes=function(t,e){for(var n=0;n<this.attributes.length;n++){var r=this.attributes[n],i=e.attributes[r.name];void 0!==i&&t.enableVertexAttribArray(i)}},et.prototype.setVertexAttribPointers=function(t,e,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],o=e.attributes[i.name];void 0!==o&&t.vertexAttribPointer(o,i.components,t[tt[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}},et.prototype.destroy=function(){var t=this.context.gl;this.buffer&&(t.deleteBuffer(this.buffer),delete this.buffer)};var nt=function(e){this.context=e,this.default=t.Color.transparent,this.current=this.default,this.dirty=!1};nt.prototype.get=function(){return this.current},nt.prototype.setDefault=function(){this.set(this.default)},nt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!0!==this.dirty||(this.context.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)};var rt=function(t){this.context=t,this.default=1,this.current=this.default,this.dirty=!1};rt.prototype.get=function(){return this.current},rt.prototype.setDefault=function(){this.set(this.default)},rt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.clearDepth(t),this.current=t,this.dirty=!1)};var it=function(t){this.context=t,this.default=0,this.current=this.default,this.dirty=!1};it.prototype.get=function(){return this.current},it.prototype.setDefault=function(){this.set(this.default)},it.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.clearStencil(t),this.current=t,this.dirty=!1)};var ot=function(t){this.context=t,this.default=[!0,!0,!0,!0],this.current=this.default,this.dirty=!1};ot.prototype.get=function(){return this.current},ot.prototype.setDefault=function(){this.set(this.default)},ot.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!0!==this.dirty||(this.context.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)};var at=function(t){this.context=t,this.default=!0,this.current=this.default,this.dirty=!1};at.prototype.get=function(){return this.current},at.prototype.setDefault=function(){this.set(this.default)},at.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.depthMask(t),this.current=t,this.dirty=!1)};var st=function(t){this.context=t,this.default=255,this.current=this.default,this.dirty=!1};st.prototype.get=function(){return this.current},st.prototype.setDefault=function(){this.set(this.default)},st.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.stencilMask(t),this.current=t,this.dirty=!1)};var ut=function(t){this.context=t,this.default={func:t.gl.ALWAYS,ref:0,mask:255},this.current=this.default,this.dirty=!1};ut.prototype.get=function(){return this.current},ut.prototype.setDefault=function(){this.set(this.default)},ut.prototype.set=function(t){var e=this.current;t.func===e.func&&t.ref===e.ref&&t.mask===e.mask&&!0!==this.dirty||(this.context.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)};var ct=function(t){this.context=t;var e=this.context.gl;this.default=[e.KEEP,e.KEEP,e.KEEP],this.current=this.default,this.dirty=!1};ct.prototype.get=function(){return this.current},ct.prototype.setDefault=function(){this.set(this.default)},ct.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&!0!==this.dirty||(this.context.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)};var lt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};lt.prototype.get=function(){return this.current},lt.prototype.setDefault=function(){this.set(this.default)},lt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}};var ft=function(t){this.context=t,this.default=[0,1],this.current=this.default,this.dirty=!1};ft.prototype.get=function(){return this.current},ft.prototype.setDefault=function(){this.set(this.default)},ft.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!0!==this.dirty||(this.context.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)};var ht=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};ht.prototype.get=function(){return this.current},ht.prototype.setDefault=function(){this.set(this.default)},ht.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}};var pt=function(t){this.context=t,this.default=t.gl.LESS,this.current=this.default,this.dirty=!1};pt.prototype.get=function(){return this.current},pt.prototype.setDefault=function(){this.set(this.default)},pt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.depthFunc(t),this.current=t,this.dirty=!1)};var dt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};dt.prototype.get=function(){return this.current},dt.prototype.setDefault=function(){this.set(this.default)},dt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}};var vt=function(t){this.context=t;var e=this.context.gl;this.default=[e.ONE,e.ZERO],this.current=this.default,this.dirty=!1};vt.prototype.get=function(){return this.current},vt.prototype.setDefault=function(){this.set(this.default)},vt.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&!0!==this.dirty||(this.context.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)};var gt=function(e){this.context=e,this.default=t.Color.transparent,this.current=this.default,this.dirty=!1};gt.prototype.get=function(){return this.current},gt.prototype.setDefault=function(){this.set(this.default)},gt.prototype.set=function(t){var e=this.current;t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a&&!0!==this.dirty||(this.context.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)};var mt=function(t){this.context=t,this.default=this.context.gl.FUNC_ADD,this.current=this.default,this.dirty=!1};mt.prototype.get=function(){return this.current},mt.prototype.setDefault=function(){this.set(this.default)},mt.prototype.set=function(t){t===this.current&&!0!==this.dirty||(this.context.gl.blendEquation(t),this.current=t,this.dirty=!1)};var yt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};yt.prototype.get=function(){return this.current},yt.prototype.setDefault=function(){this.set(this.default)},yt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}};var _t=function(t){this.context=t;var e=this.context.gl;this.default=e.BACK,this.current=this.default,this.dirty=!1};_t.prototype.get=function(){return this.current},_t.prototype.setDefault=function(){this.set(this.default)},_t.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.cullFace(t),this.current=t,this.dirty=!1)};var bt=function(t){this.context=t;var e=this.context.gl;this.default=e.CCW,this.current=this.default,this.dirty=!1};bt.prototype.get=function(){return this.current},bt.prototype.setDefault=function(){this.set(this.default)},bt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.frontFace(t),this.current=t,this.dirty=!1)};var xt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};xt.prototype.get=function(){return this.current},xt.prototype.setDefault=function(){this.set(this.default)},xt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.useProgram(t),this.current=t,this.dirty=!1)};var wt=function(t){this.context=t,this.default=t.gl.TEXTURE0,this.current=this.default,this.dirty=!1};wt.prototype.get=function(){return this.current},wt.prototype.setDefault=function(){this.set(this.default)},wt.prototype.set=function(t){this.current===t&&!0!==this.dirty||(this.context.gl.activeTexture(t),this.current=t,this.dirty=!1)};var Et=function(t){this.context=t;var e=this.context.gl;this.default=[0,0,e.drawingBufferWidth,e.drawingBufferHeight],this.current=this.default,this.dirty=!1};Et.prototype.get=function(){return this.current},Et.prototype.setDefault=function(){this.set(this.default)},Et.prototype.set=function(t){var e=this.current;t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&!0!==this.dirty||(this.context.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)};var St=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};St.prototype.get=function(){return this.current},St.prototype.setDefault=function(){this.set(this.default)},St.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}};var Pt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};Pt.prototype.get=function(){return this.current},Pt.prototype.setDefault=function(){this.set(this.default)},Pt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}};var Tt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};Tt.prototype.get=function(){return this.current},Tt.prototype.setDefault=function(){this.set(this.default)},Tt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}};var At=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};At.prototype.get=function(){return this.current},At.prototype.setDefault=function(){this.set(this.default)},At.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}};var kt=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};kt.prototype.get=function(){return this.current},kt.prototype.setDefault=function(){this.set(this.default)},kt.prototype.set=function(t){var e=this.context.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1};var Ct=function(t){this.context=t,this.default=null,this.current=this.default,this.dirty=!1};Ct.prototype.get=function(){return this.current},Ct.prototype.setDefault=function(){this.set(this.default)},Ct.prototype.set=function(t){(this.current!==t&&this.context.extVertexArrayObject||!0===this.dirty)&&(this.context.extVertexArrayObject.bindVertexArrayOES(t),this.current=t,this.dirty=!1)};var Ot=function(t){this.context=t,this.default=4,this.current=this.default,this.dirty=!1};Ot.prototype.get=function(){return this.current},Ot.prototype.setDefault=function(){this.set(this.default)},Ot.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}};var Mt=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};Mt.prototype.get=function(){return this.current},Mt.prototype.setDefault=function(){this.set(this.default)},Mt.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}};var It=function(t){this.context=t,this.default=!1,this.current=this.default,this.dirty=!1};It.prototype.get=function(){return this.current},It.prototype.setDefault=function(){this.set(this.default)},It.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}};var Lt=function(t,e){this.context=t,this.default=null,this.current=this.default,this.dirty=!1,this.parent=e};Lt.prototype.get=function(){return this.current};var Rt=function(t){function e(e,n){t.call(this,e,n),this.dirty=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setDefault=function(){this.set(this.default)},e.prototype.set=function(t){if(this.dirty||this.current!==t){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e.prototype.setDirty=function(){this.dirty=!0},e}(Lt),jt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setDefault=function(){this.set(this.default)},e.prototype.set=function(t){if(this.current!==t||!0===this.dirty){var e=this.context.gl;this.context.bindFramebuffer.set(this.parent),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(Lt),zt=function(t,e,n){this.context=t,this.width=e,this.height=n;var r=t.gl,i=this.framebuffer=r.createFramebuffer();this.colorAttachment=new Rt(t,i),this.depthAttachment=new jt(t,i)};zt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();e&&t.deleteTexture(e);var n=this.depthAttachment.get();n&&t.deleteRenderbuffer(n),t.deleteFramebuffer(this.framebuffer)};var Dt=function(t,e,n){this.func=t,this.mask=e,this.range=n};Dt.ReadOnly=!1,Dt.ReadWrite=!0,Dt.disabled=new Dt(519,Dt.ReadOnly,[0,1]);var Ft=function(t,e,n,r,i,o){this.test=t,this.ref=e,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o};Ft.disabled=new Ft({func:519,mask:0},0,0,7680,7680,7680);var Nt=function(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n};Nt.disabled=new Nt(Nt.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),Nt.unblended=new Nt(Nt.Replace,t.Color.transparent,[!0,!0,!0,!0]),Nt.alphaBlended=new Nt([1,771],t.Color.transparent,[!0,!0,!0,!0]);var Bt=function(t,e,n){this.enable=t,this.mode=e,this.frontFace=n};Bt.disabled=new Bt(!1,1029,2305),Bt.backCCW=new Bt(!0,1029,2305);var Ut=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new nt(this),this.clearDepth=new rt(this),this.clearStencil=new it(this),this.colorMask=new ot(this),this.depthMask=new at(this),this.stencilMask=new st(this),this.stencilFunc=new ut(this),this.stencilOp=new ct(this),this.stencilTest=new lt(this),this.depthRange=new ft(this),this.depthTest=new ht(this),this.depthFunc=new pt(this),this.blend=new dt(this),this.blendFunc=new vt(this),this.blendColor=new gt(this),this.blendEquation=new mt(this),this.cullFace=new yt(this),this.cullFaceSide=new _t(this),this.frontFace=new bt(this),this.program=new xt(this),this.activeTexture=new wt(this),this.viewport=new Et(this),this.bindFramebuffer=new St(this),this.bindRenderbuffer=new Pt(this),this.bindTexture=new Tt(this),this.bindVertexBuffer=new At(this),this.bindElementBuffer=new kt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ct(this),this.pixelStoreUnpack=new Ot(this),this.pixelStoreUnpackPremultiplyAlpha=new Mt(this),this.pixelStoreUnpackFlipY=new It(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&t.getExtension("OES_texture_half_float_linear")};Ut.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ut.prototype.createIndexBuffer=function(t,e){return new $(this,t,e)},Ut.prototype.createVertexBuffer=function(t,e,n){return new et(this,t,e,n)},Ut.prototype.createRenderbuffer=function(t,e,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),i},Ut.prototype.createFramebuffer=function(t,e){return new zt(this,t,e)},Ut.prototype.clear=function(t){var e=t.color,n=t.depth,r=this.gl,i=0;e&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)},Ut.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},Ut.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Ut.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Ut.prototype.setColorMode=function(e){t.isEqual(e.blendFunction,Nt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},Ut.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Vt=function(e){function n(n,r,i){var o=this;e.call(this),this.id=n,this.dispatcher=i,this.on("data",function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))}),this.on("error",function(){o._sourceErrored=!0}),this._source=Y(n,r,i,this),this._tiles={},this._cache=new Q(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},n.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},n.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,function(){})},n.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,function(){})},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles)this._tiles[e].upload(t)},n.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(qt)},n.prototype.getRenderableIds=function(e){var n=this,r=[];for(var i in n._tiles)n._isIdRenderable(+i,e)&&r.push(+i);return e?r.sort(function(e,r){var i=n._tiles[e].tileID,o=n._tiles[r].tileID,a=new t.Point(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),s=new t.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x}):r.sort(qt)},n.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},n.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},n.prototype._reloadTile=function(t,e){var n=this._tiles[t];n&&("loading"!==n.state&&(n.state=e),this._loadTile(n,this._tileLoaded.bind(this,n,t,e)))},n.prototype._tileLoaded=function(e,n,r,i){if(i)return e.state="errored",void(404!==i.status?this._source.fire(new t.ErrorEvent(i,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},n.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),n=0;n<e.length;n++){var r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){var i=this.getTileByID(r);o(t,i),o(i,t)}}function o(t,e){t.needsHillshadePrepare=!0;var n=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,i=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,r),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(t){return this.getTileByID(t.key)},n.prototype.getTileByID=function(t){return this._tiles[t]},n.prototype.getZoom=function(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)},n.prototype._retainLoadedChildren=function(t,e,n,r){for(var i in this._tiles){var o=this._tiles[i];if(!(r[i]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>e+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var u=a;u.overscaledZ>e;)if(t[(u=u.scaledTo(u.overscaledZ-1)).key]){r[a.key]=a;break}}}},n.prototype.findLoadedParent=function(t,e){for(var n=t.overscaledZ-1;n>=e;n--){var r=t.scaledTo(n);if(!r)return;var i=String(r.key),o=this._tiles[i];if(o&&o.hasData())return o;if(this._cache.has(r))return this._cache.get(r)}},n.prototype.updateCacheSize=function(t){var e=(Math.ceil(t.width/this._source.tileSize)+1)*(Math.ceil(t.height/this._source.tileSize)+1),n=Math.floor(5*e),r="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(r)},n.prototype.handleWrapJump=function(t){var e=(t-(void 0===this._prevLng?t:this._prevLng))/360,n=Math.round(e);if(this._prevLng=t,n){var r={};for(var i in this._tiles){var o=this._tiles[i];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+n),r[o.tileID.key]=o}for(var a in this._tiles=r,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var s in this._tiles){var u=this._tiles[s];this._setTileReloadTimer(s,u)}}},n.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)}):(i=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(t){return r._source.hasTile(t)}))):i=[];var o=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(e)),a=Math.max(o-n.maxOverzooming,this._source.minzoom),s=Math.max(o+n.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(i,o);if(Wt(this._source.type)){for(var c={},l={},f=0,h=Object.keys(u);f<h.length;f+=1){var p=h[f],d=u[p],v=r._tiles[p];if(v&&!(v.fadeEndTime&&v.fadeEndTime<=t.browser.now())){var g=r.findLoadedParent(d,a);g&&(r._addTile(g.tileID),c[g.tileID.key]=g.tileID),l[p]=d}}for(var m in this._retainLoadedChildren(l,o,s,u),c)u[m]||(r._coveredTiles[m]=!0,u[m]=c[m])}for(var y in u)r._tiles[y].clearFadeHold();for(var _=0,b=t.keysDifference(this._tiles,u);_<b.length;_+=1){var x=b[_],w=r._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(r.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||r._removeTile(x)}}},n.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},n.prototype._updateRetainedTiles=function(t,e){for(var r={},i={},o=Math.max(e-n.maxOverzooming,this._source.minzoom),a=Math.max(e+n.maxUnderzooming,this._source.minzoom),s={},u=0,c=t;u<c.length;u+=1){var l=c[u],f=this._addTile(l);r[l.key]=l,f.hasData()||e<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,e,a,r);for(var h=0,p=t;h<p.length;h+=1){var d=p[h],v=this._tiles[d.key];if(!v.hasData()){if(e+1>this._source.maxzoom){var g=d.children(this._source.maxzoom)[0],m=this.getTile(g);if(m&&m.hasData()){r[g.key]=g;continue}}else{var y=d.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}for(var _=v.wasRequested(),b=d.overscaledZ-1;b>=o;--b){var x=d.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(v=this.getTile(x))&&_&&(v=this._addTile(x)),v&&(r[x.key]=x,_=v.wasRequested(),v.hasData()))break}}}return r},n.prototype._addTile=function(e){var n=this._tiles[e.key];if(n)return n;(n=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));var r=Boolean(n);return r||(n=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))),n?(n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(t,e){var n=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout(function(){n._reloadTile(t,"expired"),delete n._timers[t]},r))},n.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},n.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},n.prototype.tilesIn=function(e,n){for(var r=[],i=this.getIds(),o=1/0,a=1/0,s=-1/0,u=-1/0,c=e[0].zoom,l=0;l<e.length;l++){var f=e[l];o=Math.min(o,f.column),a=Math.min(a,f.row),s=Math.max(s,f.column),u=Math.max(u,f.row)}for(var h=0;h<i.length;h++){var p=this._tiles[i[h]];if(!p.holdingForFade()){var d=p.tileID,v=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),g=n*p.queryPadding*t.EXTENT/p.tileSize/v,m=[Gt(d,new t.Coordinate(o,a,c)),Gt(d,new t.Coordinate(s,u,c))];if(m[0].x-g<t.EXTENT&&m[0].y-g<t.EXTENT&&m[1].x+g>=0&&m[1].y+g>=0){for(var y=[],_=0;_<e.length;_++)y.push(Gt(d,e[_]));r.push({tile:p,tileID:d,queryGeometry:[y],scale:v})}}}return r},n.prototype.getVisibleCoordinates=function(t){for(var e=this,n=this.getRenderableIds(t).map(function(t){return e._tiles[t].tileID}),r=0,i=n;r<i.length;r+=1){var o=i[r];o.posMatrix=e.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Wt(this._source.type))for(var e in this._tiles){var n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=t.browser.now())return!0}return!1},n.prototype.setFeatureState=function(t,e,n){t=t||"_geojsonTileLayer",this._state.updateState(t,e,n)},n.prototype.getFeatureState=function(t,e){return t=t||"_geojsonTileLayer",this._state.getState(t,e)},n}(t.Evented);function Gt(e,n){var r=n.zoomTo(e.canonical.z);return new t.Point((r.column-(e.canonical.x+e.wrap*Math.pow(2,e.canonical.z)))*t.EXTENT,(r.row-e.canonical.y)*t.EXTENT)}function qt(t,e){return t%32-e%32||e-t}function Wt(t){return"raster"===t||"image"===t||"video"===t}function Zt(){return new t.window.Worker(Br.workerUrl)}Vt.maxOverzooming=10,Vt.maxUnderzooming=3;var Xt,Ht=function(){this.active={}};function Yt(e,n){var r={};for(var i in e)"ref"!==i&&(r[i]=e[i]);return t.refProperties.forEach(function(t){t in n&&(r[t]=n[t])}),r}function Kt(t){t=t.slice();for(var e=Object.create(null),n=0;n<t.length;n++)e[t[n].id]=t[n];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Yt(t[r],e[t[r].ref]));return t}Ht.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Ht.workerCount;)this.workers.push(new Zt);return this.active[t]=!0,this.workers.slice()},Ht.prototype.release=function(t){delete this.active[t],0===Object.keys(this.active).length&&(this.workers.forEach(function(t){t.terminate()}),this.workers=null)},Ht.workerCount=Math.max(Math.floor(t.browser.hardwareConcurrency/2),1);var Jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Qt(t,e,n){n.push({command:Jt.addSource,args:[t,e[t]]})}function $t(t,e,n){e.push({command:Jt.removeSource,args:[t]}),n[t]=!0}function te(t,e,n,r){$t(t,n,r),Qt(t,e,n)}function ee(e,n,r){var i;for(i in e[r])if(e[r].hasOwnProperty(i)&&"data"!==i&&!t.isEqual(e[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!t.isEqual(e[r][i],n[r][i]))return!1;return!0}function ne(e,n,r,i,o,a){var s;for(s in e=e||{},n=n||{},e)e.hasOwnProperty(s)&&(t.isEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.isEqual(e[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}))}function re(t){return t.id}function ie(t,e){return t[e.id]=e,t}var oe=function(t,e,n){var r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};oe.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},oe.prototype.insert=function(t,e,n,r,i){this._forEachCell(e,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},oe.prototype.insertCircle=function(t,e,n,r){this._forEachCell(e-r,n-r,e+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(r)},oe.prototype._insertBoxCell=function(t,e,n,r,i,o){this.boxCells[i].push(o)},oe.prototype._insertCircleCell=function(t,e,n,r,i,o){this.circleCells[i].push(o)},oe.prototype._query=function(t,e,n,r,i,o){if(n<0||t>this.width||r<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[3*u],l=this.circles[3*u+1],f=this.circles[3*u+2];a.push({key:this.circleKeys[u],x1:c-f,y1:l-f,x2:c+f,y2:l+f})}return o?a.filter(o):a}var h={hitTest:i,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,n,r,this._queryCell,a,h,o),i?a.length>0:a},oe.prototype._queryCircle=function(t,e,n,r,i){var o=t-n,a=t+n,s=e-n,u=e+n;if(a<0||o>this.width||u<0||s>this.height)return!r&&[];var c=[],l={hitTest:r,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,u,this._queryCellCircle,c,l,i),r?c.length>0:c},oe.prototype.query=function(t,e,n,r,i){return this._query(t,e,n,r,!1,i)},oe.prototype.hitTest=function(t,e,n,r,i){return this._query(t,e,n,r,!0,i)},oe.prototype.hitTestCircle=function(t,e,n,r){return this._queryCircle(t,e,n,!0,r)},oe.prototype._queryCell=function(t,e,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var l=this.bboxes,f=0,h=c;f<h.length;f+=1){var p=h[f];if(!u.box[p]){u.box[p]=!0;var d=4*p;if(t<=l[d+2]&&e<=l[d+3]&&n>=l[d+0]&&r>=l[d+1]&&(!s||s(this.boxKeys[p]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[p],x1:l[d],y1:l[d+1],x2:l[d+2],y2:l[d+3]})}}}var v=this.circleCells[i];if(null!==v)for(var g=this.circles,m=0,y=v;m<y.length;m+=1){var _=y[m];if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(g[b],g[b+1],g[b+2],t,e,n,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=g[b],w=g[b+1],E=g[b+2];o.push({key:this.circleKeys[_],x1:x-E,y1:w-E,x2:x+E,y2:w+E})}}}},oe.prototype._queryCellCircle=function(t,e,n,r,i,o,a,s){var u=a.circle,c=a.seenUids,l=this.boxCells[i];if(null!==l)for(var f=this.bboxes,h=0,p=l;h<p.length;h+=1){var d=p[h];if(!c.box[d]){c.box[d]=!0;var v=4*d;if(this._circleAndRectCollide(u.x,u.y,u.radius,f[v+0],f[v+1],f[v+2],f[v+3])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}var g=this.circleCells[i];if(null!==g)for(var m=this.circles,y=0,_=g;y<_.length;y+=1){var b=_[y];if(!c.circle[b]){c.circle[b]=!0;var x=3*b;if(this._circlesCollide(m[x],m[x+1],m[x+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},oe.prototype._forEachCell=function(t,e,n,r,i,o,a,s){for(var u=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),l=this._convertToXCellCoord(n),f=this._convertToYCellCoord(r),h=u;h<=l;h++)for(var p=c;p<=f;p++){var d=this.xCellCount*p+h;if(i.call(this,t,e,n,r,d,o,a,s))return}},oe.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},oe.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},oe.prototype._circlesCollide=function(t,e,n,r,i,o){var a=r-t,s=i-e,u=n+o;return u*u>a*a+s*s},oe.prototype._circleAndRectCollide=function(t,e,n,r,i,o,a){var s=(o-r)/2,u=Math.abs(t-(r+s));if(u>s+n)return!1;var c=(a-i)/2,l=Math.abs(e-(i+c));if(l>c+n)return!1;if(u<=s||l<=c)return!0;var f=u-s,h=l-c;return f*f+h*h<=n*n};var ae=t.properties.layout;function se(e,n,r,i,o){var a=t.identity(new Float32Array(16));return n?(t.identity(a),t.scale(a,a,[1/o,1/o,1]),r||t.rotateZ(a,a,i.angle)):(t.scale(a,a,[i.width/2,-i.height/2,1]),t.translate(a,a,[1,-1,0]),t.multiply(a,a,e)),a}function ue(e,n,r,i,o){var a=t.identity(new Float32Array(16));return n?(t.multiply(a,a,e),t.scale(a,a,[o,o,1]),r||t.rotateZ(a,a,-i.angle)):(t.scale(a,a,[1,-1,1]),t.translate(a,a,[-1,-1,0]),t.scale(a,a,[2/i.width,2/i.height,1])),a}function ce(e,n){var r=[e.x,e.y,0,1];_e(r,r,n);var i=r[3];return{point:new t.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function le(t,e){var n=t[0]/t[3],r=t[1]/t[3];return n>=-e[0]&&n<=e[0]&&r>=-e[1]&&r<=e[1]}function fe(e,n,r,i,o,a,s,u){var c=i?e.textSizeData:e.iconSizeData,l=t.evaluateSizeForZoom(c,r.transform.zoom,ae.properties[i?"text-size":"icon-size"]),f=[256/r.width*2+1,256/r.height*2+1],h=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;h.clear();for(var p=e.lineVertexArray,d=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=r.transform.width/r.transform.height,g=!1,m=0;m<d.length;m++){var y=d.get(m);if(y.hidden||y.writingMode===t.WritingMode.vertical&&!g)ye(y.numGlyphs,h);else{g=!1;var _=[y.anchorX,y.anchorY,0,1];if(t.transformMat4(_,_,n),le(_,f)){var b=.5+_[3]/r.transform.cameraToCenterDistance*.5,x=t.evaluateSizeForFeature(c,l,y),w=s?x*b:x/b,E=new t.Point(y.anchorX,y.anchorY),S=ce(E,o).point,P={},T=de(y,w,!1,u,n,o,a,e.glyphOffsetArray,p,h,S,E,P,v);g=T.useVertical,(T.notEnoughRoom||g||T.needsFlipping&&de(y,w,!0,u,n,o,a,e.glyphOffsetArray,p,h,S,E,P,v).notEnoughRoom)&&ye(y.numGlyphs,h)}else ye(y.numGlyphs,h)}}i?e.text.dynamicLayoutVertexBuffer.updateData(h):e.icon.dynamicLayoutVertexBuffer.updateData(h)}function he(t,e,n,r,i,o,a,s,u,c,l,f){var h=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,v=e.getoffsetX(s.glyphStartIndex),g=e.getoffsetX(h-1),m=ge(t*v,n,r,i,o,a,s.segment,p,d,u,c,l,f);if(!m)return null;var y=ge(t*g,n,r,i,o,a,s.segment,p,d,u,c,l,f);return y?{first:m,last:y}:null}function pe(e,n,r,i){return e===t.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function de(e,n,r,i,o,a,s,u,c,l,f,h,p,d){var v,g=n/24,m=e.lineOffsetX*n,y=e.lineOffsetY*n;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,b=e.lineStartIndex,x=e.lineStartIndex+e.lineLength,w=he(g,u,m,y,r,f,h,e,c,a,p,!1);if(!w)return{notEnoughRoom:!0};var E=ce(w.first.point,s).point,S=ce(w.last.point,s).point;if(i&&!r){var P=pe(e.writingMode,E,S,d);if(P)return P}v=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)v.push(ge(g*u.getoffsetX(T),m,y,r,f,h,e.segment,b,x,c,a,p,!1));v.push(w.last)}else{if(i&&!r){var A=ce(h,o).point,k=e.lineStartIndex+e.segment+1,C=new t.Point(c.getx(k),c.gety(k)),O=ce(C,o),M=O.signedDistanceFromCamera>0?O.point:ve(h,C,A,1,o),I=pe(e.writingMode,A,M,d);if(I)return I}var L=ge(g*u.getoffsetX(e.glyphStartIndex),m,y,r,f,h,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,a,p,!1);if(!L)return{notEnoughRoom:!0};v=[L]}for(var R=0,j=v;R<j.length;R+=1){var z=j[R];t.addDynamicAttributes(l,z.point,z.angle)}return{}}function ve(t,e,n,r,i){var o=ce(t.add(t.sub(e)._unit()),i).point,a=n.sub(o);return n.add(a._mult(r/a.mag()))}function ge(e,n,r,i,o,a,s,u,c,l,f,h,p){var d=i?e-n:e+n,v=d>0?1:-1,g=0;i&&(v*=-1,g=Math.PI),v<0&&(g+=Math.PI);for(var m=v>0?u+s:u+s+1,y=m,_=o,b=o,x=0,w=0,E=Math.abs(d);x+w<=E;){if((m+=v)<u||m>=c)return null;if(b=_,void 0===(_=h[m])){var S=new t.Point(l.getx(m),l.gety(m)),P=ce(S,f);if(P.signedDistanceFromCamera>0)_=h[m]=P.point;else{var T=m-v;_=ve(0===x?a:new t.Point(l.getx(T),l.gety(T)),S,b,E-x+1,f)}}x+=w,w=b.dist(_)}var A=(E-x)/w,k=_.sub(b),C=k.mult(A)._add(b);return C._add(k._unit()._perp()._mult(r*v)),{point:C,angle:g+Math.atan2(_.y-b.y,_.x-b.x),tileDistance:p?{prevTileDistance:m-v===y?0:l.gettileUnitDistanceFromAnchor(m-v),lastSegmentViewportDistance:E-x}:null}}var me=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ye(t,e){for(var n=0;n<t;n++){var r=e.length;e.resize(r+4),e.float32.set(me,3*r)}}function _e(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t[3]=n[3]*r+n[7]*i+n[15],t}var be=function(t,e,n){void 0===e&&(e=new oe(t.width+200,t.height+200,25)),void 0===n&&(n=new oe(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function xe(t,e,n){t[e+4]=n?1:0}function we(e,n,r){return n*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}be.prototype.placeCollisionBox=function(t,e,n,r,i){var o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),a=n*o.perspectiveRatio,s=t.x1*a+o.point.x,u=t.y1*a+o.point.y,c=t.x2*a+o.point.x,l=t.y2*a+o.point.y;return!this.isInsideGrid(s,u,c,l)||!e&&this.grid.hitTest(s,u,c,l,i)?{box:[],offscreen:!1}:{box:[s,u,c,l],offscreen:this.isOffscreen(s,u,c,l)}},be.prototype.approximateTileDistance=function(t,e,n,r,i){var o=i?1:r/this.pitchfactor,a=t.lastSegmentViewportDistance*n;return t.prevTileDistance+a+(o-1)*a*Math.abs(Math.sin(e))},be.prototype.placeCollisionCircles=function(e,n,r,i,o,a,s,u,c,l,f,h,p){var d=[],v=this.projectAnchor(c,o.anchorX,o.anchorY),g=u/24,m=o.lineOffsetX*u,y=o.lineOffsetY*u,_=new t.Point(o.anchorX,o.anchorY),b=he(g,s,m,y,!1,ce(_,l).point,_,o,a,l,{},!0),x=!1,w=!1,E=!0,S=v.perspectiveRatio*i,P=1/(i*r),T=0,A=0;b&&(T=this.approximateTileDistance(b.first.tileDistance,b.first.angle,P,v.cameraDistance,h),A=this.approximateTileDistance(b.last.tileDistance,b.last.angle,P,v.cameraDistance,h));for(var k=0;k<e.length;k+=5){var C=e[k],O=e[k+1],M=e[k+2],I=e[k+3];if(!b||I<-T||I>A)xe(e,k,!1);else{var L=this.projectPoint(c,C,O),R=M*S;if(d.length>0){var j=L.x-d[d.length-4],z=L.y-d[d.length-3];if(R*R*2>j*j+z*z&&k+8<e.length){var D=e[k+8];if(D>-T&&D<A){xe(e,k,!1);continue}}}var F=k/5;d.push(L.x,L.y,R,F),xe(e,k,!0);var N=L.x-R,B=L.y-R,U=L.x+R,V=L.y+R;if(E=E&&this.isOffscreen(N,B,U,V),w=w||this.isInsideGrid(N,B,U,V),!n&&this.grid.hitTestCircle(L.x,L.y,R,p)){if(!f)return{circles:[],offscreen:!1};x=!0}}}return{circles:x||!w?[]:d,offscreen:E}},be.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=e;s<u.length;s+=1){var c=u[s],l=new t.Point(c.x+100,c.y+100);r=Math.min(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y),n.push(l)}for(var f={},h={},p=0,d=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a));p<d.length;p+=1){var v=d[p],g=v.key;if(void 0===f[g.bucketInstanceId]&&(f[g.bucketInstanceId]={}),!f[g.bucketInstanceId][g.featureIndex]){var m=[new t.Point(v.x1,v.y1),new t.Point(v.x2,v.y1),new t.Point(v.x2,v.y2),new t.Point(v.x1,v.y2)];t.polygonIntersectsPolygon(n,m)&&(f[g.bucketInstanceId][g.featureIndex]=!0,void 0===h[g.bucketInstanceId]&&(h[g.bucketInstanceId]=[]),h[g.bucketInstanceId].push(g.featureIndex))}}return h},be.prototype.insertCollisionBox=function(t,e,n,r,i){var o={bucketInstanceId:n,featureIndex:r,collisionGroupID:i};(e?this.ignoredGrid:this.grid).insert(o,t[0],t[1],t[2],t[3])},be.prototype.insertCollisionCircles=function(t,e,n,r,i){for(var o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:i},s=0;s<t.length;s+=4)o.insertCircle(a,t[s],t[s+1],t[s+2])},be.prototype.projectAnchor=function(t,e,n){var r=[e,n,0,1];return _e(r,r,t),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5,cameraDistance:r[3]}},be.prototype.projectPoint=function(e,n,r){var i=[n,r,0,1];return _e(i,i,e),new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},be.prototype.projectAndGetPerspectiveRatio=function(e,n,r){var i=[n,r,0,1];return _e(i,i,e),{point:new t.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},be.prototype.isOffscreen=function(t,e,n,r){return n<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},be.prototype.isInsideGrid=function(t,e,n,r){return n>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary};var Ee=function(t,e,n,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&n?1:0,this.placed=n};Ee.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Se=function(t,e,n,r,i){this.text=new Ee(t?t.text:null,e,n,i),this.icon=new Ee(t?t.icon:null,e,r,i)};Se.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Pe=function(t,e,n){this.text=t,this.icon=e,this.skipFade=n},Te=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};Te.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var Ae=function(t,e,n){this.transform=t.clone(),this.collisionIndex=new be(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new Te(n)};function ke(t,e,n){t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0),t.emplaceBack(e?1:0,n?1:0)}Ae.prototype.placeLayerTile=function(e,n,r,i){var o=n.getBucket(e),a=n.latestFeatureIndex;if(o&&a&&e.id===o.layerIds[0]){var s=n.collisionBoxArray,u=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),l=n.tileSize/t.EXTENT,f=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),h=se(f,"map"===u.get("text-pitch-alignment"),"map"===u.get("text-rotation-alignment"),this.transform,we(n,1,this.transform.zoom)),p=se(f,"map"===u.get("icon-pitch-alignment"),"map"===u.get("icon-rotation-alignment"),this.transform,we(n,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(t,e,n,r,i){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i}(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID),this.placeLayerBucket(o,f,h,p,c,l,r,n.holdingForFade(),i,s)}},Ae.prototype.placeLayerBucket=function(e,n,r,i,o,a,s,u,c,l){var f=e.layers[0].layout,h=t.evaluateSizeForZoom(e.textSizeData,this.transform.zoom,t.properties.layout.properties["text-size"]),p=f.get("text-optional"),d=f.get("icon-optional"),v=f.get("text-allow-overlap"),g=f.get("icon-allow-overlap"),m=v&&(g||!e.hasIconData()||d),y=g&&(v||!e.hasTextData()||p),_=this.collisionGroups.get(e.sourceID);!e.collisionArrays&&l&&e.deserializeCollisionBoxes(l);for(var b=0;b<e.symbolInstances.length;b++){var x=e.symbolInstances.get(b);if(!c[x.crossTileID]){if(u){this.placements[x.crossTileID]=new Pe(!1,!1,!1);continue}var w=!1,E=!1,S=!0,P=null,T=null,A=null,k=0,C=0,O=e.collisionArrays[b];O.textFeatureIndex&&(k=O.textFeatureIndex),O.textBox&&(w=(P=this.collisionIndex.placeCollisionBox(O.textBox,f.get("text-allow-overlap"),a,n,_.predicate)).box.length>0,S=S&&P.offscreen);var M=O.textCircles;if(M){var I=e.text.placedSymbolArray.get(x.horizontalPlacedTextSymbolIndex),L=t.evaluateSizeForFeature(e.textSizeData,h,I);T=this.collisionIndex.placeCollisionCircles(M,f.get("text-allow-overlap"),o,a,I,e.lineVertexArray,e.glyphOffsetArray,L,n,r,s,"map"===f.get("text-pitch-alignment"),_.predicate),w=f.get("text-allow-overlap")||T.circles.length>0,S=S&&T.offscreen}O.iconFeatureIndex&&(C=O.iconFeatureIndex),O.iconBox&&(E=(A=this.collisionIndex.placeCollisionBox(O.iconBox,f.get("icon-allow-overlap"),a,n,_.predicate)).box.length>0,S=S&&A.offscreen);var R=p||0===x.numGlyphVertices&&0===x.numVerticalGlyphVertices,j=d||0===x.numIconVertices;R||j?j?R||(E=E&&w):w=E&&w:E=w=E&&w,w&&P&&this.collisionIndex.insertCollisionBox(P.box,f.get("text-ignore-placement"),e.bucketInstanceId,k,_.ID),E&&A&&this.collisionIndex.insertCollisionBox(A.box,f.get("icon-ignore-placement"),e.bucketInstanceId,C,_.ID),w&&T&&this.collisionIndex.insertCollisionCircles(T.circles,f.get("text-ignore-placement"),e.bucketInstanceId,k,_.ID),this.placements[x.crossTileID]=new Pe(w||m,E||y,S||e.justReloaded),c[x.crossTileID]=!0}}e.justReloaded=!1},Ae.prototype.commit=function(t,e){this.commitTime=e;var n=!1,r=t&&0!==this.fadeDuration?(this.commitTime-t.commitTime)/this.fadeDuration:1,i=t?t.opacities:{};for(var o in this.placements){var a=this.placements[o],s=i[o];s?(this.opacities[o]=new Se(s,r,a.text,a.icon),n=n||a.text!==s.text.placed||a.icon!==s.icon.placed):(this.opacities[o]=new Se(null,r,a.text,a.icon,a.skipFade),n=n||a.text||a.icon)}for(var u in i){var c=i[u];if(!this.opacities[u]){var l=new Se(c,r,!1,!1);l.isHidden()||(this.opacities[u]=l,n=n||c.text.placed||c.icon.placed)}}n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},Ae.prototype.updateLayerOpacities=function(t,e){for(var n={},r=0,i=e;r<i.length;r+=1){var o=i[r],a=o.getBucket(t);a&&o.latestFeatureIndex&&t.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},Ae.prototype.updateBucketOpacities=function(t,e,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexArray.clear(),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexArray.clear();var r=t.layers[0].layout,i=new Se(null,0,!1,!1,!0),o=r.get("text-allow-overlap"),a=r.get("icon-allow-overlap"),s=new Se(null,0,o&&(a||!t.hasIconData()||r.get("icon-optional")),a&&(o||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasCollisionBoxData()||t.hasCollisionCircleData())&&t.deserializeCollisionBoxes(n);for(var u=0;u<t.symbolInstances.length;u++){var c=t.symbolInstances.get(u),l=e[c.crossTileID],f=this.opacities[c.crossTileID];l?f=i:f||(f=s,this.opacities[c.crossTileID]=f),e[c.crossTileID]=!0;var h=c.numGlyphVertices>0||c.numVerticalGlyphVertices>0,p=c.numIconVertices>0;if(h){for(var d=ze(f.text),v=(c.numGlyphVertices+c.numVerticalGlyphVertices)/4,g=0;g<v;g++)t.text.opacityVertexArray.emplaceBack(d);t.text.placedSymbolArray.get(c.horizontalPlacedTextSymbolIndex).hidden=f.text.isHidden(),c.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).hidden=f.text.isHidden())}if(p){for(var m=ze(f.icon),y=0;y<c.numIconVertices/4;y++)t.icon.opacityVertexArray.emplaceBack(m);t.icon.placedSymbolArray.get(u).hidden=f.icon.isHidden()}if(t.hasCollisionBoxData()||t.hasCollisionCircleData()){var _=t.collisionArrays[u];if(_){_.textBox&&ke(t.collisionBox.collisionVertexArray,f.text.placed,!1),_.iconBox&&ke(t.collisionBox.collisionVertexArray,f.icon.placed,!1);var b=_.textCircles;if(b&&t.hasCollisionCircleData())for(var x=0;x<b.length;x+=5){var w=l||0===b[x+4];ke(t.collisionCircle.collisionVertexArray,f.text.placed,w)}}}}t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasCollisionBoxData()&&t.collisionBox.collisionVertexBuffer&&t.collisionBox.collisionVertexBuffer.updateData(t.collisionBox.collisionVertexArray),t.hasCollisionCircleData()&&t.collisionCircle.collisionVertexBuffer&&t.collisionCircle.collisionVertexBuffer.updateData(t.collisionCircle.collisionVertexArray)},Ae.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration},Ae.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},Ae.prototype.stillRecent=function(t){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>t},Ae.prototype.setStale=function(){this.stale=!0};var Ce=Math.pow(2,25),Oe=Math.pow(2,24),Me=Math.pow(2,17),Ie=Math.pow(2,16),Le=Math.pow(2,9),Re=Math.pow(2,8),je=Math.pow(2,1);function ze(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*Ce+e*Oe+n*Me+e*Ie+n*Le+e*Re+n*je+e}var De=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};De.prototype.continuePlacement=function(t,e,n,r,i){for(;this._currentTileIndex<t.length;){var o=t[this._currentTileIndex];if(e.placeLayerTile(r,o,n,this._seenCrossTileIDs),this._currentTileIndex++,i())return!0}};var Fe=function(t,e,n,r,i,o){this.placement=new Ae(t,i,o),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1};Fe.prototype.isDone=function(){return this._done},Fe.prototype.continuePlacement=function(e,n,r){for(var i=this,o=t.browser.now(),a=function(){var e=t.browser.now()-o;return!i._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=n[e[i._currentPlacementIndex]],u=i.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(i._inProgressLayer||(i._inProgressLayer=new De),i._inProgressLayer.continuePlacement(r[s.source],i.placement,i._showCollisionBoxes,s,a))return;delete i._inProgressLayer}i._currentPlacementIndex--}this._done=!0},Fe.prototype.commit=function(t,e){return this.placement.commit(t,e),this.placement};var Ne=512/t.EXTENT/2,Be=function(t,e,n){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<e.length;r++){var i=e.get(r),o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,t)})}};Be.prototype.getScaledCoordinates=function(e,n){var r=n.canonical.z-this.tileID.canonical.z,i=Ne/Math.pow(2,r);return{x:Math.floor((n.canonical.x*t.EXTENT+e.anchorX)*i),y:Math.floor((n.canonical.y*t.EXTENT+e.anchorY)*i)}},Be.prototype.findMatches=function(t,e,n){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),i=0;i<t.length;i++){var o=t.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,e),u=0,c=a;u<c.length;u+=1){var l=c[u];if(Math.abs(l.coord.x-s.x)<=r&&Math.abs(l.coord.y-s.y)<=r&&!n[l.crossTileID]){n[l.crossTileID]=!0,o.crossTileID=l.crossTileID;break}}}}};var Ue=function(){this.maxCrossTileID=0};Ue.prototype.generate=function(){return++this.maxCrossTileID};var Ve=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ve.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var n in this.indexes){var r=this.indexes[n],i={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+e),i[a.tileID.key]=a}this.indexes[n]=i}this.lng=t},Ve.prototype.addBucket=function(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var i=this.usedCrossTileIDs[t.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>t.overscaledZ)for(var s in a){var u=a[s];u.tileID.isChildOf(t)&&u.findMatches(e.symbolInstances,t,i)}else{var c=a[t.scaledTo(Number(o)).key];c&&c.findMatches(e.symbolInstances,t,i)}}for(var l=0;l<e.symbolInstances.length;l++){var f=e.symbolInstances.get(l);f.crossTileID||(f.crossTileID=n.generate(),i[f.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Be(t,e.symbolInstances,e.bucketInstanceId),!0},Ve.prototype.removeBucketCrossTileIDs=function(t,e){for(var n in e.indexedSymbolInstances)for(var r=0,i=e.indexedSymbolInstances[n];r<i.length;r+=1){var o=i[r];delete this.usedCrossTileIDs[t][o.crossTileID]}},Ve.prototype.removeStaleBuckets=function(t){var e=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)t[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],e=!0)}return e};var Ge=function(){this.layerIndexes={},this.crossTileIDs=new Ue,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ge.prototype.addLayer=function(t,e,n){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Ve);var i=!1,o={};r.handleWrapJump(n);for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(i=!0),o[c.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i},Ge.prototype.pruneUnusedLayers=function(t){var e={};for(var n in t.forEach(function(t){e[t]=!0}),this.layerIndexes)e[n]||delete this.layerIndexes[n]};var qe=function(e,n){return t.emitValidationErrors(e,n&&n.filter(function(t){return"source.canvas"!==t.identifier}))},We=t.pick(Jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ze=t.pick(Jt,["setCenter","setZoom","setBearing","setPitch"]),Xe=function(e){function n(r,i){var o=this;void 0===i&&(i={}),e.call(this),this.map=r,this.dispatcher=new z((Xt||(Xt=new Ht),Xt),this),this.imageManager=new P,this.glyphManager=new M(r._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new j(256,512),this.crossTileSymbolIndex=new Ge,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._resetUpdates();var a=this;this._rtlTextPluginCallback=n.registerForPluginAvailability(function(t){for(var e in a.dispatcher.broadcast("loadRTLTextPlugin",t.pluginURL,t.completionCallback),a.sourceCaches)a.sourceCaches[e].reload()}),this.on("data",function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=o.sourceCaches[t.sourceId];if(e){var n=e.getSource();if(n&&n.vectorLayerIds)for(var r in o._layers){var i=o._layers[r];i.source===n.id&&o._validateLayer(i)}}}})}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.loadURL=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!d(e);e=function(t,e){if(!d(t))return t;var n=b(t);return n.path="/styles/v1"+n.path,p(n,e)}(e,n.accessToken);var o=this.map._transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(o,function(e,n){r._request=null,e?r.fire(new t.ErrorEvent(e)):n&&r._load(n,i)})},n.prototype.loadJSON=function(e,n){var r=this;void 0===n&&(n={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame(function(){r._request=null,r._load(e,!1!==n.validate)})},n.prototype._load=function(e,n){var r=this;if(!n||!qe(this,t.validateStyle(e))){for(var i in this._loaded=!0,this.stylesheet=e,e.sources)r.addSource(i,e.sources[i],{validate:!1});e.sprite?this._spriteRequest=function(e,n,r){var i,o,a,s=t.browser.devicePixelRatio>1?"@2x":"",u=t.getJSON(n(g(e,s,".json"),t.ResourceType.SpriteJSON),function(t,e){u=null,a||(a=t,i=e,l())}),c=t.getImage(n(g(e,s,".png"),t.ResourceType.SpriteImage),function(t,e){c=null,a||(a=t,o=e,l())});function l(){if(a)r(a);else if(i&&o){var e=t.browser.getImageData(o),n={};for(var s in i){var u=i[s],c=u.width,l=u.height,f=u.x,h=u.y,p=u.sdf,d=u.pixelRatio,v=new t.RGBAImage({width:c,height:l});t.RGBAImage.copy(e,v,{x:f,y:h},{x:0,y:0},{width:c,height:l}),n[s]={data:v,pixelRatio:d,sdf:p}}r(null,n)}}return{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(e.sprite,this.map._transformRequest,function(e,n){if(r._spriteRequest=null,e)r.fire(new t.ErrorEvent(e));else if(n)for(var i in n)r.imageManager.addImage(i,n[i]);r.imageManager.setLoaded(!0),r.fire(new t.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=Kt(this.stylesheet.layers);this._order=o.map(function(t){return t.id}),this._layers={};for(var a=0,s=o;a<s.length;a+=1){var u=s[a];(u=t.createStyleLayer(u)).setEventedParent(r,{layer:{id:u.id}}),r._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new R(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},n.prototype._validateLayer=function(e){var n=this.sourceCaches[e.source];if(n){var r=e.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+e.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(t){for(var e=[],n=0,r=t;n<r.length;n+=1){var i=r[n],o=this._layers[i];"custom"!==o.type&&e.push(o.serialize())}return e},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(e){if(this._loaded){if(this._changed){var n=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);for(var i in(n.length||r.length)&&this._updateWorkerLayers(n,r),this._updatedSources){var o=this._updatedSources[i];"reload"===o?this._reloadSource(i):"clear"===o&&this._clearSource(i)}for(var a in this._updatedPaintProps)this._layers[a].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates(),this.fire(new t.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var u=0,c=this._order;u<c.length;u+=1){var l=c[u],f=this._layers[l];f.recalculate(e),!f.isHidden(e.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}this.light.recalculate(e),this.z=e.zoom}},n.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},n.prototype.setState=function(e){var n=this;if(this._checkLoaded(),qe(this,t.validateStyle(e)))return!1;(e=t.clone(e)).layers=Kt(e.layers);var r=function(e,n){if(!e)return[{command:Jt.setStyle,args:[n]}];var r=[];try{if(!t.isEqual(e.version,n.version))return[{command:Jt.setStyle,args:[n]}];t.isEqual(e.center,n.center)||r.push({command:Jt.setCenter,args:[n.center]}),t.isEqual(e.zoom,n.zoom)||r.push({command:Jt.setZoom,args:[n.zoom]}),t.isEqual(e.bearing,n.bearing)||r.push({command:Jt.setBearing,args:[n.bearing]}),t.isEqual(e.pitch,n.pitch)||r.push({command:Jt.setPitch,args:[n.pitch]}),t.isEqual(e.sprite,n.sprite)||r.push({command:Jt.setSprite,args:[n.sprite]}),t.isEqual(e.glyphs,n.glyphs)||r.push({command:Jt.setGlyphs,args:[n.glyphs]}),t.isEqual(e.transition,n.transition)||r.push({command:Jt.setTransition,args:[n.transition]}),t.isEqual(e.light,n.light)||r.push({command:Jt.setLight,args:[n.light]});var i={},o=[];!function(e,n,r,i){var o;for(o in e=e||{},n=n||{},e)e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||$t(o,r,i));for(o in n)n.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t.isEqual(e[o],n[o])||("geojson"===e[o].type&&"geojson"===n[o].type&&ee(e,n,o)?r.push({command:Jt.setGeoJSONSourceData,args:[o,n[o].data]}):te(o,n,r,i)):Qt(o,n,r))}(e.sources,n.sources,o,i);var a=[];e.layers&&e.layers.forEach(function(t){i[t.source]?r.push({command:Jt.removeLayer,args:[t.id]}):a.push(t)}),r=r.concat(o),function(e,n,r){e=e||[],n=n||[];var i,o,a,s,u,c,l,f=e.map(re),h=n.map(re),p=e.reduce(ie,{}),d=n.reduce(ie,{}),v=f.slice(),g=Object.create(null);for(i=0,o=0;i<f.length;i++)a=f[i],d.hasOwnProperty(a)?o++:(r.push({command:Jt.removeLayer,args:[a]}),v.splice(v.indexOf(a,o),1));for(i=0,o=0;i<h.length;i++)a=h[h.length-1-i],v[v.length-1-i]!==a&&(p.hasOwnProperty(a)?(r.push({command:Jt.removeLayer,args:[a]}),v.splice(v.lastIndexOf(a,v.length-o),1)):o++,c=v[v.length-i],r.push({command:Jt.addLayer,args:[d[a],c]}),v.splice(v.length-i,0,a),g[a]=!0);for(i=0;i<h.length;i++)if(s=p[a=h[i]],u=d[a],!g[a]&&!t.isEqual(s,u))if(t.isEqual(s.source,u.source)&&t.isEqual(s["source-layer"],u["source-layer"])&&t.isEqual(s.type,u.type)){for(l in ne(s.layout,u.layout,r,a,null,Jt.setLayoutProperty),ne(s.paint,u.paint,r,a,null,Jt.setPaintProperty),t.isEqual(s.filter,u.filter)||r.push({command:Jt.setFilter,args:[a,u.filter]}),t.isEqual(s.minzoom,u.minzoom)&&t.isEqual(s.maxzoom,u.maxzoom)||r.push({command:Jt.setLayerZoomRange,args:[a,u.minzoom,u.maxzoom]}),s)s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?ne(s[l],u[l],r,a,l.slice(6),Jt.setPaintProperty):t.isEqual(s[l],u[l])||r.push({command:Jt.setLayerProperty,args:[a,l,u[l]]}));for(l in u)u.hasOwnProperty(l)&&!s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?ne(s[l],u[l],r,a,l.slice(6),Jt.setPaintProperty):t.isEqual(s[l],u[l])||r.push({command:Jt.setLayerProperty,args:[a,l,u[l]]}))}else r.push({command:Jt.removeLayer,args:[a]}),c=v[v.lastIndexOf(a)+1],r.push({command:Jt.addLayer,args:[u,c]})}(a,n.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:Jt.setStyle,args:[n]}]}return r}(this.serialize(),e).filter(function(t){return!(t.command in Ze)});if(0===r.length)return!1;var i=r.filter(function(t){return!(t.command in We)});if(i.length>0)throw new Error("Unimplemented: "+i.map(function(t){return t.command}).join(", ")+".");return r.forEach(function(t){"setTransition"!==t.command&&n[t.command].apply(n,t.args)}),this.stylesheet=e,!0},n.prototype.addImage=function(e,n){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,n),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.getImage=function(t){return this.imageManager.getImage(t)},n.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this.fire(new t.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(e,n,r){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,n,null,r))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[e]=new Vt(e,n,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:e}}),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+n+'" is using it.')));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},n.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},n.prototype.addLayer=function(e,n,r){this._checkLoaded();var i=e.id;if(this.getLayer(i))this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var o;if("custom"===e.type){if(qe(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(i,e.source),e=t.clone(e),e=t.extend(e,{source:i})),this._validate(t.validateStyle.layer,"layers."+i,e,{arrayIndex:-1},r))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}})}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(e,n){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==n){var r=this._order.indexOf(e);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(e){this._checkLoaded();var n=this._layers[e];if(n){n.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(t){return this._layers[t]},n.prototype.setLayerZoomRange=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(e,n){this._checkLoaded();var r=this.getLayer(e);if(r){if(!t.isEqual(r.filter,n))return null===n||void 0===n?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(t.validateStyle.filter,"layers."+r.id+".filter",n)||(r.filter=t.clone(n),this._updateLayer(r)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(e){return t.clone(this.getLayer(e).filter)},n.prototype.setLayoutProperty=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?t.isEqual(i.getLayoutProperty(n),r)||(i.setLayoutProperty(n,r),this._updateLayer(i)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(t,e){return this.getLayer(t).getLayoutProperty(e)},n.prototype.setPaintProperty=function(e,n,r){this._checkLoaded();var i=this.getLayer(e);i?t.isEqual(i.getPaintProperty(n),r)||(i.setPaintProperty(n,r)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},n.prototype.setFeatureState=function(e,n){this._checkLoaded();var r=e.source,i=e.sourceLayer,o=this.sourceCaches[r],a=parseInt(e.id,10);void 0!==o?"vector"!==o.getSource().type||i?isNaN(a)||a<0?this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):o.setFeatureState(i,a,n):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))):this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(e){this._checkLoaded();var n=e.source,r=e.sourceLayer,i=this.sourceCaches[n],o=parseInt(e.id,10);if(void 0!==i)if("vector"!==i.getSource().type||r){if(!(isNaN(o)||o<0))return i.getFeatureState(r,o);this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new t.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,function(t){return t.serialize()}),layers:this._serializeLayers(this._order)},function(t){return void 0!==t})},n.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},n.prototype._flattenRenderedFeatures=function(t){for(var e=[],n=this._order.length-1;n>=0;n--)for(var r=this._order[n],i=0,o=t;i<o.length;i+=1){var a=o[i][r];if(a)for(var s=0,u=a;s<u.length;s+=1){var c=u[s];e.push(c)}}return e},n.prototype.queryRenderedFeatures=function(e,n,r){n&&n.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",n.filter);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],u=this._layers[s];if(!u)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[u.source]=!0}}var c=[],l=e.map(function(t){return r.pointCoordinate(t)});for(var f in this.sourceCaches)n.layers&&!i[f]||c.push(K(this.sourceCaches[f],this._layers,l,n,r));return this.placement&&c.push(function(t,e,n,r,i,o){for(var a={},s=i.queryRenderedSymbols(n),u=[],c=0,l=Object.keys(s).map(Number);c<l.length;c+=1){var f=l[c];u.push(o[f])}u.sort(J);for(var h=function(){var e=d[p],n=e.featureIndex.lookupSymbolFeatures(s[e.bucketInstanceId],e.bucketIndex,e.sourceLayerIndex,r.filter,r.layers,t);for(var i in n){var o=a[i]=a[i]||[],u=n[i];u.sort(function(t,n){var r=e.featureSortOrder;if(r){var i=r.indexOf(t.featureIndex);return r.indexOf(n.featureIndex)-i}return n.featureIndex-t.featureIndex});for(var c=0,l=u;c<l.length;c+=1){var f=l[c];o.push(f.feature)}}},p=0,d=u;p<d.length;p+=1)h();var v=function(n){a[n].forEach(function(r){var i=t[n],o=e[i.source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=o})};for(var g in a)v(g);return a}(this._layers,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(c)},n.prototype.querySourceFeatures=function(e,n){n&&n.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",n.filter);var r=this.sourceCaches[e];return r?function(t,e){for(var n=t.getRenderableIds().map(function(e){return t.getTileByID(e)}),r=[],i={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(r,e))}return r}(r,n):[]},n.prototype.addSourceType=function(t,e,r){return n.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(n.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(e){this._checkLoaded();var n=this.light.getLight(),r=!1;for(var i in e)if(!t.isEqual(e[i],n[i])){r=!0;break}if(r){var o={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e),this.light.updateTransitions(o)}},n.prototype._validate=function(e,n,r,i,o){return(!o||!1!==o.validate)&&qe(this,e.call(t.validateStyle,t.extend({key:n,style:this.serialize(),value:r,styleSpec:t.styleSpec},i)))},n.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[e].clearTiles();this.dispatcher.remove()},n.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},n.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},n.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},n.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},n.prototype._updatePlacement=function(e,n,r,i){for(var o=!1,a=!1,s={},u=0,c=this._order;u<c.length;u+=1){var l=c[u],f=this._layers[l];if("symbol"===f.type){if(!s[f.source]){var h=this.sourceCaches[f.source];s[f.source]=h.getRenderableIds(!0).map(function(t){return h.getTileByID(t)}).sort(function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)})}var p=this.crossTileSymbolIndex.addLayer(f,s[f.source],e.center.lng);o=o||p}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var d=this._layerOrderChanged;if((d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now()))&&(this.pauseablePlacement=new Fe(e,this._order,d,n,r,i),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,s),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,t.browser.now()),a=!0),o&&this.pauseablePlacement.placement.setStale()),a||o)for(var v=0,g=this._order;v<g.length;v+=1){var m=g[v],y=this._layers[m];"symbol"===y.type&&this.placement.updateLayerOpacities(y,s[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},n.prototype.getImages=function(t,e,n){this.imageManager.getImages(e.icons,n)},n.prototype.getGlyphs=function(t,e,n){this.glyphManager.getGlyphs(e.stacks,n)},n}(t.Evented);Xe.getSourceType=function(t){return H[t]},Xe.setSourceType=function(t,e){H[t]=e},Xe.registerForPluginAvailability=t.registerForPluginAvailability;var He=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ye={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"\nuniform vec2 u_texsize;\nuniform sampler2D u_image;\nuniform float u_fade;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_fade) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform vec4 u_scale;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileRatio, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileRatio, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_fade) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform vec4 u_scale;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileZoomRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileZoomRatio, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileZoomRatio, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n\nvoid main() {\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\nuniform float u_vertical_gradient;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize highp float base\n    #pragma mapbox: initialize highp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        // This avoids another branching statement, but multiplies by a constant of 0.84 if no vertical gradient,\n        // and otherwise calculates the gradient based on base + height\n        directional *= (\n            (1.0 - u_vertical_gradient) +\n            (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_fade);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_height_factor;\nuniform vec4 u_scale;\nuniform float u_vertical_gradient;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileRatio, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileRatio, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        // This avoids another branching statement, but multiplies by a constant of 0.84 if no vertical gradient,\n        // and otherwise calculates the gradient based on base + height\n        directional *= (\n            (1.0 - u_vertical_gradient) +\n            (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_texsize;\nuniform float u_fade;\nuniform mediump vec4 u_scale;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileZoomRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    vec2 pattern_size_a = vec2(display_size_a.x * fromScale / tileZoomRatio, display_size_a.y);\n    vec2 pattern_size_b = vec2(display_size_b.x * toScale / tileZoomRatio, display_size_b.y);\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (pattern_size_a.y + 2.0) / 2.0) / pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (pattern_size_b.y + 2.0) / 2.0) / pattern_size_b.y);\n    vec2 pos_a = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform vec2 u_gl_units_to_pixels;\nuniform mediump float u_ratio;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n    // float tileRatio = u_scale.y;\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},Ke=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Je=function(t){var e=Ye[t],n={};e.fragmentSource=e.fragmentSource.replace(Ke,function(t,e,r,i,o){return n[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+r+" "+i+" "+o+";\n#else\nuniform "+r+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+r+" "+i+" "+o+" = u_"+o+";\n#endif\n"}),e.vertexSource=e.vertexSource.replace(Ke,function(t,e,r,i,o){var a="float"===i?"vec2":"vec4",s=o.match(/color/)?"color":a;return n[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+r+" "+a+" a_"+o+";\nvarying "+r+" "+i+" "+o+";\n#else\nuniform "+r+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+r+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+r+" "+i+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+r+" "+a+" a_"+o+";\n#else\nuniform "+r+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+r+" "+i+" "+o+" = a_"+o+";\n#else\n    "+r+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+r+" "+i+" "+o+" = unpack_mix_"+s+"(a_"+o+", a_"+o+"_t);\n#else\n    "+r+" "+i+" "+o+" = u_"+o+";\n#endif\n"})};for(var Qe in Ye)Je(Qe);var $e=Ye,tn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};tn.prototype.bind=function(t,e,n,r,i,o,a,s){this.context=t;for(var u=this.boundPaintVertexBuffers.length!==r.length,c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);var l=!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==a||this.boundDynamicVertexBuffer2!==s;!t.extVertexArrayObject||l?this.freshBind(e,n,r,i,o,a,s):(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind())},tn.prototype.freshBind=function(t,e,n,r,i,o,a){var s,u=t.numAttributes,c=this.context,l=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var f=u;f<s;f++)l.disableVertexAttribArray(f)}e.enableAttributes(l,t);for(var h=0,p=n;h<p.length;h+=1)p[h].enableAttributes(l,t);o&&o.enableAttributes(l,t),a&&a.enableAttributes(l,t),e.bind(),e.setVertexAttribPointers(l,t,i);for(var d=0,v=n;d<v.length;d+=1){var g=v[d];g.bind(),g.setVertexAttribPointers(l,t,i)}o&&(o.bind(),o.setVertexAttribPointers(l,t,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(l,t,i)),c.currentNumAttributes=u},tn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var en=function(e,n,r,i,o){var a=e.gl;this.program=a.createProgram();var s=r.defines().concat("#define DEVICE_PIXEL_RATIO "+t.browser.devicePixelRatio.toFixed(1));o&&s.push("#define OVERDRAW_INSPECTOR;");var u=s.concat($e.prelude.fragmentSource,n.fragmentSource).join("\n"),c=s.concat($e.prelude.vertexSource,n.vertexSource).join("\n"),l=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(l,u),a.compileShader(l),a.attachShader(this.program,l);var f=a.createShader(a.VERTEX_SHADER);a.shaderSource(f,c),a.compileShader(f),a.attachShader(this.program,f);for(var h=r.layoutAttributes||[],p=0;p<h.length;p++)a.bindAttribLocation(this.program,p,h[p].name);a.linkProgram(this.program),this.numAttributes=a.getProgramParameter(this.program,a.ACTIVE_ATTRIBUTES),this.attributes={};for(var d={},v=0;v<this.numAttributes;v++){var g=a.getActiveAttrib(this.program,v);g&&(this.attributes[g.name]=a.getAttribLocation(this.program,g.name))}for(var m=a.getProgramParameter(this.program,a.ACTIVE_UNIFORMS),y=0;y<m;y++){var _=a.getActiveUniform(this.program,y);_&&(d[_.name]=a.getUniformLocation(this.program,_.name))}this.fixedUniforms=i(e,d),this.binderUniforms=r.getUniforms(e,d)};function nn(e,n,r){var i=1/we(r,1,n.transform.tileZoom),o=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,n.transform.tileZoom)/o,s=a*(r.tileID.canonical.x+r.tileID.wrap*o),u=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[t.browser.devicePixelRatio,i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,u>>16],u_pixel_coord_lower:[65535&s,65535&u]}}en.prototype.draw=function(t,e,n,r,i,o,a,s,u,c,l,f,h,p,d,v){var g,m=t.gl;for(var y in t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(r),t.setColorMode(i),t.setCullFace(o),this.fixedUniforms)this.fixedUniforms[y].set(a[y]);p&&p.setUniforms(t,this.binderUniforms,f,{zoom:h});for(var _=(g={},g[m.LINES]=2,g[m.TRIANGLES]=3,g[m.LINE_STRIP]=1,g)[e],b=0,x=l.get();b<x.length;b+=1){var w=x[b],E=w.vaos||(w.vaos={});(E[s]||(E[s]=new tn)).bind(t,this,u,p?p.getPaintVertexBuffers():[],c,w.vertexOffset,d,v),m.drawElements(e,w.primitiveLength*_,m.UNSIGNED_SHORT,w.primitiveOffset*_*2)}};var rn=function(e,n,r){var i=n.style.light,o=i.properties.get("position"),a=[o.x,o.y,o.z],s=t.create$2();"viewport"===i.properties.get("anchor")&&t.fromRotation(s,-n.transform.angle),t.transformMat3(a,a,s);var u=i.properties.get("color");return{u_matrix:e,u_lightpos:a,u_lightintensity:i.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r}},on=function(e,n,r,i,o,a){return t.extend(rn(e,n,r),nn(o,n,a),{u_height_factor:-Math.pow(2,i.overscaledZ)/a.tileSize/8})},an=function(e,n,r){var i=t.create();t.ortho(i,0,e.width,e.height,0,0,1);var o=e.context.gl;return{u_matrix:i,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:r,u_opacity:n}},sn=function(t){return{u_matrix:t}},un=function(e,n,r,i){return t.extend(sn(e),nn(r,n,i))},cn=function(t,e){return{u_matrix:t,u_world:e}},ln=function(e,n,r,i,o){return t.extend(un(e,n,r,i),{u_world:o})},fn=function(t,e,n,r){var i,o,a=t.transform;if("map"===r.paint.get("circle-pitch-alignment")){var s=we(n,1,a.zoom);i=!0,o=[s,s]}else i=!1,o=a.pixelsToGLUnits;return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+i,u_extrude_scale:o}},hn=function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,n.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,n.u_overscale_factor)}},pn=function(t,e,n){var r=we(n,1,e.zoom),i=Math.pow(2,e.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*i),e.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},dn=function(t,e){return{u_matrix:t,u_color:e}},vn=function(t){return{u_matrix:t}},gn=function(t,e,n,r){return{u_matrix:t,u_extrude_scale:we(e,1,n),u_intensity:r}},mn=function(e,n,r){var i=r.paint.get("hillshade-shadow-color"),o=r.paint.get("hillshade-highlight-color"),a=r.paint.get("hillshade-accent-color"),s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle),{u_matrix:e.transform.calculatePosMatrix(n.tileID.toUnwrapped(),!0),u_image:0,u_latrange:function(e,n){var r=n.toCoordinate(),i=new t.Coordinate(r.column,r.row+1,r.zoom);return[e.transform.coordinateLocation(r).lat,e.transform.coordinateLocation(i).lat]}(e,n.tileID),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}},yn=function(e,n){var r=e.dem.dim,i=t.create();return t.ortho(i,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(i,i,[0,-t.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[2*r,2*r],u_zoom:e.tileID.overscaledZ,u_maxzoom:n}},_n=function(t,e,n){var r=t.transform;return{u_matrix:Sn(t,e,n),u_ratio:1/we(e,1,r.zoom),u_gl_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},bn=function(e,n,r){return t.extend(_n(e,n,r),{u_image:0})},xn=function(e,n,r,i){var o=e.transform,a=En(n,o);return{u_matrix:Sn(e,n,r),u_texsize:n.imageAtlasTexture.size,u_ratio:1/we(n,1,o.zoom),u_image:0,u_scale:[t.browser.devicePixelRatio,a,i.fromScale,i.toScale],u_fade:i.t,u_gl_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},wn=function(e,n,r,i,o){var a=e.transform,s=e.lineAtlas,u=En(n,a),c="round"===r.layout.get("line-cap"),l=s.getDash(i.from,c),f=s.getDash(i.to,c),h=l.width*o.fromScale,p=f.width*o.toScale;return t.extend(_n(e,n,r),{u_patternscale_a:[u/h,-l.height/2],u_patternscale_b:[u/p,-f.height/2],u_sdfgamma:s.width/(256*Math.min(h,p)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:l.y,u_tex_y_b:f.y,u_mix:o.t})};function En(t,e){return 1/we(t,1,e.tileZoom)}function Sn(t,e,n){return t.translatePosMatrix(e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Pn=function(t,e,n,r,i){return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:function(t){t*=Math.PI/180;var e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}(i.paint.get("raster-hue-rotate"))};var o,a},Tn=function(t,e,n,r,i,o,a,s,u,c){var l=i.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:l.cameraToCenterDistance,u_pitch:l.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:l.width/l.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_gl_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},An=function(e,n,r,i,o,a,s,u,c,l,f){var h=o.transform;return t.extend(Tn(e,n,r,i,o,a,s,u,c,l),{u_gamma_scale:i?Math.cos(h._pitch)*h.cameraToCenterDistance:1,u_is_halo:+f})},kn=function(t,e,n){return{u_matrix:t,u_opacity:e,u_color:n}},Cn=function(e,n,r,i,o,a){return t.extend(function(t,e,n,r){var i=n.imageManager.getPattern(t.from),o=n.imageManager.getPattern(t.to),a=n.imageManager.getPixelSize(),s=a.width,u=a.height,c=Math.pow(2,r.tileID.overscaledZ),l=r.tileSize*Math.pow(2,n.transform.tileZoom)/c,f=l*(r.tileID.canonical.x+r.tileID.wrap*c),h=l*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,u],u_mix:e.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/we(r,1,n.transform.tileZoom),u_pixel_coord_upper:[f>>16,h>>16],u_pixel_coord_lower:[65535&f,65535&h]}}(i,a,r,o),{u_matrix:e,u_opacity:n})},On={fillExtrusion:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient)}},fillExtrusionPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_lightpos:new t.Uniform3f(e,n.u_lightpos),u_lightintensity:new t.Uniform1f(e,n.u_lightintensity),u_lightcolor:new t.Uniform3f(e,n.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,n.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,n.u_height_factor),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},extrusionTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_opacity:new t.Uniform1f(e,n.u_opacity)}},fill:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},fillPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},fillOutline:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world)}},fillOutlinePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_texsize:new t.Uniform2f(e,n.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},circle:function(e,n){return{u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,n.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,n.u_extrude_scale),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},collisionBox:hn,collisionCircle:hn,debug:function(e,n){return{u_color:new t.UniformColor(e,n.u_color),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},clippingMask:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmap:function(e,n){return{u_extrude_scale:new t.Uniform1f(e,n.u_extrude_scale),u_intensity:new t.Uniform1f(e,n.u_intensity),u_matrix:new t.UniformMatrix4f(e,n.u_matrix)}},heatmapTexture:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_world:new t.Uniform2f(e,n.u_world),u_image:new t.Uniform1i(e,n.u_image),u_color_ramp:new t.Uniform1i(e,n.u_color_ramp),u_opacity:new t.Uniform1f(e,n.u_opacity)}},hillshade:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_latrange:new t.Uniform2f(e,n.u_latrange),u_light:new t.Uniform2f(e,n.u_light),u_shadow:new t.UniformColor(e,n.u_shadow),u_highlight:new t.UniformColor(e,n.u_highlight),u_accent:new t.UniformColor(e,n.u_accent)}},hillshadePrepare:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_image:new t.Uniform1i(e,n.u_image),u_dimension:new t.Uniform2f(e,n.u_dimension),u_zoom:new t.Uniform1f(e,n.u_zoom),u_maxzoom:new t.Uniform1f(e,n.u_maxzoom)}},line:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels)}},lineGradient:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels),u_image:new t.Uniform1i(e,n.u_image)}},linePattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_texsize:new t.Uniform2f(e,n.u_texsize),u_ratio:new t.Uniform1f(e,n.u_ratio),u_image:new t.Uniform1i(e,n.u_image),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels),u_scale:new t.Uniform4f(e,n.u_scale),u_fade:new t.Uniform1f(e,n.u_fade)}},lineSDF:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_ratio:new t.Uniform1f(e,n.u_ratio),u_gl_units_to_pixels:new t.Uniform2f(e,n.u_gl_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,n.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,n.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,n.u_sdfgamma),u_image:new t.Uniform1i(e,n.u_image),u_tex_y_a:new t.Uniform1f(e,n.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,n.u_tex_y_b),u_mix:new t.Uniform1f(e,n.u_mix)}},raster:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_tl_parent:new t.Uniform2f(e,n.u_tl_parent),u_scale_parent:new t.Uniform1f(e,n.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,n.u_buffer_scale),u_fade_t:new t.Uniform1f(e,n.u_fade_t),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image0:new t.Uniform1i(e,n.u_image0),u_image1:new t.Uniform1i(e,n.u_image1),u_brightness_low:new t.Uniform1f(e,n.u_brightness_low),u_brightness_high:new t.Uniform1f(e,n.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,n.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,n.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,n.u_spin_weights)}},symbolIcon:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_gl_coord_matrix:new t.UniformMatrix4f(e,n.u_gl_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture)}},symbolSDF:function(e,n){return{u_is_size_zoom_constant:new t.Uniform1i(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,n.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,n.u_size_t),u_size:new t.Uniform1f(e,n.u_size),u_camera_to_center_distance:new t.Uniform1f(e,n.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,n.u_pitch),u_rotate_symbol:new t.Uniform1i(e,n.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,n.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,n.u_fade_change),u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,n.u_label_plane_matrix),u_gl_coord_matrix:new t.UniformMatrix4f(e,n.u_gl_coord_matrix),u_is_text:new t.Uniform1f(e,n.u_is_text),u_pitch_with_map:new t.Uniform1i(e,n.u_pitch_with_map),u_texsize:new t.Uniform2f(e,n.u_texsize),u_texture:new t.Uniform1i(e,n.u_texture),u_gamma_scale:new t.Uniform1f(e,n.u_gamma_scale),u_is_halo:new t.Uniform1f(e,n.u_is_halo)}},background:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_color:new t.UniformColor(e,n.u_color)}},backgroundPattern:function(e,n){return{u_matrix:new t.UniformMatrix4f(e,n.u_matrix),u_opacity:new t.Uniform1f(e,n.u_opacity),u_image:new t.Uniform1i(e,n.u_image),u_pattern_tl_a:new t.Uniform2f(e,n.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,n.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,n.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,n.u_pattern_br_b),u_texsize:new t.Uniform2f(e,n.u_texsize),u_mix:new t.Uniform1f(e,n.u_mix),u_pattern_size_a:new t.Uniform2f(e,n.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,n.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,n.u_scale_a),u_scale_b:new t.Uniform1f(e,n.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,n.u_tile_units_to_pixels)}}};function Mn(e,n){for(var r=e.sort(function(t,e){return t.tileID.isLessThan(e.tileID)?-1:e.tileID.isLessThan(t.tileID)?1:0}),i=0;i<r.length;i++){var o={},a=r[i],s=r.slice(i+1);In(a.tileID.wrapped(),a.tileID,s,new t.OverscaledTileID(0,a.tileID.wrap+1,0,0,0),o),a.setMask(o,n)}}function In(e,n,r,i,o){for(var a=0;a<r.length;a++){var s=r[a];if(i.isLessThan(s.tileID))break;if(n.key===s.tileID.key)return;if(s.tileID.isChildOf(n)){for(var u=n.children(1/0),c=0;c<u.length;c++)In(e,u[c],r.slice(a),i,o);return}}var l=n.overscaledZ-e.overscaledZ,f=new t.CanonicalTileID(l,n.canonical.x-(e.canonical.x<<l),n.canonical.y-(e.canonical.y<<l));o[f.key]=o[f.key]||f}function Ln(t,e,n,r,i){for(var o=t.context,a=o.gl,s=i?t.useProgram("collisionCircle"):t.useProgram("collisionBox"),u=0;u<r.length;u++){var c=r[u],l=e.getTile(c),f=l.getBucket(n);if(f){var h=i?f.collisionCircle:f.collisionBox;h&&s.draw(o,i?a.TRIANGLES:a.LINES,Dt.disabled,Ft.disabled,t.colorModeForRenderPass(),Bt.disabled,pn(c.posMatrix,t.transform,l),n.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,t.transform.zoom,null,null,h.collisionVertexBuffer)}}}var Rn=t.identity(new Float32Array(16)),jn=t.properties.layout;function zn(e,n,r,i,o,a,s,u,c,l,f,h){for(var p,d,v=e.context,g=v.gl,m=e.transform,y="map"===u,_="map"===c,b=y&&"point"!==r.layout.get("symbol-placement"),x=y&&!_&&!b,w=_?e.depthModeForSublayer(0,Dt.ReadOnly):Dt.disabled,E=0,S=i;E<S.length;E+=1){var P=S[E],T=n.getTile(P),A=T.getBucket(r);if(A){var k=o?A.text:A.icon;if(k&&k.segments.get().length){var C=k.programConfigurations.get(r.id),O=o||A.sdfIcons,M=o?A.textSizeData:A.iconSizeData;p||(p=e.useProgram(O?"symbolSDF":"symbolIcon",C),d=t.evaluateSizeForZoom(M,m.zoom,jn.properties[o?"text-size":"icon-size"])),v.activeTexture.set(g.TEXTURE0);var I=void 0;if(o)T.glyphAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),I=T.glyphAtlasTexture.size;else{var L=1!==r.layout.get("icon-size").constantOr(0)||A.iconsNeedLinear,R=_||0!==m.pitch;T.imageAtlasTexture.bind(O||e.options.rotating||e.options.zooming||L||R?g.LINEAR:g.NEAREST,g.CLAMP_TO_EDGE),I=T.imageAtlasTexture.size}var j=we(T,1,e.transform.zoom),z=se(P.posMatrix,_,y,e.transform,j),D=ue(P.posMatrix,_,y,e.transform,j);b&&fe(A,P.posMatrix,e,o,z,D,_,l);var F=e.translatePosMatrix(P.posMatrix,T,a,s),N=b?Rn:z,B=e.translatePosMatrix(D,T,a,s,!0),U=void 0;if(O){var V=0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);U=An(M.functionType,d,x,_,e,F,N,B,o,I,!0),V&&Dn(k,r,e,p,w,f,h,U),U.u_is_halo=0}else U=Tn(M.functionType,d,x,_,e,F,N,B,o,I);Dn(k,r,e,p,w,f,h,U)}}}}function Dn(t,e,n,r,i,o,a,s){var u=n.context,c=u.gl;r.draw(u,c.TRIANGLES,i,o,a,Bt.disabled,s,e.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,e.paint,n.transform.zoom,t.programConfigurations.get(e.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Fn(t,e,n,r,i,o,a){var s,u,c,l,f,h=t.context.gl,p=n.paint.get("fill-pattern"),d=p&&p.constantOr(1),v=n.getCrossfadeParameters();a?(u=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=h.LINES):(u=d?"fillPattern":"fill",s=h.TRIANGLES);for(var g=0,m=r;g<m.length;g+=1){var y=m[g],_=e.getTile(y);if(!d||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=t.useProgram(u,x);d&&(t.context.activeTexture.set(h.TEXTURE0),_.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),x.updatePatternPaintBuffers(v));var E=p.constantOr(null);if(E&&_.imageAtlas){var S=_.imageAtlas.patternPositions[E.to],P=_.imageAtlas.patternPositions[E.from];S&&P&&x.setConstantPatternPositions(S,P)}var T=t.translatePosMatrix(y.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){l=b.indexBuffer2,f=b.segments2;var A=[h.drawingBufferWidth,h.drawingBufferHeight];c="fillOutlinePattern"===u&&d?ln(T,t,v,_,A):cn(T,A)}else l=b.indexBuffer,f=b.segments,c=d?un(T,t,v,_):sn(T);w.draw(t.context,s,i,t.stencilModeForClipping(y),o,Bt.disabled,c,n.id,b.layoutVertexBuffer,l,f,n.paint,t.transform.zoom,x)}}}}function Nn(e,n){var r=e.context,i=r.gl,o=n.viewportFrame;if(e.depthRboNeedsClear&&e.setupOffscreenDepthRenderbuffer(),!o){var a=new t.Texture(r,{width:e.width,height:e.height,data:null},i.RGBA);a.bind(i.LINEAR,i.CLAMP_TO_EDGE),(o=n.viewportFrame=r.createFramebuffer(e.width,e.height)).colorAttachment.set(a.texture)}r.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(e.depthRbo),e.depthRboNeedsClear&&(r.clear({depth:1}),e.depthRboNeedsClear=!1),r.clear({color:t.Color.transparent}),r.setStencilMode(Ft.disabled),r.setDepthMode(new Dt(i.LEQUAL,Dt.ReadWrite,[0,1])),r.setColorMode(e.colorModeForRenderPass())}function Bn(t,e,n){var r=e.viewportFrame;if(r){var i=t.context,o=i.gl;i.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),t.useProgram("extrusionTexture").draw(i,o.TRIANGLES,Dt.disabled,Ft.disabled,t.colorModeForRenderPass(),Bt.disabled,an(t,n,0),e.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,e.paint,t.transform.zoom)}}function Un(t,e,n,r,i,o){var a=t.context,s=a.gl,u=e.fbo;if(u){var c=t.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u.colorAttachment.get());var l=mn(t,e,n);e.maskedBoundsBuffer&&e.maskedIndexBuffer&&e.segments?c.draw(a,s.TRIANGLES,r,i,o,Bt.disabled,l,n.id,e.maskedBoundsBuffer,e.maskedIndexBuffer,e.segments):c.draw(a,s.TRIANGLES,r,i,o,Bt.disabled,l,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function Vn(e,n,r,i,o,a,s){var u=e.context,c=u.gl;if(n.dem&&n.dem.data){var l=n.dem.dim,f=n.dem.getPixels();if(u.activeTexture.set(c.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(n.tileSize),n.demTexture){var h=n.demTexture;h.update(f,{premultiply:!1}),h.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new t.Texture(u,f,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);u.activeTexture.set(c.TEXTURE0);var p=n.fbo;if(!p){var d=new t.Texture(u,{width:l,height:l,data:null},c.RGBA);d.bind(c.LINEAR,c.CLAMP_TO_EDGE),(p=n.fbo=u.createFramebuffer(l,l)).colorAttachment.set(d.texture)}u.bindFramebuffer.set(p.framebuffer),u.viewport.set([0,0,l,l]),e.useProgram("hillshadePrepare").draw(u,c.TRIANGLES,o,a,s,Bt.disabled,yn(n,i),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Gn(e,n,r,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=t.browser.now(),u=(s-e.timeAdded)/a,c=n?(s-n.timeAdded)/a:-1,l=r.getSource(),f=o.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-f)>Math.abs(e.tileID.overscaledZ-f),p=h&&e.refreshedUponExpiration?1:t.clamp(h?u:1-c,0,1);return e.refreshedUponExpiration&&u>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}function qn(e,n,r){var i=e.context,o=i.gl,a=r.posMatrix,s=e.useProgram("debug"),u=Dt.disabled,c=Ft.disabled,l=e.colorModeForRenderPass(),f="$debug";s.draw(i,o.LINE_STRIP,u,c,l,Bt.disabled,dn(a,t.Color.red),f,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);for(var h=function(t,e,n,r){r=r||1;var i,o,a,s,u,c,l,f,h=[];for(i=0,o=t.length;i<o;i++)if(u=Wn[t[i]]){for(f=null,a=0,s=u[1].length;a<s;a+=2)-1===u[1][a]&&-1===u[1][a+1]?f=null:(c=e+u[1][a]*r,l=200-u[1][a+1]*r,f&&h.push(f.x,f.y,c,l),f={x:c,y:l});e+=u[0]*r}return h}(r.toString(),50,0,5),p=new t.StructArrayLayout2i4,d=new t.StructArrayLayout2ui4,v=0;v<h.length;v+=2)p.emplaceBack(h[v],h[v+1]),d.emplaceBack(v,v+1);for(var g=i.createVertexBuffer(p,He.members),m=i.createIndexBuffer(d),y=t.SegmentVector.simpleSegment(0,0,p.length/2,p.length/2),_=n.getTile(r).tileSize,b=t.EXTENT/(Math.pow(2,e.transform.zoom-r.overscaledZ)*_),x=[[-1,-1],[-1,1],[1,-1],[1,1]],w=0;w<x.length;w++){var E=x[w];s.draw(i,o.LINES,u,c,l,Bt.disabled,dn(t.translate([],a,[b*E[0],b*E[1],0]),t.Color.white),f,g,m,y)}s.draw(i,o.LINES,u,c,l,Bt.disabled,dn(a,t.Color.black),f,g,m,y)}var Wn={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},Zn={symbol:function(t,e,n,r){if("translucent"===t.renderPass){var i=Ft.disabled,o=t.colorModeForRenderPass();0!==n.paint.get("icon-opacity").constantOr(1)&&zn(t,e,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),i,o),0!==n.paint.get("text-opacity").constantOr(1)&&zn(t,e,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),i,o),e.map.showCollisionBoxes&&function(t,e,n,r){Ln(t,e,n,r,!1),Ln(t,e,n,r,!0)}(t,e,n,r)}},circle:function(t,e,n,r){if("translucent"===t.renderPass){var i=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),a=n.paint.get("circle-stroke-opacity");if(0!==i.constantOr(1)||0!==o.constantOr(1)&&0!==a.constantOr(1))for(var s=t.context,u=s.gl,c=t.depthModeForSublayer(0,Dt.ReadOnly),l=Ft.disabled,f=t.colorModeForRenderPass(),h=0;h<r.length;h++){var p=r[h],d=e.getTile(p),v=d.getBucket(n);if(v){var g=v.programConfigurations.get(n.id);t.useProgram("circle",g).draw(s,u.TRIANGLES,c,l,f,Bt.disabled,fn(t,p,d,n),n.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,n.paint,t.transform.zoom,g)}}}},heatmap:function(e,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var o=e.context,a=o.gl,s=e.depthModeForSublayer(0,Dt.ReadOnly),u=Ft.disabled,c=new Nt([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,n){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),t.bindFramebuffer.set(i.framebuffer);else{var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),function t(e,n,r,i){var o=e.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n.width/4,n.height/4,0,o.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(r),e.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(e.extTextureHalfFloat=null,i.colorAttachment.setDirty(),t(e,n,r,i))}(t,e,o,i=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4))}}(o,e,r),o.clear({color:t.Color.transparent});for(var l=0;l<i.length;l++){var f=i[l];if(!n.hasRenderableParent(f)){var h=n.getTile(f),p=h.getBucket(r);if(p){var d=p.programConfigurations.get(r.id),v=e.useProgram("heatmap",d),g=e.transform.zoom;v.draw(o,a.TRIANGLES,s,u,c,Bt.disabled,gn(f.posMatrix,h,g,r.paint.get("heatmap-intensity")),r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,d)}}}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){var r=e.context,i=r.gl,o=n.heatmapFbo;if(o){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new t.Texture(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Dt.disabled,Ft.disabled,e.colorModeForRenderPass(),Bt.disabled,function(e,n,r,i){var o=t.create();t.ortho(o,0,e.width,e.height,0,0,1);var a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:n.paint.get("heatmap-opacity")}}(e,n,0,1),n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}}(e,r))},line:function(e,n,r,i){if("translucent"===e.renderPass){var o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=e.depthModeForSublayer(0,Dt.ReadOnly),u=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),l=r.paint.get("line-pattern"),f=l.constantOr(1),h=r.paint.get("line-gradient"),p=r.getCrossfadeParameters(),d=c?"lineSDF":f?"linePattern":h?"lineGradient":"line",v=e.context,g=v.gl,m=!0;if(h){v.activeTexture.set(g.TEXTURE0);var y=r.gradientTexture;if(!r.gradient)return;y||(y=r.gradientTexture=new t.Texture(v,r.gradient,g.RGBA)),y.bind(g.LINEAR,g.CLAMP_TO_EDGE)}for(var _=0,b=i;_<b.length;_+=1){var x=b[_],w=n.getTile(x);if(!f||w.patternsLoaded()){var E=w.getBucket(r);if(E){var S=E.programConfigurations.get(r.id),P=e.context.program.get(),T=e.useProgram(d,S),A=m||T.program!==P,k=l.constantOr(null);if(k&&w.imageAtlas){var C=w.imageAtlas.patternPositions[k.to],O=w.imageAtlas.patternPositions[k.from];C&&O&&S.setConstantPatternPositions(C,O)}var M=c?wn(e,w,r,c,p):f?xn(e,w,r,p):h?bn(e,w,r):_n(e,w,r);c&&(A||e.lineAtlas.dirty)?(v.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(v)):f&&(v.activeTexture.set(g.TEXTURE0),w.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),S.updatePatternPaintBuffers(p)),T.draw(v,g.TRIANGLES,s,e.stencilModeForClipping(x),u,Bt.disabled,M,r.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,r.paint,e.transform.zoom,S),m=!1}}}}}},fill:function(e,n,r,i){var o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=e.colorModeForRenderPass(),u=r.paint.get("fill-pattern").constantOr(1)||1!==o.constantOr(t.Color.transparent).a||1!==a.constantOr(0)?"translucent":"opaque";e.renderPass===u&&Fn(e,n,r,i,e.depthModeForSublayer(1,"opaque"===e.renderPass?Dt.ReadWrite:Dt.ReadOnly),s,!1),"translucent"===e.renderPass&&r.paint.get("fill-antialias")&&Fn(e,n,r,i,e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Dt.ReadOnly),s,!0)}},"fill-extrusion":function(t,e,n,r){0!==n.paint.get("fill-extrusion-opacity")&&("offscreen"===t.renderPass?(Nn(t,n),function(t,e,n,r,i,o,a){for(var s=t.context,u=s.gl,c=n.paint.get("fill-extrusion-pattern"),l=c.constantOr(1),f=n.getCrossfadeParameters(),h=0,p=r;h<p.length;h+=1){var d=p[h],v=e.getTile(d),g=v.getBucket(n);if(g){var m=g.programConfigurations.get(n.id),y=t.useProgram(l?"fillExtrusionPattern":"fillExtrusion",m);l&&(t.context.activeTexture.set(u.TEXTURE0),v.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),m.updatePatternPaintBuffers(f));var _=c.constantOr(null);if(_&&v.imageAtlas){var b=v.imageAtlas.patternPositions[_.to],x=v.imageAtlas.patternPositions[_.from];b&&x&&m.setConstantPatternPositions(b,x)}var w=t.translatePosMatrix(d.posMatrix,v,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),E=n.paint.get("fill-extrusion-vertical-gradient"),S=l?on(w,t,E,d,f,v):rn(w,t,E);y.draw(s,s.gl.TRIANGLES,i,o,a,Bt.backCCW,S,n.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,n.paint,t.transform.zoom,m)}}}(t,e,n,r,new Dt(t.context.gl.LEQUAL,Dt.ReadWrite,[0,1]),Ft.disabled,t.colorModeForRenderPass())):"translucent"===t.renderPass&&Bn(t,n,n.paint.get("fill-extrusion-opacity")))},hillshade:function(t,e,n,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var i=t.context,o=e.getSource().maxzoom,a=t.depthModeForSublayer(0,Dt.ReadOnly),s=Ft.disabled,u=t.colorModeForRenderPass(),c=0,l=r;c<l.length;c+=1){var f=l[c],h=e.getTile(f);h.needsHillshadePrepare&&"offscreen"===t.renderPass?Vn(t,h,n,o,a,s,u):"translucent"===t.renderPass&&Un(t,h,n,a,s,u)}i.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,n,r){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity"))for(var i=t.context,o=i.gl,a=e.getSource(),s=t.useProgram("raster"),u=Ft.disabled,c=t.colorModeForRenderPass(),l=r.length&&r[0].overscaledZ,f=0,h=r;f<h.length;f+=1){var p=h[f],d=t.depthModeForSublayer(p.overscaledZ-l,1===n.paint.get("raster-opacity")?Dt.ReadWrite:Dt.ReadOnly,o.LESS),v=e.getTile(p),g=t.transform.calculatePosMatrix(p.toUnwrapped(),!0);v.registerFadeDuration(n.paint.get("raster-fade-duration"));var m=e.findLoadedParent(p,0),y=Gn(v,m,e,n,t.transform),_=void 0,b=void 0,x="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),v.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),m?(m.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),_=Math.pow(2,m.tileID.overscaledZ-v.tileID.overscaledZ),b=[v.tileID.canonical.x*_%1,v.tileID.canonical.y*_%1]):v.texture.bind(x,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var w=Pn(g,b||[0,0],_||1,y,n);a instanceof W?s.draw(i,o.TRIANGLES,d,u,c,Bt.disabled,w,n.id,a.boundsBuffer,t.quadTriangleIndexBuffer,a.boundsSegments):v.maskedBoundsBuffer&&v.maskedIndexBuffer&&v.segments?s.draw(i,o.TRIANGLES,d,u,c,Bt.disabled,w,n.id,v.maskedBoundsBuffer,v.maskedIndexBuffer,v.segments,n.paint,t.transform.zoom):s.draw(i,o.TRIANGLES,d,u,c,Bt.disabled,w,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,n){var r=n.paint.get("background-color"),i=n.paint.get("background-opacity");if(0!==i){var o=t.context,a=o.gl,s=t.transform,u=s.tileSize,c=n.paint.get("background-pattern");if(!t.isPatternMissing(c)){var l=c||1!==r.a||1!==i?"translucent":"opaque";if(t.renderPass===l){var f=Ft.disabled,h=t.depthModeForSublayer(0,"opaque"===l?Dt.ReadWrite:Dt.ReadOnly),p=t.colorModeForRenderPass(),d=t.useProgram(c?"backgroundPattern":"background"),v=s.coveringTiles({tileSize:u});c&&(o.activeTexture.set(a.TEXTURE0),t.imageManager.bind(t.context));for(var g=n.getCrossfadeParameters(),m=0,y=v;m<y.length;m+=1){var _=y[m],b=t.transform.calculatePosMatrix(_.toUnwrapped()),x=c?Cn(b,i,t,c,{tileID:_,tileSize:u},g):kn(b,i,r);d.draw(o,a.TRIANGLES,h,f,p,Bt.disabled,x,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,n){for(var r=0;r<n.length;r++)qn(t,e,n[r])},custom:function(t,e,n){var r=t.context,i=n.implementation;if("offscreen"===t.renderPass){var o=i.prerender;o&&(t.setCustomLayerDefaults(),o.call(i,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState()),"3d"===i.renderingMode&&(t.setCustomLayerDefaults(),Nn(t,n),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else"translucent"===t.renderPass&&("3d"===i.renderingMode?Bn(t,n,1):(t.setCustomLayerDefaults(),r.setStencilMode(Ft.disabled),r.setDepthMode(Dt.disabled),i.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)))}},Xn=function(e,n){this.context=new Ut(e),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Vt.maxUnderzooming+Vt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new t.ProgramConfiguration,this.crossTileSymbolIndex=new Ge};function Hn(t,e){if(t.row>e.row){var n=t;t=e,e=n}return{x0:t.column,y0:t.row,x1:e.column,y1:e.row,dx:e.column-t.column,dy:e.row-t.row}}function Yn(t,e,n,r,i){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(r,Math.ceil(e.y1));if(t.x0===e.x0&&t.y0===e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,c=e.dx/e.dy,l=t.dx>0,f=e.dx<0,h=o;h<a;h++){var p=u*Math.max(0,Math.min(t.dy,h+l-t.y0))+t.x0,d=c*Math.max(0,Math.min(e.dy,h+f-e.y0))+e.x0;i(Math.floor(d),Math.ceil(p),h)}}function Kn(t,e,n,r,i,o){var a,s=Hn(t,e),u=Hn(e,n),c=Hn(n,t);s.dy>u.dy&&(a=s,s=u,u=a),s.dy>c.dy&&(a=s,s=c,c=a),u.dy>c.dy&&(a=u,u=c,c=a),s.dy&&Yn(c,s,r,i,o),u.dy&&Yn(c,u,r,i,o)}Xn.prototype.resize=function(e,n){var r=this.context.gl;if(this.width=e*t.browser.devicePixelRatio,this.height=n*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,o=this.style._order;i<o.length;i+=1){var a=o[i];this.style._layers[a].resize()}this.depthRbo&&(r.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Xn.prototype.setup=function(){var e=this.context,n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(n,He.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,He.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var i=new t.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(t.EXTENT,0,t.EXTENT,0),i.emplaceBack(0,t.EXTENT,0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(i,t.rasterBoundsAttributes.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,He.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);var u=this.context.gl;this.stencilClearMode=new Ft({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)},Xn.prototype.clearStencil=function(){var e=this.context,n=e.gl,r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Dt.disabled,this.stencilClearMode,Nt.disabled,Bt.disabled,vn(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Xn.prototype._renderTileClippingMasks=function(t){var e=this.context,n=e.gl;e.setColorMode(Nt.disabled),e.setDepthMode(Dt.disabled);var r=this.useProgram("clippingMask"),i=1;this._tileClippingMaskIDs={};for(var o=0,a=t;o<a.length;o+=1){var s=a[o],u=this._tileClippingMaskIDs[s.key]=i++;r.draw(e,n.TRIANGLES,Dt.disabled,new Ft({func:n.ALWAYS,mask:0},u,255,n.KEEP,n.KEEP,n.REPLACE),Nt.disabled,Bt.disabled,vn(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}},Xn.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Ft({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},Xn.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new Nt([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Nt.unblended:Nt.alphaBlended},Xn.prototype.depthModeForSublayer=function(t,e,n){var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon,i=r-1+this.depthRange;return new Dt(n||this.context.gl.LEQUAL,e,[i,r])},Xn.prototype.render=function(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now());var r=this.style._order,i=this.style.sourceCaches;for(var o in i){var a=i[o];a.used&&a.prepare(this.context)}var s,u={},c={},l={};for(var f in i){var h=i[f];u[f]=h.getVisibleCoordinates(),c[f]=u[f].slice().reverse(),l[f]=h.getVisibleCoordinates(!0).reverse()}for(var p in i){var d=i[p],v=d.getSource();if("raster"===v.type||"raster-dem"===v.type){for(var g=[],m=0,y=u[p];m<y.length;m+=1){var _=y[m];g.push(d.getTile(_))}Mn(g,this.context)}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var b=0,x=r;b<x.length;b+=1){var w=x[b],E=this.style._layers[w];if(E.hasOffscreenPass()&&!E.isHidden(this.transform.zoom)){var S=c[E.source];("custom"===E.type||S.length)&&this.renderLayer(this,i[E.source],E,S)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRange=(e._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){var P=this.style._layers[r[this.currentLayer]],T=i[P.source],A=u[P.source];P.source!==s&&T&&(this.clearStencil(),T.getSource().isTileClipped&&this._renderTileClippingMasks(A)),this.renderLayer(this,T,P,A),s=P.source}for(this.renderPass="translucent",this.currentLayer=0,s=null;this.currentLayer<r.length;this.currentLayer++){var k=this.style._layers[r[this.currentLayer]],C=i[k.source],O=("symbol"===k.type?l:c)[k.source];k.source!==s&&C&&(this.clearStencil(),C.getSource().isTileClipped&&this._renderTileClippingMasks(u[k.source])),this.renderLayer(this,C,k,O),s=k.source}if(this.options.showTileBoundaries)for(var M in i){Zn.debug(this,i[M],u[M]);break}this.setCustomLayerDefaults()},Xn.prototype.setupOffscreenDepthRenderbuffer=function(){var t=this.context;this.depthRbo||(this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height))},Xn.prototype.renderLayer=function(t,e,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||r.length)&&(this.id=n.id,Zn[n.type](t,e,n,r))},Xn.prototype.translatePosMatrix=function(e,n,r,i,o){if(!r[0]&&!r[1])return e;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),u=Math.cos(a);r=[r[0]*u-r[1]*s,r[0]*s+r[1]*u]}var c=[o?r[0]:we(n,r[0],this.transform.zoom),o?r[1]:we(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,c),l},Xn.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},Xn.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},Xn.prototype.isPatternMissing=function(t){if(!t)return!1;var e=this.imageManager.getPattern(t.from),n=this.imageManager.getPattern(t.to);return!e||!n},Xn.prototype.useProgram=function(t,e){void 0===e&&(e=this.emptyProgramConfiguration),this.cache=this.cache||{};var n=""+t+(e.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new en(this.context,$e[t],e,On[t],this._showOverdrawInspector)),this.cache[n]},Xn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Xn.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)};var Jn=function(t,e,n){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===n||n,this._minZoom=t||0,this._maxZoom=e||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new F(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},Qn={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};Jn.prototype.clone=function(){var t=new Jn(this._minZoom,this._maxZoom,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._calcMatrices(),t},Qn.minZoom.get=function(){return this._minZoom},Qn.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Qn.maxZoom.get=function(){return this._maxZoom},Qn.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Qn.renderWorldCopies.get=function(){return this._renderWorldCopies},Qn.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Qn.worldSize.get=function(){return this.tileSize*this.scale},Qn.centerPoint.get=function(){return this.size._div(2)},Qn.size.get=function(){return new t.Point(this.width,this.height)},Qn.bearing.get=function(){return-this.angle/Math.PI*180},Qn.bearing.set=function(e){var n=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=t.create$4(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Qn.pitch.get=function(){return this._pitch/Math.PI*180},Qn.pitch.set=function(e){var n=t.clamp(e,0,60)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},Qn.fov.get=function(){return this._fov/Math.PI*180},Qn.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Qn.zoom.get=function(){return this._zoom},Qn.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Qn.center.get=function(){return this._center},Qn.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Jn.prototype.coveringZoomLevel=function(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))},Jn.prototype.getVisibleUnwrappedCoordinates=function(e){var n=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.Point(0,0),0),i=this.pointCoordinate(new t.Point(this.width,0),0),o=this.pointCoordinate(new t.Point(this.width,this.height),0),a=this.pointCoordinate(new t.Point(0,this.height),0),s=Math.floor(Math.min(r.column,i.column,o.column,a.column)),u=Math.floor(Math.max(r.column,i.column,o.column,a.column)),c=s-1;c<=u+1;c++)0!==c&&n.push(new t.UnwrappedTileID(c,e));return n},Jn.prototype.coveringTiles=function(e){var n=this.coveringZoomLevel(e),r=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);var i=this.pointCoordinate(this.centerPoint,n),o=new t.Point(i.column-.5,i.row-.5);return function(e,n,r,i){void 0===i&&(i=!0);var o=1<<e,a={};function s(n,s,u){var c,l,f,h;if(u>=0&&u<=o)for(c=n;c<s;c++)l=Math.floor(c/o),f=(c%o+o)%o,0!==l&&!0!==i||(h=new t.OverscaledTileID(r,l,e,f,u),a[h.key]=h)}return Kn(n[0],n[1],n[2],0,o,s),Kn(n[2],n[3],n[0],0,o,s),Object.keys(a).map(function(t){return a[t]})}(n,[this.pointCoordinate(new t.Point(0,0),n),this.pointCoordinate(new t.Point(this.width,0),n),this.pointCoordinate(new t.Point(this.width,this.height),n),this.pointCoordinate(new t.Point(0,this.height),n)],e.reparseOverscaled?r:n,this._renderWorldCopies).sort(function(t,e){return o.dist(t.canonical)-o.dist(e.canonical)})},Jn.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Qn.unmodified.get=function(){return this._unmodified},Jn.prototype.zoomScale=function(t){return Math.pow(2,t)},Jn.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Jn.prototype.project=function(e){return new t.Point(this.lngX(e.lng),this.latY(e.lat))},Jn.prototype.unproject=function(t){return new F(this.xLng(t.x),this.yLat(t.y))},Qn.x.get=function(){return this.lngX(this.center.lng)},Qn.y.get=function(){return this.latY(this.center.lat)},Qn.point.get=function(){return new t.Point(this.x,this.y)},Jn.prototype.lngX=function(t){return(180+t)*this.worldSize/360},Jn.prototype.latY=function(e){return e=t.clamp(e,-this.maxValidLatitude,this.maxValidLatitude),(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))*this.worldSize/360},Jn.prototype.xLng=function(t){return 360*t/this.worldSize-180},Jn.prototype.yLat=function(t){var e=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90},Jn.prototype.setLocationAtPoint=function(t,e){var n=this.pointCoordinate(e)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(t)._sub(n)),this._renderWorldCopies&&(this.center=this.center.wrap())},Jn.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Jn.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Jn.prototype.locationCoordinate=function(e){return new t.Coordinate(this.lngX(e.lng)/this.tileSize,this.latY(e.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},Jn.prototype.coordinateLocation=function(t){var e=t.zoomTo(this.zoom);return new F(this.xLng(e.column*this.tileSize),this.yLat(e.row*this.tileSize))},Jn.prototype.pointCoordinate=function(e,n){void 0===n&&(n=this.tileZoom);var r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(i,i,this.pixelMatrixInverse);var o=r[3],a=i[3],s=r[0]/o,u=i[0]/a,c=r[1]/o,l=i[1]/a,f=r[2]/o,h=i[2]/a,p=f===h?0:(0-f)/(h-f);return new t.Coordinate(t.number(s,u,p)/this.tileSize,t.number(c,l,p)/this.tileSize,this.zoom)._zoomTo(n)},Jn.prototype.coordinatePoint=function(e){var n=e.zoomTo(this.zoom),r=[n.column*this.tileSize,n.row*this.tileSize,0,1];return t.transformMat4(r,r,this.pixelMatrix),new t.Point(r[0]/r[3],r[1]/r[3])},Jn.prototype.getBounds=function(){return(new N).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Jn.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new N([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Jn.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Jn.prototype.calculatePosMatrix=function(e,n){void 0===n&&(n=!1);var r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var o=e.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*e.wrap,u=t.identity(new Float64Array(16));return t.translate(u,u,[s*a,o.y*a,0]),t.scale(u,u,[a/t.EXTENT,a/t.EXTENT,1]),t.multiply(u,n?this.alignedProjMatrix:this.projMatrix,u),i[r]=new Float32Array(u),i[r]},Jn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Jn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,n,r,i,o=-90,a=90,s=-180,u=180,c=this.size,l=this._unmodified;if(this.latRange){var f=this.latRange;o=this.latY(f[1]),e=(a=this.latY(f[0]))-o<c.y?c.y/(a-o):0}if(this.lngRange){var h=this.lngRange;s=this.lngX(h[0]),n=(u=this.lngX(h[1]))-s<c.x?c.x/(u-s):0}var p=Math.max(n||0,e||0);if(p)return this.center=this.unproject(new t.Point(n?(u+s)/2:this.x,e?(a+o)/2:this.y)),this.zoom+=this.scaleZoom(p),this._unmodified=l,void(this._constraining=!1);if(this.latRange){var d=this.y,v=c.y/2;d-v<o&&(i=o+v),d+v>a&&(i=a-v)}if(this.lngRange){var g=this.x,m=c.x/2;g-m<s&&(r=s+m),g+m>u&&(r=u-m)}void 0===r&&void 0===i||(this.center=this.unproject(new t.Point(void 0!==r?r:this.x,void 0!==i?i:this.y))),this._unmodified=l,this._constraining=!1}},Jn.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,n=Math.PI/2+this._pitch,r=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-n-e),i=this.x,o=this.y,a=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),s=new Float64Array(16);t.perspective(s,this._fov,this.width/this.height,1,a),t.scale(s,s,[1,-1,1]),t.translate(s,s,[0,0,-this.cameraToCenterDistance]),t.rotateX(s,s,this._pitch),t.rotateZ(s,s,this.angle),t.translate(s,s,[-i,-o,0]),this.mercatorMatrix=t.scale([],s,[this.worldSize,this.worldSize,this.worldSize]);var u=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));t.scale(s,s,[1,1,u,1]),this.projMatrix=s;var c=this.width%2/2,l=this.height%2/2,f=Math.cos(this.angle),h=Math.sin(this.angle),p=i-Math.round(i)+f*c+h*l,d=o-Math.round(o)+f*l+h*c,v=new Float64Array(s);if(t.translate(v,v,[p>.5?p-1:p,d>.5?d-1:d,0]),this.alignedProjMatrix=v,s=t.create(),t.scale(s,s,[this.width/2,-this.height/2,1]),t.translate(s,s,[1,-1,0]),this.pixelMatrix=t.multiply(new Float64Array(16),s,this.projMatrix),!(s=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=s,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Jn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)).zoomTo(this.zoom),n=[e.column*this.tileSize,e.row*this.tileSize,0,1];return t.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(Jn.prototype,Qn);var $n=function(){var e,n,r,i;t.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(e=this._updateHashUnthrottled.bind(this),n=!1,r=0,i=function(){r=0,n&&(e(),r=setTimeout(i,300),n=!1)},function(){return n=!0,r||i(),r})};$n.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},$n.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},$n.prototype.getHashString=function(t){var e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,r),o=Math.round(e.lng*i)/i,a=Math.round(e.lat*i)/i,s=this._map.getBearing(),u=this._map.getPitch(),c="";return c+=t?"#/"+o+"/"+a+"/"+n:"#"+n+"/"+a+"/"+o,(s||u)&&(c+="/"+Math.round(10*s)/10),u&&(c+="/"+Math.round(u)),c},$n.prototype._onHashChange=function(){var e=t.window.location.hash.replace("#","").split("/");return e.length>=3&&(this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:+(e[3]||0),pitch:+(e[4]||0)}),!0)},$n.prototype._updateHashUnthrottled=function(){var e=this.getHashString();t.window.history.replaceState(t.window.history.state,"",e)};var tr=function(e){function r(r,i,o,a){void 0===a&&(a={});var s=n.mousePos(i.getCanvasContainer(),o),u=i.unproject(s);e.call(this,r,t.extend({point:s,lngLat:u,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),er=function(e){function r(r,i,o){var a=n.touchPos(i.getCanvasContainer(),o),s=a.map(function(t){return i.unproject(t)}),u=a.reduce(function(t,e,n,r){return t.add(e.div(r.length))},new t.Point(0,0)),c=i.unproject(u);e.call(this,r,{points:a,point:u,lngLats:s,lngLat:c,originalEvent:o}),this._defaultPrevented=!1}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(t.Event),nr=function(t){function e(e,n,r){t.call(this,e,{originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,n),e}(t.Event),rr=function(e){this._map=e,this._el=e.getCanvasContainer(),this._delta=0,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};rr.prototype.isEnabled=function(){return!!this._enabled},rr.prototype.isActive=function(){return!!this._active},rr.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},rr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rr.prototype.onWheel=function(e){if(this.isEnabled()){var n=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this.isActive()||this._start(e)),e.preventDefault()}},rr.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(t)},rr.prototype._start=function(e){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new t.Event("movestart",{originalEvent:e})),this._map.fire(new t.Event("zoomstart",{originalEvent:e})),this._finishTimeout&&clearTimeout(this._finishTimeout);var r=n.mousePos(this._el,e);this._around=F.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},rr.prototype._onScrollFrame=function(){var e=this;if(this._frameId=null,this.isActive()){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:n.zoom,s=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&s&&u){var l=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),f=u(l);n.zoom=t.number(s,a,f),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):c=!0}else n.zoom=a,c=!0;n.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new t.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new t.Event("zoom",{originalEvent:this._lastWheelEvent})),c&&(this._active=!1,this._finishTimeout=setTimeout(function(){e._map.fire(new t.Event("zoomend",{originalEvent:e._lastWheelEvent})),e._map.fire(new t.Event("moveend",{originalEvent:e._lastWheelEvent})),delete e._targetZoom},200))}},rr.prototype._smoothOutEasing=function(e){var n=t.ease;if(this._prevEase){var r=this._prevEase,i=(t.browser.now()-r.start)/r.duration,o=r.easing(i+.01)-r.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=t.bezier(a,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:n},n};var ir=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1,t.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};ir.prototype.isEnabled=function(){return!!this._enabled},ir.prototype.isActive=function(){return!!this._active},ir.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ir.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ir.prototype.onMouseDown=function(e){this.isEnabled()&&e.shiftKey&&0===e.button&&(t.window.document.addEventListener("mousemove",this._onMouseMove,!1),t.window.document.addEventListener("keydown",this._onKeyDown,!1),t.window.document.addEventListener("mouseup",this._onMouseUp,!1),n.disableDrag(),this._startPos=this._lastPos=n.mousePos(this._el,e),this._active=!0)},ir.prototype._onMouseMove=function(t){var e=n.mousePos(this._el,t);if(!(this._lastPos.equals(e)||!this._box&&e.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=e,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var i=Math.min(r.x,e.x),o=Math.max(r.x,e.x),a=Math.min(r.y,e.y),s=Math.max(r.y,e.y);n.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}},ir.prototype._onMouseUp=function(e){if(0===e.button){var r=this._startPos,i=n.mousePos(this._el,e);this._finish(),n.suppressClick(),r.x===i.x&&r.y===i.y?this._fireEvent("boxzoomcancel",e):this._map.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!0}).fire(new t.Event("boxzoomend",{originalEvent:e}))}},ir.prototype._onKeyDown=function(t){27===t.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",t))},ir.prototype._finish=function(){this._active=!1,t.window.document.removeEventListener("mousemove",this._onMouseMove,!1),t.window.document.removeEventListener("keydown",this._onKeyDown,!1),t.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},ir.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,{originalEvent:n}))};var or=t.bezier(0,0,.25,1),ar=function(e,n){this._map=e,this._el=n.element||e.getCanvasContainer(),this._state="disabled",this._button=n.button||"right",this._bearingSnap=n.bearingSnap||0,this._pitchWithRotate=!1!==n.pitchWithRotate,t.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};ar.prototype.isEnabled=function(){return"disabled"!==this._state},ar.prototype.isActive=function(){return"active"===this._state},ar.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},ar.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},ar.prototype.onMouseDown=function(e){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=n.mouseButton(e),this._eventButton!==(e.ctrlKey?0:2))return}else{if(e.ctrlKey||0!==n.mouseButton(e))return;this._eventButton=0}n.disableDrag(),t.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.addEventListener("mouseup",this._onMouseUp),t.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[t.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=n.mousePos(this._el,e),this._center=this._map.transform.centerPoint,e.preventDefault()}},ar.prototype._onMouseMove=function(t){var e=n.mousePos(this._el,t);this._lastPos.equals(e)||(this._lastMoveEvent=t,this._lastPos=e,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",t),this._fireEvent("movestart",t),this._pitchWithRotate&&this._fireEvent("pitchstart",t)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},ar.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var n=this._map.transform,r=this._startPos,i=this._lastPos,o=.8*(r.x-i.x),a=-.5*(r.y-i.y),s=n.bearing-o,u=n.pitch-a,c=this._inertia,l=c[c.length-1];this._drainInertiaBuffer(),c.push([t.browser.now(),this._map._normalizeBearing(s,l[1])]),n.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",e),n.pitch=u),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._startPos=this._lastPos}},ar.prototype._onMouseUp=function(t){if(n.mouseButton(t)===this._eventButton)switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(t);break;case"pending":this._state="enabled",this._unbind()}},ar.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",t),this._pitchWithRotate&&this._fireEvent("pitchend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},ar.prototype._unbind=function(){t.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),t.window.document.removeEventListener("mouseup",this._onMouseUp),t.window.removeEventListener("blur",this._onBlur),n.enableDrag()},ar.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},ar.prototype._inertialRotate=function(t){var e=this;this._fireEvent("rotateend",t),this._drainInertiaBuffer();var n=this._map,r=n.getBearing(),i=this._inertia,o=function(){Math.abs(r)<e._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:t}):e._fireEvent("moveend",t),e._pitchWithRotate&&e._fireEvent("pitchend",t)};if(i.length<2)o();else{var a=i[0],s=i[i.length-1],u=i[i.length-2],c=n._normalizeBearing(r,u[1]),l=s[1]-a[1],f=l<0?-1:1,h=(s[0]-a[0])/1e3;if(0!==l&&0!==h){var p=Math.abs(l*(.25/h));p>180&&(p=180);var d=p/180;c+=f*p*(d/2),Math.abs(n._normalizeBearing(c,0))<this._bearingSnap&&(c=n._normalizeBearing(0,c)),n.rotateTo(c,{duration:1e3*d,easing:or,noMoveStart:!0},{originalEvent:t})}else o()}},ar.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},ar.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>0&&n-e[0][0]>160;)e.shift()};var sr=t.bezier(0,0,.3,1),ur=function(e,n){this._map=e,this._el=e.getCanvasContainer(),this._state="disabled",this._clickTolerance=n.clickTolerance||1,t.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};ur.prototype.isEnabled=function(){return"disabled"!==this._state},ur.prototype.isActive=function(){return"active"===this._state},ur.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},ur.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},ur.prototype.onMouseDown=function(e){"enabled"===this._state&&(e.ctrlKey||0!==n.mouseButton(e)||(n.addEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),n.addEventListener(t.window.document,"mouseup",this._onMouseUp),this._start(e)))},ur.prototype.onTouchStart=function(e){"enabled"===this._state&&(e.touches.length>1||(n.addEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.addEventListener(t.window.document,"touchend",this._onTouchEnd),this._start(e)))},ur.prototype._start=function(e){t.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=n.mousePos(this._el,e),this._inertia=[[t.browser.now(),this._startPos]]},ur.prototype._onMove=function(e){e.preventDefault();var r=n.mousePos(this._el,e);this._lastPos.equals(r)||"pending"===this._state&&r.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=e,this._lastPos=r,this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},ur.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var e=this._map.transform;e.setLocationAtPoint(e.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",t),this._fireEvent("move",t),this._startPos=this._lastPos,delete this._lastMoveEvent}},ur.prototype._onMouseUp=function(t){if(0===n.mouseButton(t))switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},ur.prototype._onTouchEnd=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(t);break;case"pending":this._state="enabled",this._unbind()}},ur.prototype._onBlur=function(t){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",t),this._fireEvent("moveend",t);break;case"pending":this._state="enabled",this._unbind()}},ur.prototype._unbind=function(){n.removeEventListener(t.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.removeEventListener(t.window.document,"touchend",this._onTouchEnd),n.removeEventListener(t.window.document,"mousemove",this._onMove,{capture:!0}),n.removeEventListener(t.window.document,"mouseup",this._onMouseUp),n.removeEventListener(t.window,"blur",this._onBlur)},ur.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},ur.prototype._inertialPan=function(t){this._fireEvent("dragend",t),this._drainInertiaBuffer();var e=this._inertia;if(e.length<2)this._fireEvent("moveend",t);else{var n=e[e.length-1],r=e[0],i=n[1].sub(r[1]),o=(n[0]-r[0])/1e3;if(0===o||n[1].equals(r[1]))this._fireEvent("moveend",t);else{var a=i.mult(.3/o),s=a.mag();s>1400&&(s=1400,a._unit()._mult(s));var u=s/750,c=a.mult(-u/2);this._map.panBy(c,{duration:1e3*u,easing:sr,noMoveStart:!0},{originalEvent:t})}}},ur.prototype._fireEvent=function(e,n){return this._map.fire(new t.Event(e,n?{originalEvent:n}:{}))},ur.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>0&&n-e[0][0]>160;)e.shift()};var cr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onKeyDown"],this)};function lr(t){return t*(2-t)}cr.prototype.isEnabled=function(){return!!this._enabled},cr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},cr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},cr.prototype._onKeyDown=function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=0,n=0,r=0,i=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),i=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),i=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?r=-1:(o=1,t.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),u={duration:300,delayEndEvents:500,easing:lr,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*r,offset:[100*-i,100*-o],center:a.getCenter()};a.easeTo(u,{originalEvent:t})}};var fr=function(e){this._map=e,t.bindAll(["_onDblClick","_onZoomEnd"],this)};fr.prototype.isEnabled=function(){return!!this._enabled},fr.prototype.isActive=function(){return!!this._active},fr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},fr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},fr.prototype.onTouchStart=function(t){var e=this;this.isEnabled()&&(t.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(t)):this._tapped=setTimeout(function(){e._tapped=null},300)))},fr.prototype.onDblClick=function(t){this.isEnabled()&&(t.originalEvent.preventDefault(),this._zoom(t))},fr.prototype._zoom=function(t){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)},fr.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var hr=t.bezier(0,0,.15,1),pr=function(e){this._map=e,this._el=e.getCanvasContainer(),t.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};pr.prototype.isEnabled=function(){return!!this._enabled},pr.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)},pr.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},pr.prototype.disableRotation=function(){this._rotationDisabled=!0},pr.prototype.enableRotation=function(){this._rotationDisabled=!1},pr.prototype.onStart=function(e){if(this.isEnabled()&&2===e.touches.length){var r=n.mousePos(this._el,e.touches[0]),i=n.mousePos(this._el,e.touches[1]),o=r.add(i).div(2);this._startVec=r.sub(i),this._startAround=this._map.transform.pointLocation(o),this._gestureIntent=void 0,this._inertia=[],n.addEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),n.addEventListener(t.window.document,"touchend",this._onEnd)}},pr.prototype._getTouchEventData=function(t){var e=n.mousePos(this._el,t.touches[0]),r=n.mousePos(this._el,t.touches[1]),i=e.sub(r);return{vec:i,center:e.add(r).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},pr.prototype._onMove=function(e){if(2===e.touches.length){var n=this._getTouchEventData(e),r=n.vec,i=n.scale,o=n.bearing;if(!this._gestureIntent){var a=Math.abs(1-i)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new t.Event(this._gestureIntent+"start",{originalEvent:e})),this._map.fire(new t.Event("movestart",{originalEvent:e})),this._startVec=r)}this._lastTouchEvent=e,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),e.preventDefault()}},pr.prototype._onTouchFrame=function(){this._frameId=null;var e=this._gestureIntent;if(e){var n=this._map.transform;this._startScale||(this._startScale=n.scale,this._startBearing=n.bearing);var r=this._getTouchEventData(this._lastTouchEvent),i=r.center,o=r.bearing,a=r.scale,s=n.pointLocation(i),u=n.locationPoint(s);"rotate"===e&&(n.bearing=this._startBearing+o),n.zoom=n.scaleZoom(this._startScale*a),n.setLocationAtPoint(this._startAround,u),this._map.fire(new t.Event(e,{originalEvent:this._lastTouchEvent})),this._map.fire(new t.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([t.browser.now(),a,i])}},pr.prototype._onEnd=function(e){n.removeEventListener(t.window.document,"touchmove",this._onMove,{passive:!1}),n.removeEventListener(t.window.document,"touchend",this._onEnd);var r=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,r){this._map.fire(new t.Event(r+"end",{originalEvent:e})),this._drainInertiaBuffer();var o=this._inertia,a=this._map;if(o.length<2)a.snapToNorth({},{originalEvent:e});else{var s=o[o.length-1],u=o[0],c=a.transform.scaleZoom(i*s[1]),l=a.transform.scaleZoom(i*u[1]),f=c-l,h=(s[0]-u[0])/1e3,p=s[2];if(0!==h&&c!==l){var d=.15*f/h;Math.abs(d)>2.5&&(d=d>0?2.5:-2.5);var v=1e3*Math.abs(d/(12*.15)),g=c+d*v/2e3;g<0&&(g=0),a.easeTo({zoom:g,duration:v,easing:hr,around:this._aroundCenter?a.getCenter():a.unproject(p),noMoveStart:!0},{originalEvent:e})}else a.snapToNorth({},{originalEvent:e})}}},pr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,n=t.browser.now();e.length>2&&n-e[0][0]>160;)e.shift()};var dr={scrollZoom:rr,boxZoom:ir,dragRotate:ar,dragPan:ur,keyboard:cr,doubleClickZoom:fr,touchZoomRotate:pr},vr=function(e){function n(n,r){e.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.getCenter=function(){return this.transform.center},n.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},n.prototype.panBy=function(e,n,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},n),r)},n.prototype.panTo=function(e,n,r){return this.easeTo(t.extend({center:e},n),r)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},n.prototype.zoomTo=function(e,n,r){return this.easeTo(t.extend({zoom:e},n),r)},n.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},n.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},n.prototype.rotateTo=function(e,n,r){return this.easeTo(t.extend({bearing:e},n),r)},n.prototype.resetNorth=function(e,n){return this.rotateTo(0,t.extend({duration:1e3},e),n),this},n.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},n.prototype.cameraForBounds=function(t,e){return t=N.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,e)},n.prototype._cameraForBoxAndBearing=function(e,n,r,i){if("number"==typeof(i=t.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var o=i.padding;i.padding={top:o,bottom:o,right:o,left:o}}if(t.isEqual(Object.keys(i.padding).sort(function(t,e){return t<e?-1:t>e?1:0}),["bottom","left","right","top"])){var a=[(i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2],s=Math.min(i.padding.right,i.padding.left),u=Math.min(i.padding.top,i.padding.bottom);i.offset=[i.offset[0]+a[0],i.offset[1]+a[1]];var c=this.transform,l=c.project(F.convert(e)),f=c.project(F.convert(n)),h=l.rotate(-r*Math.PI/180),p=f.rotate(-r*Math.PI/180),d=new t.Point(Math.max(h.x,p.x),Math.max(h.y,p.y)),v=new t.Point(Math.min(h.x,p.x),Math.min(h.y,p.y)),g=t.Point.convert(i.offset),m=d.sub(v),y=(c.width-2*s-2*Math.abs(g.x))/m.x,_=(c.height-2*u-2*Math.abs(g.y))/m.y;if(!(_<0||y<0))return i.center=c.unproject(l.add(f).div(2)),i.zoom=Math.min(c.scaleZoom(c.scale*Math.min(y,_)),i.maxZoom),i.bearing=r,i;t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else t.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},n.prototype.fitBounds=function(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)},n.prototype.fitScreenCoordinates=function(e,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(n)),r,i),i,o)},n.prototype._fitInternal=function(e,n,r){return e?(n=t.extend(e,n)).linear?this.easeTo(n,r):this.flyTo(n,r):this},n.prototype.jumpTo=function(e,n){this.stop();var r=this.transform,i=!1,o=!1,a=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=F.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(o=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(a=!0,r.pitch=+e.pitch),this.fire(new t.Event("movestart",n)).fire(new t.Event("move",n)),i&&this.fire(new t.Event("zoomstart",n)).fire(new t.Event("zoom",n)).fire(new t.Event("zoomend",n)),o&&this.fire(new t.Event("rotatestart",n)).fire(new t.Event("rotate",n)).fire(new t.Event("rotateend",n)),a&&this.fire(new t.Event("pitchstart",n)).fire(new t.Event("pitch",n)).fire(new t.Event("pitchend",n)),this.fire(new t.Event("moveend",n))},n.prototype.easeTo=function(e,n){var r=this;this.stop(),!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate&&(e.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u="zoom"in e?+e.zoom:o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,l="pitch"in e?+e.pitch:s,f=i.centerPoint.add(t.Point.convert(e.offset)),h=i.pointLocation(f),p=F.convert(e.center||h);this._normalizeCenter(p);var d,v,g=i.project(h),m=i.project(p).sub(g),y=i.zoomScale(u-o);return e.around&&(d=F.convert(e.around),v=i.locationPoint(d)),this._zooming=u!==o,this._rotating=a!==c,this._pitching=l!==s,this._prepareEase(n,e.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(e){if(r._zooming&&(i.zoom=t.number(o,u,e)),r._rotating&&(i.bearing=t.number(a,c,e)),r._pitching&&(i.pitch=t.number(s,l,e)),d)i.setLocationAtPoint(d,v);else{var h=i.zoomScale(i.zoom-o),p=u>o?Math.min(2,y):Math.max(.5,y),_=Math.pow(p,1-e),b=i.unproject(g.add(m.mult(e*_)).mult(h));i.setLocationAtPoint(i.renderWorldCopies?b.wrap():b,f)}r._fireMoveEvents(n)},function(){e.delayEndEvents?r._easeEndTimeoutID=setTimeout(function(){return r._afterEase(n)},e.delayEndEvents):r._afterEase(n)},e),this},n.prototype._prepareEase=function(e,n){this._moving=!0,n||this.fire(new t.Event("movestart",e)),this._zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&this.fire(new t.Event("pitchstart",e))},n.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},n.prototype._afterEase=function(e){var n=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,n&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),i&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))},n.prototype.flyTo=function(e,n){var r=this;this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u="zoom"in e?t.clamp(+e.zoom,i.minZoom,i.maxZoom):o,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,l="pitch"in e?+e.pitch:s,f=i.zoomScale(u-o),h=i.centerPoint.add(t.Point.convert(e.offset)),p=i.pointLocation(h),d=F.convert(e.center||p);this._normalizeCenter(d);var v=i.project(p),g=i.project(d).sub(v),m=e.curve,y=Math.max(i.width,i.height),_=y/f,b=g.mag();if("minZoom"in e){var x=t.clamp(Math.min(e.minZoom,o,u),i.minZoom,i.maxZoom),w=y/i.zoomScale(x-o);m=Math.sqrt(w/b*2)}var E=m*m;function S(t){var e=(_*_-y*y+(t?-1:1)*E*E*b*b)/(2*(t?_:y)*E*b);return Math.log(Math.sqrt(e*e+1)-e)}function P(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}var A=S(0),k=function(t){return T(A)/T(A+m*t)},C=function(t){return y*((T(A)*(P(e=A+m*t)/T(e))-P(A))/E)/b;var e},O=(S(1)-A)/m;if(Math.abs(b)<1e-6||!isFinite(O)){if(Math.abs(y-_)<1e-6)return this.easeTo(e,n);var M=_<y?-1:1;O=Math.abs(Math.log(_/y))/m,C=function(){return 0},k=function(t){return Math.exp(M*m*t)}}if("duration"in e)e.duration=+e.duration;else{var I="screenSpeed"in e?+e.screenSpeed/m:+e.speed;e.duration=1e3*O/I}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=a!==c,this._pitching=l!==s,this._prepareEase(n,!1),this._ease(function(e){var f=e*O,p=1/k(f);i.zoom=1===e?u:o+i.scaleZoom(p),r._rotating&&(i.bearing=t.number(a,c,e)),r._pitching&&(i.pitch=t.number(s,l,e));var m=1===e?d:i.unproject(v.add(g.mult(C(f))).mult(p));i.setLocationAtPoint(i.renderWorldCopies?m.wrap():m,h),r._fireMoveEvents(n)},function(){return r._afterEase(n)},e),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd,t.call(this)}return this},n.prototype._ease=function(e,n,r){!1===r.animate||0===r.duration?(e(1),n()):(this._easeStart=t.browser.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(e,n){e=t.wrap(e,-180,180);var r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e},n.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}},n}(t.Evented),gr=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};gr.prototype.getDefaultPosition=function(){return"bottom-right"},gr.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},gr.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},gr.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var e=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:f.ACCESS_TOKEN}];if(t){var n=e.reduce(function(t,n,r){return n.value&&(t+=n.key+"="+n.value+(r<e.length-1?"&":"")),t},"?");t.href="https://www.mapbox.com/feedback/"+n+(this._map._hash?this._map._hash.getHashString(!0):"")}},gr.prototype._updateData=function(t){t&&"metadata"===t.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},gr.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r].getSource();i.attribution&&t.indexOf(i.attribution)<0&&t.push(i.attribution)}t.sort(function(t,e){return t.length-e.length}),(t=t.filter(function(e,n){for(var r=n+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0})).length?(this._container.innerHTML=t.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},gr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var mr=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};mr.prototype.onAdd=function(t){this._map=t,this._container=n.create("div","mapboxgl-ctrl");var e=n.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.href="https://www.mapbox.com/",e.setAttribute("aria-label","Mapbox logo"),e.setAttribute("rel","noopener"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},mr.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},mr.prototype.getDefaultPosition=function(){return"bottom-left"},mr.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},mr.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},mr.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var yr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};yr.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},yr.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,r=e?this._queue.concat(e):this._queue;n<r.length;n+=1){var i=r[n];if(i.id===t)return void(i.cancelled=!0)}},yr.prototype.run=function(){var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e+=1){var r=n[e];if(!r.cancelled&&(r.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},yr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var _r=t.window.HTMLImageElement,br=t.window.HTMLElement,xr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},wr=function(r){function i(e){var i=this;if(null!=(e=t.extend({},xr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than minZoom");var o=new Jn(e.minZoom,e.maxZoom,e.renderWorldCopies);r.call(this,o,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new yr,this._controls=[];var a=e.transformRequest;if(this._transformRequest=a?function(t,e){return a(t,e)||{url:t}}:function(t){return{url:t}},"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof br))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return i._update(!1)}),this.on("zoom",function(){return i._update(!0)}),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),function(t,e){var r=t.getCanvasContainer(),i=null,o=!1,a=null;for(var s in dr)t[s]=new dr[s](t,e),e.interactive&&e[s]&&t[s].enable(e[s]);n.addEventListener(r,"mouseout",function(e){t.fire(new tr("mouseout",t,e))}),n.addEventListener(r,"mousedown",function(i){o=!0,a=n.mousePos(r,i);var s=new tr("mousedown",t,i);t.fire(s),s.defaultPrevented||(e.interactive&&!t.doubleClickZoom.isActive()&&t.stop(),t.boxZoom.onMouseDown(i),t.boxZoom.isActive()||t.dragPan.isActive()||t.dragRotate.onMouseDown(i),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onMouseDown(i))}),n.addEventListener(r,"mouseup",function(e){var n=t.dragRotate.isActive();i&&!n&&t.fire(new tr("contextmenu",t,i)),i=null,o=!1,t.fire(new tr("mouseup",t,e))}),n.addEventListener(r,"mousemove",function(e){if(!t.dragPan.isActive()&&!t.dragRotate.isActive()){for(var n=e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new tr("mousemove",t,e))}}),n.addEventListener(r,"mouseover",function(e){for(var n=e.target;n&&n!==r;)n=n.parentNode;n===r&&t.fire(new tr("mouseover",t,e))}),n.addEventListener(r,"touchstart",function(n){var r=new er("touchstart",t,n);t.fire(r),r.defaultPrevented||(e.interactive&&t.stop(),t.boxZoom.isActive()||t.dragRotate.isActive()||t.dragPan.onTouchStart(n),t.touchZoomRotate.onStart(n),t.doubleClickZoom.onTouchStart(r))},{passive:!1}),n.addEventListener(r,"touchmove",function(e){t.fire(new er("touchmove",t,e))},{passive:!1}),n.addEventListener(r,"touchend",function(e){t.fire(new er("touchend",t,e))}),n.addEventListener(r,"touchcancel",function(e){t.fire(new er("touchcancel",t,e))}),n.addEventListener(r,"click",function(i){var o=n.mousePos(r,i);(o.equals(a)||o.dist(a)<e.clickTolerance)&&t.fire(new tr("click",t,i))}),n.addEventListener(r,"dblclick",function(e){var n=new tr("dblclick",t,e);t.fire(n),n.defaultPrevented||t.doubleClickZoom.onDblClick(n)}),n.addEventListener(r,"contextmenu",function(e){var n=t.dragRotate.isActive();o||n?o&&(i=e):t.fire(new tr("contextmenu",t,e)),e.preventDefault()}),n.addEventListener(r,"wheel",function(n){e.interactive&&t.stop();var r=new nr("wheel",t,n);t.fire(r),r.defaultPrevented||t.scrollZoom.onWheel(n)},{passive:!1})}(this,e),this._hash=e.hash&&(new $n).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),this.resize(),e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new gr({customAttribution:e.customAttribution})),this.addControl(new mr,e.logoPosition),this.on("style.load",function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)}),this.on("data",function(e){i._update("style"===e.dataType),i.fire(new t.Event(e.dataType+"data",e))}),this.on("dataloading",function(e){i.fire(new t.Event(e.dataType+"dataloading",e))})}r&&(i.__proto__=r),i.prototype=Object.create(r&&r.prototype),i.prototype.constructor=i;var o={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return i.prototype.addControl=function(e,n){if(void 0===n&&e.getDefaultPosition&&(n=e.getDefaultPosition()),void 0===n&&(n="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},i.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this},i.prototype.resize=function(e){var n=this._containerDimensions(),r=n[0],i=n[1];return this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e)).fire(new t.Event("resize",e)).fire(new t.Event("moveend",e)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(N.convert(t)),this._update()},i.prototype.setMinZoom=function(t){if((t=null===t||void 0===t?0:t)>=0&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(t){if((t=null===t||void 0===t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.project=function(t){return this.transform.locationPoint(F.convert(t))},i.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype.on=function(t,e,n){var i,o=this;if(void 0===n)return r.prototype.on.call(this,t,e);var a=function(){if("mouseenter"===t||"mouseover"===t){var r=!1;return{layer:e,listener:n,delegates:{mousemove:function(i){var a=o.getLayer(e)?o.queryRenderedFeatures(i.point,{layers:[e]}):[];a.length?r||(r=!0,n.call(o,new tr(t,o,i.originalEvent,{features:a}))):r=!1},mouseout:function(){r=!1}}}}if("mouseleave"===t||"mouseout"===t){var a=!1;return{layer:e,listener:n,delegates:{mousemove:function(r){(o.getLayer(e)?o.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?a=!0:a&&(a=!1,n.call(o,new tr(t,o,r.originalEvent)))},mouseout:function(e){a&&(a=!1,n.call(o,new tr(t,o,e.originalEvent)))}}}}return{layer:e,listener:n,delegates:(i={},i[t]=function(t){var r=o.getLayer(e)?o.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,n.call(o,t),delete t.features)},i)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(a),a.delegates)o.on(s,a.delegates[s]);return this},i.prototype.off=function(t,e,n){if(void 0===n)return r.prototype.off.call(this,t,e);if(this._delegatedListeners&&this._delegatedListeners[t])for(var i=this._delegatedListeners[t],o=0;o<i.length;o++){var a=i[o];if(a.layer===e&&a.listener===n){for(var s in a.delegates)this.off(s,a.delegates[s]);return i.splice(o,1),this}}return this},i.prototype.queryRenderedFeatures=function(e,n){if(!this.style)return[];var r;if(void 0!==n||void 0===e||e instanceof t.Point||Array.isArray(e)||(n=e,e=void 0),n=n||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])r=[t.Point.convert(e)];else{var i=t.Point.convert(e[0]),o=t.Point.convert(e[1]);r=[i,new t.Point(o.x,i.y),o,new t.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)},i.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},i.prototype.setStyle=function(e,n){if((!n||!1!==n.diff&&!n.localIdeographFontFamily)&&this.style&&e&&"object"==typeof e)try{return this.style.setState(e)&&this._update(!0),this}catch(e){t.warnOnce("Unable to perform style diff: "+(e.message||e.error||e)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Xe(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(t,e){return this.style.addSource(t,e),this._update(!0)},i.prototype.isSourceLoaded=function(e){var n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},i.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var n=t[e]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(t,e,n){return this.style.addSourceType(t,e,n)},i.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},i.prototype.getSource=function(t){return this.style.getSource(t)},i.prototype.addImage=function(e,n,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var o=r.sdf;if(void 0===o&&(o=!1),n instanceof _r){var a=t.browser.getImageData(n),s=a.width,u=a.height,c=a.data;this.style.addImage(e,{data:new t.RGBAImage({width:s,height:u},c),pixelRatio:i,sdf:o})}else{if(void 0===n.width||void 0===n.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var l=n.width,f=n.height,h=n.data;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:f},new Uint8Array(h)),pixelRatio:i,sdf:o})}},i.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(t){this.style.removeImage(t)},i.prototype.loadImage=function(e,n){t.getImage(this._transformRequest(e,t.ResourceType.Image),n)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(t,e){return this.style.addLayer(t,e),this._update(!0)},i.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},i.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},i.prototype.getLayer=function(t){return this.style.getLayer(t)},i.prototype.setFilter=function(t,e){return this.style.setFilter(t,e),this._update(!0)},i.prototype.setLayerZoomRange=function(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)},i.prototype.getFilter=function(t){return this.style.getFilter(t)},i.prototype.setPaintProperty=function(t,e,n){return this.style.setPaintProperty(t,e,n),this._update(!0)},i.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},i.prototype.setLayoutProperty=function(t,e,n){return this.style.setLayoutProperty(t,e,n),this._update(!0)},i.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},i.prototype.setLight=function(t){return this.style.setLight(t),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},i.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=n.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",e),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=n.create("div","mapboxgl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(t){o[t]=n.create("div","mapboxgl-ctrl-"+t,i)})},i.prototype._resizeCanvas=function(e,n){var r=t.window.devicePixelRatio||1;this._canvas.width=r*e,this._canvas.height=r*n,this._canvas.style.width=e+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=t.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},e.webGLContextAttributes),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?this.painter=new Xn(r,this.transform):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},i.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},i.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},i.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var e=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var n=this.transform.zoom,r=t.browser.now();this.style.zoomHistory.update(n,r);var i=new t.EvaluationParameters(n,{now:r,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=i.crossFadingFactor();1===o&&o===this._crossFadingFactor||(e=!0,this._crossFadingFactor=o),this.style.update(i)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||e)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this.triggerRepaint(),this},i.prototype.remove=function(){this._hash&&this._hash.remove(),this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));for(var e=0,n=this._controls;e<n.length;e+=1)n[e].onRemove(this);this._controls=[];var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Er(this._canvasContainer),Er(this._controlContainer),Er(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new t.Event("remove"))},i.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame(function(){e._frame=null,e._render()}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(t){this._repaint=t,this._update()},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(t){this._vertices=t,this._update()},Object.defineProperties(i.prototype,o),i}(vr);function Er(t){t.parentNode&&t.parentNode.removeChild(t)}var Sr={showCompass:!0,showZoom:!0},Pr=function(e){var r=this;this.options=t.extend({},Sr,e),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return r._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return r._map.zoomOut()})),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return r._map.resetNorth()}),this._compassArrow=n.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function Tr(t,e,n){if(t=new F(t.lng,t.lat),e){var r=new F(t.lng-360,t.lat),i=new F(t.lng+360,t.lat),o=n.locationPoint(t).distSqr(e);n.locationPoint(r).distSqr(e)<o?t=r:n.locationPoint(i).distSqr(e)<o&&(t=i)}for(;Math.abs(t.lng-n.center.lng)>180;){var a=n.locationPoint(t);if(a.x>=0&&a.y>=0&&a.x<=n.width&&a.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}Pr.prototype._rotateCompassArrow=function(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t},Pr.prototype.onAdd=function(t){return this._map=t,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ar(t,{button:"left",element:this._compass}),n.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},Pr.prototype.onRemove=function(){n.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),n.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},Pr.prototype._createButton=function(t,e,r){var i=n.create("button",t,this._container);return i.type="button",i.setAttribute("aria-label",e),i.addEventListener("click",r),i};var Ar={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function kr(t,e,n){var r=t.classList;for(var i in Ar)r.remove("mapboxgl-"+n+"-anchor-"+i);r.add("mapboxgl-"+n+"-anchor-"+e)}var Cr,Or=function(e){function r(r){if(e.call(this),(arguments[0]instanceof t.window.HTMLElement||2===arguments.length)&&(r=t.extend({element:r},arguments[1])),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._draggable=r&&r.draggable||!1,this._state="inactive",r&&r.element)this._element=r.element,this._offset=t.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div");var i=n.createNS("http://www.w3.org/2000/svg","svg");i.setAttributeNS(null,"height","41px"),i.setAttributeNS(null,"width","27px"),i.setAttributeNS(null,"viewBox","0 0 27 41");var o=n.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");var a=n.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"fill-rule","nonzero");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");for(var u=0,c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];u<c.length;u+=1){var l=c[u],f=n.createNS("http://www.w3.org/2000/svg","ellipse");f.setAttributeNS(null,"opacity","0.04"),f.setAttributeNS(null,"cx","10.5"),f.setAttributeNS(null,"cy","5.80029008"),f.setAttributeNS(null,"rx",l.rx),f.setAttributeNS(null,"ry",l.ry),s.appendChild(f)}var h=n.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);var p=n.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(p);var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");var v=n.createNS("http://www.w3.org/2000/svg","path");v.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(v);var g=n.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(6.0, 7.0)"),g.setAttributeNS(null,"fill","#FFFFFF");var m=n.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");var y=n.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#000000"),y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962");var _=n.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),m.appendChild(y),m.appendChild(_),a.appendChild(s),a.appendChild(h),a.appendChild(d),a.appendChild(g),a.appendChild(m),i.appendChild(a),this._element.appendChild(i),this._offset=t.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(t){return this._lngLat=F.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},r.prototype._onMapClick=function(t){var e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},r.prototype._update=function(t){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=Tr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),t&&"moveend"!==t.type||(this._pos=this._pos.round()),n.setTransform(this._element,Ar[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),kr(this._element,this._anchor,"marker"))},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},r.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r}(t.Evented),Mr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},Ir=function(e){function r(n){e.call(this),this.options=t.extend({},Mr,n),t.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Cr?r(Cr):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(function(t){Cr="denied"!==t.state,r(Cr)}):(Cr=!!t.window.navigator.geolocation,r(Cr)),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),n.remove(this._container),this._map=void 0},r.prototype._onSuccess=function(e){if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()},r.prototype._updateCamera=function(t){var e=new F(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy;this._map.fitBounds(e.toBounds(n),this.options.fitBoundsOptions,{geolocateSource:!0})},r.prototype._updateMarker=function(t){t?this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},r.prototype._onError=function(e){if(this.options.trackUserLocation)if(1===e.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;!1!==e?(this._container.addEventListener("contextmenu",function(t){return t.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Or(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(e){e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))})):t.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),Lr={maxWidth:100,unit:"metric"},Rr=function(e){this.options=t.extend({},Lr,e),t.bindAll(["_onMove","setUnit"],this)};function jr(t,e,n){var r,i,o,a,s,u,c=n&&n.maxWidth||100,l=t._container.clientHeight/2,f=(r=t.unproject([0,l]),i=t.unproject([c,l]),o=Math.PI/180,a=r.lat*o,s=i.lat*o,u=Math.sin(a)*Math.sin(s)+Math.cos(a)*Math.cos(s)*Math.cos((i.lng-r.lng)*o),6371e3*Math.acos(Math.min(u,1)));if(n&&"imperial"===n.unit){var h=3.2808*f;h>5280?zr(e,c,h/5280,"mi"):zr(e,c,h,"ft")}else n&&"nautical"===n.unit?zr(e,c,f/1852,"nm"):zr(e,c,f,"m")}function zr(t,e,n,r){var i,o,a,s=(i=n,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:1)),u=s/n;"m"===r&&s>=1e3&&(s/=1e3,r="km"),t.style.width=e*u+"px",t.innerHTML=s+r}Rr.prototype.getDefaultPosition=function(){return"bottom-left"},Rr.prototype._onMove=function(){jr(this._map,this._container,this.options)},Rr.prototype.onAdd=function(t){return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Rr.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Rr.prototype.setUnit=function(t){this.options.unit=t,jr(this._map,this._container,this.options)};var Dr=function(){this._fullscreen=!1,t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Dr.prototype.onAdd=function(e){return this._map=e,this._mapContainer=this._map.getContainer(),this._container=n.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._container},Dr.prototype.onRemove=function(){n.remove(this._container),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Dr.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},Dr.prototype._setupUI=function(){var e=this._fullscreenButton=n.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);e.setAttribute("aria-label","Toggle fullscreen"),e.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Dr.prototype._isFullscreen=function(){return this._fullscreen},Dr.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Dr.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var Fr={closeButton:!0,closeOnClick:!0,className:""},Nr=function(e){function r(n){e.call(this),this.options=t.extend(Object.create(Fr),n),t.bindAll(["_update","_onClickClose"],this)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.addTo=function(e){return this._map=e,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(t){return this._lngLat=F.convert(t),this._pos=null,this._update(),this},r.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},r.prototype.setHTML=function(e){var n,r=t.window.document.createDocumentFragment(),i=t.window.document.createElement("body");for(i.innerHTML=e;n=i.firstChild;)r.appendChild(n);return this.setDOMContent(r)},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},r.prototype._update=function(){var e=this;if(this._map&&this._lngLat&&this._content){this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(t){return e._container.classList.add(t)})),this._map.transform.renderWorldCopies&&(this._lngLat=Tr(this._lngLat,this._pos,this._map.transform));var r=this._pos=this._map.project(this._lngLat),i=this.options.anchor,o=function e(n){if(n){if("number"==typeof n){var r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new t.Point(0,0),top:new t.Point(0,n),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-n),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(n,0),right:new t.Point(-n,0)}}if(n instanceof t.Point||Array.isArray(n)){var i=t.Point.convert(n);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.Point.convert(n.center||[0,0]),top:t.Point.convert(n.top||[0,0]),"top-left":t.Point.convert(n["top-left"]||[0,0]),"top-right":t.Point.convert(n["top-right"]||[0,0]),bottom:t.Point.convert(n.bottom||[0,0]),"bottom-left":t.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(n["bottom-right"]||[0,0]),left:t.Point.convert(n.left||[0,0]),right:t.Point.convert(n.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!i){var a,s=this._container.offsetWidth,u=this._container.offsetHeight;a=r.y+o.bottom.y<u?["top"]:r.y>this._map.transform.height-u?["bottom"]:[],r.x<s/2?a.push("left"):r.x>this._map.transform.width-s/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}var c=r.add(o[i]).round();n.setTransform(this._container,Ar[i]+" translate("+c.x+"px,"+c.y+"px)"),kr(this._container,i,"popup")}},r.prototype._onClickClose=function(){this.remove()},r}(t.Evented),Br={version:"0.50.0",supported:e,setRTLTextPlugin:t.setRTLTextPlugin,Map:wr,NavigationControl:Pr,GeolocateControl:Ir,AttributionControl:gr,ScaleControl:Rr,FullscreenControl:Dr,Popup:Nr,Marker:Or,Style:Xe,LngLat:F,LngLatBounds:N,Point:t.Point,Evented:t.Evented,config:f,get accessToken(){return f.ACCESS_TOKEN},set accessToken(t){f.ACCESS_TOKEN=t},get workerCount(){return Ht.workerCount},set workerCount(t){Ht.workerCount=t},workerUrl:""};return Br}),n}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){var n={};return Array.from(new Set(Object.keys(t).concat(Object.keys(e)))).map(function(r){t[r]!==e[r]&&(n[r]=e[r])}),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=0;e.generateID=function(){return r+=1}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(551),s=n(82),u={zIndex:3},c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=void 0,e.prevent=!1,e.state={},e.setContainer=function(t){t&&(e.container=t)},e.handleMapMove=function(){e.prevent||e.setState(a.overlayState(e.props,e.props.map,e.container))},e}return r(e,t),e.prototype.componentDidMount=function(){this.props.map.on("move",this.handleMapMove),this.handleMapMove()},e.prototype.havePropsChanged=function(t,e){return t.coordinates[0]!==e.coordinates[0]||t.coordinates[1]!==e.coordinates[1]||t.offset!==e.offset||t.anchor!==e.anchor},e.prototype.componentWillReceiveProps=function(t){this.havePropsChanged(this.props,t)&&this.setState(a.overlayState(t,this.props.map,this.container))},e.prototype.componentWillUnmount=function(){var t=this.props.map;this.prevent=!0,t.off("move",this.handleMapMove)},e.prototype.render=function(){var t=this.props,e=t.style,n=t.children,r=t.className,s=t.onClick,c=t.onDoubleClick,l=t.onMouseEnter,f=t.onMouseLeave,h=t.onScroll,p=t.onWheel,d=t.type,v=t.tabIndex,g=this.state.anchor,m=i({},u,e,{transform:a.overlayTransform(this.state).join(" ")}),y=g&&"popup"===d?"mapboxgl-popup-anchor-"+g:"";return o.createElement("div",{className:r+" "+y,onClick:s,onDoubleClick:c,onMouseEnter:l,onMouseLeave:f,onScroll:h,onWheel:p,style:m,ref:this.setContainer,tabIndex:v},n)},e.defaultProps={offset:0,onClick:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t}},e}(o.Component);e.ProjectedLayer=c,e.default=s.withMap(c)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClassName=function(t,e){return e?e.split(" ").concat(t).join(" "):t.join(" ")}},function(t,e,n){"use strict";n.r(e);var r=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},i=function(t){return 1===t.length&&(t=function(t){return function(e,n){return r(t(e),n)}}(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var o=i(r),a=o.right,s=o.left,u=a,c=function(t,e){null==e&&(e=l);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return o};function l(t,e){return[t,e]}var f=function(t,e,n){var r,i,o,a,s=t.length,u=e.length,c=new Array(s*u);for(null==n&&(n=l),r=o=0;r<s;++r)for(a=t[r],i=0;i<u;++i,++o)c[o]=n(a,e[i]);return c},h=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},p=function(t){return null===t?NaN:+t},d=function(t,e){var n,r,i=t.length,o=0,a=-1,s=0,u=0;if(null==e)for(;++a<i;)isNaN(n=p(t[a]))||(u+=(r=n-s)*(n-(s+=r/++o)));else for(;++a<i;)isNaN(n=p(e(t[a],a,t)))||(u+=(r=n-s)*(n-(s+=r/++o)));if(o>1)return u/(o-1)},v=function(t,e){var n=d(t,e);return n?Math.sqrt(n):n},g=function(t,e){var n,r,i,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=i=n;++a<o;)null!=(n=t[a])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=i=n;++a<o;)null!=(n=e(t[a],a,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},m=Array.prototype,y=m.slice,_=m.map,b=function(t){return function(){return t}},x=function(t){return t},w=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o},E=Math.sqrt(50),S=Math.sqrt(10),P=Math.sqrt(2),T=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=A(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o};function A(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=E?10:o>=S?5:o>=P?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=E?10:o>=S?5:o>=P?2:1)}function k(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=E?i*=10:o>=S?i*=5:o>=P&&(i*=2),e<t?-i:i}var C=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},O=function(){var t=x,e=g,n=C;function r(r){var i,o,a=r.length,s=new Array(a);for(i=0;i<a;++i)s[i]=t(r[i],i,r);var c=e(s),l=c[0],f=c[1],h=n(s,l,f);Array.isArray(h)||(h=k(l,f,h),h=w(Math.ceil(l/h)*h,f,h));for(var p=h.length;h[0]<=l;)h.shift(),--p;for(;h[p-1]>f;)h.pop(),--p;var d,v=new Array(p+1);for(i=0;i<=p;++i)(d=v[i]=[]).x0=i>0?h[i-1]:l,d.x1=i<p?h[i]:f;for(i=0;i<a;++i)l<=(o=s[i])&&o<=f&&v[u(h,o,0,p)].push(r[i]);return v}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:b(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:b([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?b(y.call(t)):b(t),r):n},r},M=function(t,e,n){if(null==n&&(n=p),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}},I=function(t,e,n){return t=_.call(t,p).sort(r),Math.ceil((n-e)/(2*(M(t,.75)-M(t,.25))*Math.pow(t.length,-1/3)))},L=function(t,e,n){return Math.ceil((n-e)/(3.5*v(t)*Math.pow(t.length,-1/3)))},R=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&n>r&&(r=n);return r},j=function(t,e){var n,r=t.length,i=r,o=-1,a=0;if(null==e)for(;++o<r;)isNaN(n=p(t[o]))?--i:a+=n;else for(;++o<r;)isNaN(n=p(e(t[o],o,t)))?--i:a+=n;if(i)return a/i},z=function(t,e){var n,i=t.length,o=-1,a=[];if(null==e)for(;++o<i;)isNaN(n=p(t[o]))||a.push(n);else for(;++o<i;)isNaN(n=p(e(t[o],o,t)))||a.push(n);return M(a.sort(r),.5)},D=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--a]=r[e];return n},F=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&r>n&&(r=n);return r},N=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},B=function(t,e){if(n=t.length){var n,i,o=0,a=0,s=t[a];for(null==e&&(e=r);++o<n;)(e(i=t[o],s)<0||0!==e(s,s))&&(s=i,a=o);return 0===e(s,s)?a:void 0}},U=function(t,e,n){for(var r,i,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)i=Math.random()*o--|0,r=t[o+e],t[o+e]=t[i+e],t[i+e]=r;return t},V=function(t,e){var n,r=t.length,i=-1,o=0;if(null==e)for(;++i<r;)(n=+t[i])&&(o+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(o+=n);return o},G=function(t){if(!(i=t.length))return[];for(var e=-1,n=F(t,q),r=new Array(n);++e<n;)for(var i,o=-1,a=r[e]=new Array(i);++o<i;)a[o]=t[o][e];return r};function q(t){return t.length}var W=function(){return G(arguments)},Z=Array.prototype.slice,X=function(t){return t},H=1,Y=2,K=3,J=4,Q=1e-6;function $(t){return"translate("+(t+.5)+",0)"}function tt(t){return"translate(0,"+(t+.5)+")"}function et(){return!this.__axis}function nt(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,u=t===H||t===J?-1:1,c=t===J||t===Y?"x":"y",l=t===H||t===K?$:tt;function f(f){var h=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,p=null==i?e.tickFormat?e.tickFormat.apply(e,n):X:i,d=Math.max(o,0)+s,v=e.range(),g=+v[0]+.5,m=+v[v.length-1]+.5,y=(e.bandwidth?function(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}:function(t){return function(e){return+t(e)}})(e.copy()),_=f.selection?f.selection():f,b=_.selectAll(".domain").data([null]),x=_.selectAll(".tick").data(h,e).order(),w=x.exit(),E=x.enter().append("g").attr("class","tick"),S=x.select("line"),P=x.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(E),S=S.merge(E.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),P=P.merge(E.append("text").attr("fill","currentColor").attr(c,u*d).attr("dy",t===H?"0em":t===K?"0.71em":"0.32em")),f!==_&&(b=b.transition(f),x=x.transition(f),S=S.transition(f),P=P.transition(f),w=w.transition(f).attr("opacity",Q).attr("transform",function(t){return isFinite(t=y(t))?l(t):this.getAttribute("transform")}),E.attr("opacity",Q).attr("transform",function(t){var e=this.parentNode.__axis;return l(e&&isFinite(e=e(t))?e:y(t))})),w.remove(),b.attr("d",t===J||t==Y?a?"M"+u*a+","+g+"H0.5V"+m+"H"+u*a:"M0.5,"+g+"V"+m:a?"M"+g+","+u*a+"V0.5H"+m+"V"+u*a:"M"+g+",0.5H"+m),x.attr("opacity",1).attr("transform",function(t){return l(y(t))}),S.attr(c+"2",u*o),P.attr(c,u*d).text(p),_.filter(et).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Y?"start":t===J?"end":"middle"),_.each(function(){this.__axis=y})}return f.scale=function(t){return arguments.length?(e=t,f):e},f.ticks=function(){return n=Z.call(arguments),f},f.tickArguments=function(t){return arguments.length?(n=null==t?[]:Z.call(t),f):n.slice()},f.tickValues=function(t){return arguments.length?(r=null==t?null:Z.call(t),f):r&&r.slice()},f.tickFormat=function(t){return arguments.length?(i=t,f):i},f.tickSize=function(t){return arguments.length?(o=a=+t,f):o},f.tickSizeInner=function(t){return arguments.length?(o=+t,f):o},f.tickSizeOuter=function(t){return arguments.length?(a=+t,f):a},f.tickPadding=function(t){return arguments.length?(s=+t,f):s},f}function rt(t){return nt(H,t)}function it(t){return nt(Y,t)}function ot(t){return nt(K,t)}function at(t){return nt(J,t)}var st={value:function(){}};function ut(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new ct(r)}function ct(t){this._=t}function lt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function ft(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=st,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}ct.prototype=ut.prototype={constructor:ct,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=ft(r[n],t.name,e);else if(null==e)for(n in r)r[n]=ft(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=lt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new ct(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var ht=ut,pt="http://www.w3.org/1999/xhtml",dt={svg:"http://www.w3.org/2000/svg",xhtml:pt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},vt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),dt.hasOwnProperty(e)?{space:dt[e],local:t}:t};var gt=function(t){var e=vt(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===pt&&e.documentElement.namespaceURI===pt?e.createElement(t):e.createElementNS(n,t)}})(e)};function mt(){}var yt=function(t){return null==t?mt:function(){return this.querySelector(t)}};function _t(){return[]}var bt=function(t){return null==t?_t:function(){return this.querySelectorAll(t)}},xt=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var wt=document.documentElement;if(!wt.matches){var Et=wt.webkitMatchesSelector||wt.msMatchesSelector||wt.mozMatchesSelector||wt.oMatchesSelector;xt=function(t){return function(){return Et.call(this,t)}}}}var St=xt,Pt=function(t){return new Array(t.length)};function Tt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Tt.prototype={constructor:Tt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var At="$";function kt(t,e,n,r,i,o){for(var a,s=0,u=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Tt(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function Ct(t,e,n,r,i,o,a){var s,u,c,l={},f=e.length,h=o.length,p=new Array(f);for(s=0;s<f;++s)(u=e[s])&&(p[s]=c=At+a.call(u,u.__data__,s,e),c in l?i[s]=u:l[c]=u);for(s=0;s<h;++s)(u=l[c=At+a.call(t,o[s],s,o)])?(r[s]=u,u.__data__=o[s],l[c]=null):n[s]=new Tt(t,o[s]);for(s=0;s<f;++s)(u=e[s])&&l[p[s]]===u&&(i[s]=u)}function Ot(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var Mt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function It(t,e){return t.style.getPropertyValue(e)||Mt(t).getComputedStyle(t,null).getPropertyValue(e)}function Lt(t){return t.trim().split(/^|\s+/)}function Rt(t){return t.classList||new jt(t)}function jt(t){this._node=t,this._names=Lt(t.getAttribute("class")||"")}function zt(t,e){for(var n=Rt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Dt(t,e){for(var n=Rt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}jt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ft(){this.textContent=""}function Nt(){this.innerHTML=""}function Bt(){this.nextSibling&&this.parentNode.appendChild(this)}function Ut(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Vt(){return null}function Gt(){var t=this.parentNode;t&&t.removeChild(this)}function qt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function Wt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var Zt={},Xt=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Zt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Ht(t,e,n){return t=Yt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Yt(t,e,n){return function(r){var i=Xt;Xt=r;try{t.call(this,this.__data__,e,n)}finally{Xt=i}}}function Kt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function Jt(t,e,n){var r=Zt.hasOwnProperty(t.type)?Ht:Yt;return function(i,o,a){var s,u=this.__on,c=r(e,o,a);if(u)for(var l=0,f=u.length;l<f;++l)if((s=u[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}function Qt(t,e,n,r){var i=Xt;t.sourceEvent=Xt,Xt=t;try{return e.apply(n,r)}finally{Xt=i}}function $t(t,e,n){var r=Mt(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}var te=[null];function ee(t,e){this._groups=t,this._parents=e}function ne(){return new ee([[document.documentElement]],te)}ee.prototype=ne.prototype={constructor:ee,select:function(t){"function"!=typeof t&&(t=yt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],u=s.length,c=r[i]=new Array(u),l=0;l<u;++l)(o=s[l])&&(a=t.call(o,o.__data__,l,s))&&("__data__"in o&&(a.__data__=o.__data__),c[l]=a);return new ee(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=bt(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],u=s.length,c=0;c<u;++c)(a=s[c])&&(r.push(t.call(a,a.__data__,c,s)),i.push(a));return new ee(r,i)},filter:function(t){"function"!=typeof t&&(t=St(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new ee(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each(function(t){p[++c]=t}),p;var n=e?Ct:kt,r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),c=0;c<o;++c){var l=r[c],f=i[c],h=f.length,p=t.call(l,l&&l.__data__,c,r),d=p.length,v=s[c]=new Array(d),g=a[c]=new Array(d);n(l,f,v,g,u[c]=new Array(h),p,e);for(var m,y,_=0,b=0;_<d;++_)if(m=v[_]){for(_>=b&&(b=_+1);!(y=g[b])&&++b<d;);m._next=y||null}}return(a=new ee(a,r))._enter=s,a._exit=u,a},enter:function(){return new ee(this._enter||this._groups.map(Pt),this._parents)},exit:function(){return new ee(this._exit||this._groups.map(Pt),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],l=n[s],f=c.length,h=a[s]=new Array(f),p=0;p<f;++p)(u=c[p]||l[p])&&(h[p]=u);for(;s<r;++s)a[s]=e[s];return new ee(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ot);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,c=i[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(e)}return new ee(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=vt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):It(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=Lt(t+"");if(arguments.length<2){for(var r=Rt(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?zt:Dt)(this,t)}}:e?function(t){return function(){zt(this,t)}}:function(t){return function(){Dt(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?Ft:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Nt:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(Bt)},lower:function(){return this.each(Ut)},append:function(t){var e="function"==typeof t?t:gt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:gt(t),r=null==e?Vt:"function"==typeof e?e:yt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Gt)},clone:function(t){return this.select(t?Wt:qt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?Jt:Kt,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(r=0,u=s[c];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return $t(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return $t(this,t,e)}})(t,e))}};var re=ne,ie=function(t){return"string"==typeof t?new ee([[document.querySelector(t)]],[document.documentElement]):new ee([[t]],te)},oe=function(t){return ie(gt(t).call(document.documentElement))},ae=0;function se(){return new ue}function ue(){this._="@"+(++ae).toString(36)}ue.prototype=se.prototype={constructor:ue,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var ce=function(){for(var t,e=Xt;t=e.sourceEvent;)e=t;return e},le=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},fe=function(t){var e=ce();return e.changedTouches&&(e=e.changedTouches[0]),le(t,e)},he=function(t){return"string"==typeof t?new ee([document.querySelectorAll(t)],[document.documentElement]):new ee([null==t?[]:t],te)},pe=function(t,e,n){arguments.length<3&&(n=e,e=ce().changedTouches);for(var r,i=0,o=e?e.length:0;i<o;++i)if((r=e[i]).identifier===n)return le(t,r);return null},de=function(t,e){null==e&&(e=ce().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=le(t,e[n]);return i};function ve(){Xt.stopImmediatePropagation()}var ge=function(){Xt.preventDefault(),Xt.stopImmediatePropagation()},me=function(t){var e=t.document.documentElement,n=ie(t).on("dragstart.drag",ge,!0);"onselectstart"in e?n.on("selectstart.drag",ge,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function ye(t,e){var n=t.document.documentElement,r=ie(t).on("dragstart.drag",null);e&&(r.on("click.drag",ge,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var _e=function(t){return function(){return t}};function be(t,e,n,r,i,o,a,s,u,c){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=a,this.dx=s,this.dy=u,this._=c}function xe(){return!Xt.button}function we(){return this.parentNode}function Ee(t){return null==t?{x:Xt.x,y:Xt.y}:t}function Se(){return"ontouchstart"in this}be.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Pe=function(){var t,e,n,r,i=xe,o=we,a=Ee,s=Se,u={},c=ht("start","drag","end"),l=0,f=0;function h(t){t.on("mousedown.drag",p).filter(s).on("touchstart.drag",g).on("touchmove.drag",m).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(){if(!r&&i.apply(this,arguments)){var a=_("mouse",o.apply(this,arguments),fe,this,arguments);a&&(ie(Xt.view).on("mousemove.drag",d,!0).on("mouseup.drag",v,!0),me(Xt.view),ve(),n=!1,t=Xt.clientX,e=Xt.clientY,a("start"))}}function d(){if(ge(),!n){var r=Xt.clientX-t,i=Xt.clientY-e;n=r*r+i*i>f}u.mouse("drag")}function v(){ie(Xt.view).on("mousemove.drag mouseup.drag",null),ye(Xt.view,n),ge(),u.mouse("end")}function g(){if(i.apply(this,arguments)){var t,e,n=Xt.changedTouches,r=o.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=_(n[t].identifier,r,pe,this,arguments))&&(ve(),e("start"))}}function m(){var t,e,n=Xt.changedTouches,r=n.length;for(t=0;t<r;++t)(e=u[n[t].identifier])&&(ge(),e("drag"))}function y(){var t,e,n=Xt.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),t=0;t<i;++t)(e=u[n[t].identifier])&&(ve(),e("end"))}function _(t,e,n,r,i){var o,s,f,p=n(e,t),d=c.copy();if(Qt(new be(h,"beforestart",o,t,l,p[0],p[1],0,0,d),function(){return null!=(Xt.subject=o=a.apply(r,i))&&(s=o.x-p[0]||0,f=o.y-p[1]||0,!0)}))return function a(c){var v,g=p;switch(c){case"start":u[t]=a,v=l++;break;case"end":delete u[t],--l;case"drag":p=n(e,t),v=l}Qt(new be(h,c,o,t,v,p[0]+s,p[1]+f,p[0]-g[0],p[1]-g[1],d),d.apply,d,[c,r,i])}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:_e(!!t),h):i},h.container=function(t){return arguments.length?(o="function"==typeof t?t:_e(t),h):o},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:_e(t),h):a},h.touchable=function(t){return arguments.length?(s="function"==typeof t?t:_e(!!t),h):s},h.on=function(){var t=c.on.apply(c,arguments);return t===c?h:t},h.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,h):Math.sqrt(f)},h},Te=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Ae(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ke(){}var Ce="\\s*([+-]?\\d+)\\s*",Oe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Me="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ie=/^#([0-9a-f]{3})$/,Le=/^#([0-9a-f]{6})$/,Re=new RegExp("^rgb\\("+[Ce,Ce,Ce]+"\\)$"),je=new RegExp("^rgb\\("+[Me,Me,Me]+"\\)$"),ze=new RegExp("^rgba\\("+[Ce,Ce,Ce,Oe]+"\\)$"),De=new RegExp("^rgba\\("+[Me,Me,Me,Oe]+"\\)$"),Fe=new RegExp("^hsl\\("+[Oe,Me,Me]+"\\)$"),Ne=new RegExp("^hsla\\("+[Oe,Me,Me,Oe]+"\\)$"),Be={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ue(t){var e;return t=(t+"").trim().toLowerCase(),(e=Ie.exec(t))?new Ze((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Le.exec(t))?Ve(parseInt(e[1],16)):(e=Re.exec(t))?new Ze(e[1],e[2],e[3],1):(e=je.exec(t))?new Ze(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ze.exec(t))?Ge(e[1],e[2],e[3],e[4]):(e=De.exec(t))?Ge(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Fe.exec(t))?He(e[1],e[2]/100,e[3]/100,1):(e=Ne.exec(t))?He(e[1],e[2]/100,e[3]/100,e[4]):Be.hasOwnProperty(t)?Ve(Be[t]):"transparent"===t?new Ze(NaN,NaN,NaN,0):null}function Ve(t){return new Ze(t>>16&255,t>>8&255,255&t,1)}function Ge(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ze(t,e,n,r)}function qe(t){return t instanceof ke||(t=Ue(t)),t?new Ze((t=t.rgb()).r,t.g,t.b,t.opacity):new Ze}function We(t,e,n,r){return 1===arguments.length?qe(t):new Ze(t,e,n,null==r?1:r)}function Ze(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Xe(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function He(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ke(t,e,n,r)}function Ye(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Ke)return new Ke(t.h,t.s,t.l,t.opacity);if(t instanceof ke||(t=Ue(t)),!t)return new Ke;if(t instanceof Ke)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Ke(a,s,u,t.opacity)}(t):new Ke(t,e,n,null==r?1:r)}function Ke(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Je(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Te(ke,Ue,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Te(Ze,We,Ae(ke,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ze(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ze(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Xe(this.r)+Xe(this.g)+Xe(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Te(Ke,Ye,Ae(ke,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ke(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ke(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ze(Je(t>=240?t-240:t+120,i,r),Je(t,i,r),Je(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Qe=Math.PI/180,$e=180/Math.PI,tn=.96422,en=1,nn=.82521,rn=4/29,on=6/29,an=3*on*on,sn=on*on*on;function un(t){if(t instanceof fn)return new fn(t.l,t.a,t.b,t.opacity);if(t instanceof _n){if(isNaN(t.h))return new fn(t.l,0,0,t.opacity);var e=t.h*Qe;return new fn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Ze||(t=qe(t));var n,r,i=vn(t.r),o=vn(t.g),a=vn(t.b),s=hn((.2225045*i+.7168786*o+.0606169*a)/en);return i===o&&o===a?n=r=s:(n=hn((.4360747*i+.3850649*o+.1430804*a)/tn),r=hn((.0139322*i+.0971045*o+.7141733*a)/nn)),new fn(116*s-16,500*(n-s),200*(s-r),t.opacity)}function cn(t,e){return new fn(t,0,0,null==e?1:e)}function ln(t,e,n,r){return 1===arguments.length?un(t):new fn(t,e,n,null==r?1:r)}function fn(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function hn(t){return t>sn?Math.pow(t,1/3):t/an+rn}function pn(t){return t>on?t*t*t:an*(t-rn)}function dn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function vn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function gn(t){if(t instanceof _n)return new _n(t.h,t.c,t.l,t.opacity);if(t instanceof fn||(t=un(t)),0===t.a&&0===t.b)return new _n(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*$e;return new _n(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function mn(t,e,n,r){return 1===arguments.length?gn(t):new _n(n,e,t,null==r?1:r)}function yn(t,e,n,r){return 1===arguments.length?gn(t):new _n(t,e,n,null==r?1:r)}function _n(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}Te(fn,ln,Ae(ke,{brighter:function(t){return new fn(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new fn(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Ze(dn(3.1338561*(e=tn*pn(e))-1.6168667*(t=en*pn(t))-.4906146*(n=nn*pn(n))),dn(-.9787684*e+1.9161415*t+.033454*n),dn(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Te(_n,yn,Ae(ke,{brighter:function(t){return new _n(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new _n(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return un(this).rgb()}}));var bn=-.29227,xn=-.90649,wn=1.97294,En=wn*xn,Sn=1.78277*wn,Pn=1.78277*bn- -.14861*xn;function Tn(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof An)return new An(t.h,t.s,t.l,t.opacity);t instanceof Ze||(t=qe(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Pn*r+En*e-Sn*n)/(Pn+En-Sn),o=r-i,a=(wn*(n-i)-bn*o)/xn,s=Math.sqrt(a*a+o*o)/(wn*i*(1-i)),u=s?Math.atan2(a,o)*$e-120:NaN;return new An(u<0?u+360:u,s,i,t.opacity)}(t):new An(t,e,n,null==r?1:r)}function An(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function kn(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Te(An,Tn,Ae(ke,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new An(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new An(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Qe,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Ze(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(bn*r+xn*i)),255*(e+n*(wn*r)),this.opacity)}}));var Cn=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return kn((n-r/e)*e,a,i,o,s)}},On=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return kn((n-r/e)*e,i,o,a,s)}},Mn=function(t){return function(){return t}};function In(t,e){return function(n){return t+n*e}}function Ln(t,e){var n=e-t;return n?In(t,n>180||n<-180?n-360*Math.round(n/360):n):Mn(isNaN(t)?e:t)}function Rn(t){return 1==(t=+t)?jn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Mn(isNaN(e)?n:e)}}function jn(t,e){var n=e-t;return n?In(t,n):Mn(isNaN(t)?e:t)}var zn=function t(e){var n=Rn(e);function r(t,e){var r=n((t=We(t)).r,(e=We(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=jn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function Dn(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=We(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var Fn=Dn(Cn),Nn=Dn(On),Bn=function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Jn(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}},Un=function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}},Vn=function(t,e){return e-=t=+t,function(n){return t+e*n}},Gn=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Jn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},qn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wn=new RegExp(qn.source,"g");var Zn,Xn,Hn,Yn,Kn=function(t,e){var n,r,i,o=qn.lastIndex=Wn.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=qn.exec(t))&&(r=Wn.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Vn(n,r)})),o=Wn.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Jn=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Mn(e):("number"===r?Vn:"string"===r?(n=Ue(e))?(e=n,zn):Kn:e instanceof Ue?zn:e instanceof Date?Un:Array.isArray(e)?Bn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Gn:Vn)(t,e)},Qn=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},$n=function(t,e){var n=Ln(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},tr=function(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}},er=180/Math.PI,nr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},rr=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*er,skewX:Math.atan(u)*er,scaleX:a,scaleY:s}};function ir(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:Vn(t,i)},{i:u-2,x:Vn(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Vn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Vn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Vn(t,n)},{i:s-2,x:Vn(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var or=ir(function(t){return"none"===t?nr:(Zn||(Zn=document.createElement("DIV"),Xn=document.documentElement,Hn=document.defaultView),Zn.style.transform=t,t=Hn.getComputedStyle(Xn.appendChild(Zn),null).getPropertyValue("transform"),Xn.removeChild(Zn),t=t.slice(7,-1).split(","),rr(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),ar=ir(function(t){return null==t?nr:(Yn||(Yn=document.createElementNS("http://www.w3.org/2000/svg","g")),Yn.setAttribute("transform",t),(t=Yn.transform.baseVal.consolidate())?(t=t.matrix,rr(t.a,t.b,t.c,t.d,t.e,t.f)):nr)},", ",")",")"),sr=Math.SQRT2;function ur(t){return((t=Math.exp(t))+1/t)/2}var cr=function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=e[0],u=e[1],c=e[2],l=s-i,f=u-o,h=l*l+f*f;if(h<1e-12)r=Math.log(c/a)/sr,n=function(t){return[i+t*l,o+t*f,a*Math.exp(sr*t*r)]};else{var p=Math.sqrt(h),d=(c*c-a*a+4*h)/(2*a*2*p),v=(c*c-a*a-4*h)/(2*c*2*p),g=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(v*v+1)-v);r=(m-g)/sr,n=function(t){var e=t*r,n=ur(g),s=a/(2*p)*(n*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(sr*e+g)-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+s*l,o+s*f,a*n/ur(sr*e+g)]}}return n.duration=1e3*r,n};function lr(t){return function(e,n){var r=t((e=Ye(e)).h,(n=Ye(n)).h),i=jn(e.s,n.s),o=jn(e.l,n.l),a=jn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var fr=lr(Ln),hr=lr(jn);function pr(t,e){var n=jn((t=ln(t)).l,(e=ln(e)).l),r=jn(t.a,e.a),i=jn(t.b,e.b),o=jn(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function dr(t){return function(e,n){var r=t((e=yn(e)).h,(n=yn(n)).h),i=jn(e.c,n.c),o=jn(e.l,n.l),a=jn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var vr=dr(Ln),gr=dr(jn);function mr(t){return function e(n){function r(e,r){var i=t((e=Tn(e)).h,(r=Tn(r)).h),o=jn(e.s,r.s),a=jn(e.l,r.l),s=jn(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}var yr=mr(Ln),_r=mr(jn);function br(t,e){for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}var xr,wr,Er=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n},Sr=0,Pr=0,Tr=0,Ar=1e3,kr=0,Cr=0,Or=0,Mr="object"==typeof performance&&performance.now?performance:Date,Ir="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Lr(){return Cr||(Ir(Rr),Cr=Mr.now()+Or)}function Rr(){Cr=0}function jr(){this._call=this._time=this._next=null}function zr(t,e,n){var r=new jr;return r.restart(t,e,n),r}function Dr(){Lr(),++Sr;for(var t,e=xr;e;)(t=Cr-e._time)>=0&&e._call.call(null,t),e=e._next;--Sr}function Fr(){Cr=(kr=Mr.now())+Or,Sr=Pr=0;try{Dr()}finally{Sr=0,function(){var t,e,n=xr,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:xr=e);wr=t,Br(r)}(),Cr=0}}function Nr(){var t=Mr.now(),e=t-kr;e>Ar&&(Or-=e,kr=t)}function Br(t){Sr||(Pr&&(Pr=clearTimeout(Pr)),t-Cr>24?(t<1/0&&(Pr=setTimeout(Fr,t-Mr.now()-Or)),Tr&&(Tr=clearInterval(Tr))):(Tr||(kr=Mr.now(),Tr=setInterval(Nr,Ar)),Sr=1,Ir(Fr)))}jr.prototype=zr.prototype={constructor:jr,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Lr():+n)+(null==e?0:+e),this._next||wr===this||(wr?wr._next=this:xr=this,wr=this),this._call=t,this._time=n,Br()},stop:function(){this._call&&(this._call=null,this._time=1/0,Br())}};var Ur=function(t,e,n){var r=new jr;return e=null==e?0:+e,r.restart(function(n){r.stop(),t(n+e)},e,n),r},Vr=function(t,e,n){var r=new jr,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?Lr():+n,r.restart(function o(a){a+=i,r.restart(o,i+=e,n),t(a)},e,n),r)},Gr=ht("start","end","interrupt"),qr=[],Wr=0,Zr=1,Xr=2,Hr=3,Yr=4,Kr=5,Jr=6,Qr=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(u){var c,l,f,h;if(n.state!==Zr)return s();for(c in i)if((h=i[c]).name===n.name){if(h.state===Hr)return Ur(o);h.state===Yr?(h.state=Jr,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[c]):+c<e&&(h.state=Jr,h.timer.stop(),delete i[c])}if(Ur(function(){n.state===Hr&&(n.state=Yr,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Xr,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Xr){for(n.state=Hr,r=new Array(f=n.tween.length),c=0,l=-1;c<f;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++l]=h);r.length=l+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=Kr,1),o=-1,a=r.length;++o<a;)r[o].call(null,i);n.state===Kr&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=Jr,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=zr(function(t){n.state=Zr,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:i,on:Gr,tween:qr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Wr})};function $r(t,e){var n=ei(t,e);if(n.state>Wr)throw new Error("too late; already scheduled");return n}function ti(t,e){var n=ei(t,e);if(n.state>Xr)throw new Error("too late; already started");return n}function ei(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var ni=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>Xr&&n.state<Kr,n.state=Jr,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}};function ri(t,e,n){var r=t._id;return t.each(function(){var t=ti(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return ei(t,r).value[e]}}var ii=function(t,e){var n;return("number"==typeof e?Vn:e instanceof Ue?zn:(n=Ue(e))?(e=n,zn):Kn)(t,e)};var oi=re.prototype.constructor;var ai=0;function si(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function ui(t){return re().transition(t)}function ci(){return++ai}var li=re.prototype;function fi(t){return+t}function hi(t){return t*t}function pi(t){return t*(2-t)}function di(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function vi(t){return t*t*t}function gi(t){return--t*t*t+1}function mi(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}si.prototype=ui.prototype={constructor:si,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=yt(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s,u,c=r[a],l=c.length,f=o[a]=new Array(l),h=0;h<l;++h)(s=c[h])&&(u=t.call(s,s.__data__,h,c))&&("__data__"in s&&(u.__data__=s.__data__),f[h]=u,Qr(f[h],e,n,h,f,ei(s,n)));return new si(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=bt(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u,c=r[s],l=c.length,f=0;f<l;++f)if(u=c[f]){for(var h,p=t.call(u,u.__data__,f,c),d=ei(u,n),v=0,g=p.length;v<g;++v)(h=p[v])&&Qr(h,e,n,v,p,d);o.push(p),a.push(u)}return new si(o,a,e,n)},filter:function(t){"function"!=typeof t&&(t=St(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new si(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u,c=e[s],l=n[s],f=c.length,h=a[s]=new Array(f),p=0;p<f;++p)(u=c[p]||l[p])&&(h[p]=u);for(;s<r;++s)a[s]=e[s];return new si(a,this._parents,this._name,this._id)},selection:function(){return new oi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=ci(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)if(a=s[c]){var l=ei(a,e);Qr(a,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new si(r,this._parents,t,n)},call:li.call,nodes:li.nodes,node:li.node,size:li.size,empty:li.empty,each:li.each,on:function(t,e){var n=this._id;return arguments.length<2?ei(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?$r:ti;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=vt(t),r="transform"===n?ar:ii;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var r,i,o;return function(){var a,s=n(this);if(null!=s)return(a=this.getAttributeNS(t.space,t.local))===s?null:a===r&&s===i?o:o=e(r=a,i=s);this.removeAttributeNS(t.space,t.local)}}:function(t,e,n){var r,i,o;return function(){var a,s=n(this);if(null!=s)return(a=this.getAttribute(t))===s?null:a===r&&s===i?o:o=e(r=a,i=s);this.removeAttribute(t)}})(n,r,ri(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var r,i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===n?null:o===r?i:i=e(r=o,n)}}:function(t,e,n){var r,i;return function(){var o=this.getAttribute(t);return o===n?null:o===r?i:i=e(r=o,n)}})(n,r,e+""))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=vt(t);return this.tween(n,(r.local?function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}:function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n})(r,e))},style:function(t,e,n){var r="transform"==(t+="")?or:ii;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=It(this,t),a=(this.style.removeProperty(t),It(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,function(t){return function(){this.style.removeProperty(t)}}(t)):this.styleTween(t,"function"==typeof e?function(t,e,n){var r,i,o;return function(){var a=It(this,t),s=n(this);return null==s&&(this.style.removeProperty(t),s=It(this,t)),a===s?null:a===r&&s===i?o:o=e(r=a,i=s)}}(t,r,ri(this,"style."+t,e)):function(t,e,n){var r,i;return function(){var o=It(this,t);return o===n?null:o===r?i:i=e(r=o,n)}}(t,r,e+""),n)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ri(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=ei(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?function(t,e){var n,r;return function(){var i=ti(this,t),o=i.tween;if(o!==n)for(var a=0,s=(r=n=o).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}:function(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=ti(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=s;break}u===c&&i.push(s)}o.tween=i}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){$r(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){$r(this,t).delay=e}})(e,t)):ei(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){ti(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){ti(this,t).duration=e}})(e,t)):ei(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){ti(this,t).ease=e}}(e,t)):ei(this.node(),e).ease}};var yi=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),_i=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),bi=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),xi=Math.PI,wi=xi/2;function Ei(t){return 1-Math.cos(t*wi)}function Si(t){return Math.sin(t*wi)}function Pi(t){return(1-Math.cos(xi*t))/2}function Ti(t){return Math.pow(2,10*t-10)}function Ai(t){return 1-Math.pow(2,-10*t)}function ki(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Ci(t){return 1-Math.sqrt(1-t*t)}function Oi(t){return Math.sqrt(1- --t*t)}function Mi(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Ii=4/11,Li=6/11,Ri=8/11,ji=.75,zi=9/11,Di=10/11,Fi=.9375,Ni=21/22,Bi=63/64,Ui=1/Ii/Ii;function Vi(t){return 1-Gi(1-t)}function Gi(t){return(t=+t)<Ii?Ui*t*t:t<Ri?Ui*(t-=Li)*t+ji:t<Di?Ui*(t-=zi)*t+Fi:Ui*(t-=Ni)*t+Bi}function qi(t){return((t*=2)<=1?1-Gi(1-t):Gi(t-1)+1)/2}var Wi=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(1.70158),Zi=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(1.70158),Xi=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158),Hi=2*Math.PI,Yi=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Hi);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*Hi)},i.period=function(n){return t(e,n)},i}(1,.3),Ki=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Hi);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*Hi)},i.period=function(n){return t(e,n)},i}(1,.3),Ji=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Hi);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*Hi)},i.period=function(n){return t(e,n)},i}(1,.3),Qi={time:null,delay:0,duration:250,ease:mi};function $i(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Qi.time=Lr(),Qi;return n}re.prototype.interrupt=function(t){return this.each(function(){ni(this,t)})},re.prototype.transition=function(t){var e,n;t instanceof si?(e=t._id,t=t._name):(e=ci(),(n=Qi).time=Lr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,s=r[o],u=s.length,c=0;c<u;++c)(a=s[c])&&Qr(a,t,e,c,s,n||$i(a,e));return new si(r,this._parents,t,e)};var to=[null],eo=function(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>Zr&&n.name===e)return new si([[t]],to,e,+r);return null},no=function(t){return function(){return t}},ro=function(t,e,n){this.target=t,this.type=e,this.selection=n};function io(){Xt.stopImmediatePropagation()}var oo=function(){Xt.preventDefault(),Xt.stopImmediatePropagation()},ao={name:"drag"},so={name:"space"},uo={name:"handle"},co={name:"center"},lo={name:"x",handles:["e","w"].map(_o),input:function(t,e){return t&&[[t[0],e[0][1]],[t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},fo={name:"y",handles:["n","s"].map(_o),input:function(t,e){return t&&[[e[0][0],t[0]],[e[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},ho={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(_o),input:function(t){return t},output:function(t){return t}},po={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},vo={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},go={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},mo={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},yo={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function _o(t){return{type:t}}function bo(){return!Xt.button}function xo(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function wo(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Eo(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function So(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function Po(){return ko(lo)}function To(){return ko(fo)}var Ao=function(){return ko(ho)};function ko(t){var e,n=xo,r=bo,i=ht(a,"start","brush","end"),o=6;function a(e){var n=e.property("__brush",f).selectAll(".overlay").data([_o("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",po.overlay).merge(n).each(function(){var t=wo(this).extent;ie(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),e.selectAll(".selection").data([_o("selection")]).enter().append("rect").attr("class","selection").attr("cursor",po.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,function(t){return t.type});r.exit().remove(),r.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return po[t.type]}),e.each(s).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",l)}function s(){var t=ie(this),e=wo(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-o/2:e[0][0]-o/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-o/2:e[0][1]-o/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+o:o}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+o:o})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e){return t.__brush.emitter||new c(t,e)}function c(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function l(){if(Xt.touches){if(Xt.changedTouches.length<Xt.touches.length)return oo()}else if(e)return;if(r.apply(this,arguments)){var n,i,o,a,c,l,f,h,p,d,v,g,m,y=this,_=Xt.target.__data__.type,b="selection"===(Xt.metaKey?_="overlay":_)?ao:Xt.altKey?co:uo,x=t===fo?null:mo[_],w=t===lo?null:yo[_],E=wo(y),S=E.extent,P=E.selection,T=S[0][0],A=S[0][1],k=S[1][0],C=S[1][1],O=x&&w&&Xt.shiftKey,M=fe(y),I=M,L=u(y,arguments).beforestart();"overlay"===_?E.selection=P=[[n=t===fo?T:M[0],o=t===lo?A:M[1]],[c=t===fo?k:n,f=t===lo?C:o]]:(n=P[0][0],o=P[0][1],c=P[1][0],f=P[1][1]),i=n,a=o,l=c,h=f;var R=ie(y).attr("pointer-events","none"),j=R.selectAll(".overlay").attr("cursor",po[_]);if(Xt.touches)R.on("touchmove.brush",D,!0).on("touchend.brush touchcancel.brush",N,!0);else{var z=ie(Xt.view).on("keydown.brush",function(){switch(Xt.keyCode){case 16:O=x&&w;break;case 18:b===uo&&(x&&(c=l-p*x,n=i+p*x),w&&(f=h-d*w,o=a+d*w),b=co,F());break;case 32:b!==uo&&b!==co||(x<0?c=l-p:x>0&&(n=i-p),w<0?f=h-d:w>0&&(o=a-d),b=so,j.attr("cursor",po.selection),F());break;default:return}oo()},!0).on("keyup.brush",function(){switch(Xt.keyCode){case 16:O&&(g=m=O=!1,F());break;case 18:b===co&&(x<0?c=l:x>0&&(n=i),w<0?f=h:w>0&&(o=a),b=uo,F());break;case 32:b===so&&(Xt.altKey?(x&&(c=l-p*x,n=i+p*x),w&&(f=h-d*w,o=a+d*w),b=co):(x<0?c=l:x>0&&(n=i),w<0?f=h:w>0&&(o=a),b=uo),j.attr("cursor",po[_]),F());break;default:return}oo()},!0).on("mousemove.brush",D,!0).on("mouseup.brush",N,!0);me(Xt.view)}io(),ni(y),s.call(y),L.start()}function D(){var t=fe(y);!O||g||m||(Math.abs(t[0]-I[0])>Math.abs(t[1]-I[1])?m=!0:g=!0),I=t,v=!0,oo(),F()}function F(){var t;switch(p=I[0]-M[0],d=I[1]-M[1],b){case so:case ao:x&&(p=Math.max(T-n,Math.min(k-c,p)),i=n+p,l=c+p),w&&(d=Math.max(A-o,Math.min(C-f,d)),a=o+d,h=f+d);break;case uo:x<0?(p=Math.max(T-n,Math.min(k-n,p)),i=n+p,l=c):x>0&&(p=Math.max(T-c,Math.min(k-c,p)),i=n,l=c+p),w<0?(d=Math.max(A-o,Math.min(C-o,d)),a=o+d,h=f):w>0&&(d=Math.max(A-f,Math.min(C-f,d)),a=o,h=f+d);break;case co:x&&(i=Math.max(T,Math.min(k,n-p*x)),l=Math.max(T,Math.min(k,c+p*x))),w&&(a=Math.max(A,Math.min(C,o-d*w)),h=Math.max(A,Math.min(C,f+d*w)))}l<i&&(x*=-1,t=n,n=c,c=t,t=i,i=l,l=t,_ in vo&&j.attr("cursor",po[_=vo[_]])),h<a&&(w*=-1,t=o,o=f,f=t,t=a,a=h,h=t,_ in go&&j.attr("cursor",po[_=go[_]])),E.selection&&(P=E.selection),g&&(i=P[0][0],l=P[1][0]),m&&(a=P[0][1],h=P[1][1]),P[0][0]===i&&P[0][1]===a&&P[1][0]===l&&P[1][1]===h||(E.selection=[[i,a],[l,h]],s.call(y),L.brush())}function N(){if(io(),Xt.touches){if(Xt.touches.length)return;e&&clearTimeout(e),e=setTimeout(function(){e=null},500),R.on("touchmove.brush touchend.brush touchcancel.brush",null)}else ye(Xt.view,v),z.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);R.attr("pointer-events","all"),j.attr("cursor",po.overlay),E.selection&&(P=E.selection),Eo(P)&&(E.selection=null,s.call(y)),L.end()}}function f(){var e=this.__brush||{selection:null};return e.extent=n.apply(this,arguments),e.dim=t,e}return a.move=function(e,n){e.selection?e.on("start.brush",function(){u(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){u(this,arguments).end()}).tween("brush",function(){var e=this,r=e.__brush,i=u(e,arguments),o=r.selection,a=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),c=Jn(o,a);function l(t){r.selection=1===t&&Eo(a)?null:c(t),s.call(e),i.brush()}return o&&a?l:l(1)}):e.each(function(){var e=arguments,r=this.__brush,i=t.input("function"==typeof n?n.apply(this,e):n,r.extent),o=u(this,e).beforestart();ni(this),r.selection=null==i||Eo(i)?null:i,s.call(this),o.start().brush().end()})},c.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){Qt(new ro(a,e,t.output(this.state.selection)),i.apply,i,[e,this.that,this.args])}},a.extent=function(t){return arguments.length?(n="function"==typeof t?t:no([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),a):n},a.filter=function(t){return arguments.length?(r="function"==typeof t?t:no(!!t),a):r},a.handleSize=function(t){return arguments.length?(o=+t,a):o},a.on=function(){var t=i.on.apply(i,arguments);return t===i?a:t},a}var Co=Math.cos,Oo=Math.sin,Mo=Math.PI,Io=Mo/2,Lo=2*Mo,Ro=Math.max;var jo=function(){var t=0,e=null,n=null,r=null;function i(i){var o,a,s,u,c,l,f=i.length,h=[],p=w(f),d=[],v=[],g=v.groups=new Array(f),m=new Array(f*f);for(o=0,c=-1;++c<f;){for(a=0,l=-1;++l<f;)a+=i[c][l];h.push(a),d.push(w(f)),o+=a}for(e&&p.sort(function(t,n){return e(h[t],h[n])}),n&&d.forEach(function(t,e){t.sort(function(t,r){return n(i[e][t],i[e][r])})}),u=(o=Ro(0,Lo-t*f)/o)?t:Lo/f,a=0,c=-1;++c<f;){for(s=a,l=-1;++l<f;){var y=p[c],_=d[y][l],b=i[y][_],x=a,E=a+=b*o;m[_*f+y]={index:y,subindex:_,startAngle:x,endAngle:E,value:b}}g[y]={index:y,startAngle:s,endAngle:a,value:h[y]},a+=u}for(c=-1;++c<f;)for(l=c-1;++l<f;){var S=m[l*f+c],P=m[c*f+l];(S.value||P.value)&&v.push(S.value<P.value?{source:P,target:S}:{source:S,target:P})}return r?v.sort(r):v}return i.padAngle=function(e){return arguments.length?(t=Ro(0,e),i):t},i.sortGroups=function(t){return arguments.length?(e=t,i):e},i.sortSubgroups=function(t){return arguments.length?(n=t,i):n},i.sortChords=function(t){return arguments.length?(null==t?r=null:(r=function(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}(t))._=t,i):r&&r._},i},zo=Array.prototype.slice,Do=function(t){return function(){return t}},Fo=Math.PI,No=2*Fo,Bo=No-1e-6;function Uo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Vo(){return new Uo}Uo.prototype=Vo.prototype={constructor:Uo,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,u=r-e,c=o-t,l=a-e,f=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>1e-6)if(Math.abs(l*s-u*c)>1e-6&&i){var h=n-o,p=r-a,d=s*s+u*u,v=h*h+p*p,g=Math.sqrt(d),m=Math.sqrt(f),y=i*Math.tan((Fo-Math.acos((d+f-v)/(2*g*m)))/2),_=y/m,b=y/g;Math.abs(_-1)>1e-6&&(this._+="L"+(t+_*c)+","+(e+_*l)),this._+="A"+i+","+i+",0,0,"+ +(l*h>c*p)+","+(this._x1=t+b*s)+","+(this._y1=e+b*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+a,c=e+s,l=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+u+","+c),n&&(f<0&&(f=f%No+No),f>Bo?this._+="A"+n+","+n+",0,1,"+l+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=Fo)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Go=Vo;function qo(t){return t.source}function Wo(t){return t.target}function Zo(t){return t.radius}function Xo(t){return t.startAngle}function Ho(t){return t.endAngle}var Yo=function(){var t=qo,e=Wo,n=Zo,r=Xo,i=Ho,o=null;function a(){var a,s=zo.call(arguments),u=t.apply(this,s),c=e.apply(this,s),l=+n.apply(this,(s[0]=u,s)),f=r.apply(this,s)-Io,h=i.apply(this,s)-Io,p=l*Co(f),d=l*Oo(f),v=+n.apply(this,(s[0]=c,s)),g=r.apply(this,s)-Io,m=i.apply(this,s)-Io;if(o||(o=a=Go()),o.moveTo(p,d),o.arc(0,0,l,f,h),f===g&&h===m||(o.quadraticCurveTo(0,0,v*Co(g),v*Oo(g)),o.arc(0,0,v,g,m)),o.quadraticCurveTo(0,0,p,d),o.closePath(),a)return o=null,a+""||null}return a.radius=function(t){return arguments.length?(n="function"==typeof t?t:Do(+t),a):n},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Do(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Do(+t),a):i},a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(t){return arguments.length?(e=t,a):e},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a};function Ko(){}function Jo(t,e){var n=new Ko;if(t instanceof Ko)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}Ko.prototype=Jo.prototype={constructor:Ko,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Qo=Jo,$o=function(){var t,e,n,r=[],i=[];function o(n,i,a,s){if(i>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var u,c,l,f=-1,h=n.length,p=r[i++],d=Qo(),v=a();++f<h;)(l=d.get(u=p(c=n[f])+""))?l.push(c):d.set(u,[c]);return d.each(function(t,e){s(v,e,o(t,i,a,s))}),v}return n={object:function(t){return o(t,0,ta,ea)},map:function(t){return o(t,0,na,ra)},entries:function(t){return function t(n,o){if(++o>r.length)return n;var a,s=i[o-1];return null!=e&&o>=r.length?a=n.entries():(a=[],n.each(function(e,n){a.push({key:n,values:t(e,o)})})),null!=s?a.sort(function(t,e){return s(t.key,e.key)}):a}(o(t,0,na,ra),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}};function ta(){return{}}function ea(t,e,n){t[e]=n}function na(){return Qo()}function ra(t,e,n){t.set(e,n)}function ia(){}var oa=Qo.prototype;function aa(t,e){var n=new ia;if(t instanceof ia)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}ia.prototype=aa.prototype={constructor:ia,has:oa.has,add:function(t){return this["$"+(t+="")]=t,this},remove:oa.remove,clear:oa.clear,values:oa.keys,size:oa.size,empty:oa.empty,each:oa.each};var sa=aa,ua=function(t){var e=[];for(var n in t)e.push(n);return e},ca=function(t){var e=[];for(var n in t)e.push(t[n]);return e},la=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},fa=Array.prototype.slice,ha=function(t,e){return t-e},pa=function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r},da=function(t){return function(){return t}},va=function(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=ga(t,e[r]))return n;return 0};function ga(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var u=t[o],c=u[0],l=u[1],f=t[s],h=f[0],p=f[1];if(ma(u,f,e))return 0;l>r!=p>r&&n<(h-c)*(r-l)/(p-l)+c&&(i=-i)}return i}function ma(t,e,n){var r;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&function(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}(t[r=+(t[0]===e[0])],n[r],e[r])}var ya=function(){},_a=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],ba=function(){var t=1,e=1,n=C,r=s;function i(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(ha);else{var r=g(t),i=r[0],a=r[1];e=k(i,a,e),e=w(Math.floor(i/e)*e,Math.floor(a/e)*e,e)}return e.map(function(e){return o(t,e)})}function o(n,i){var o=[],s=[];return function(n,r,i){var o,s,u,c,l,f,h=new Array,p=new Array;o=s=-1,c=n[0]>=r,_a[c<<1].forEach(d);for(;++o<t-1;)u=c,c=n[o+1]>=r,_a[u|c<<1].forEach(d);_a[c<<0].forEach(d);for(;++s<e-1;){for(o=-1,c=n[s*t+t]>=r,l=n[s*t]>=r,_a[c<<1|l<<2].forEach(d);++o<t-1;)u=c,c=n[s*t+t+o+1]>=r,f=l,l=n[s*t+o+1]>=r,_a[u|c<<1|l<<2|f<<3].forEach(d);_a[c|l<<3].forEach(d)}o=-1,l=n[s*t]>=r,_a[l<<2].forEach(d);for(;++o<t-1;)f=l,l=n[s*t+o+1]>=r,_a[l<<2|f<<3].forEach(d);function d(t){var e,n,r=[t[0][0]+o,t[0][1]+s],u=[t[1][0]+o,t[1][1]+s],c=a(r),l=a(u);(e=p[c])?(n=h[l])?(delete p[e.end],delete h[n.start],e===n?(e.ring.push(u),i(e.ring)):h[e.start]=p[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete p[e.end],e.ring.push(u),p[e.end=l]=e):(e=h[l])?(n=p[c])?(delete h[e.start],delete p[n.end],e===n?(e.ring.push(u),i(e.ring)):h[n.start]=p[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(r),h[e.start=c]=e):h[c]=p[l]={start:c,end:l,ring:[r,u]}}_a[l<<3].forEach(d)}(n,i,function(t){r(t,n,i),pa(t)>0?o.push([t]):s.push(t)}),s.forEach(function(t){for(var e,n=0,r=o.length;n<r;++n)if(-1!==va((e=o[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:i,coordinates:o}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,i){n.forEach(function(n){var o,a=n[0],s=n[1],u=0|a,c=0|s,l=r[c*t+u];a>0&&a<t&&u===a&&(o=r[c*t+u-1],n[0]=a+(i-o)/(l-o)-.5),s>0&&s<e&&c===s&&(o=r[(c-1)*t+u],n[1]=s+(i-o)/(l-o)-.5)})}return i.contour=o,i.size=function(n){if(!arguments.length)return[t,e];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>0&&o>0))throw new Error("invalid size");return t=r,e=o,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?da(fa.call(t)):da(t),i):n},i.smooth=function(t){return arguments.length?(r=t?s:ya,i):r===s},i};function xa(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),a=0;a<i;++a)for(var s=0,u=0;s<r+n;++s)s<r&&(u+=t.data[s+a*r]),s>=n&&(s>=o&&(u-=t.data[s-o+a*r]),e.data[s-n+a*r]=u/Math.min(s+1,r-1+o-s,o))}function wa(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),a=0;a<r;++a)for(var s=0,u=0;s<i+n;++s)s<i&&(u+=t.data[a+s*r]),s>=n&&(s>=o&&(u-=t.data[a+(s-o)*r]),e.data[a+(s-n)*r]=u/Math.min(s+1,i-1+o-s,o))}function Ea(t){return t[0]}function Sa(t){return t[1]}function Pa(){return 1}var Ta=function(){var t=Ea,e=Sa,n=Pa,r=960,i=500,o=20,a=2,s=3*o,u=r+2*s>>a,c=i+2*s>>a,l=da(20);function f(r){var i=new Float32Array(u*c),f=new Float32Array(u*c);r.forEach(function(r,o,l){var f=+t(r,o,l)+s>>a,h=+e(r,o,l)+s>>a,p=+n(r,o,l);f>=0&&f<u&&h>=0&&h<c&&(i[f+h*u]+=p)}),xa({width:u,height:c,data:i},{width:u,height:c,data:f},o>>a),wa({width:u,height:c,data:f},{width:u,height:c,data:i},o>>a),xa({width:u,height:c,data:i},{width:u,height:c,data:f},o>>a),wa({width:u,height:c,data:f},{width:u,height:c,data:i},o>>a),xa({width:u,height:c,data:i},{width:u,height:c,data:f},o>>a),wa({width:u,height:c,data:f},{width:u,height:c,data:i},o>>a);var p=l(i);if(!Array.isArray(p)){var d=R(i);p=k(0,d,p),(p=w(0,Math.floor(d/p)*p,p)).shift()}return ba().thresholds(p).size([u,c])(i).map(h)}function h(t){return t.value*=Math.pow(2,-2*a),t.coordinates.forEach(p),t}function p(t){t.forEach(d)}function d(t){t.forEach(v)}function v(t){t[0]=t[0]*Math.pow(2,a)-s,t[1]=t[1]*Math.pow(2,a)-s}function g(){return u=r+2*(s=3*o)>>a,c=i+2*s>>a,f}return f.x=function(e){return arguments.length?(t="function"==typeof e?e:da(+e),f):t},f.y=function(t){return arguments.length?(e="function"==typeof t?t:da(+t),f):e},f.weight=function(t){return arguments.length?(n="function"==typeof t?t:da(+t),f):n},f.size=function(t){if(!arguments.length)return[r,i];var e=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error("invalid size");return r=e,i=n,g()},f.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(t)/Math.LN2),g()},f.thresholds=function(t){return arguments.length?(l="function"==typeof t?t:Array.isArray(t)?da(fa.call(t)):da(t),f):l},f.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),g()},f},Aa={},ka={},Ca=34,Oa=10,Ma=13;function Ia(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}var La=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return ka;if(c)return c=!1,Aa;var e,r,i=a;if(t.charCodeAt(i)===Ca){for(;a++<o&&t.charCodeAt(a)!==Ca||t.charCodeAt(++a)===Ca;);return(e=a)>=o?u=!0:(r=t.charCodeAt(a++))===Oa?c=!0:r===Ma&&(c=!0,t.charCodeAt(a)===Oa&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===Oa)c=!0;else if(r===Ma)c=!0,t.charCodeAt(a)===Oa&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Oa&&--o,t.charCodeAt(o-1)===Ma&&--o;(r=l())!==ka;){for(var f=[];r!==Aa&&r!==ka;)f.push(r),r=l();e&&null==(f=e(f,s++))||i.push(f)}return i}function i(e){return e.map(o).join(t)}function o(t){return null==t?"":e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Ia(t);return function(r,i){return e(n(r),i,t)}}(t,e):Ia(t)});return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=function(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}(e)),[n.map(o).join(t)].concat(e.map(function(e){return n.map(function(t){return o(e[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(i).join("\n")}}},Ra=La(","),ja=Ra.parse,za=Ra.parseRows,Da=Ra.format,Fa=Ra.formatRows,Na=La("\t"),Ba=Na.parse,Ua=Na.parseRows,Va=Na.format,Ga=Na.formatRows;function qa(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}var Wa=function(t,e){return fetch(t,e).then(qa)};function Za(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}var Xa=function(t,e){return fetch(t,e).then(Za)};function Ha(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var Ya=function(t,e){return fetch(t,e).then(Ha)};function Ka(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),Ya(e,n).then(function(e){return t(e,r)})}}function Ja(t,e,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var i=La(t);return Ya(e,n).then(function(t){return i.parse(t,r)})}var Qa=Ka(ja),$a=Ka(Ba),ts=function(t,e){return new Promise(function(n,r){var i=new Image;for(var o in e)i[o]=e[o];i.onerror=r,i.onload=function(){n(i)},i.src=t})};function es(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}var ns=function(t,e){return fetch(t,e).then(es)};function rs(t){return function(e,n){return Ya(e,n).then(function(e){return(new DOMParser).parseFromString(e,t)})}}var is=rs("application/xml"),os=rs("text/html"),as=rs("image/svg+xml"),ss=function(t,e){var n;function r(){var r,i,o=n.length,a=0,s=0;for(r=0;r<o;++r)a+=(i=n[r]).x,s+=i.y;for(a=a/o-t,s=s/o-e,r=0;r<o;++r)(i=n[r]).x-=a,i.y-=s}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r},us=function(t){return function(){return t}},cs=function(){return 1e-6*(Math.random()-.5)};function ls(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,c,l,f,h,p=t._root,d={data:r},v=t._x0,g=t._y0,m=t._x1,y=t._y1;if(!p)return t._root=d,t;for(;p.length;)if((c=e>=(o=(v+m)/2))?v=o:m=o,(l=n>=(a=(g+y)/2))?g=a:y=a,i=p,!(p=p[f=l<<1|c]))return i[f]=d,t;if(s=+t._x.call(null,p.data),u=+t._y.call(null,p.data),e===s&&n===u)return d.next=p,i?i[f]=d:t._root=d,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(c=e>=(o=(v+m)/2))?v=o:m=o,(l=n>=(a=(g+y)/2))?g=a:y=a}while((f=l<<1|c)==(h=(u>=a)<<1|s>=o));return i[h]=p,i[f]=d,t}var fs=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function hs(t){return t[0]}function ps(t){return t[1]}function ds(t,e,n){var r=new vs(null==e?hs:e,null==n?ps:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function vs(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function gs(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var ms=ds.prototype=vs.prototype;function ys(t){return t.x+t.vx}function _s(t){return t.y+t.vy}ms.copy=function(){var t,e,n=new vs(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=gs(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=gs(e));return n},ms.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return ls(this.cover(e,n),e,n,t)},ms.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>f&&(f=i));for(l<u&&(u=this._x0,l=this._x1),f<c&&(c=this._y0,f=this._y1),this.cover(u,c).cover(l,f),n=0;n<o;++n)ls(this,a[n],s[n],t[n]);return this},ms.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{if(!(n>t||t>i||r>e||e>o))return this;var a,s,u=i-n,c=this._root;switch(s=(e<(r+o)/2)<<1|t<(n+i)/2){case 0:do{(a=new Array(4))[s]=c,c=a}while(o=r+(u*=2),t>(i=n+u)||e>o);break;case 1:do{(a=new Array(4))[s]=c,c=a}while(o=r+(u*=2),(n=i-u)>t||e>o);break;case 2:do{(a=new Array(4))[s]=c,c=a}while(r=o-(u*=2),t>(i=n+u)||r>e);break;case 3:do{(a=new Array(4))[s]=c,c=a}while(r=o-(u*=2),(n=i-u)>t||r>e)}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},ms.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},ms.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ms.find=function(t,e,n){var r,i,o,a,s,u,c,l=this._x0,f=this._y0,h=this._x1,p=this._y1,d=[],v=this._root;for(v&&d.push(new fs(v,l,f,h,p)),null==n?n=1/0:(l=t-n,f=e-n,h=t+n,p=e+n,n*=n);u=d.pop();)if(!(!(v=u.node)||(i=u.x0)>h||(o=u.y0)>p||(a=u.x1)<l||(s=u.y1)<f))if(v.length){var g=(i+a)/2,m=(o+s)/2;d.push(new fs(v[3],g,m,a,s),new fs(v[2],i,m,g,s),new fs(v[1],g,o,a,m),new fs(v[0],i,o,g,m)),(c=(e>=m)<<1|t>=g)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-c],d[d.length-1-c]=u)}else{var y=t-+this._x.call(null,v.data),_=e-+this._y.call(null,v.data),b=y*y+_*_;if(b<n){var x=Math.sqrt(n=b);l=t-x,f=e-x,h=t+x,p=e+x,r=v.data}}return r},ms.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,c,l,f,h,p=this._root,d=this._x0,v=this._y0,g=this._x1,m=this._y1;if(!p)return this;if(p.length)for(;;){if((c=o>=(s=(d+g)/2))?d=s:g=s,(l=a>=(u=(v+m)/2))?v=u:m=u,e=p,!(p=p[f=l<<1|c]))return this;if(!p.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,h=f)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(p=e[0]||e[1]||e[2]||e[3])&&p===(e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[h]=p:this._root=p),this):(this._root=i,this)},ms.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},ms.root=function(){return this._root},ms.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},ms.visit=function(t){var e,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new fs(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var c=(r+o)/2,l=(i+a)/2;(n=u[3])&&s.push(new fs(n,c,l,o,a)),(n=u[2])&&s.push(new fs(n,r,l,c,a)),(n=u[1])&&s.push(new fs(n,c,i,o,l)),(n=u[0])&&s.push(new fs(n,r,i,c,l))}return this},ms.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new fs(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,c=e.y1,l=(a+u)/2,f=(s+c)/2;(o=i[0])&&n.push(new fs(o,a,s,l,f)),(o=i[1])&&n.push(new fs(o,l,s,u,f)),(o=i[2])&&n.push(new fs(o,a,f,l,c)),(o=i[3])&&n.push(new fs(o,l,f,u,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},ms.x=function(t){return arguments.length?(this._x=t,this):this._x},ms.y=function(t){return arguments.length?(this._y=t,this):this._y};var bs=function(t){var e,n,r=1,i=1;function o(){for(var t,o,s,u,c,l,f,h=e.length,p=0;p<i;++p)for(o=ds(e,ys,_s).visitAfter(a),t=0;t<h;++t)s=e[t],l=n[s.index],f=l*l,u=s.x+s.vx,c=s.y+s.vy,o.visit(d);function d(t,e,n,i,o){var a=t.data,h=t.r,p=l+h;if(!a)return e>u+p||i<u-p||n>c+p||o<c-p;if(a.index>s.index){var d=u-a.x-a.vx,v=c-a.y-a.vy,g=d*d+v*v;g<p*p&&(0===d&&(g+=(d=cs())*d),0===v&&(g+=(v=cs())*v),g=(p-(g=Math.sqrt(g)))/g*r,s.vx+=(d*=g)*(p=(h*=h)/(f+h)),s.vy+=(v*=g)*p,a.vx-=d*(p=1-p),a.vy-=v*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=us(null==t?1:+t)),o.initialize=function(t){e=t,s()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:us(+e),s(),o):t},o};function xs(t){return t.index}function ws(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}var Es=function(t){var e,n,r,i,o,a=xs,s=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=us(30),c=1;function l(r){for(var i=0,a=t.length;i<c;++i)for(var s,u,l,f,h,p,d,v=0;v<a;++v)u=(s=t[v]).source,f=(l=s.target).x+l.vx-u.x-u.vx||cs(),h=l.y+l.vy-u.y-u.vy||cs(),f*=p=((p=Math.sqrt(f*f+h*h))-n[v])/p*r*e[v],h*=p,l.vx-=f*(d=o[v]),l.vy-=h*d,u.vx+=f*(d=1-d),u.vy+=h*d}function f(){if(r){var s,u,c=r.length,l=t.length,f=Qo(r,a);for(s=0,i=new Array(c);s<l;++s)(u=t[s]).index=s,"object"!=typeof u.source&&(u.source=ws(f,u.source)),"object"!=typeof u.target&&(u.target=ws(f,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,o=new Array(l);s<l;++s)u=t[s],o[s]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),h(),n=new Array(l),p()}}function h(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t){r=t,f()},l.links=function(e){return arguments.length?(t=e,f(),l):t},l.id=function(t){return arguments.length?(a=t,l):a},l.iterations=function(t){return arguments.length?(c=+t,l):c},l.strength=function(t){return arguments.length?(s="function"==typeof t?t:us(+t),h(),l):s},l.distance=function(t){return arguments.length?(u="function"==typeof t?t:us(+t),p(),l):u},l};function Ss(t){return t.x}function Ps(t){return t.y}var Ts=10,As=Math.PI*(3-Math.sqrt(5)),ks=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=Qo(),u=zr(l),c=ht("tick","end");function l(){f(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function f(){var e,r,u=t.length;for(n+=(o-n)*i,s.each(function(t){t(n)}),e=0;e<u;++e)null==(r=t[e]).fx?r.x+=r.vx*=a:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=a:(r.y=r.fy,r.vy=0)}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,isNaN(e.x)||isNaN(e.y)){var i=Ts*Math.sqrt(n),o=n*As;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),h(),e={tick:f,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),s.each(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},force:function(t,n){return arguments.length>1?(null==n?s.remove(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(a=(i=e-(s=t[c]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}},Cs=function(){var t,e,n,r,i=us(-30),o=1,a=1/0,s=.81;function u(r){var i,o=t.length,a=ds(t,Ss,Ps).visitAfter(l);for(n=r,i=0;i<o;++i)e=t[i],a.visit(f)}function c(){if(t){var e,n,o=t.length;for(r=new Array(o),e=0;e<o;++e)n=t[e],r[n.index]=+i(n,e,t)}}function l(t){var e,n,i,o,a,s=0,u=0;if(t.length){for(i=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,i+=n*e.x,o+=n*e.y);t.x=i/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function f(t,i,u,c){if(!t.value)return!0;var l=t.x-e.x,f=t.y-e.y,h=c-i,p=l*l+f*f;if(h*h/s<p)return p<a&&(0===l&&(p+=(l=cs())*l),0===f&&(p+=(f=cs())*f),p<o&&(p=Math.sqrt(o*p)),e.vx+=l*t.value*n/p,e.vy+=f*t.value*n/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===l&&(p+=(l=cs())*l),0===f&&(p+=(f=cs())*f),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(h=r[t.data.index]*n/p,e.vx+=l*h,e.vy+=f*h)}while(t=t.next)}}return u.initialize=function(e){t=e,c()},u.strength=function(t){return arguments.length?(i="function"==typeof t?t:us(+t),c(),u):i},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.theta=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u},Os=function(t,e,n){var r,i,o,a=us(.1);function s(t){for(var a=0,s=r.length;a<s;++a){var u=r[a],c=u.x-e||1e-6,l=u.y-n||1e-6,f=Math.sqrt(c*c+l*l),h=(o[a]-f)*i[a]*t/f;u.vx+=c*h,u.vy+=l*h}}function u(){if(r){var e,n=r.length;for(i=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(r[e],e,r),i[e]=isNaN(o[e])?0:+a(r[e],e,r)}}return"function"!=typeof t&&(t=us(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,u()},s.strength=function(t){return arguments.length?(a="function"==typeof t?t:us(+t),u(),s):a},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:us(+e),u(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s},Ms=function(t){var e,n,r,i=us(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=us(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:us(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:us(+e),a(),o):t},o},Is=function(t){var e,n,r,i=us(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=us(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:us(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:us(+e),a(),o):t},o},Ls=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Rs=function(t){return(t=Ls(Math.abs(t)))?t[1]:NaN},js=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zs(t){return new Ds(t)}function Ds(t){if(!(e=js.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}zs.prototype=Ds.prototype,Ds.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Fs,Ns,Bs,Us,Vs=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t},Gs=function(t,e){var n=Ls(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},qs={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Gs(100*t,e)},r:Gs,s:function(t,e){var n=Ls(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Fs=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Ls(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Ws=function(t){return t},Zs=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],Xs=function(t){var e=t.grouping&&t.thousands?function(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}(t.grouping,t.thousands):Ws,n=t.currency,r=t.decimal,i=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):Ws,o=t.percent||"%";function a(t){var a=(t=zs(t)).fill,s=t.align,u=t.sign,c=t.symbol,l=t.zero,f=t.width,h=t.comma,p=t.precision,d=t.trim,v=t.type;"n"===v?(h=!0,v="g"):qs[v]||(null==p&&(p=12),d=!0,v="g"),(l||"0"===a&&"="===s)&&(l=!0,a="0",s="=");var g="$"===c?n[0]:"#"===c&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",m="$"===c?n[1]:/[%p]/.test(v)?o:"",y=qs[v],_=/[defgprs%]/.test(v);function b(t){var n,o,c,b=g,x=m;if("c"===v)x=y(t)+x,t="";else{var w=(t=+t)<0;if(t=y(Math.abs(t),p),d&&(t=Vs(t)),w&&0==+t&&(w=!1),b=(w?"("===u?u:"-":"-"===u||"("===u?"":u)+b,x=("s"===v?Zs[8+Fs/3]:"")+x+(w&&"("===u?")":""),_)for(n=-1,o=t.length;++n<o;)if(48>(c=t.charCodeAt(n))||c>57){x=(46===c?r+t.slice(n+1):t.slice(n))+x,t=t.slice(0,n);break}}h&&!l&&(t=e(t,1/0));var E=b.length+t.length+x.length,S=E<f?new Array(f-E+1).join(a):"";switch(h&&l&&(t=e(S+t,S.length?f-x.length:1/0),S=""),s){case"<":t=b+t+x+S;break;case"=":t=b+S+t+x;break;case"^":t=S.slice(0,E=S.length>>1)+b+t+x+S.slice(E);break;default:t=S+b+t+x}return i(t)}return p=null==p?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),b.toString=function(){return t+""},b}return{format:a,formatPrefix:function(t,e){var n=a(((t=zs(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Rs(e)/3))),i=Math.pow(10,-r),o=Zs[8+r/3];return function(t){return n(i*t)+o}}}};function Hs(t){return Ns=Xs(t),Bs=Ns.format,Us=Ns.formatPrefix,Ns}Hs({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Ys=function(t){return Math.max(0,-Rs(Math.abs(t)))},Ks=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Rs(e)/3)))-Rs(Math.abs(t)))},Js=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Rs(e)-Rs(t))+1},Qs=function(){return new $s};function $s(){this.reset()}$s.prototype={constructor:$s,reset:function(){this.s=this.t=0},add:function(t){eu(tu,t,this.t),eu(this,tu.s,this.s),this.s?this.t+=tu.t:this.s=tu.t},valueOf:function(){return this.s}};var tu=new $s;function eu(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var nu=1e-6,ru=Math.PI,iu=ru/2,ou=ru/4,au=2*ru,su=180/ru,uu=ru/180,cu=Math.abs,lu=Math.atan,fu=Math.atan2,hu=Math.cos,pu=Math.ceil,du=Math.exp,vu=(Math.floor,Math.log),gu=Math.pow,mu=Math.sin,yu=Math.sign||function(t){return t>0?1:t<0?-1:0},_u=Math.sqrt,bu=Math.tan;function xu(t){return t>1?0:t<-1?ru:Math.acos(t)}function wu(t){return t>1?iu:t<-1?-iu:Math.asin(t)}function Eu(t){return(t=mu(t/2))*t}function Su(){}function Pu(t,e){t&&Au.hasOwnProperty(t.type)&&Au[t.type](t,e)}var Tu={Feature:function(t,e){Pu(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Pu(n[r].geometry,e)}},Au={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){ku(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)ku(n[r],e,0)},Polygon:function(t,e){Cu(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Cu(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Pu(n[r],e)}};function ku(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function Cu(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)ku(t[n],e,1);e.polygonEnd()}var Ou,Mu,Iu,Lu,Ru,ju=function(t,e){t&&Tu.hasOwnProperty(t.type)?Tu[t.type](t,e):Pu(t,e)},zu=Qs(),Du=Qs(),Fu={point:Su,lineStart:Su,lineEnd:Su,polygonStart:function(){zu.reset(),Fu.lineStart=Nu,Fu.lineEnd=Bu},polygonEnd:function(){var t=+zu;Du.add(t<0?au+t:t),this.lineStart=this.lineEnd=this.point=Su},sphere:function(){Du.add(au)}};function Nu(){Fu.point=Uu}function Bu(){Vu(Ou,Mu)}function Uu(t,e){Fu.point=Vu,Ou=t,Mu=e,Iu=t*=uu,Lu=hu(e=(e*=uu)/2+ou),Ru=mu(e)}function Vu(t,e){e=(e*=uu)/2+ou;var n=(t*=uu)-Iu,r=n>=0?1:-1,i=r*n,o=hu(e),a=mu(e),s=Ru*a,u=Lu*o+s*hu(i),c=s*r*mu(i);zu.add(fu(c,u)),Iu=t,Lu=o,Ru=a}var Gu=function(t){return Du.reset(),ju(t,Fu),2*Du};function qu(t){return[fu(t[1],t[0]),wu(t[2])]}function Wu(t){var e=t[0],n=t[1],r=hu(n);return[r*hu(e),r*mu(e),mu(n)]}function Zu(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Xu(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Hu(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Yu(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Ku(t){var e=_u(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Ju,Qu,$u,tc,ec,nc,rc,ic,oc,ac,sc=Qs(),uc={point:cc,lineStart:fc,lineEnd:hc,polygonStart:function(){uc.point=pc,uc.lineStart=dc,uc.lineEnd=vc,sc.reset(),Fu.polygonStart()},polygonEnd:function(){Fu.polygonEnd(),uc.point=cc,uc.lineStart=fc,uc.lineEnd=hc,zu<0?(Ju=-($u=180),Qu=-(tc=90)):sc>nu?tc=90:sc<-nu&&(Qu=-90),ac[0]=Ju,ac[1]=$u}};function cc(t,e){oc.push(ac=[Ju=t,$u=t]),e<Qu&&(Qu=e),e>tc&&(tc=e)}function lc(t,e){var n=Wu([t*uu,e*uu]);if(ic){var r=Xu(ic,n),i=Xu([r[1],-r[0],0],r);Ku(i),i=qu(i);var o,a=t-ec,s=a>0?1:-1,u=i[0]*su*s,c=cu(a)>180;c^(s*ec<u&&u<s*t)?(o=i[1]*su)>tc&&(tc=o):c^(s*ec<(u=(u+360)%360-180)&&u<s*t)?(o=-i[1]*su)<Qu&&(Qu=o):(e<Qu&&(Qu=e),e>tc&&(tc=e)),c?t<ec?gc(Ju,t)>gc(Ju,$u)&&($u=t):gc(t,$u)>gc(Ju,$u)&&(Ju=t):$u>=Ju?(t<Ju&&(Ju=t),t>$u&&($u=t)):t>ec?gc(Ju,t)>gc(Ju,$u)&&($u=t):gc(t,$u)>gc(Ju,$u)&&(Ju=t)}else oc.push(ac=[Ju=t,$u=t]);e<Qu&&(Qu=e),e>tc&&(tc=e),ic=n,ec=t}function fc(){uc.point=lc}function hc(){ac[0]=Ju,ac[1]=$u,uc.point=cc,ic=null}function pc(t,e){if(ic){var n=t-ec;sc.add(cu(n)>180?n+(n>0?360:-360):n)}else nc=t,rc=e;Fu.point(t,e),lc(t,e)}function dc(){Fu.lineStart()}function vc(){pc(nc,rc),Fu.lineEnd(),cu(sc)>nu&&(Ju=-($u=180)),ac[0]=Ju,ac[1]=$u,ic=null}function gc(t,e){return(e-=t)<0?e+360:e}function mc(t,e){return t[0]-e[0]}function yc(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var _c,bc,xc,wc,Ec,Sc,Pc,Tc,Ac,kc,Cc,Oc,Mc,Ic,Lc,Rc,jc=function(t){var e,n,r,i,o,a,s;if(tc=$u=-(Ju=Qu=1/0),oc=[],ju(t,uc),n=oc.length){for(oc.sort(mc),e=1,o=[r=oc[0]];e<n;++e)yc(r,(i=oc[e])[0])||yc(r,i[1])?(gc(r[0],i[1])>gc(r[0],r[1])&&(r[1]=i[1]),gc(i[0],r[1])>gc(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=gc(r[1],i[0]))>a&&(a=s,Ju=i[0],$u=r[1])}return oc=ac=null,Ju===1/0||Qu===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ju,Qu],[$u,tc]]},zc={sphere:Su,point:Dc,lineStart:Nc,lineEnd:Vc,polygonStart:function(){zc.lineStart=Gc,zc.lineEnd=qc},polygonEnd:function(){zc.lineStart=Nc,zc.lineEnd=Vc}};function Dc(t,e){t*=uu;var n=hu(e*=uu);Fc(n*hu(t),n*mu(t),mu(e))}function Fc(t,e,n){xc+=(t-xc)/++_c,wc+=(e-wc)/_c,Ec+=(n-Ec)/_c}function Nc(){zc.point=Bc}function Bc(t,e){t*=uu;var n=hu(e*=uu);Ic=n*hu(t),Lc=n*mu(t),Rc=mu(e),zc.point=Uc,Fc(Ic,Lc,Rc)}function Uc(t,e){t*=uu;var n=hu(e*=uu),r=n*hu(t),i=n*mu(t),o=mu(e),a=fu(_u((a=Lc*o-Rc*i)*a+(a=Rc*r-Ic*o)*a+(a=Ic*i-Lc*r)*a),Ic*r+Lc*i+Rc*o);bc+=a,Sc+=a*(Ic+(Ic=r)),Pc+=a*(Lc+(Lc=i)),Tc+=a*(Rc+(Rc=o)),Fc(Ic,Lc,Rc)}function Vc(){zc.point=Dc}function Gc(){zc.point=Wc}function qc(){Zc(Oc,Mc),zc.point=Dc}function Wc(t,e){Oc=t,Mc=e,t*=uu,e*=uu,zc.point=Zc;var n=hu(e);Ic=n*hu(t),Lc=n*mu(t),Rc=mu(e),Fc(Ic,Lc,Rc)}function Zc(t,e){t*=uu;var n=hu(e*=uu),r=n*hu(t),i=n*mu(t),o=mu(e),a=Lc*o-Rc*i,s=Rc*r-Ic*o,u=Ic*i-Lc*r,c=_u(a*a+s*s+u*u),l=wu(c),f=c&&-l/c;Ac+=f*a,kc+=f*s,Cc+=f*u,bc+=l,Sc+=l*(Ic+(Ic=r)),Pc+=l*(Lc+(Lc=i)),Tc+=l*(Rc+(Rc=o)),Fc(Ic,Lc,Rc)}var Xc=function(t){_c=bc=xc=wc=Ec=Sc=Pc=Tc=Ac=kc=Cc=0,ju(t,zc);var e=Ac,n=kc,r=Cc,i=e*e+n*n+r*r;return i<1e-12&&(e=Sc,n=Pc,r=Tc,bc<nu&&(e=xc,n=wc,r=Ec),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[fu(n,e)*su,wu(r/_u(i))*su]},Hc=function(t){return function(){return t}},Yc=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function Kc(t,e){return[t>ru?t-au:t<-ru?t+au:t,e]}function Jc(t,e,n){return(t%=au)?e||n?Yc($c(t),tl(e,n)):$c(t):e||n?tl(e,n):Kc}function Qc(t){return function(e,n){return[(e+=t)>ru?e-au:e<-ru?e+au:e,n]}}function $c(t){var e=Qc(t);return e.invert=Qc(-t),e}function tl(t,e){var n=hu(t),r=mu(t),i=hu(e),o=mu(e);function a(t,e){var a=hu(e),s=hu(t)*a,u=mu(t)*a,c=mu(e),l=c*n+s*r;return[fu(u*i-l*o,s*n-c*r),wu(l*i+u*o)]}return a.invert=function(t,e){var a=hu(e),s=hu(t)*a,u=mu(t)*a,c=mu(e),l=c*i-u*o;return[fu(u*i+c*o,s*n+l*r),wu(l*n-s*r)]},a}Kc.invert=Kc;var el=function(t){function e(e){return(e=t(e[0]*uu,e[1]*uu))[0]*=su,e[1]*=su,e}return t=Jc(t[0]*uu,t[1]*uu,t.length>2?t[2]*uu:0),e.invert=function(e){return(e=t.invert(e[0]*uu,e[1]*uu))[0]*=su,e[1]*=su,e},e};function nl(t,e,n,r,i,o){if(n){var a=hu(e),s=mu(e),u=r*n;null==i?(i=e+r*au,o=e-u/2):(i=rl(a,i),o=rl(a,o),(r>0?i<o:i>o)&&(i+=r*au));for(var c,l=i;r>0?l>o:l<o;l-=u)c=qu([a,-s*hu(l),-s*mu(l)]),t.point(c[0],c[1])}}function rl(t,e){(e=Wu(e))[0]-=t,Ku(e);var n=xu(-e[1]);return((-e[2]<0?-n:n)+au-nu)%au}var il=function(){var t,e,n=Hc([0,0]),r=Hc(90),i=Hc(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=su,n[1]*=su}};function a(){var a=n.apply(this,arguments),s=r.apply(this,arguments)*uu,u=i.apply(this,arguments)*uu;return t=[],e=Jc(-a[0]*uu,-a[1]*uu,0).invert,nl(o,s,u,1),a={type:"Polygon",coordinates:[t]},t=e=null,a}return a.center=function(t){return arguments.length?(n="function"==typeof t?t:Hc([+t[0],+t[1]]),a):n},a.radius=function(t){return arguments.length?(r="function"==typeof t?t:Hc(+t),a):r},a.precision=function(t){return arguments.length?(i="function"==typeof t?t:Hc(+t),a):i},a},ol=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Su,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},al=function(t,e){return cu(t[0]-e[0])<nu&&cu(t[1]-e[1])<nu};function sl(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var ul=function(t,e,n,r,i){var o,a,s=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(al(r,a)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else s.push(n=new sl(r,t,null,!0)),u.push(n.o=new sl(r,null,n,!1)),s.push(n=new sl(a,t,null,!1)),u.push(n.o=new sl(a,null,n,!0))}}),s.length){for(u.sort(e),cl(s),cl(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var c,l,f=s[0];;){for(var h=f,p=!0;h.v;)if((h=h.n)===f)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(o=0,a=c.length;o<a;++o)i.point((l=c[o])[0],l[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(p)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(h.x,h.p.x,-1,i);h=h.p}c=(h=h.o).z,p=!p}while(!h.v);i.lineEnd()}}};function cl(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var ll=Qs(),fl=function(t,e){var n=e[0],r=e[1],i=mu(r),o=[mu(n),-hu(n),0],a=0,s=0;ll.reset(),1===i?r=iu+nu:-1===i&&(r=-iu-nu);for(var u=0,c=t.length;u<c;++u)if(f=(l=t[u]).length)for(var l,f,h=l[f-1],p=h[0],d=h[1]/2+ou,v=mu(d),g=hu(d),m=0;m<f;++m,p=_,v=x,g=w,h=y){var y=l[m],_=y[0],b=y[1]/2+ou,x=mu(b),w=hu(b),E=_-p,S=E>=0?1:-1,P=S*E,T=P>ru,A=v*x;if(ll.add(fu(A*S*mu(P),g*w+A*hu(P))),a+=T?E+S*au:E,T^p>=n^_>=n){var k=Xu(Wu(h),Wu(y));Ku(k);var C=Xu(o,k);Ku(C);var O=(T^E>=0?-1:1)*wu(C[2]);(r>O||r===O&&(k[0]||k[1]))&&(s+=T^E>=0?1:-1)}}return(a<-nu||a<nu&&ll<-nu)^1&s},hl=function(t,e,n,r){return function(i){var o,a,s,u=e(i),c=ol(),l=e(c),f=!1,h={point:p,lineStart:v,lineEnd:g,polygonStart:function(){h.point=m,h.lineStart=y,h.lineEnd=_,a=[],o=[]},polygonEnd:function(){h.point=p,h.lineStart=v,h.lineEnd=g,a=D(a);var t=fl(o,r);a.length?(f||(i.polygonStart(),f=!0),ul(a,dl,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function p(e,n){t(e,n)&&i.point(e,n)}function d(t,e){u.point(t,e)}function v(){h.point=d,u.lineStart()}function g(){h.point=p,u.lineEnd()}function m(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function _(){m(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),h=c.result(),p=h.length;if(s.pop(),o.push(s),s=null,p)if(1&u){if((e=(n=h[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else p>1&&2&u&&h.push(h.pop().concat(h.shift())),a.push(h.filter(pl))}return h}};function pl(t){return t.length>1}function dl(t,e){return((t=t.x)[0]<0?t[1]-iu-nu:iu-t[1])-((e=e.x)[0]<0?e[1]-iu-nu:iu-e[1])}var vl=hl(function(){return!0},function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?ru:-ru,u=cu(o-n);cu(u-ru)<nu?(t.point(n,r=(r+a)/2>0?iu:-iu),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&u>=ru&&(cu(n-i)<nu&&(n-=i*nu),cu(o-s)<nu&&(o-=s*nu),r=function(t,e,n,r){var i,o,a=mu(t-n);return cu(a)>nu?lu((mu(e)*(o=hu(r))*mu(n)-mu(r)*(i=hu(e))*mu(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var i;if(null==t)i=n*iu,r.point(-ru,i),r.point(0,i),r.point(ru,i),r.point(ru,0),r.point(ru,-i),r.point(0,-i),r.point(-ru,-i),r.point(-ru,0),r.point(-ru,i);else if(cu(t[0]-e[0])>nu){var o=t[0]<e[0]?ru:-ru;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])},[-ru,-iu]);var gl=function(t){var e=hu(t),n=6*uu,r=e>0,i=cu(e)>nu;function o(t,n){return hu(t)*hu(n)>e}function a(t,n,r){var i=[1,0,0],o=Xu(Wu(t),Wu(n)),a=Zu(o,o),s=o[0],u=a-s*s;if(!u)return!r&&t;var c=e*a/u,l=-e*s/u,f=Xu(i,o),h=Yu(i,c);Hu(h,Yu(o,l));var p=f,d=Zu(h,p),v=Zu(p,p),g=d*d-v*(Zu(h,h)-1);if(!(g<0)){var m=_u(g),y=Yu(p,(-d-m)/v);if(Hu(y,h),y=qu(y),!r)return y;var _,b=t[0],x=n[0],w=t[1],E=n[1];x<b&&(_=b,b=x,x=_);var S=x-b,P=cu(S-ru)<nu;if(!P&&E<w&&(_=w,w=E,E=_),P||S<nu?P?w+E>0^y[1]<(cu(y[0]-b)<nu?w:E):w<=y[1]&&y[1]<=E:S>ru^(b<=y[0]&&y[0]<=x)){var T=Yu(p,(-d+m)/v);return Hu(T,h),[y,qu(T)]}}}function s(e,n){var i=r?t:ru-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return hl(o,function(t){var e,n,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(f,h){var p,d=[f,h],v=o(f,h),g=r?v?0:s(f,h):v?s(f+(f<0?ru:-ru),h):0;if(!e&&(c=u=v)&&t.lineStart(),v!==u&&(!(p=a(e,d))||al(e,p)||al(d,p))&&(d[0]+=nu,d[1]+=nu,v=o(d[0],d[1])),v!==u)l=0,v?(t.lineStart(),p=a(d,e),t.point(p[0],p[1])):(p=a(e,d),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(i&&e&&r^v){var m;g&n||!(m=a(d,e,!0))||(l=0,r?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!v||e&&al(e,d)||t.point(d[0],d[1]),e=d,u=v,n=g},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return l|(c&&u)<<1}}},function(e,r,i,o){nl(o,t,n,i,e,r)},r?[0,-t]:[-ru,t-ru])},ml=function(t,e,n,r,i,o){var a,s=t[0],u=t[1],c=0,l=1,f=e[0]-s,h=e[1]-u;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<l&&(l=a)}else if(f>0){if(a>l)return;a>c&&(c=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>l)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<l&&(l=a)}if(a=r-u,h||!(a>0)){if(a/=h,h<0){if(a<c)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>c&&(c=a)}if(a=o-u,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>c&&(c=a)}else if(h>0){if(a<c)return;a<l&&(l=a)}return c>0&&(t[0]=s+c*f,t[1]=u+c*h),l<1&&(e[0]=s+l*f,e[1]=u+l*h),!0}}}}},yl=1e9,_l=-yl;function bl(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,c){var l=0,f=0;if(null==i||(l=a(i,s))!==(f=a(o,s))||u(i,o)<0^s>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==f);else c.point(o[0],o[1])}function a(r,i){return cu(r[0]-t)<nu?i>0?0:3:cu(r[0]-n)<nu?i>0?2:1:cu(r[1]-e)<nu?i>0?1:0:i>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var u,c,l,f,h,p,d,v,g,m,y,_=a,b=ol(),x={point:w,lineStart:function(){x.point=E,c&&c.push(l=[]);m=!0,g=!1,d=v=NaN},lineEnd:function(){u&&(E(f,h),p&&g&&b.rejoin(),u.push(b.result()));x.point=w,g&&_.lineEnd()},polygonStart:function(){_=b,u=[],c=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,a,s=c[n],u=1,l=s.length,f=s[0],h=f[0],p=f[1];u<l;++u)o=h,a=p,f=s[u],h=f[0],p=f[1],a<=r?p>r&&(h-o)*(r-a)>(p-a)*(t-o)&&++e:p<=r&&(h-o)*(r-a)<(p-a)*(t-o)&&--e;return e}(),n=y&&e,i=(u=D(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&ul(u,s,e,o,a),a.polygonEnd());_=a,u=c=l=null}};function w(t,e){i(t,e)&&_.point(t,e)}function E(o,a){var s=i(o,a);if(c&&l.push([o,a]),m)f=o,h=a,p=s,m=!1,s&&(_.lineStart(),_.point(o,a));else if(s&&g)_.point(o,a);else{var u=[d=Math.max(_l,Math.min(yl,d)),v=Math.max(_l,Math.min(yl,v))],b=[o=Math.max(_l,Math.min(yl,o)),a=Math.max(_l,Math.min(yl,a))];ml(u,b,t,e,n,r)?(g||(_.lineStart(),_.point(u[0],u[1])),_.point(b[0],b[1]),s||_.lineEnd(),y=!1):s&&(_.lineStart(),_.point(o,a),y=!1)}d=o,v=a,g=s}return x}}var xl,wl,El,Sl=function(){var t,e,n,r=0,i=0,o=960,a=500;return n={stream:function(n){return t&&e===n?t:t=bl(r,i,o,a)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],o=+s[1][0],a=+s[1][1],t=e=null,n):[[r,i],[o,a]]}}},Pl=Qs(),Tl={sphere:Su,point:Su,lineStart:function(){Tl.point=kl,Tl.lineEnd=Al},lineEnd:Su,polygonStart:Su,polygonEnd:Su};function Al(){Tl.point=Tl.lineEnd=Su}function kl(t,e){xl=t*=uu,wl=mu(e*=uu),El=hu(e),Tl.point=Cl}function Cl(t,e){t*=uu;var n=mu(e*=uu),r=hu(e),i=cu(t-xl),o=hu(i),a=r*mu(i),s=El*n-wl*r*o,u=wl*n+El*r*o;Pl.add(fu(_u(a*a+s*s),u)),xl=t,wl=n,El=r}var Ol=function(t){return Pl.reset(),ju(t,Tl),+Pl},Ml=[null,null],Il={type:"LineString",coordinates:Ml},Ll=function(t,e){return Ml[0]=t,Ml[1]=e,Ol(Il)},Rl={Feature:function(t,e){return zl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(zl(n[r].geometry,e))return!0;return!1}},jl={Sphere:function(){return!0},Point:function(t,e){return Dl(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Dl(n[r],e))return!0;return!1},LineString:function(t,e){return Fl(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Fl(n[r],e))return!0;return!1},Polygon:function(t,e){return Nl(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Nl(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(zl(n[r],e))return!0;return!1}};function zl(t,e){return!(!t||!jl.hasOwnProperty(t.type))&&jl[t.type](t,e)}function Dl(t,e){return 0===Ll(t,e)}function Fl(t,e){var n=Ll(t[0],t[1]);return Ll(t[0],e)+Ll(e,t[1])<=n+nu}function Nl(t,e){return!!fl(t.map(Bl),Ul(e))}function Bl(t){return(t=t.map(Ul)).pop(),t}function Ul(t){return[t[0]*uu,t[1]*uu]}var Vl=function(t,e){return(t&&Rl.hasOwnProperty(t.type)?Rl[t.type]:zl)(t,e)};function Gl(t,e,n){var r=w(t,e-nu,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function ql(t,e,n){var r=w(t,e-nu,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function Wl(){var t,e,n,r,i,o,a,s,u,c,l,f,h=10,p=h,d=90,v=360,g=2.5;function m(){return{type:"MultiLineString",coordinates:y()}}function y(){return w(pu(r/d)*d,n,d).map(l).concat(w(pu(s/v)*v,a,v).map(f)).concat(w(pu(e/h)*h,t,h).filter(function(t){return cu(t%d)>nu}).map(u)).concat(w(pu(o/p)*p,i,p).filter(function(t){return cu(t%v)>nu}).map(c))}return m.lines=function(){return y().map(function(t){return{type:"LineString",coordinates:t}})},m.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(f(a).slice(1),l(n).reverse().slice(1),f(s).reverse().slice(1))]}},m.extent=function(t){return arguments.length?m.extentMajor(t).extentMinor(t):m.extentMinor()},m.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),m.precision(g)):[[r,s],[n,a]]},m.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),m.precision(g)):[[e,o],[t,i]]},m.step=function(t){return arguments.length?m.stepMajor(t).stepMinor(t):m.stepMinor()},m.stepMajor=function(t){return arguments.length?(d=+t[0],v=+t[1],m):[d,v]},m.stepMinor=function(t){return arguments.length?(h=+t[0],p=+t[1],m):[h,p]},m.precision=function(h){return arguments.length?(g=+h,u=Gl(o,i,90),c=ql(e,t,g),l=Gl(s,a,90),f=ql(r,n,g),m):g},m.extentMajor([[-180,-90+nu],[180,90-nu]]).extentMinor([[-180,-80-nu],[180,80+nu]])}function Zl(){return Wl()()}var Xl,Hl,Yl,Kl,Jl=function(t,e){var n=t[0]*uu,r=t[1]*uu,i=e[0]*uu,o=e[1]*uu,a=hu(r),s=mu(r),u=hu(o),c=mu(o),l=a*hu(n),f=a*mu(n),h=u*hu(i),p=u*mu(i),d=2*wu(_u(Eu(o-r)+a*u*Eu(i-n))),v=mu(d),g=d?function(t){var e=mu(t*=d)/v,n=mu(d-t)/v,r=n*l+e*h,i=n*f+e*p,o=n*s+e*c;return[fu(i,r)*su,fu(o,_u(r*r+i*i))*su]}:function(){return[n*su,r*su]};return g.distance=d,g},Ql=function(t){return t},$l=Qs(),tf=Qs(),ef={point:Su,lineStart:Su,lineEnd:Su,polygonStart:function(){ef.lineStart=nf,ef.lineEnd=af},polygonEnd:function(){ef.lineStart=ef.lineEnd=ef.point=Su,$l.add(cu(tf)),tf.reset()},result:function(){var t=$l/2;return $l.reset(),t}};function nf(){ef.point=rf}function rf(t,e){ef.point=of,Xl=Yl=t,Hl=Kl=e}function of(t,e){tf.add(Kl*t-Yl*e),Yl=t,Kl=e}function af(){of(Xl,Hl)}var sf=ef,uf=1/0,cf=uf,lf=-uf,ff=lf;var hf,pf,df,vf,gf={point:function(t,e){t<uf&&(uf=t);t>lf&&(lf=t);e<cf&&(cf=e);e>ff&&(ff=e)},lineStart:Su,lineEnd:Su,polygonStart:Su,polygonEnd:Su,result:function(){var t=[[uf,cf],[lf,ff]];return lf=ff=-(cf=uf=1/0),t}},mf=0,yf=0,_f=0,bf=0,xf=0,wf=0,Ef=0,Sf=0,Pf=0,Tf={point:Af,lineStart:kf,lineEnd:Mf,polygonStart:function(){Tf.lineStart=If,Tf.lineEnd=Lf},polygonEnd:function(){Tf.point=Af,Tf.lineStart=kf,Tf.lineEnd=Mf},result:function(){var t=Pf?[Ef/Pf,Sf/Pf]:wf?[bf/wf,xf/wf]:_f?[mf/_f,yf/_f]:[NaN,NaN];return mf=yf=_f=bf=xf=wf=Ef=Sf=Pf=0,t}};function Af(t,e){mf+=t,yf+=e,++_f}function kf(){Tf.point=Cf}function Cf(t,e){Tf.point=Of,Af(df=t,vf=e)}function Of(t,e){var n=t-df,r=e-vf,i=_u(n*n+r*r);bf+=i*(df+t)/2,xf+=i*(vf+e)/2,wf+=i,Af(df=t,vf=e)}function Mf(){Tf.point=Af}function If(){Tf.point=Rf}function Lf(){jf(hf,pf)}function Rf(t,e){Tf.point=jf,Af(hf=df=t,pf=vf=e)}function jf(t,e){var n=t-df,r=e-vf,i=_u(n*n+r*r);bf+=i*(df+t)/2,xf+=i*(vf+e)/2,wf+=i,Ef+=(i=vf*t-df*e)*(df+t),Sf+=i*(vf+e),Pf+=3*i,Af(df=t,vf=e)}var zf=Tf;function Df(t){this._context=t}Df.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,au)}},result:Su};var Ff,Nf,Bf,Uf,Vf,Gf=Qs(),qf={point:Su,lineStart:function(){qf.point=Wf},lineEnd:function(){Ff&&Zf(Nf,Bf),qf.point=Su},polygonStart:function(){Ff=!0},polygonEnd:function(){Ff=null},result:function(){var t=+Gf;return Gf.reset(),t}};function Wf(t,e){qf.point=Zf,Nf=Uf=t,Bf=Vf=e}function Zf(t,e){Uf-=t,Vf-=e,Gf.add(_u(Uf*Uf+Vf*Vf)),Uf=t,Vf=e}var Xf=qf;function Hf(){this._string=[]}function Yf(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Hf.prototype={_radius:4.5,_circle:Yf(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Yf(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Kf=function(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),ju(t,n(r))),r.result()}return o.area=function(t){return ju(t,n(sf)),sf.result()},o.measure=function(t){return ju(t,n(Xf)),Xf.result()},o.bounds=function(t){return ju(t,n(gf)),gf.result()},o.centroid=function(t){return ju(t,n(zf)),zf.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Ql):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new Hf):new Df(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)},Jf=function(t){return{stream:Qf(t)}};function Qf(t){return function(e){var n=new $f;for(var r in t)n[r]=t[r];return n.stream=e,n}}function $f(){}function th(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),ju(n,t.stream(gf)),e(gf.result()),null!=r&&t.clipExtent(r),t}function eh(t,e,n){return th(t,function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])},n)}function nh(t,e,n){return eh(t,[[0,0],e],n)}function rh(t,e,n){return th(t,function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])},n)}function ih(t,e,n){return th(t,function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])},n)}$f.prototype={constructor:$f,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var oh=16,ah=hu(30*uu),sh=function(t,e){return+e?function(t,e){function n(r,i,o,a,s,u,c,l,f,h,p,d,v,g){var m=c-r,y=l-i,_=m*m+y*y;if(_>4*e&&v--){var b=a+h,x=s+p,w=u+d,E=_u(b*b+x*x+w*w),S=wu(w/=E),P=cu(cu(w)-1)<nu||cu(o-f)<nu?(o+f)/2:fu(x,b),T=t(P,S),A=T[0],k=T[1],C=A-r,O=k-i,M=y*C-m*O;(M*M/_>e||cu((m*C+y*O)/_-.5)>.3||a*h+s*p+u*d<ah)&&(n(r,i,o,a,s,u,A,k,P,b/=E,x/=E,w,v,g),g.point(A,k),n(A,k,P,b,x,w,c,l,f,h,p,d,v,g))}}return function(e){var r,i,o,a,s,u,c,l,f,h,p,d,v={point:g,lineStart:m,lineEnd:_,polygonStart:function(){e.polygonStart(),v.lineStart=b},polygonEnd:function(){e.polygonEnd(),v.lineStart=m}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function m(){l=NaN,v.point=y,e.lineStart()}function y(r,i){var o=Wu([r,i]),a=t(r,i);n(l,f,c,h,p,d,l=a[0],f=a[1],c=r,h=o[0],p=o[1],d=o[2],oh,e),e.point(l,f)}function _(){v.point=g,e.lineEnd()}function b(){m(),v.point=x,v.lineEnd=w}function x(t,e){y(r=t,e),i=l,o=f,a=h,s=p,u=d,v.point=y}function w(){n(l,f,c,h,p,d,i,o,r,a,s,u,oh,e),v.lineEnd=_,_()}return v}}(t,e):function(t){return Qf({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var uh=Qf({point:function(t,e){this.stream.point(t*uu,e*uu)}});function ch(t,e,n,r){var i=hu(r),o=mu(r),a=i*t,s=o*t,u=i/t,c=o/t,l=(o*n-i*e)/t,f=(o*e+i*n)/t;function h(t,r){return[a*t-s*r+e,n-s*t-a*r]}return h.invert=function(t,e){return[u*t-c*e+l,f-c*t-u*e]},h}function lh(t){return fh(function(){return t})()}function fh(t){var e,n,r,i,o,a,s,u,c,l,f=150,h=480,p=250,d=0,v=0,g=0,m=0,y=0,_=0,b=null,x=vl,w=null,E=Ql,S=.5;function P(t){return u(t[0]*uu,t[1]*uu)}function T(t){return(t=u.invert(t[0],t[1]))&&[t[0]*su,t[1]*su]}function A(){var t=ch(f,0,0,_).apply(null,e(d,v)),r=(_?ch:function(t,e,n){function r(r,i){return[e+t*r,n-t*i]}return r.invert=function(r,i){return[(r-e)/t,(n-i)/t]},r})(f,h-t[0],p-t[1],_);return n=Jc(g,m,y),s=Yc(e,r),u=Yc(n,s),a=sh(s,S),k()}function k(){return c=l=null,P}return P.stream=function(t){return c&&l===t?c:c=uh(function(t){return Qf({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(x(a(E(l=t)))))},P.preclip=function(t){return arguments.length?(x=t,b=void 0,k()):x},P.postclip=function(t){return arguments.length?(E=t,w=r=i=o=null,k()):E},P.clipAngle=function(t){return arguments.length?(x=+t?gl(b=t*uu):(b=null,vl),k()):b*su},P.clipExtent=function(t){return arguments.length?(E=null==t?(w=r=i=o=null,Ql):bl(w=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),k()):null==w?null:[[w,r],[i,o]]},P.scale=function(t){return arguments.length?(f=+t,A()):f},P.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],A()):[h,p]},P.center=function(t){return arguments.length?(d=t[0]%360*uu,v=t[1]%360*uu,A()):[d*su,v*su]},P.rotate=function(t){return arguments.length?(g=t[0]%360*uu,m=t[1]%360*uu,y=t.length>2?t[2]%360*uu:0,A()):[g*su,m*su,y*su]},P.angle=function(t){return arguments.length?(_=t%360*uu,A()):_*su},P.precision=function(t){return arguments.length?(a=sh(s,S=t*t),k()):_u(S)},P.fitExtent=function(t,e){return eh(P,t,e)},P.fitSize=function(t,e){return nh(P,t,e)},P.fitWidth=function(t,e){return rh(P,t,e)},P.fitHeight=function(t,e){return ih(P,t,e)},function(){return e=t.apply(this,arguments),P.invert=e.invert&&T,A()}}function hh(t){var e=0,n=ru/3,r=fh(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*uu,n=t[1]*uu):[e*su,n*su]},i}function ph(t,e){var n=mu(t),r=(n+mu(e))/2;if(cu(r)<nu)return function(t){var e=hu(t);function n(t,n){return[t*e,mu(n)/e]}return n.invert=function(t,n){return[t/e,wu(n*e)]},n}(t);var i=1+n*(2*r-n),o=_u(i)/r;function a(t,e){var n=_u(i-2*r*mu(e))/r;return[n*mu(t*=r),o-n*hu(t)]}return a.invert=function(t,e){var n=o-e;return[fu(t,cu(n))/r*yu(n),wu((i-(t*t+n*n)*r*r)/(2*r))]},a}var dh=function(){return hh(ph).scale(155.424).center([0,33.6442])},vh=function(){return dh().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var gh=function(){var t,e,n,r,i,o,a=vh(),s=dh().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=dh().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function l(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function f(){return t=e=null,l}return l.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(t)},l.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([a.stream(e=n),s.stream(n),u.stream(n)])},l.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),u.precision(t),f()):a.precision()},l.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),u.scale(t),l.translate(a.translate())):a.scale()},l.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],l=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,l-.238*e],[o+.455*e,l+.238*e]]).stream(c),r=s.translate([o-.307*e,l+.201*e]).clipExtent([[o-.425*e+nu,l+.12*e+nu],[o-.214*e-nu,l+.234*e-nu]]).stream(c),i=u.translate([o-.205*e,l+.212*e]).clipExtent([[o-.214*e+nu,l+.166*e+nu],[o-.115*e-nu,l+.234*e-nu]]).stream(c),f()},l.fitExtent=function(t,e){return eh(l,t,e)},l.fitSize=function(t,e){return nh(l,t,e)},l.fitWidth=function(t,e){return rh(l,t,e)},l.fitHeight=function(t,e){return ih(l,t,e)},l.scale(1070)};function mh(t){return function(e,n){var r=hu(e),i=hu(n),o=t(r*i);return[o*i*mu(e),o*mu(n)]}}function yh(t){return function(e,n){var r=_u(e*e+n*n),i=t(r),o=mu(i),a=hu(i);return[fu(e*o,r*a),wu(r&&n*o/r)]}}var _h=mh(function(t){return _u(2/(1+t))});_h.invert=yh(function(t){return 2*wu(t/2)});var bh=function(){return lh(_h).scale(124.75).clipAngle(179.999)},xh=mh(function(t){return(t=xu(t))&&t/mu(t)});xh.invert=yh(function(t){return t});var wh=function(){return lh(xh).scale(79.4188).clipAngle(179.999)};function Eh(t,e){return[t,vu(bu((iu+e)/2))]}Eh.invert=function(t,e){return[t,2*lu(du(e))-iu]};var Sh=function(){return Ph(Eh).scale(961/au)};function Ph(t){var e,n,r,i=lh(t),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,c=null;function l(){var o=ru*a(),s=i(el(i.rotate()).invert([0,0]));return u(null==c?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Eh?[[Math.max(s[0]-o,c),e],[Math.min(s[0]+o,n),r]]:[[c,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),l()):a()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(o(t),l()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==c?null:[[c,e],[n,r]]},l()}function Th(t){return bu((iu+t)/2)}function Ah(t,e){var n=hu(t),r=t===e?mu(t):vu(n/hu(e))/vu(Th(e)/Th(t)),i=n*gu(Th(t),r)/r;if(!r)return Eh;function o(t,e){i>0?e<-iu+nu&&(e=-iu+nu):e>iu-nu&&(e=iu-nu);var n=i/gu(Th(e),r);return[n*mu(r*t),i-n*hu(r*t)]}return o.invert=function(t,e){var n=i-e,o=yu(r)*_u(t*t+n*n);return[fu(t,cu(n))/r*yu(n),2*lu(gu(i/o,1/r))-iu]},o}var kh=function(){return hh(Ah).scale(109.5).parallels([30,30])};function Ch(t,e){return[t,e]}Ch.invert=Ch;var Oh=function(){return lh(Ch).scale(152.63)};function Mh(t,e){var n=hu(t),r=t===e?mu(t):(n-hu(e))/(e-t),i=n/r+t;if(cu(r)<nu)return Ch;function o(t,e){var n=i-e,o=r*t;return[n*mu(o),i-n*hu(o)]}return o.invert=function(t,e){var n=i-e;return[fu(t,cu(n))/r*yu(n),i-yu(r)*_u(t*t+n*n)]},o}var Ih=function(){return hh(Mh).scale(131.154).center([0,13.9389])},Lh=1.340264,Rh=-.081106,jh=893e-6,zh=.003796,Dh=_u(3)/2;function Fh(t,e){var n=wu(Dh*mu(e)),r=n*n,i=r*r*r;return[t*hu(n)/(Dh*(Lh+3*Rh*r+i*(7*jh+9*zh*r))),n*(Lh+Rh*r+i*(jh+zh*r))]}Fh.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(Lh+Rh*i+o*(jh+zh*i))-e)/(Lh+3*Rh*i+o*(7*jh+9*zh*i)))*r)*i*i,!(cu(n)<1e-12));++a);return[Dh*t*(Lh+3*Rh*i+o*(7*jh+9*zh*i))/hu(r),wu(mu(r)/Dh)]};var Nh=function(){return lh(Fh).scale(177.158)};function Bh(t,e){var n=hu(e),r=hu(t)*n;return[n*mu(t)/r,mu(e)/r]}Bh.invert=yh(lu);var Uh=function(){return lh(Bh).scale(144.049).clipAngle(60)};function Vh(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?Ql:Qf({point:function(i,o){this.stream.point(i*t+n,o*e+r)}})}var Gh=function(){var t,e,n,r,i,o,a=1,s=0,u=0,c=1,l=1,f=Ql,h=null,p=Ql;function d(){return r=i=null,o}return o={stream:function(t){return r&&i===t?r:r=f(p(i=t))},postclip:function(r){return arguments.length?(p=r,h=t=e=n=null,d()):p},clipExtent:function(r){return arguments.length?(p=null==r?(h=t=e=n=null,Ql):bl(h=+r[0][0],t=+r[0][1],e=+r[1][0],n=+r[1][1]),d()):null==h?null:[[h,t],[e,n]]},scale:function(t){return arguments.length?(f=Vh((a=+t)*c,a*l,s,u),d()):a},translate:function(t){return arguments.length?(f=Vh(a*c,a*l,s=+t[0],u=+t[1]),d()):[s,u]},reflectX:function(t){return arguments.length?(f=Vh(a*(c=t?-1:1),a*l,s,u),d()):c<0},reflectY:function(t){return arguments.length?(f=Vh(a*c,a*(l=t?-1:1),s,u),d()):l<0},fitExtent:function(t,e){return eh(o,t,e)},fitSize:function(t,e){return nh(o,t,e)},fitWidth:function(t,e){return rh(o,t,e)},fitHeight:function(t,e){return ih(o,t,e)}}};function qh(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}qh.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(cu(n)>nu&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};var Wh=function(){return lh(qh).scale(175.295)};function Zh(t,e){return[hu(e)*mu(t),mu(e)]}Zh.invert=yh(wu);var Xh=function(){return lh(Zh).scale(249.5).clipAngle(90+nu)};function Hh(t,e){var n=hu(e),r=1+hu(t)*n;return[n*mu(t)/r,mu(e)/r]}Hh.invert=yh(function(t){return 2*lu(t)});var Yh=function(){return lh(Hh).scale(250).clipAngle(142)};function Kh(t,e){return[vu(bu((iu+e)/2)),-t]}Kh.invert=function(t,e){return[-e,2*lu(du(t))-iu]};var Jh=function(){var t=Ph(Kh),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};function Qh(t,e){return t.parent===e.parent?1:2}function $h(t,e){return t+e.x}function tp(t,e){return Math.max(t,e.y)}var ep=function(){var t=Qh,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter(function(e){var n=e.children;n?(e.x=function(t){return t.reduce($h,0)/t.length}(n),e.y=function(t){return 1+t.reduce(tp,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)});var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),c=s.x-t(s,u)/2,l=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(l-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i};function np(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function rp(t,e){var n,r,i,o,a,s=new sp(t),u=+t.value&&(s.value=t.value),c=[s];for(null==e&&(e=ip);n=c.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)c.push(r=n.children[o]=new sp(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ap)}function ip(t){return t.children}function op(t){t.data=t.data.data}function ap(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function sp(t){this.data=t,this.depth=this.height=0,this.parent=null}sp.prototype=rp.prototype={constructor:sp,count:function(){return this.eachAfter(np)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return rp(this).eachBefore(op)}};var up=Array.prototype.slice;var cp=function(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(up.call(t))).length,o=[];r<i;)e=t[r],n&&hp(n,e)?++r:(n=dp(o=lp(o,e)),r=0);return n};function lp(t,e){var n,r;if(pp(e,t))return[e];for(n=0;n<t.length;++n)if(fp(e,t[n])&&pp(vp(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(fp(vp(t[n],t[r]),e)&&fp(vp(t[n],e),t[r])&&fp(vp(t[r],e),t[n])&&pp(gp(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function fp(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function hp(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function pp(t,e){for(var n=0;n<e.length;++n)if(!hp(t,e[n]))return!1;return!0}function dp(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return vp(t[0],t[1]);case 3:return gp(t[0],t[1],t[2])}}function vp(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,u=o-n,c=a-r,l=s-i,f=Math.sqrt(u*u+c*c);return{x:(n+o+u/f*l)/2,y:(r+a+c/f*l)/2,r:(f+i+s)/2}}function gp(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,u=e.r,c=n.x,l=n.y,f=n.r,h=r-a,p=r-c,d=i-s,v=i-l,g=u-o,m=f-o,y=r*r+i*i-o*o,_=y-a*a-s*s+u*u,b=y-c*c-l*l+f*f,x=p*d-h*v,w=(d*b-v*_)/(2*x)-r,E=(v*g-d*m)/x,S=(p*_-h*b)/(2*x)-i,P=(h*m-p*g)/x,T=E*E+P*P-1,A=2*(o+w*E+S*P),k=w*w+S*S-o*o,C=-(T?(A+Math.sqrt(A*A-4*T*k))/(2*T):k/A);return{x:r+w+E*C,y:i+S+P*C,r:C}}function mp(t,e,n){var r,i,o,a,s=t.x-e.x,u=t.y-e.y,c=s*s+u*u;c?(i=e.r+n.r,i*=i,a=t.r+n.r,i>(a*=a)?(r=(c+a-i)/(2*c),o=Math.sqrt(Math.max(0,a/c-r*r)),n.x=t.x-r*s-o*u,n.y=t.y-r*u+o*s):(r=(c+i-a)/(2*c),o=Math.sqrt(Math.max(0,i/c-r*r)),n.x=e.x+r*s-o*u,n.y=e.y+r*u+o*s)):(n.x=e.x+n.r,n.y=e.y)}function yp(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function _p(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function bp(t){this._=t,this.next=null,this.previous=null}function xp(t){if(!(i=t.length))return 0;var e,n,r,i,o,a,s,u,c,l,f;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;mp(n,e,r=t[2]),e=new bp(e),n=new bp(n),r=new bp(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){mp(e._,n._,r=t[s]),r=new bp(r),u=n.next,c=e.previous,l=n._.r,f=e._.r;do{if(l<=f){if(yp(u._,r._)){n=u,e.next=n,n.previous=e,--s;continue t}l+=u._.r,u=u.next}else{if(yp(c._,r._)){(e=c).next=n,n.previous=e,--s;continue t}f+=c._.r,c=c.previous}}while(u!==c.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,o=_p(e);(r=r.next)!==n;)(a=_p(r))<o&&(e=r,o=a);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=cp(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}var wp=function(t){return xp(t),t};function Ep(t){if("function"!=typeof t)throw new Error;return t}function Sp(){return 0}var Pp=function(t){return function(){return t}};function Tp(t){return Math.sqrt(t.value)}var Ap=function(){var t=null,e=1,n=1,r=Sp;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(kp(t)).eachAfter(Cp(r,.5)).eachBefore(Op(1)):i.eachBefore(kp(Tp)).eachAfter(Cp(Sp,1)).eachAfter(Cp(r,i.r/Math.min(e,n))).eachBefore(Op(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=function(t){return null==t?null:Ep(t)}(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:Pp(+t),i):r},i};function kp(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Cp(t,e){return function(n){if(r=n.children){var r,i,o,a=r.length,s=t(n)*e||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=xp(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function Op(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var Mp=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Ip=function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(r-e)/t.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c},Lp=function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&Ip(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(Mp),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},Rp="$",jp={depth:-1},zp={};function Dp(t){return t.id}function Fp(t){return t.parentId}var Np=function(){var t=Dp,e=Fp;function n(n){var r,i,o,a,s,u,c,l=n.length,f=new Array(l),h={};for(i=0;i<l;++i)r=n[i],s=f[i]=new sp(r),null!=(u=t(r,i,n))&&(u+="")&&(h[c=Rp+(s.id=u)]=c in h?zp:s);for(i=0;i<l;++i)if(s=f[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(a=h[Rp+u]))throw new Error("missing: "+u);if(a===zp)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=jp,o.eachBefore(function(t){t.depth=t.parent.depth+1,--l}).eachBefore(ap),o.parent=null,l>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=Ep(e),n):t},n.parentId=function(t){return arguments.length?(e=Ep(t),n):e},n};function Bp(t,e){return t.parent===e.parent?1:2}function Up(t){var e=t.children;return e?e[0]:t.t}function Vp(t){var e=t.children;return e?e[e.length-1]:t.t}function Gp(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function qp(t,e,n){return t.a.parent===e.parent?t.a:n}function Wp(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Wp.prototype=Object.create(sp.prototype);var Zp=function(){var t=Bp,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,o,a=new Wp(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new Wp(r[i],i)),n.parent=e;return(a.parent=new Wp(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var c=i,l=i,f=i;i.eachBefore(function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>f.depth&&(f=t)});var h=c===l?1:t(c,l)/2,p=h-c.x,d=e/(l.x+h+p),v=n/(f.depth||1);i.eachBefore(function(t){t.x=(t.x+p)*d,t.y=t.depth*v})}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,u=o.parent.children[0],c=o.m,l=a.m,f=s.m,h=u.m;s=Vp(s),o=Up(o),s&&o;)u=Up(u),(a=Vp(a)).a=e,(i=s.z+f-o.z-c+t(s._,o._))>0&&(Gp(qp(s,e,r),e,i),c+=i,l+=i),f+=s.m,c+=o.m,h+=u.m,l+=a.m;s&&!Vp(a)&&(a.t=s,a.m+=f-l),o&&!Up(u)&&(u.t=o,u.m+=c-h,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},Xp=function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(i-n)/t.value;++s<u;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c},Hp=(1+Math.sqrt(5))/2;function Yp(t,e,n,r,i,o){for(var a,s,u,c,l,f,h,p,d,v,g,m=[],y=e.children,_=0,b=0,x=y.length,w=e.value;_<x;){u=i-n,c=o-r;do{l=y[b++].value}while(!l&&b<x);for(f=h=l,g=l*l*(v=Math.max(c/u,u/c)/(w*t)),d=Math.max(h/g,g/f);b<x;++b){if(l+=s=y[b].value,s<f&&(f=s),s>h&&(h=s),g=l*l*v,(p=Math.max(h/g,g/f))>d){l-=s;break}d=p}m.push(a={value:l,dice:u<c,children:y.slice(_,b)}),a.dice?Ip(a,n,r,i,w?r+=c*l/w:o):Xp(a,n,r,w?n+=u*l/w:i,o),w-=l,_=b}return m}var Kp=function t(e){function n(t,n,r,i,o){Yp(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Hp),Jp=function(){var t=Kp,e=!1,n=1,r=1,i=[0],o=Sp,a=Sp,s=Sp,u=Sp,c=Sp;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(Mp),t}function f(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,f=e.x1-n,h=e.y1-n;f<r&&(r=f=(r+f)/2),h<l&&(l=h=(l+h)/2),e.x0=r,e.y0=l,e.x1=f,e.y1=h,e.children&&(n=i[e.depth+1]=o(e)/2,r+=c(e)-n,l+=a(e)-n,f-=s(e)-n,h-=u(e)-n,f<r&&(r=f=(r+f)/2),h<l&&(l=h=(l+h)/2),t(e,r,l,f,h))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=Ep(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:Pp(+t),l):o},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:Pp(+t),l):a},l.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:Pp(+t),l):s},l.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:Pp(+t),l):u},l.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:Pp(+t),l):c},l},Qp=function(t,e,n,r,i){var o,a,s=t.children,u=s.length,c=new Array(u+1);for(c[0]=a=o=0;o<u;++o)c[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,u){if(e>=n-1){var l=s[e];return l.x0=i,l.y0=o,l.x1=a,void(l.y1=u)}var f=c[e],h=r/2+f,p=e+1,d=n-1;for(;p<d;){var v=p+d>>>1;c[v]<h?p=v+1:d=v}h-c[p-1]<c[p]-h&&e+1<p&&--p;var g=c[p]-f,m=r-g;if(a-i>u-o){var y=(i*m+a*g)/r;t(e,p,g,i,o,y,u),t(p,n,m,y,o,a,u)}else{var _=(o*m+u*g)/r;t(e,p,g,i,o,a,_),t(p,n,m,i,_,a,u)}}(0,u,t.value,e,n,r,i)},$p=function(t,e,n,r,i){(1&t.depth?Xp:Ip)(t,e,n,r,i)},td=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,u,c,l,f=-1,h=a.length,p=t.value;++f<h;){for(u=(s=a[f]).children,c=s.value=0,l=u.length;c<l;++c)s.value+=u[c].value;s.dice?Ip(s,n,r,i,r+=(o-r)*s.value/p):Xp(s,n,r,n+=(i-n)*s.value/p,o),p-=s.value}else t._squarify=a=Yp(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Hp),ed=function(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)e=i,i=t[n],o+=e[1]*i[0]-e[0]*i[1];return o/2},nd=function(t){for(var e,n,r=-1,i=t.length,o=0,a=0,s=t[i-1],u=0;++r<i;)e=s,s=t[r],u+=n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o/(u*=3),a/u]},rd=function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])};function id(t,e){return t[0]-e[0]||t[1]-e[1]}function od(t){for(var e=t.length,n=[0,1],r=2,i=2;i<e;++i){for(;r>1&&rd(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}var ad=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(id),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var o=od(r),a=od(i),s=a[0]===o[0],u=a[a.length-1]===o[o.length-1],c=[];for(e=o.length-1;e>=0;--e)c.push(t[r[o[e]][2]]);for(e=+s;e<a.length-u;++e)c.push(t[r[a[e]][2]]);return c},sd=function(t,e){for(var n,r,i=t.length,o=t[i-1],a=e[0],s=e[1],u=o[0],c=o[1],l=!1,f=0;f<i;++f)n=(o=t[f])[0],(r=o[1])>s!=c>s&&a<(u-n)*(s-r)/(c-r)+n&&(l=!l),u=n,c=r;return l},ud=function(t){for(var e,n,r=-1,i=t.length,o=t[i-1],a=o[0],s=o[1],u=0;++r<i;)e=a,n=s,e-=a=(o=t[r])[0],n-=s=o[1],u+=Math.sqrt(e*e+n*n);return u},cd=function(){return Math.random()},ld=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(cd),fd=function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(cd),hd=function t(e){function n(){var t=fd.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(cd),pd=function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(cd),dd=function t(e){function n(t){var n=pd.source(e)(t);return function(){return n()/t}}return n.source=t,n}(cd),vd=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(cd),gd=Array.prototype,md=gd.map,yd=gd.slice,_d={name:"implicit"};function bd(t){var e=Qo(),n=[],r=_d;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==_d)return r;e.set(o,a=n.push(i))}return t[(a-1)%t.length]}return t=null==t?[]:yd.call(t),i.domain=function(t){if(!arguments.length)return n.slice();n=[],e=Qo();for(var r,o,a=-1,s=t.length;++a<s;)e.has(o=(r=t[a])+"")||e.set(o,n.push(r));return i},i.range=function(e){return arguments.length?(t=yd.call(e),i):t.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return bd().domain(n).range(t).unknown(r)},i}function xd(){var t,e,n=bd().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,u=0,c=.5;function l(){var n=r().length,l=o[1]<o[0],f=o[l-0],h=o[1-l];t=(h-f)/Math.max(1,n-s+2*u),a&&(t=Math.floor(t)),f+=(h-f-t*(n-s))*c,e=t*(1-s),a&&(f=Math.round(f),e=Math.round(e));var p=w(n).map(function(e){return f+t*e});return i(l?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),l()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],l()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,l()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,l()):a},n.padding=function(t){return arguments.length?(s=u=Math.max(0,Math.min(1,t)),l()):s},n.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},n.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},n.copy=function(){return xd().domain(r()).range(o).round(a).paddingInner(s).paddingOuter(u).align(c)},l()}function wd(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(xd().paddingInner(1))}var Ed=function(t){return function(){return t}},Sd=function(t){return+t},Pd=[0,1];function Td(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Ed(e)}function Ad(t,e,n,r){var i=t[0],o=t[1],a=e[0],s=e[1];return o<i?(i=n(o,i),a=r(s,a)):(i=n(i,o),a=r(a,s)),function(t){return a(i(t))}}function kd(t,e,n,r){var i=Math.min(t.length,e.length)-1,o=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)o[s]=n(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(e){var n=u(t,e,1,i)-1;return a[n](o[n](e))}}function Cd(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function Od(t,e){var n,r,i,o=Pd,a=Pd,s=Jn,u=!1;function c(){return n=Math.min(o.length,a.length)>2?kd:Ad,r=i=null,l}function l(e){return(r||(r=n(o,a,u?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,s)))(+e)}return l.invert=function(t){return(i||(i=n(a,o,Td,u?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},l.domain=function(t){return arguments.length?(o=md.call(t,Sd),c()):o.slice()},l.range=function(t){return arguments.length?(a=yd.call(t),c()):a.slice()},l.rangeRound=function(t){return a=yd.call(t),s=tr,c()},l.clamp=function(t){return arguments.length?(u=!!t,c()):u},l.interpolate=function(t){return arguments.length?(s=t,c()):s},c()}var Md=function(t,e,n){var r,i=t[0],o=t[t.length-1],a=k(i,o,null==e?10:e);switch((n=zs(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(o));return null!=n.precision||isNaN(r=Ks(a,s))||(n.precision=r),Us(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=Js(a,Math.max(Math.abs(i),Math.abs(o))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=Ys(a))||(n.precision=r-2*("%"===n.type))}return Bs(n)};function Id(t){var e=t.domain;return t.ticks=function(t){var n=e();return T(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return Md(e(),t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=A(s,u,n))>0?r=A(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=A(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function Ld(){var t=Od(Td,Vn);return t.copy=function(){return Cd(t,Ld())},Id(t)}function Rd(){var t=[0,1];function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=md.call(n,Sd),e):t.slice()},e.copy=function(){return Rd().domain(t)},Id(e)}var jd=function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t};function zd(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:Ed(e)}function Dd(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function Fd(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Nd(t){return 10===t?Fd:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Bd(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Ud(t){return function(e){return-t(-e)}}function Vd(){var t=Od(zd,Dd).domain([1,10]),e=t.domain,n=10,r=Bd(10),i=Nd(10);function o(){return r=Bd(n),i=Nd(n),e()[0]<0&&(r=Ud(r),i=Ud(i)),t}return t.base=function(t){return arguments.length?(n=+t,o()):n},t.domain=function(t){return arguments.length?(e(t),o()):e()},t.ticks=function(t){var o,a=e(),s=a[0],u=a[a.length-1];(o=u<s)&&(h=s,s=u,u=h);var c,l,f,h=r(s),p=r(u),d=null==t?10:+t,v=[];if(!(n%1)&&p-h<d){if(h=Math.round(h)-1,p=Math.round(p)+1,s>0){for(;h<p;++h)for(l=1,c=i(h);l<n;++l)if(!((f=c*l)<s)){if(f>u)break;v.push(f)}}else for(;h<p;++h)for(l=n-1,c=i(h);l>=1;--l)if(!((f=c*l)<s)){if(f>u)break;v.push(f)}}else v=T(h,p,Math.min(p-h,d)).map(i);return o?v.reverse():v},t.tickFormat=function(e,o){if(null==o&&(o=10===n?".0e":","),"function"!=typeof o&&(o=Bs(o)),e===1/0)return o;null==e&&(e=10);var a=Math.max(1,n*e/t.ticks().length);return function(t){var e=t/i(Math.round(r(t)));return e*n<n-.5&&(e*=n),e<=a?o(t):""}},t.nice=function(){return e(jd(e(),{floor:function(t){return i(Math.floor(r(t)))},ceil:function(t){return i(Math.ceil(r(t)))}}))},t.copy=function(){return Cd(t,Vd().base(n))},t}function Gd(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function qd(){var t=1,e=Od(function(e,n){return(n=Gd(n,t)-(e=Gd(e,t)))?function(r){return(Gd(r,t)-e)/n}:Ed(n)},function(e,n){return n=Gd(n,t)-(e=Gd(e,t)),function(r){return Gd(e+n*r,1/t)}}),n=e.domain;return e.exponent=function(e){return arguments.length?(t=+e,n(n())):t},e.copy=function(){return Cd(e,qd().exponent(t))},Id(e)}function Wd(){return qd().exponent(.5)}function Zd(){var t=[],e=[],n=[];function i(){var r=0,i=Math.max(1,e.length);for(n=new Array(i-1);++r<i;)n[r-1]=M(t,r/i);return o}function o(t){if(!isNaN(t=+t))return e[u(n,t)]}return o.invertExtent=function(r){var i=e.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:t[0],i<n.length?n[i]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var n,o=0,a=e.length;o<a;++o)null==(n=e[o])||isNaN(n=+n)||t.push(n);return t.sort(r),i()},o.range=function(t){return arguments.length?(e=yd.call(t),i()):e.slice()},o.quantiles=function(){return n.slice()},o.copy=function(){return Zd().domain(t).range(e)},o}function Xd(){var t=0,e=1,n=1,r=[.5],i=[0,1];function o(t){if(t<=t)return i[u(r,t,0,n)]}function a(){var i=-1;for(r=new Array(n);++i<n;)r[i]=((i+1)*e-(i-n)*t)/(n+1);return o}return o.domain=function(n){return arguments.length?(t=+n[0],e=+n[1],a()):[t,e]},o.range=function(t){return arguments.length?(n=(i=yd.call(t)).length-1,a()):i.slice()},o.invertExtent=function(o){var a=i.indexOf(o);return a<0?[NaN,NaN]:a<1?[t,r[0]]:a>=n?[r[n-1],e]:[r[a-1],r[a]]},o.copy=function(){return Xd().domain([t,e]).range(i)},Id(o)}function Hd(){var t=[.5],e=[0,1],n=1;function r(r){if(r<=r)return e[u(t,r,0,n)]}return r.domain=function(i){return arguments.length?(t=yd.call(i),n=Math.min(t.length,e.length-1),r):t.slice()},r.range=function(i){return arguments.length?(e=yd.call(i),n=Math.min(t.length,e.length-1),r):e.slice()},r.invertExtent=function(n){var r=e.indexOf(n);return[t[r-1],t[r]]},r.copy=function(){return Hd().domain(t).range(e)},r}var Yd=new Date,Kd=new Date;function Jd(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Jd(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return Yd.setTime(+e),Kd.setTime(+r),t(Yd),t(Kd),Math.floor(n(Yd,Kd))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Qd=Jd(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Qd.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Jd(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Qd:null};var $d=Qd,tv=Qd.range,ev=6e4,nv=6048e5,rv=Jd(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),iv=rv,ov=rv.range,av=Jd(function(t){t.setTime(Math.floor(t/ev)*ev)},function(t,e){t.setTime(+t+e*ev)},function(t,e){return(e-t)/ev},function(t){return t.getMinutes()}),sv=av,uv=av.range,cv=Jd(function(t){var e=t.getTimezoneOffset()*ev%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),lv=cv,fv=cv.range,hv=Jd(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ev)/864e5},function(t){return t.getDate()-1}),pv=hv,dv=hv.range;function vv(t){return Jd(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ev)/nv})}var gv=vv(0),mv=vv(1),yv=vv(2),_v=vv(3),bv=vv(4),xv=vv(5),wv=vv(6),Ev=gv.range,Sv=mv.range,Pv=yv.range,Tv=_v.range,Av=bv.range,kv=xv.range,Cv=wv.range,Ov=Jd(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),Mv=Ov,Iv=Ov.range,Lv=Jd(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Lv.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Jd(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Rv=Lv,jv=Lv.range,zv=Jd(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*ev)},function(t,e){return(e-t)/ev},function(t){return t.getUTCMinutes()}),Dv=zv,Fv=zv.range,Nv=Jd(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),Bv=Nv,Uv=Nv.range,Vv=Jd(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),Gv=Vv,qv=Vv.range;function Wv(t){return Jd(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/nv})}var Zv=Wv(0),Xv=Wv(1),Hv=Wv(2),Yv=Wv(3),Kv=Wv(4),Jv=Wv(5),Qv=Wv(6),$v=Zv.range,tg=Xv.range,eg=Hv.range,ng=Yv.range,rg=Kv.range,ig=Jv.range,og=Qv.range,ag=Jd(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),sg=ag,ug=ag.range,cg=Jd(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});cg.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Jd(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var lg=cg,fg=cg.range;function hg(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function pg(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function dg(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function vg(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=Ag(i),l=kg(i),f=Ag(o),h=kg(o),p=Ag(a),d=kg(a),v=Ag(s),g=kg(s),m=Ag(u),y=kg(u),_={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Hg,e:Hg,f:$g,H:Yg,I:Kg,j:Jg,L:Qg,m:tm,M:em,p:function(t){return i[+(t.getHours()>=12)]},Q:Cm,s:Om,S:nm,u:rm,U:im,V:om,w:am,W:sm,x:null,X:null,y:um,Y:cm,Z:lm,"%":km},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:fm,e:fm,f:gm,H:hm,I:pm,j:dm,L:vm,m:mm,M:ym,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:Cm,s:Om,S:_m,u:bm,U:xm,V:wm,w:Em,W:Sm,x:null,X:null,y:Pm,Y:Tm,Z:Am,"%":km},x={a:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:Fg,e:Fg,f:qg,H:Bg,I:Bg,j:Ng,L:Gg,m:Dg,M:Ug,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},Q:Zg,s:Xg,S:Vg,u:Og,U:Mg,V:Ig,w:Cg,W:Lg,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:jg,Y:Rg,Z:zg,"%":Wg};function w(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=xg[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function E(t,e){return function(n){var r,i,o=dg(1900);if(S(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=(r=pg(dg(o.y))).getUTCDay())>4||0===i?Xv.ceil(r):Xv(r),r=Gv.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=(i=(r=e(dg(o.y))).getDay())>4||0===i?mv.ceil(r):mv(r),r=pv.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?pg(dg(o.y)).getUTCDay():e(dg(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,pg(o)):e(o)}}function S(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=x[i in xg?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=w(n,_),_.X=w(r,_),_.c=w(e,_),b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),{format:function(t){var e=w(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=E(t+="",hg);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=E(t,pg);return e.toString=function(){return t},e}}}var gg,mg,yg,_g,bg,xg={"-":"",_:" ",0:"0"},wg=/^\s*\d+/,Eg=/^%/,Sg=/[\\^$*+?|[\]().{}]/g;function Pg(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Tg(t){return t.replace(Sg,"\\$&")}function Ag(t){return new RegExp("^(?:"+t.map(Tg).join("|")+")","i")}function kg(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Cg(t,e,n){var r=wg.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Og(t,e,n){var r=wg.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Mg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Ig(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Lg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Rg(t,e,n){var r=wg.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function jg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function zg(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Dg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Fg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ng(t,e,n){var r=wg.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Bg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Ug(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Vg(t,e,n){var r=wg.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Gg(t,e,n){var r=wg.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function qg(t,e,n){var r=wg.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Wg(t,e,n){var r=Eg.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Zg(t,e,n){var r=wg.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Xg(t,e,n){var r=wg.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function Hg(t,e){return Pg(t.getDate(),e,2)}function Yg(t,e){return Pg(t.getHours(),e,2)}function Kg(t,e){return Pg(t.getHours()%12||12,e,2)}function Jg(t,e){return Pg(1+pv.count(Rv(t),t),e,3)}function Qg(t,e){return Pg(t.getMilliseconds(),e,3)}function $g(t,e){return Qg(t,e)+"000"}function tm(t,e){return Pg(t.getMonth()+1,e,2)}function em(t,e){return Pg(t.getMinutes(),e,2)}function nm(t,e){return Pg(t.getSeconds(),e,2)}function rm(t){var e=t.getDay();return 0===e?7:e}function im(t,e){return Pg(gv.count(Rv(t),t),e,2)}function om(t,e){var n=t.getDay();return t=n>=4||0===n?bv(t):bv.ceil(t),Pg(bv.count(Rv(t),t)+(4===Rv(t).getDay()),e,2)}function am(t){return t.getDay()}function sm(t,e){return Pg(mv.count(Rv(t),t),e,2)}function um(t,e){return Pg(t.getFullYear()%100,e,2)}function cm(t,e){return Pg(t.getFullYear()%1e4,e,4)}function lm(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Pg(e/60|0,"0",2)+Pg(e%60,"0",2)}function fm(t,e){return Pg(t.getUTCDate(),e,2)}function hm(t,e){return Pg(t.getUTCHours(),e,2)}function pm(t,e){return Pg(t.getUTCHours()%12||12,e,2)}function dm(t,e){return Pg(1+Gv.count(lg(t),t),e,3)}function vm(t,e){return Pg(t.getUTCMilliseconds(),e,3)}function gm(t,e){return vm(t,e)+"000"}function mm(t,e){return Pg(t.getUTCMonth()+1,e,2)}function ym(t,e){return Pg(t.getUTCMinutes(),e,2)}function _m(t,e){return Pg(t.getUTCSeconds(),e,2)}function bm(t){var e=t.getUTCDay();return 0===e?7:e}function xm(t,e){return Pg(Zv.count(lg(t),t),e,2)}function wm(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Kv(t):Kv.ceil(t),Pg(Kv.count(lg(t),t)+(4===lg(t).getUTCDay()),e,2)}function Em(t){return t.getUTCDay()}function Sm(t,e){return Pg(Xv.count(lg(t),t),e,2)}function Pm(t,e){return Pg(t.getUTCFullYear()%100,e,2)}function Tm(t,e){return Pg(t.getUTCFullYear()%1e4,e,4)}function Am(){return"+0000"}function km(){return"%"}function Cm(t){return+t}function Om(t){return Math.floor(+t/1e3)}function Mm(t){return gg=vg(t),mg=gg.format,yg=gg.parse,_g=gg.utcFormat,bg=gg.utcParse,gg}Mm({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Im=Date.prototype.toISOString?function(t){return t.toISOString()}:_g("%Y-%m-%dT%H:%M:%S.%LZ");var Lm=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:bg("%Y-%m-%dT%H:%M:%S.%LZ"),Rm=1e3,jm=60*Rm,zm=60*jm,Dm=24*zm,Fm=7*Dm,Nm=30*Dm,Bm=365*Dm;function Um(t){return new Date(t)}function Vm(t){return t instanceof Date?+t:+new Date(+t)}function Gm(t,e,n,r,o,a,s,u,c){var l=Od(Td,Vn),f=l.invert,h=l.domain,p=c(".%L"),d=c(":%S"),v=c("%I:%M"),g=c("%I %p"),m=c("%a %d"),y=c("%b %d"),_=c("%B"),b=c("%Y"),x=[[s,1,Rm],[s,5,5*Rm],[s,15,15*Rm],[s,30,30*Rm],[a,1,jm],[a,5,5*jm],[a,15,15*jm],[a,30,30*jm],[o,1,zm],[o,3,3*zm],[o,6,6*zm],[o,12,12*zm],[r,1,Dm],[r,2,2*Dm],[n,1,Fm],[e,1,Nm],[e,3,3*Nm],[t,1,Bm]];function w(i){return(s(i)<i?p:a(i)<i?d:o(i)<i?v:r(i)<i?g:e(i)<i?n(i)<i?m:y:t(i)<i?_:b)(i)}function E(e,n,r,o){if(null==e&&(e=10),"number"==typeof e){var a=Math.abs(r-n)/e,s=i(function(t){return t[2]}).right(x,a);s===x.length?(o=k(n/Bm,r/Bm,e),e=t):s?(o=(s=x[a/x[s-1][2]<x[s][2]/a?s-1:s])[1],e=s[0]):(o=Math.max(k(n,r,e),1),e=u)}return null==o?e:e.every(o)}return l.invert=function(t){return new Date(f(t))},l.domain=function(t){return arguments.length?h(md.call(t,Vm)):h().map(Um)},l.ticks=function(t,e){var n,r=h(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=E(t,i,o,e))?n.range(i,o+1):[],a?n.reverse():n},l.tickFormat=function(t,e){return null==e?w:c(e)},l.nice=function(t,e){var n=h();return(t=E(t,n[0],n[n.length-1],e))?h(jd(n,t)):l},l.copy=function(){return Cd(l,Gm(t,e,n,r,o,a,s,u,c))},l}var qm=function(){return Gm(Rv,Mv,gv,pv,lv,sv,iv,$d,mg).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},Wm=function(){return Gm(lg,sg,Zv,Gv,Bv,Dv,iv,$d,_g).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])};function Zm(t){var e=0,n=1,r=1,i=!1;function o(n){var o=(n-e)*r;return t(i?Math.max(0,Math.min(1,o)):o)}return o.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],r=e===n?0:1/(n-e),o):[e,n]},o.clamp=function(t){return arguments.length?(i=!!t,o):i},o.interpolator=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return Zm(t).domain([e,n]).clamp(i)},Id(o)}function Xm(t){var e=0,n=.5,r=1,i=1,o=1,a=!1;function s(e){var r=.5+((e=+e)-n)*(e<n?i:o);return t(a?Math.max(0,Math.min(1,r)):r)}return s.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],r=+t[2],i=e===n?0:.5/(n-e),o=n===r?0:.5/(r-n),s):[e,n,r]},s.clamp=function(t){return arguments.length?(a=!!t,s):a},s.interpolator=function(e){return arguments.length?(t=e,s):t},s.copy=function(){return Xm(t).domain([e,n,r]).clamp(a)},Id(s)}var Hm=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n},Ym=Hm("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Km=Hm("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Jm=Hm("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Qm=Hm("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),$m=Hm("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),ty=Hm("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),ey=Hm("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),ny=Hm("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),ry=Hm("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),iy=function(t){return Fn(t[t.length-1])},oy=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Hm),ay=iy(oy),sy=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Hm),uy=iy(sy),cy=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Hm),ly=iy(cy),fy=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Hm),hy=iy(fy),py=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Hm),dy=iy(py),vy=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Hm),gy=iy(vy),my=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Hm),yy=iy(my),_y=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Hm),by=iy(_y),xy=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Hm),wy=iy(xy),Ey=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Hm),Sy=iy(Ey),Py=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Hm),Ty=iy(Py),Ay=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Hm),ky=iy(Ay),Cy=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Hm),Oy=iy(Cy),My=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Hm),Iy=iy(My),Ly=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Hm),Ry=iy(Ly),jy=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Hm),zy=iy(jy),Dy=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Hm),Fy=iy(Dy),Ny=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Hm),By=iy(Ny),Uy=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Hm),Vy=iy(Uy),Gy=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Hm),qy=iy(Gy),Wy=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Hm),Zy=iy(Wy),Xy=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Hm),Hy=iy(Xy),Yy=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Hm),Ky=iy(Yy),Jy=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Hm),Qy=iy(Jy),$y=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Hm),t_=iy($y),e_=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Hm),n_=iy(e_),r_=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Hm),i_=iy(r_),o_=_r(Tn(300,.5,0),Tn(-240,.5,1)),a_=_r(Tn(-100,.75,.35),Tn(80,1.5,.8)),s_=_r(Tn(260,.75,.35),Tn(80,1.5,.8)),u_=Tn(),c_=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return u_.h=360*t-100,u_.s=1.5-1.5*e,u_.l=.8-.9*e,u_+""},l_=We(),f_=Math.PI/3,h_=2*Math.PI/3,p_=function(t){var e;return t=(.5-t)*Math.PI,l_.r=255*(e=Math.sin(t))*e,l_.g=255*(e=Math.sin(t+f_))*e,l_.b=255*(e=Math.sin(t+h_))*e,l_+""};function d_(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var v_=d_(Hm("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),g_=d_(Hm("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),m_=d_(Hm("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),y_=d_(Hm("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),__=function(t){return function(){return t}},b_=Math.abs,x_=Math.atan2,w_=Math.cos,E_=Math.max,S_=Math.min,P_=Math.sin,T_=Math.sqrt,A_=1e-12,k_=Math.PI,C_=k_/2,O_=2*k_;function M_(t){return t>=1?C_:t<=-1?-C_:Math.asin(t)}function I_(t){return t.innerRadius}function L_(t){return t.outerRadius}function R_(t){return t.startAngle}function j_(t){return t.endAngle}function z_(t){return t&&t.padAngle}function D_(t,e,n,r,i,o,a){var s=t-n,u=e-r,c=(a?o:-o)/T_(s*s+u*u),l=c*u,f=-c*s,h=t+l,p=e+f,d=n+l,v=r+f,g=(h+d)/2,m=(p+v)/2,y=d-h,_=v-p,b=y*y+_*_,x=i-o,w=h*v-d*p,E=(_<0?-1:1)*T_(E_(0,x*x*b-w*w)),S=(w*_-y*E)/b,P=(-w*y-_*E)/b,T=(w*_+y*E)/b,A=(-w*y+_*E)/b,k=S-g,C=P-m,O=T-g,M=A-m;return k*k+C*C>O*O+M*M&&(S=T,P=A),{cx:S,cy:P,x01:-l,y01:-f,x11:S*(i/x-1),y11:P*(i/x-1)}}var F_=function(){var t=I_,e=L_,n=__(0),r=null,i=R_,o=j_,a=z_,s=null;function u(){var u,c,l=+t.apply(this,arguments),f=+e.apply(this,arguments),h=i.apply(this,arguments)-C_,p=o.apply(this,arguments)-C_,d=b_(p-h),v=p>h;if(s||(s=u=Go()),f<l&&(c=f,f=l,l=c),f>A_)if(d>O_-A_)s.moveTo(f*w_(h),f*P_(h)),s.arc(0,0,f,h,p,!v),l>A_&&(s.moveTo(l*w_(p),l*P_(p)),s.arc(0,0,l,p,h,v));else{var g,m,y=h,_=p,b=h,x=p,w=d,E=d,S=a.apply(this,arguments)/2,P=S>A_&&(r?+r.apply(this,arguments):T_(l*l+f*f)),T=S_(b_(f-l)/2,+n.apply(this,arguments)),A=T,k=T;if(P>A_){var C=M_(P/l*P_(S)),O=M_(P/f*P_(S));(w-=2*C)>A_?(b+=C*=v?1:-1,x-=C):(w=0,b=x=(h+p)/2),(E-=2*O)>A_?(y+=O*=v?1:-1,_-=O):(E=0,y=_=(h+p)/2)}var M=f*w_(y),I=f*P_(y),L=l*w_(x),R=l*P_(x);if(T>A_){var j=f*w_(_),z=f*P_(_),D=l*w_(b),F=l*P_(b);if(d<k_){var N=w>A_?function(t,e,n,r,i,o,a,s){var u=n-t,c=r-e,l=a-i,f=s-o,h=(l*(e-o)-f*(t-i))/(f*u-l*c);return[t+h*u,e+h*c]}(M,I,D,F,j,z,L,R):[L,R],B=M-N[0],U=I-N[1],V=j-N[0],G=z-N[1],q=1/P_(function(t){return t>1?0:t<-1?k_:Math.acos(t)}((B*V+U*G)/(T_(B*B+U*U)*T_(V*V+G*G)))/2),W=T_(N[0]*N[0]+N[1]*N[1]);A=S_(T,(l-W)/(q-1)),k=S_(T,(f-W)/(q+1))}}E>A_?k>A_?(g=D_(D,F,M,I,f,k,v),m=D_(j,z,L,R,f,k,v),s.moveTo(g.cx+g.x01,g.cy+g.y01),k<T?s.arc(g.cx,g.cy,k,x_(g.y01,g.x01),x_(m.y01,m.x01),!v):(s.arc(g.cx,g.cy,k,x_(g.y01,g.x01),x_(g.y11,g.x11),!v),s.arc(0,0,f,x_(g.cy+g.y11,g.cx+g.x11),x_(m.cy+m.y11,m.cx+m.x11),!v),s.arc(m.cx,m.cy,k,x_(m.y11,m.x11),x_(m.y01,m.x01),!v))):(s.moveTo(M,I),s.arc(0,0,f,y,_,!v)):s.moveTo(M,I),l>A_&&w>A_?A>A_?(g=D_(L,R,j,z,l,-A,v),m=D_(M,I,D,F,l,-A,v),s.lineTo(g.cx+g.x01,g.cy+g.y01),A<T?s.arc(g.cx,g.cy,A,x_(g.y01,g.x01),x_(m.y01,m.x01),!v):(s.arc(g.cx,g.cy,A,x_(g.y01,g.x01),x_(g.y11,g.x11),!v),s.arc(0,0,l,x_(g.cy+g.y11,g.cx+g.x11),x_(m.cy+m.y11,m.cx+m.x11),v),s.arc(m.cx,m.cy,A,x_(m.y11,m.x11),x_(m.y01,m.x01),!v))):s.arc(0,0,l,x,b,v):s.lineTo(L,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-k_/2;return[w_(r)*n,P_(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:__(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:__(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:__(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:__(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:__(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:__(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:__(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u};function N_(t){this._context=t}N_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var B_=function(t){return new N_(t)};function U_(t){return t[0]}function V_(t){return t[1]}var G_=function(){var t=U_,e=V_,n=__(!0),r=null,i=B_,o=null;function a(a){var s,u,c,l=a.length,f=!1;for(null==r&&(o=i(c=Go())),s=0;s<=l;++s)!(s<l&&n(u=a[s],s,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(u,s,a),+e(u,s,a));if(c)return o=null,c+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:__(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:__(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:__(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a},q_=function(){var t=U_,e=null,n=__(0),r=V_,i=__(!0),o=null,a=B_,s=null;function u(u){var c,l,f,h,p,d=u.length,v=!1,g=new Array(d),m=new Array(d);for(null==o&&(s=a(p=Go())),c=0;c<=d;++c){if(!(c<d&&i(h=u[c],c,u))===v)if(v=!v)l=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=c-1;f>=l;--f)s.point(g[f],m[f]);s.lineEnd(),s.areaEnd()}v&&(g[c]=+t(h,c,u),m[c]=+n(h,c,u),s.point(e?+e(h,c,u):g[c],r?+r(h,c,u):m[c]))}if(p)return s=null,p+""||null}function c(){return G_().defined(i).curve(a).context(o)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:__(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:__(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:__(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:__(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:__(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:__(+t),u):r},u.lineX0=u.lineY0=function(){return c().x(t).y(n)},u.lineY1=function(){return c().x(t).y(r)},u.lineX1=function(){return c().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:__(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u},W_=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Z_=function(t){return t},X_=function(){var t=Z_,e=W_,n=null,r=__(0),i=__(O_),o=__(0);function a(a){var s,u,c,l,f,h=a.length,p=0,d=new Array(h),v=new Array(h),g=+r.apply(this,arguments),m=Math.min(O_,Math.max(-O_,i.apply(this,arguments)-g)),y=Math.min(Math.abs(m)/h,o.apply(this,arguments)),_=y*(m<0?-1:1);for(s=0;s<h;++s)(f=v[d[s]=s]=+t(a[s],s,a))>0&&(p+=f);for(null!=e?d.sort(function(t,n){return e(v[t],v[n])}):null!=n&&d.sort(function(t,e){return n(a[t],a[e])}),s=0,c=p?(m-h*_)/p:0;s<h;++s,g=l)u=d[s],l=g+((f=v[u])>0?f*c:0)+_,v[u]={data:a[u],index:s,value:f,startAngle:g,endAngle:l,padAngle:y};return v}return a.value=function(e){return arguments.length?(t="function"==typeof e?e:__(+e),a):t},a.sortValues=function(t){return arguments.length?(e=t,n=null,a):e},a.sort=function(t){return arguments.length?(n=t,e=null,a):n},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:__(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:__(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:__(+t),a):o},a},H_=K_(B_);function Y_(t){this._curve=t}function K_(t){function e(e){return new Y_(t(e))}return e._curve=t,e}function J_(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(K_(t)):e()._curve},t}Y_.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var Q_=function(){return J_(G_().curve(H_))},$_=function(){var t=q_().curve(H_),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return J_(n())},delete t.lineX0,t.lineEndAngle=function(){return J_(r())},delete t.lineX1,t.lineInnerRadius=function(){return J_(i())},delete t.lineY0,t.lineOuterRadius=function(){return J_(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(K_(t)):e()._curve},t},tb=function(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]},eb=Array.prototype.slice;function nb(t){return t.source}function rb(t){return t.target}function ib(t){var e=nb,n=rb,r=U_,i=V_,o=null;function a(){var a,s=eb.call(arguments),u=e.apply(this,s),c=n.apply(this,s);if(o||(o=a=Go()),t(o,+r.apply(this,(s[0]=u,s)),+i.apply(this,s),+r.apply(this,(s[0]=c,s)),+i.apply(this,s)),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(e=t,a):e},a.target=function(t){return arguments.length?(n=t,a):n},a.x=function(t){return arguments.length?(r="function"==typeof t?t:__(+t),a):r},a.y=function(t){return arguments.length?(i="function"==typeof t?t:__(+t),a):i},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a}function ob(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function ab(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function sb(t,e,n,r,i){var o=tb(e,n),a=tb(e,n=(n+i)/2),s=tb(r,n),u=tb(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(a[0],a[1],s[0],s[1],u[0],u[1])}function ub(){return ib(ob)}function cb(){return ib(ab)}function lb(){var t=ib(sb);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var fb={draw:function(t,e){var n=Math.sqrt(e/k_);t.moveTo(n,0),t.arc(0,0,n,0,O_)}},hb={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},pb=Math.sqrt(1/3),db=2*pb,vb={draw:function(t,e){var n=Math.sqrt(e/db),r=n*pb;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},gb=Math.sin(k_/10)/Math.sin(7*k_/10),mb=Math.sin(O_/10)*gb,yb=-Math.cos(O_/10)*gb,_b={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=mb*n,i=yb*n;t.moveTo(0,-n),t.lineTo(r,i);for(var o=1;o<5;++o){var a=O_*o/5,s=Math.cos(a),u=Math.sin(a);t.lineTo(u*n,-s*n),t.lineTo(s*r-u*i,u*r+s*i)}t.closePath()}},bb={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},xb=Math.sqrt(3),wb={draw:function(t,e){var n=-Math.sqrt(e/(3*xb));t.moveTo(0,2*n),t.lineTo(-xb*n,-n),t.lineTo(xb*n,-n),t.closePath()}},Eb=Math.sqrt(3)/2,Sb=1/Math.sqrt(12),Pb=3*(Sb/2+1),Tb={draw:function(t,e){var n=Math.sqrt(e/Pb),r=n/2,i=n*Sb,o=r,a=n*Sb+n,s=-o,u=a;t.moveTo(r,i),t.lineTo(o,a),t.lineTo(s,u),t.lineTo(-.5*r-Eb*i,Eb*r+-.5*i),t.lineTo(-.5*o-Eb*a,Eb*o+-.5*a),t.lineTo(-.5*s-Eb*u,Eb*s+-.5*u),t.lineTo(-.5*r+Eb*i,-.5*i-Eb*r),t.lineTo(-.5*o+Eb*a,-.5*a-Eb*o),t.lineTo(-.5*s+Eb*u,-.5*u-Eb*s),t.closePath()}},Ab=[fb,hb,vb,bb,_b,wb,Tb],kb=function(){var t=__(fb),e=__(64),n=null;function r(){var r;if(n||(n=r=Go()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:__(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:__(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r},Cb=function(){};function Ob(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Mb(t){this._context=t}Mb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ob(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ob(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Ib=function(t){return new Mb(t)};function Lb(t){this._context=t}Lb.prototype={areaStart:Cb,areaEnd:Cb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Ob(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Rb=function(t){return new Lb(t)};function jb(t){this._context=t}jb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ob(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var zb=function(t){return new jb(t)};function Db(t,e){this._basis=new Mb(t),this._beta=e}Db.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*a),this._beta*e[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Fb=function t(e){function n(t){return 1===e?new Mb(t):new Db(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Nb(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Bb(t,e){this._context=t,this._k=(1-e)/6}Bb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Nb(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Nb(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ub=function t(e){function n(t){return new Bb(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Vb(t,e){this._context=t,this._k=(1-e)/6}Vb.prototype={areaStart:Cb,areaEnd:Cb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Nb(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Gb=function t(e){function n(t){return new Vb(t,e)}return n.tension=function(e){return t(+e)},n}(0);function qb(t,e){this._context=t,this._k=(1-e)/6}qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Nb(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Wb=function t(e){function n(t){return new qb(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Zb(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>A_){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>A_){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/l,a=(a*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function Xb(t,e){this._context=t,this._alpha=e}Xb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Zb(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Hb=function t(e){function n(t){return e?new Xb(t,e):new Bb(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Yb(t,e){this._context=t,this._alpha=e}Yb.prototype={areaStart:Cb,areaEnd:Cb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Zb(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Kb=function t(e){function n(t){return e?new Yb(t,e):new Vb(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Jb(t,e){this._context=t,this._alpha=e}Jb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Zb(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Qb=function t(e){function n(t){return e?new Jb(t,e):new qb(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function $b(t){this._context=t}$b.prototype={areaStart:Cb,areaEnd:Cb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var tx=function(t){return new $b(t)};function ex(t){return t<0?-1:1}function nx(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(ex(o)+ex(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function rx(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function ix(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function ox(t){this._context=t}function ax(t){this._context=new sx(t)}function sx(t){this._context=t}function ux(t){return new ox(t)}function cx(t){return new ax(t)}function lx(t){this._context=t}function fx(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}ox.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ix(this,this._t0,rx(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ix(this,rx(this,n=nx(this,t,e)),n);break;default:ix(this,this._t0,n=nx(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(ax.prototype=Object.create(ox.prototype)).point=function(t,e){ox.prototype.point.call(this,e,t)},sx.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},lx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=fx(t),i=fx(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var hx=function(t){return new lx(t)};function px(t,e){this._context=t,this._t=e}px.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var dx=function(t){return new px(t,.5)};function vx(t){return new px(t,0)}function gx(t){return new px(t,1)}var mx=function(t,e){if((i=t.length)>1)for(var n,r,i,o=1,a=t[e[0]],s=a.length;o<i;++o)for(r=a,a=t[e[o]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},yx=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function _x(t,e){return t[e]}var bx=function(){var t=__([]),e=yx,n=mx,r=_x;function i(i){var o,a,s=t.apply(this,arguments),u=i.length,c=s.length,l=new Array(c);for(o=0;o<c;++o){for(var f,h=s[o],p=l[o]=new Array(u),d=0;d<u;++d)p[d]=f=[0,+r(i[d],h,d,i)],f.data=i[d];p.key=h}for(o=0,a=e(l);o<c;++o)l[a[o]].index=o;return n(l,a),l}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:__(eb.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:__(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?yx:"function"==typeof t?t:__(eb.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?mx:t,i):n},i},xx=function(t,e){if((r=t.length)>0){for(var n,r,i,o=0,a=t[0].length;o<a;++o){for(i=n=0;n<r;++n)i+=t[n][o][1]||0;if(i)for(n=0;n<r;++n)t[n][o][1]/=i}mx(t,e)}},wx=function(t,e){if((s=t.length)>1)for(var n,r,i,o,a,s,u=0,c=t[e[0]].length;u<c;++u)for(o=a=0,n=0;n<s;++n)(i=(r=t[e[n]][u])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):r[0]=o},Ex=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],o=i.length;r<o;++r){for(var a=0,s=0;a<n;++a)s+=t[a][r][1]||0;i[r][1]+=i[r][0]=-s/2}mx(t,e)}},Sx=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,o=0,a=1;a<r;++a){for(var s=0,u=0,c=0;s<i;++s){for(var l=t[e[s]],f=l[a][1]||0,h=(f-(l[a-1][1]||0))/2,p=0;p<s;++p){var d=t[e[p]];h+=(d[a][1]||0)-(d[a-1][1]||0)}u+=f,c+=h*f}n[a-1][1]+=n[a-1][0]=o,u&&(o-=c/u)}n[a-1][1]+=n[a-1][0]=o,mx(t,e)}},Px=function(t){var e=t.map(Tx);return yx(t).sort(function(t,n){return e[t]-e[n]})};function Tx(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}var Ax=function(t){return Px(t).reverse()},kx=function(t){var e,n,r=t.length,i=t.map(Tx),o=yx(t).sort(function(t,e){return i[e]-i[t]}),a=0,s=0,u=[],c=[];for(e=0;e<r;++e)n=o[e],a<s?(a+=i[n],u.push(n)):(s+=i[n],c.push(n));return c.reverse().concat(u)},Cx=function(t){return yx(t).reverse()},Ox=function(t){return function(){return t}};function Mx(t){return t[0]}function Ix(t){return t[1]}function Lx(){this._=null}function Rx(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function jx(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function zx(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Dx(t){for(;t.L;)t=t.L;return t}Lx.prototype={constructor:Lx,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Dx(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(jx(this,n),n=(t=n).U),n.C=!1,r.C=!0,zx(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(zx(this,n),n=(t=n).U),n.C=!1,r.C=!0,jx(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?Dx(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,jx(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,zx(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,jx(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,zx(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,jx(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,zx(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var Fx=Lx;function Nx(t,e,n,r){var i=[null,null],o=sw.push(i)-1;return i.left=t,i.right=e,n&&Ux(i,t,e,n),r&&Ux(i,e,t,r),ow[t.index].halfedges.push(o),ow[e.index].halfedges.push(o),i}function Bx(t,e,n){var r=[e,n];return r.left=t,r}function Ux(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Vx(t,e,n,r,i){var o,a=t[0],s=t[1],u=a[0],c=a[1],l=0,f=1,h=s[0]-u,p=s[1]-c;if(o=e-u,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<f&&(f=o)}else if(h>0){if(o>f)return;o>l&&(l=o)}if(o=r-u,h||!(o<0)){if(o/=h,h<0){if(o>f)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<f&&(f=o)}if(o=n-c,p||!(o>0)){if(o/=p,p<0){if(o<l)return;o<f&&(f=o)}else if(p>0){if(o>f)return;o>l&&(l=o)}if(o=i-c,p||!(o<0)){if(o/=p,p<0){if(o>f)return;o>l&&(l=o)}else if(p>0){if(o<l)return;o<f&&(f=o)}return!(l>0||f<1)||(l>0&&(t[0]=[u+l*h,c+l*p]),f<1&&(t[1]=[u+f*h,c+f*p]),!0)}}}}}function Gx(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,u=t[0],c=t.left,l=t.right,f=c[0],h=c[1],p=l[0],d=l[1],v=(f+p)/2,g=(h+d)/2;if(d===h){if(v<e||v>=r)return;if(f>p){if(u){if(u[1]>=i)return}else u=[v,n];o=[v,i]}else{if(u){if(u[1]<n)return}else u=[v,i];o=[v,n]}}else if(s=g-(a=(f-p)/(d-h))*v,a<-1||a>1)if(f>p){if(u){if(u[1]>=i)return}else u=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(u){if(u[1]<n)return}else u=[(i-s)/a,i];o=[(n-s)/a,n]}else if(h<d){if(u){if(u[0]>=r)return}else u=[e,a*e+s];o=[r,a*r+s]}else{if(u){if(u[0]<e)return}else u=[r,a*r+s];o=[e,a*e+s]}return t[0]=u,t[1]=o,!0}function qx(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Wx(t,e){return e[+(e.left!==t.site)]}function Zx(t,e){return e[+(e.left===t.site)]}var Xx,Hx=[];function Yx(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],u=r[0]-a,c=r[1]-s,l=o[0]-a,f=o[1]-s,h=2*(u*f-c*l);if(!(h>=-cw)){var p=u*u+c*c,d=l*l+f*f,v=(f*p-c*d)/h,g=(u*d-l*p)/h,m=Hx.pop()||new function(){Rx(this),this.x=this.y=this.arc=this.site=this.cy=null};m.arc=t,m.site=i,m.x=v+a,m.y=(m.cy=g+s)+Math.sqrt(v*v+g*g),t.circle=m;for(var y=null,_=aw._;_;)if(m.y<_.y||m.y===_.y&&m.x<=_.x){if(!_.L){y=_.P;break}_=_.L}else{if(!_.R){y=_;break}_=_.R}aw.insert(y,m),y||(Xx=m)}}}}function Kx(t){var e=t.circle;e&&(e.P||(Xx=e.N),aw.remove(e),Hx.push(e),Rx(e),t.circle=null)}var Jx=[];function Qx(t){var e=Jx.pop()||new function(){Rx(this),this.edge=this.site=this.circle=null};return e.site=t,e}function $x(t){Kx(t),iw.remove(t),Jx.push(t),Rx(t)}function tw(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];$x(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<uw&&Math.abs(r-u.circle.cy)<uw;)o=u.P,s.unshift(u),$x(u),u=o;s.unshift(u),Kx(u);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<uw&&Math.abs(r-c.circle.cy)<uw;)a=c.N,s.push(c),$x(c),c=a;s.push(c),Kx(c);var l,f=s.length;for(l=1;l<f;++l)c=s[l],u=s[l-1],Ux(c.edge,u.site,c.site,i);u=s[0],(c=s[f-1]).edge=Nx(u.site,c.site,null,i),Yx(u),Yx(c)}function ew(t){for(var e,n,r,i,o=t[0],a=t[1],s=iw._;s;)if((r=nw(s,a)-o)>uw)s=s.L;else{if(!((i=o-rw(s,a))>uw)){r>-uw?(e=s.P,n=s):i>-uw?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){ow[t.index]={site:t,halfedges:[]}}(t);var u=Qx(t);if(iw.insert(e,u),e||n){if(e===n)return Kx(e),n=Qx(e.site),iw.insert(u,n),u.edge=n.edge=Nx(e.site,u.site),Yx(e),void Yx(n);if(n){Kx(e),Kx(n);var c=e.site,l=c[0],f=c[1],h=t[0]-l,p=t[1]-f,d=n.site,v=d[0]-l,g=d[1]-f,m=2*(h*g-p*v),y=h*h+p*p,_=v*v+g*g,b=[(g*y-p*_)/m+l,(h*_-v*y)/m+f];Ux(n.edge,c,d,b),u.edge=Nx(c,t,null,b),n.edge=Nx(t,d,null,b),Yx(e),Yx(n)}else u.edge=Nx(e.site,u.site)}}function nw(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],u=n[1],c=u-e;if(!c)return s;var l=s-r,f=1/o-1/c,h=l/c;return f?(-h+Math.sqrt(h*h-2*f*(l*l/(-2*c)-u+c/2+i-o/2)))/f+r:(r+s)/2}function rw(t,e){var n=t.N;if(n)return nw(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var iw,ow,aw,sw,uw=1e-6,cw=1e-12;function lw(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function fw(t,e){return e[1]-t[1]||e[0]-t[0]}function hw(t,e){var n,r,i,o=t.sort(fw).pop();for(sw=[],ow=new Array(t.length),iw=new Fx,aw=new Fx;;)if(i=Xx,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(ew(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;tw(i.arc)}if(function(){for(var t,e,n,r,i=0,o=ow.length;i<o;++i)if((t=ow[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=qx(t,sw[e[n]]);for(a.sort(function(t,e){return s[e]-s[t]}),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],u=+e[1][0],c=+e[1][1];!function(t,e,n,r){for(var i,o=sw.length;o--;)Gx(i=sw[o],t,e,n,r)&&Vx(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>uw||Math.abs(i[0][1]-i[1][1])>uw)||delete sw[o]}(a,s,u,c),function(t,e,n,r){var i,o,a,s,u,c,l,f,h,p,d,v,g=ow.length,m=!0;for(i=0;i<g;++i)if(o=ow[i]){for(a=o.site,s=(u=o.halfedges).length;s--;)sw[u[s]]||u.splice(s,1);for(s=0,c=u.length;s<c;)d=(p=Zx(o,sw[u[s]]))[0],v=p[1],f=(l=Wx(o,sw[u[++s%c]]))[0],h=l[1],(Math.abs(d-f)>uw||Math.abs(v-h)>uw)&&(u.splice(s,0,sw.push(Bx(a,p,Math.abs(d-t)<uw&&r-v>uw?[t,Math.abs(f-t)<uw?h:r]:Math.abs(v-r)<uw&&n-d>uw?[Math.abs(h-r)<uw?f:n,r]:Math.abs(d-n)<uw&&v-e>uw?[n,Math.abs(f-n)<uw?h:e]:Math.abs(v-e)<uw&&d-t>uw?[Math.abs(h-e)<uw?f:t,e]:null))-1),++c);c&&(m=!1)}if(m){var y,_,b,x=1/0;for(i=0,m=null;i<g;++i)(o=ow[i])&&(b=(y=(a=o.site)[0]-t)*y+(_=a[1]-e)*_)<x&&(x=b,m=o);if(m){var w=[t,e],E=[t,r],S=[n,r],P=[n,e];m.halfedges.push(sw.push(Bx(a=m.site,w,E))-1,sw.push(Bx(a,E,S))-1,sw.push(Bx(a,S,P))-1,sw.push(Bx(a,P,w))-1)}}for(i=0;i<g;++i)(o=ow[i])&&(o.halfedges.length||delete ow[i])}(a,s,u,c)}this.edges=sw,this.cells=ow,iw=aw=sw=ow=null}hw.prototype={constructor:hw,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return Wx(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s=n.site,u=-1,c=e[i[o-1]],l=c.left===s?c.right:c.left;++u<o;)a=l,l=(c=e[i[u]]).left===s?c.right:c.left,a&&l&&r<a.index&&r<l.index&&lw(s,a,l)<0&&t.push([s.data,a.data,l.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var u=t-i.site[0],c=e-i.site[1],l=u*u+c*c;do{i=o.cells[r=a],a=null,i.halfedges.forEach(function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var u=t-s[0],c=e-s[1],f=u*u+c*c;f<l&&(l=f,a=s.index)}})}while(null!==a);return o._found=r,null==n||l<=n*n?i.site:null}};var pw=function(){var t=Mx,e=Ix,n=null;function r(r){return new hw(r.map(function(n,i){var o=[Math.round(t(n,i,r)/uw)*uw,Math.round(e(n,i,r)/uw)*uw];return o.index=i,o.data=n,o}),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:Ox(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:Ox(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r},dw=function(t){return function(){return t}};function vw(t,e,n){this.k=t,this.x=e,this.y=n}vw.prototype={constructor:vw,scale:function(t){return 1===t?this:new vw(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new vw(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var gw=new vw(1,0,0);function mw(t){return t.__zoom||gw}function yw(){Xt.stopImmediatePropagation()}mw.prototype=vw.prototype;var _w=function(){Xt.preventDefault(),Xt.stopImmediatePropagation()};function bw(){return!Xt.button}function xw(){var t,e,n=this;return n instanceof SVGElement?(t=(n=n.ownerSVGElement||n).width.baseVal.value,e=n.height.baseVal.value):(t=n.clientWidth,e=n.clientHeight),[[0,0],[t,e]]}function ww(){return this.__zoom||gw}function Ew(){return-Xt.deltaY*(Xt.deltaMode?120:1)/500}function Sw(){return"ontouchstart"in this}function Pw(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}var Tw=function(){var t,e,n=bw,r=xw,i=Pw,o=Ew,a=Sw,s=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],c=250,l=cr,f=[],h=ht("start","zoom","end"),p=500,d=150,v=0;function g(t){t.property("__zoom",ww).on("wheel.zoom",E).on("mousedown.zoom",S).on("dblclick.zoom",P).filter(a).on("touchstart.zoom",T).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",k).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new vw(e,t.x,t.y)}function y(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new vw(t.k,r,i)}function _(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n){t.on("start.zoom",function(){x(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).end()}).tween("zoom",function(){var t=arguments,i=x(this,t),o=r.apply(this,t),a=n||_(o),s=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),u=this.__zoom,c="function"==typeof e?e.apply(this,t):e,f=l(u.invert(a).concat(s/u.k),c.invert(a).concat(s/c.k));return function(t){if(1===t)t=c;else{var e=f(t),n=s/e[2];t=new vw(n,a[0]-e[0]*n,a[1]-e[1]*n)}i.zoom(null,t)}})}function x(t,e){for(var n,r=0,i=f.length;r<i;++r)if((n=f[r]).that===t)return n;return new w(t,e)}function w(t,e){this.that=t,this.args=e,this.index=-1,this.active=0,this.extent=r.apply(t,e)}function E(){if(n.apply(this,arguments)){var t=x(this,arguments),e=this.__zoom,r=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,o.apply(this,arguments)))),a=fe(this);if(t.wheel)t.mouse[0][0]===a[0]&&t.mouse[0][1]===a[1]||(t.mouse[1]=e.invert(t.mouse[0]=a)),clearTimeout(t.wheel);else{if(e.k===r)return;t.mouse=[a,e.invert(a)],ni(this),t.start()}_w(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},d),t.zoom("mouse",i(y(m(e,r),t.mouse[0],t.mouse[1]),t.extent,u))}}function S(){if(!e&&n.apply(this,arguments)){var t=x(this,arguments),r=ie(Xt.view).on("mousemove.zoom",function(){if(_w(),!t.moved){var e=Xt.clientX-a,n=Xt.clientY-s;t.moved=e*e+n*n>v}t.zoom("mouse",i(y(t.that.__zoom,t.mouse[0]=fe(t.that),t.mouse[1]),t.extent,u))},!0).on("mouseup.zoom",function(){r.on("mousemove.zoom mouseup.zoom",null),ye(Xt.view,t.moved),_w(),t.end()},!0),o=fe(this),a=Xt.clientX,s=Xt.clientY;me(Xt.view),yw(),t.mouse=[o,this.__zoom.invert(o)],ni(this),t.start()}}function P(){if(n.apply(this,arguments)){var t=this.__zoom,e=fe(this),o=t.invert(e),a=t.k*(Xt.shiftKey?.5:2),s=i(y(m(t,a),e,o),r.apply(this,arguments),u);_w(),c>0?ie(this).transition().duration(c).call(b,s,e):ie(this).call(g.transform,s)}}function T(){if(n.apply(this,arguments)){var e,r,i,o,a=x(this,arguments),s=Xt.changedTouches,u=s.length;for(yw(),r=0;r<u;++r)i=s[r],o=[o=pe(this,s,i.identifier),this.__zoom.invert(o),i.identifier],a.touch0?a.touch1||(a.touch1=o):(a.touch0=o,e=!0);if(t&&(t=clearTimeout(t),!a.touch1))return a.end(),void((o=ie(this).on("dblclick.zoom"))&&o.apply(this,arguments));e&&(t=setTimeout(function(){t=null},p),ni(this),a.start())}}function A(){var e,n,r,o,a=x(this,arguments),s=Xt.changedTouches,c=s.length;for(_w(),t&&(t=clearTimeout(t)),e=0;e<c;++e)n=s[e],r=pe(this,s,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var l=a.touch0[0],f=a.touch0[1],h=a.touch1[0],p=a.touch1[1],d=(d=h[0]-l[0])*d+(d=h[1]-l[1])*d,v=(v=p[0]-f[0])*v+(v=p[1]-f[1])*v;n=m(n,Math.sqrt(d/v)),r=[(l[0]+h[0])/2,(l[1]+h[1])/2],o=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",i(y(n,r,o),a.extent,u))}function k(){var t,n,r=x(this,arguments),i=Xt.changedTouches,o=i.length;for(yw(),e&&clearTimeout(e),e=setTimeout(function(){e=null},p),t=0;t<o;++t)n=i[t],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0?r.touch0[1]=this.__zoom.invert(r.touch0[0]):r.end()}return g.transform=function(t,e){var n=t.selection?t.selection():t;n.property("__zoom",ww),t!==n?b(t,e):n.interrupt().each(function(){x(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},g.scaleBy=function(t,e){g.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)})},g.scaleTo=function(t,e){g.transform(t,function(){var t=r.apply(this,arguments),n=this.__zoom,o=_(t),a=n.invert(o),s="function"==typeof e?e.apply(this,arguments):e;return i(y(m(n,s),o,a),t,u)})},g.translateBy=function(t,e,n){g.transform(t,function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),u)})},g.translateTo=function(t,e,n){g.transform(t,function(){var t=r.apply(this,arguments),o=this.__zoom,a=_(t);return i(gw.translate(a[0],a[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,u)})},w.prototype={start:function(){return 1==++this.active&&(this.index=f.push(this)-1,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(f.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){Qt(new function(t,e,n){this.target=t,this.type=e,this.transform=n}(g,t,this.that.__zoom),h.apply,h,[t,this.that,this.args])}},g.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:dw(+t),g):o},g.filter=function(t){return arguments.length?(n="function"==typeof t?t:dw(!!t),g):n},g.touchable=function(t){return arguments.length?(a="function"==typeof t?t:dw(!!t),g):a},g.extent=function(t){return arguments.length?(r="function"==typeof t?t:dw([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):r},g.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],g):[s[0],s[1]]},g.translateExtent=function(t){return arguments.length?(u[0][0]=+t[0][0],u[1][0]=+t[1][0],u[0][1]=+t[0][1],u[1][1]=+t[1][1],g):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},g.constrain=function(t){return arguments.length?(i=t,g):i},g.duration=function(t){return arguments.length?(c=+t,g):c},g.interpolate=function(t){return arguments.length?(l=t,g):l},g.on=function(){var t=h.on.apply(h,arguments);return t===h?g:t},g.clickDistance=function(t){return arguments.length?(v=(t=+t)*t,g):Math.sqrt(v)},g};n.d(e,"version",function(){return"5.7.0"}),n.d(e,"bisect",function(){return u}),n.d(e,"bisectRight",function(){return a}),n.d(e,"bisectLeft",function(){return s}),n.d(e,"ascending",function(){return r}),n.d(e,"bisector",function(){return i}),n.d(e,"cross",function(){return f}),n.d(e,"descending",function(){return h}),n.d(e,"deviation",function(){return v}),n.d(e,"extent",function(){return g}),n.d(e,"histogram",function(){return O}),n.d(e,"thresholdFreedmanDiaconis",function(){return I}),n.d(e,"thresholdScott",function(){return L}),n.d(e,"thresholdSturges",function(){return C}),n.d(e,"max",function(){return R}),n.d(e,"mean",function(){return j}),n.d(e,"median",function(){return z}),n.d(e,"merge",function(){return D}),n.d(e,"min",function(){return F}),n.d(e,"pairs",function(){return c}),n.d(e,"permute",function(){return N}),n.d(e,"quantile",function(){return M}),n.d(e,"range",function(){return w}),n.d(e,"scan",function(){return B}),n.d(e,"shuffle",function(){return U}),n.d(e,"sum",function(){return V}),n.d(e,"ticks",function(){return T}),n.d(e,"tickIncrement",function(){return A}),n.d(e,"tickStep",function(){return k}),n.d(e,"transpose",function(){return G}),n.d(e,"variance",function(){return d}),n.d(e,"zip",function(){return W}),n.d(e,"axisTop",function(){return rt}),n.d(e,"axisRight",function(){return it}),n.d(e,"axisBottom",function(){return ot}),n.d(e,"axisLeft",function(){return at}),n.d(e,"brush",function(){return Ao}),n.d(e,"brushX",function(){return Po}),n.d(e,"brushY",function(){return To}),n.d(e,"brushSelection",function(){return So}),n.d(e,"chord",function(){return jo}),n.d(e,"ribbon",function(){return Yo}),n.d(e,"nest",function(){return $o}),n.d(e,"set",function(){return sa}),n.d(e,"map",function(){return Qo}),n.d(e,"keys",function(){return ua}),n.d(e,"values",function(){return ca}),n.d(e,"entries",function(){return la}),n.d(e,"color",function(){return Ue}),n.d(e,"rgb",function(){return We}),n.d(e,"hsl",function(){return Ye}),n.d(e,"lab",function(){return ln}),n.d(e,"hcl",function(){return yn}),n.d(e,"lch",function(){return mn}),n.d(e,"gray",function(){return cn}),n.d(e,"cubehelix",function(){return Tn}),n.d(e,"contours",function(){return ba}),n.d(e,"contourDensity",function(){return Ta}),n.d(e,"dispatch",function(){return ht}),n.d(e,"drag",function(){return Pe}),n.d(e,"dragDisable",function(){return me}),n.d(e,"dragEnable",function(){return ye}),n.d(e,"dsvFormat",function(){return La}),n.d(e,"csvParse",function(){return ja}),n.d(e,"csvParseRows",function(){return za}),n.d(e,"csvFormat",function(){return Da}),n.d(e,"csvFormatRows",function(){return Fa}),n.d(e,"tsvParse",function(){return Ba}),n.d(e,"tsvParseRows",function(){return Ua}),n.d(e,"tsvFormat",function(){return Va}),n.d(e,"tsvFormatRows",function(){return Ga}),n.d(e,"easeLinear",function(){return fi}),n.d(e,"easeQuad",function(){return di}),n.d(e,"easeQuadIn",function(){return hi}),n.d(e,"easeQuadOut",function(){return pi}),n.d(e,"easeQuadInOut",function(){return di}),n.d(e,"easeCubic",function(){return mi}),n.d(e,"easeCubicIn",function(){return vi}),n.d(e,"easeCubicOut",function(){return gi}),n.d(e,"easeCubicInOut",function(){return mi}),n.d(e,"easePoly",function(){return bi}),n.d(e,"easePolyIn",function(){return yi}),n.d(e,"easePolyOut",function(){return _i}),n.d(e,"easePolyInOut",function(){return bi}),n.d(e,"easeSin",function(){return Pi}),n.d(e,"easeSinIn",function(){return Ei}),n.d(e,"easeSinOut",function(){return Si}),n.d(e,"easeSinInOut",function(){return Pi}),n.d(e,"easeExp",function(){return ki}),n.d(e,"easeExpIn",function(){return Ti}),n.d(e,"easeExpOut",function(){return Ai}),n.d(e,"easeExpInOut",function(){return ki}),n.d(e,"easeCircle",function(){return Mi}),n.d(e,"easeCircleIn",function(){return Ci}),n.d(e,"easeCircleOut",function(){return Oi}),n.d(e,"easeCircleInOut",function(){return Mi}),n.d(e,"easeBounce",function(){return Gi}),n.d(e,"easeBounceIn",function(){return Vi}),n.d(e,"easeBounceOut",function(){return Gi}),n.d(e,"easeBounceInOut",function(){return qi}),n.d(e,"easeBack",function(){return Xi}),n.d(e,"easeBackIn",function(){return Wi}),n.d(e,"easeBackOut",function(){return Zi}),n.d(e,"easeBackInOut",function(){return Xi}),n.d(e,"easeElastic",function(){return Ki}),n.d(e,"easeElasticIn",function(){return Yi}),n.d(e,"easeElasticOut",function(){return Ki}),n.d(e,"easeElasticInOut",function(){return Ji}),n.d(e,"blob",function(){return Wa}),n.d(e,"buffer",function(){return Xa}),n.d(e,"dsv",function(){return Ja}),n.d(e,"csv",function(){return Qa}),n.d(e,"tsv",function(){return $a}),n.d(e,"image",function(){return ts}),n.d(e,"json",function(){return ns}),n.d(e,"text",function(){return Ya}),n.d(e,"xml",function(){return is}),n.d(e,"html",function(){return os}),n.d(e,"svg",function(){return as}),n.d(e,"forceCenter",function(){return ss}),n.d(e,"forceCollide",function(){return bs}),n.d(e,"forceLink",function(){return Es}),n.d(e,"forceManyBody",function(){return Cs}),n.d(e,"forceRadial",function(){return Os}),n.d(e,"forceSimulation",function(){return ks}),n.d(e,"forceX",function(){return Ms}),n.d(e,"forceY",function(){return Is}),n.d(e,"formatDefaultLocale",function(){return Hs}),n.d(e,"format",function(){return Bs}),n.d(e,"formatPrefix",function(){return Us}),n.d(e,"formatLocale",function(){return Xs}),n.d(e,"formatSpecifier",function(){return zs}),n.d(e,"precisionFixed",function(){return Ys}),n.d(e,"precisionPrefix",function(){return Ks}),n.d(e,"precisionRound",function(){return Js}),n.d(e,"geoArea",function(){return Gu}),n.d(e,"geoBounds",function(){return jc}),n.d(e,"geoCentroid",function(){return Xc}),n.d(e,"geoCircle",function(){return il}),n.d(e,"geoClipAntimeridian",function(){return vl}),n.d(e,"geoClipCircle",function(){return gl}),n.d(e,"geoClipExtent",function(){return Sl}),n.d(e,"geoClipRectangle",function(){return bl}),n.d(e,"geoContains",function(){return Vl}),n.d(e,"geoDistance",function(){return Ll}),n.d(e,"geoGraticule",function(){return Wl}),n.d(e,"geoGraticule10",function(){return Zl}),n.d(e,"geoInterpolate",function(){return Jl}),n.d(e,"geoLength",function(){return Ol}),n.d(e,"geoPath",function(){return Kf}),n.d(e,"geoAlbers",function(){return vh}),n.d(e,"geoAlbersUsa",function(){return gh}),n.d(e,"geoAzimuthalEqualArea",function(){return bh}),n.d(e,"geoAzimuthalEqualAreaRaw",function(){return _h}),n.d(e,"geoAzimuthalEquidistant",function(){return wh}),n.d(e,"geoAzimuthalEquidistantRaw",function(){return xh}),n.d(e,"geoConicConformal",function(){return kh}),n.d(e,"geoConicConformalRaw",function(){return Ah}),n.d(e,"geoConicEqualArea",function(){return dh}),n.d(e,"geoConicEqualAreaRaw",function(){return ph}),n.d(e,"geoConicEquidistant",function(){return Ih}),n.d(e,"geoConicEquidistantRaw",function(){return Mh}),n.d(e,"geoEqualEarth",function(){return Nh}),n.d(e,"geoEqualEarthRaw",function(){return Fh}),n.d(e,"geoEquirectangular",function(){return Oh}),n.d(e,"geoEquirectangularRaw",function(){return Ch}),n.d(e,"geoGnomonic",function(){return Uh}),n.d(e,"geoGnomonicRaw",function(){return Bh}),n.d(e,"geoIdentity",function(){return Gh}),n.d(e,"geoProjection",function(){return lh}),n.d(e,"geoProjectionMutator",function(){return fh}),n.d(e,"geoMercator",function(){return Sh}),n.d(e,"geoMercatorRaw",function(){return Eh}),n.d(e,"geoNaturalEarth1",function(){return Wh}),n.d(e,"geoNaturalEarth1Raw",function(){return qh}),n.d(e,"geoOrthographic",function(){return Xh}),n.d(e,"geoOrthographicRaw",function(){return Zh}),n.d(e,"geoStereographic",function(){return Yh}),n.d(e,"geoStereographicRaw",function(){return Hh}),n.d(e,"geoTransverseMercator",function(){return Jh}),n.d(e,"geoTransverseMercatorRaw",function(){return Kh}),n.d(e,"geoRotation",function(){return el}),n.d(e,"geoStream",function(){return ju}),n.d(e,"geoTransform",function(){return Jf}),n.d(e,"cluster",function(){return ep}),n.d(e,"hierarchy",function(){return rp}),n.d(e,"pack",function(){return Ap}),n.d(e,"packSiblings",function(){return wp}),n.d(e,"packEnclose",function(){return cp}),n.d(e,"partition",function(){return Lp}),n.d(e,"stratify",function(){return Np}),n.d(e,"tree",function(){return Zp}),n.d(e,"treemap",function(){return Jp}),n.d(e,"treemapBinary",function(){return Qp}),n.d(e,"treemapDice",function(){return Ip}),n.d(e,"treemapSlice",function(){return Xp}),n.d(e,"treemapSliceDice",function(){return $p}),n.d(e,"treemapSquarify",function(){return Kp}),n.d(e,"treemapResquarify",function(){return td}),n.d(e,"interpolate",function(){return Jn}),n.d(e,"interpolateArray",function(){return Bn}),n.d(e,"interpolateBasis",function(){return Cn}),n.d(e,"interpolateBasisClosed",function(){return On}),n.d(e,"interpolateDate",function(){return Un}),n.d(e,"interpolateDiscrete",function(){return Qn}),n.d(e,"interpolateHue",function(){return $n}),n.d(e,"interpolateNumber",function(){return Vn}),n.d(e,"interpolateObject",function(){return Gn}),n.d(e,"interpolateRound",function(){return tr}),n.d(e,"interpolateString",function(){return Kn}),n.d(e,"interpolateTransformCss",function(){return or}),n.d(e,"interpolateTransformSvg",function(){return ar}),n.d(e,"interpolateZoom",function(){return cr}),n.d(e,"interpolateRgb",function(){return zn}),n.d(e,"interpolateRgbBasis",function(){return Fn}),n.d(e,"interpolateRgbBasisClosed",function(){return Nn}),n.d(e,"interpolateHsl",function(){return fr}),n.d(e,"interpolateHslLong",function(){return hr}),n.d(e,"interpolateLab",function(){return pr}),n.d(e,"interpolateHcl",function(){return vr}),n.d(e,"interpolateHclLong",function(){return gr}),n.d(e,"interpolateCubehelix",function(){return yr}),n.d(e,"interpolateCubehelixLong",function(){return _r}),n.d(e,"piecewise",function(){return br}),n.d(e,"quantize",function(){return Er}),n.d(e,"path",function(){return Go}),n.d(e,"polygonArea",function(){return ed}),n.d(e,"polygonCentroid",function(){return nd}),n.d(e,"polygonHull",function(){return ad}),n.d(e,"polygonContains",function(){return sd}),n.d(e,"polygonLength",function(){return ud}),n.d(e,"quadtree",function(){return ds}),n.d(e,"randomUniform",function(){return ld}),n.d(e,"randomNormal",function(){return fd}),n.d(e,"randomLogNormal",function(){return hd}),n.d(e,"randomBates",function(){return dd}),n.d(e,"randomIrwinHall",function(){return pd}),n.d(e,"randomExponential",function(){return vd}),n.d(e,"scaleBand",function(){return xd}),n.d(e,"scalePoint",function(){return wd}),n.d(e,"scaleIdentity",function(){return Rd}),n.d(e,"scaleLinear",function(){return Ld}),n.d(e,"scaleLog",function(){return Vd}),n.d(e,"scaleOrdinal",function(){return bd}),n.d(e,"scaleImplicit",function(){return _d}),n.d(e,"scalePow",function(){return qd}),n.d(e,"scaleSqrt",function(){return Wd}),n.d(e,"scaleQuantile",function(){return Zd}),n.d(e,"scaleQuantize",function(){return Xd}),n.d(e,"scaleThreshold",function(){return Hd}),n.d(e,"scaleTime",function(){return qm}),n.d(e,"scaleUtc",function(){return Wm}),n.d(e,"scaleSequential",function(){return Zm}),n.d(e,"scaleDiverging",function(){return Xm}),n.d(e,"schemeCategory10",function(){return Ym}),n.d(e,"schemeAccent",function(){return Km}),n.d(e,"schemeDark2",function(){return Jm}),n.d(e,"schemePaired",function(){return Qm}),n.d(e,"schemePastel1",function(){return $m}),n.d(e,"schemePastel2",function(){return ty}),n.d(e,"schemeSet1",function(){return ey}),n.d(e,"schemeSet2",function(){return ny}),n.d(e,"schemeSet3",function(){return ry}),n.d(e,"interpolateBrBG",function(){return ay}),n.d(e,"schemeBrBG",function(){return oy}),n.d(e,"interpolatePRGn",function(){return uy}),n.d(e,"schemePRGn",function(){return sy}),n.d(e,"interpolatePiYG",function(){return ly}),n.d(e,"schemePiYG",function(){return cy}),n.d(e,"interpolatePuOr",function(){return hy}),n.d(e,"schemePuOr",function(){return fy}),n.d(e,"interpolateRdBu",function(){return dy}),n.d(e,"schemeRdBu",function(){return py}),n.d(e,"interpolateRdGy",function(){return gy}),n.d(e,"schemeRdGy",function(){return vy}),n.d(e,"interpolateRdYlBu",function(){return yy}),n.d(e,"schemeRdYlBu",function(){return my}),n.d(e,"interpolateRdYlGn",function(){return by}),n.d(e,"schemeRdYlGn",function(){return _y}),n.d(e,"interpolateSpectral",function(){return wy}),n.d(e,"schemeSpectral",function(){return xy}),n.d(e,"interpolateBuGn",function(){return Sy}),n.d(e,"schemeBuGn",function(){return Ey}),n.d(e,"interpolateBuPu",function(){return Ty}),n.d(e,"schemeBuPu",function(){return Py}),n.d(e,"interpolateGnBu",function(){return ky}),n.d(e,"schemeGnBu",function(){return Ay}),n.d(e,"interpolateOrRd",function(){return Oy}),n.d(e,"schemeOrRd",function(){return Cy}),n.d(e,"interpolatePuBuGn",function(){return Iy}),n.d(e,"schemePuBuGn",function(){return My}),n.d(e,"interpolatePuBu",function(){return Ry}),n.d(e,"schemePuBu",function(){return Ly}),n.d(e,"interpolatePuRd",function(){return zy}),n.d(e,"schemePuRd",function(){return jy}),n.d(e,"interpolateRdPu",function(){return Fy}),n.d(e,"schemeRdPu",function(){return Dy}),n.d(e,"interpolateYlGnBu",function(){return By}),n.d(e,"schemeYlGnBu",function(){return Ny}),n.d(e,"interpolateYlGn",function(){return Vy}),n.d(e,"schemeYlGn",function(){return Uy}),n.d(e,"interpolateYlOrBr",function(){return qy}),n.d(e,"schemeYlOrBr",function(){return Gy}),n.d(e,"interpolateYlOrRd",function(){return Zy}),n.d(e,"schemeYlOrRd",function(){return Wy}),n.d(e,"interpolateBlues",function(){return Hy}),n.d(e,"schemeBlues",function(){return Xy}),n.d(e,"interpolateGreens",function(){return Ky}),n.d(e,"schemeGreens",function(){return Yy}),n.d(e,"interpolateGreys",function(){return Qy}),n.d(e,"schemeGreys",function(){return Jy}),n.d(e,"interpolatePurples",function(){return t_}),n.d(e,"schemePurples",function(){return $y}),n.d(e,"interpolateReds",function(){return n_}),n.d(e,"schemeReds",function(){return e_}),n.d(e,"interpolateOranges",function(){return i_}),n.d(e,"schemeOranges",function(){return r_}),n.d(e,"interpolateCubehelixDefault",function(){return o_}),n.d(e,"interpolateRainbow",function(){return c_}),n.d(e,"interpolateWarm",function(){return a_}),n.d(e,"interpolateCool",function(){return s_}),n.d(e,"interpolateSinebow",function(){return p_}),n.d(e,"interpolateViridis",function(){return v_}),n.d(e,"interpolateMagma",function(){return g_}),n.d(e,"interpolateInferno",function(){return m_}),n.d(e,"interpolatePlasma",function(){return y_}),n.d(e,"create",function(){return oe}),n.d(e,"creator",function(){return gt}),n.d(e,"local",function(){return se}),n.d(e,"matcher",function(){return St}),n.d(e,"mouse",function(){return fe}),n.d(e,"namespace",function(){return vt}),n.d(e,"namespaces",function(){return dt}),n.d(e,"clientPoint",function(){return le}),n.d(e,"select",function(){return ie}),n.d(e,"selectAll",function(){return he}),n.d(e,"selection",function(){return re}),n.d(e,"selector",function(){return yt}),n.d(e,"selectorAll",function(){return bt}),n.d(e,"style",function(){return It}),n.d(e,"touch",function(){return pe}),n.d(e,"touches",function(){return de}),n.d(e,"window",function(){return Mt}),n.d(e,"event",function(){return Xt}),n.d(e,"customEvent",function(){return Qt}),n.d(e,"arc",function(){return F_}),n.d(e,"area",function(){return q_}),n.d(e,"line",function(){return G_}),n.d(e,"pie",function(){return X_}),n.d(e,"areaRadial",function(){return $_}),n.d(e,"radialArea",function(){return $_}),n.d(e,"lineRadial",function(){return Q_}),n.d(e,"radialLine",function(){return Q_}),n.d(e,"pointRadial",function(){return tb}),n.d(e,"linkHorizontal",function(){return ub}),n.d(e,"linkVertical",function(){return cb}),n.d(e,"linkRadial",function(){return lb}),n.d(e,"symbol",function(){return kb}),n.d(e,"symbols",function(){return Ab}),n.d(e,"symbolCircle",function(){return fb}),n.d(e,"symbolCross",function(){return hb}),n.d(e,"symbolDiamond",function(){return vb}),n.d(e,"symbolSquare",function(){return bb}),n.d(e,"symbolStar",function(){return _b}),n.d(e,"symbolTriangle",function(){return wb}),n.d(e,"symbolWye",function(){return Tb}),n.d(e,"curveBasisClosed",function(){return Rb}),n.d(e,"curveBasisOpen",function(){return zb}),n.d(e,"curveBasis",function(){return Ib}),n.d(e,"curveBundle",function(){return Fb}),n.d(e,"curveCardinalClosed",function(){return Gb}),n.d(e,"curveCardinalOpen",function(){return Wb}),n.d(e,"curveCardinal",function(){return Ub}),n.d(e,"curveCatmullRomClosed",function(){return Kb}),n.d(e,"curveCatmullRomOpen",function(){return Qb}),n.d(e,"curveCatmullRom",function(){return Hb}),n.d(e,"curveLinearClosed",function(){return tx}),n.d(e,"curveLinear",function(){return B_}),n.d(e,"curveMonotoneX",function(){return ux}),n.d(e,"curveMonotoneY",function(){return cx}),n.d(e,"curveNatural",function(){return hx}),n.d(e,"curveStep",function(){return dx}),n.d(e,"curveStepAfter",function(){return gx}),n.d(e,"curveStepBefore",function(){return vx}),n.d(e,"stack",function(){return bx}),n.d(e,"stackOffsetExpand",function(){return xx}),n.d(e,"stackOffsetDiverging",function(){return wx}),n.d(e,"stackOffsetNone",function(){return mx}),n.d(e,"stackOffsetSilhouette",function(){return Ex}),n.d(e,"stackOffsetWiggle",function(){return Sx}),n.d(e,"stackOrderAscending",function(){return Px}),n.d(e,"stackOrderDescending",function(){return Ax}),n.d(e,"stackOrderInsideOut",function(){return kx}),n.d(e,"stackOrderNone",function(){return yx}),n.d(e,"stackOrderReverse",function(){return Cx}),n.d(e,"timeInterval",function(){return Jd}),n.d(e,"timeMillisecond",function(){return $d}),n.d(e,"timeMilliseconds",function(){return tv}),n.d(e,"utcMillisecond",function(){return $d}),n.d(e,"utcMilliseconds",function(){return tv}),n.d(e,"timeSecond",function(){return iv}),n.d(e,"timeSeconds",function(){return ov}),n.d(e,"utcSecond",function(){return iv}),n.d(e,"utcSeconds",function(){return ov}),n.d(e,"timeMinute",function(){return sv}),n.d(e,"timeMinutes",function(){return uv}),n.d(e,"timeHour",function(){return lv}),n.d(e,"timeHours",function(){return fv}),n.d(e,"timeDay",function(){return pv}),n.d(e,"timeDays",function(){return dv}),n.d(e,"timeWeek",function(){return gv}),n.d(e,"timeWeeks",function(){return Ev}),n.d(e,"timeSunday",function(){return gv}),n.d(e,"timeSundays",function(){return Ev}),n.d(e,"timeMonday",function(){return mv}),n.d(e,"timeMondays",function(){return Sv}),n.d(e,"timeTuesday",function(){return yv}),n.d(e,"timeTuesdays",function(){return Pv}),n.d(e,"timeWednesday",function(){return _v}),n.d(e,"timeWednesdays",function(){return Tv}),n.d(e,"timeThursday",function(){return bv}),n.d(e,"timeThursdays",function(){return Av}),n.d(e,"timeFriday",function(){return xv}),n.d(e,"timeFridays",function(){return kv}),n.d(e,"timeSaturday",function(){return wv}),n.d(e,"timeSaturdays",function(){return Cv}),n.d(e,"timeMonth",function(){return Mv}),n.d(e,"timeMonths",function(){return Iv}),n.d(e,"timeYear",function(){return Rv}),n.d(e,"timeYears",function(){return jv}),n.d(e,"utcMinute",function(){return Dv}),n.d(e,"utcMinutes",function(){return Fv}),n.d(e,"utcHour",function(){return Bv}),n.d(e,"utcHours",function(){return Uv}),n.d(e,"utcDay",function(){return Gv}),n.d(e,"utcDays",function(){return qv}),n.d(e,"utcWeek",function(){return Zv}),n.d(e,"utcWeeks",function(){return $v}),n.d(e,"utcSunday",function(){return Zv}),n.d(e,"utcSundays",function(){return $v}),n.d(e,"utcMonday",function(){return Xv}),n.d(e,"utcMondays",function(){return tg}),n.d(e,"utcTuesday",function(){return Hv}),n.d(e,"utcTuesdays",function(){return eg}),n.d(e,"utcWednesday",function(){return Yv}),n.d(e,"utcWednesdays",function(){return ng}),n.d(e,"utcThursday",function(){return Kv}),n.d(e,"utcThursdays",function(){return rg}),n.d(e,"utcFriday",function(){return Jv}),n.d(e,"utcFridays",function(){return ig}),n.d(e,"utcSaturday",function(){return Qv}),n.d(e,"utcSaturdays",function(){return og}),n.d(e,"utcMonth",function(){return sg}),n.d(e,"utcMonths",function(){return ug}),n.d(e,"utcYear",function(){return lg}),n.d(e,"utcYears",function(){return fg}),n.d(e,"timeFormatDefaultLocale",function(){return Mm}),n.d(e,"timeFormat",function(){return mg}),n.d(e,"timeParse",function(){return yg}),n.d(e,"utcFormat",function(){return _g}),n.d(e,"utcParse",function(){return bg}),n.d(e,"timeFormatLocale",function(){return vg}),n.d(e,"isoFormat",function(){return Im}),n.d(e,"isoParse",function(){return Lm}),n.d(e,"now",function(){return Lr}),n.d(e,"timer",function(){return zr}),n.d(e,"timerFlush",function(){return Dr}),n.d(e,"timeout",function(){return Ur}),n.d(e,"interval",function(){return Vr}),n.d(e,"transition",function(){return ui}),n.d(e,"active",function(){return eo}),n.d(e,"interrupt",function(){return ni}),n.d(e,"voronoi",function(){return pw}),n.d(e,"zoom",function(){return Tw}),n.d(e,"zoomTransform",function(){return mw}),n.d(e,"zoomIdentity",function(){return gw})},function(t,e,n){"use strict";n.r(e);var r=n(13),i=n(14),o=n.n(i),a=n(11),s="#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=a.t.fp64LowPart,v=[0,0,0,255],g={fp64:!1,getSourcePosition:function(t){return t.sourcePosition},getTargetPosition:function(t){return t.targetPosition},getSourceColor:v,getTargetColor:v,getStrokeWidth:1,widthScale:1},m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=null;return Number.isFinite(t.strokeWidth)&&(r.log.deprecated("ArcLayer: `strokeWidth`","`getStrokeWidth`")(),n={getStrokeWidth:t.strokeWidth}),l(this,h(e).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,r["Layer"]),function(t,e,n){e&&c(t.prototype,e),n&&c(t,n)}(e,[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"#define SHADER_NAME arc-layer-vertex-shader-64\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\n\nattribute vec4 instancePositions;\nattribute vec4 instancePositions64Low;\n\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\n\nvarying vec4 vColor;\n\nvec2 paraboloid_fp64(vec2 source[2], vec2 target[2], float ratio) {\n\n  vec2 x[2];\n  vec2_mix_fp64(source, target, ratio, x);\n  vec2 center[2];\n  vec2_mix_fp64(source, target, 0.5, center);\n\n  vec2 dSourceCenter = vec2_distance_fp64(source, center);\n  vec2 dXCenter = vec2_distance_fp64(x, center);\n  return mul_fp64(sum_fp64(dSourceCenter, dXCenter), sub_fp64(dSourceCenter, dXCenter));\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths * widthScale / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvoid get_pos_fp64(vec2 source[2], vec2 target[2], float segmentRatio, out vec2 position[4]) {\n\n  vec2 vertex_height = paraboloid_fp64(source, target, segmentRatio);\n\n  vec2 position_temp[2];\n\n  vec2_mix_fp64(source, target, segmentRatio, position_temp);\n\n  position[0] = position_temp[0];\n  position[1] = position_temp[1];\n\n  if (vertex_height.x < 0.0 || (vertex_height.x == 0.0 && vertex_height.y <= 0.0)) {\n    vertex_height = vec2(0.0, 0.0);\n  }\n\n  position[2] = sqrt_fp64(vertex_height);\n  position[3] = vec2(1.0, 0.0);\n}\n\nvoid main(void) {\n  vec2 projected_source_coord[2];\n  vec2 projected_target_coord[2];\n\n  project_position_fp64(instancePositions.xy, instancePositions64Low.xy, projected_source_coord);\n  project_position_fp64(instancePositions.zw, instancePositions64Low.zw, projected_target_coord);\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec2 curr_pos_modelspace[4];\n\n  get_pos_fp64(projected_source_coord, projected_target_coord, segmentRatio,\n    curr_pos_modelspace);\n\n  vec2 next_pos_modelspace[4];\n\n  get_pos_fp64(projected_source_coord, projected_target_coord, nextSegmentRatio,\n    next_pos_modelspace);\n\n  vec4 curr_pos_clipspace = project_to_clipspace_fp64(curr_pos_modelspace);\n  vec4 next_pos_clipspace = project_to_clipspace_fp64(next_pos_modelspace);\n\n  vec2 offset = getExtrusionOffset(next_pos_clipspace.xy - curr_pos_clipspace.xy, positions.y);\n\n  gl_Position = curr_pos_clipspace + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:s,modules:["project64","picking"]}:{vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec4 instancePositions;\nattribute vec4 instancePositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\n\nvarying vec4 vColor;\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths * widthScale / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\n\nvoid main(void) {\n  vec2 source = project_position(vec3(instancePositions.xy, 0.0), instancePositions64Low.xy).xy;\n  vec2 target = project_position(vec3(instancePositions.zw, 0.0), instancePositions64Low.zw).xy;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec3 currPos = getPos(source, target, segmentRatio);\n  vec3 nextPos = getPos(source, target, nextSegmentRatio);\n  vec4 curr = project_to_clipspace(vec4(currPos, 1.0));\n  vec4 next = project_to_clipspace(vec4(nextPos, 1.0));\n\n  // extrude\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y);\n  gl_Position = curr + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:s,modules:["picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:4,transition:!0,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstancePositions},instancePositions64Low:{size:4,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstancePositions64Low},instanceSourceColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getSourceColor",defaultValue:v},instanceTargetColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getTargetColor",defaultValue:v},instanceWidths:{size:1,transition:!0,accessor:"getStrokeWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(f(h(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}this.state.model.setUniforms({widthScale:n.widthScale})}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<50;n++)e=e.concat([n,-1,0,n,1,0]);var r=new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLE_STRIP,attributes:{positions:new Float32Array(e)}}),isInstanced:!0,shaderCache:this.context.shaderCache}));return r.setUniforms({numSegments:50}),r}},{key:"calculateInstancePositions",value:function(t){var e=this.props,n=e.data,r=e.getSourcePosition,i=e.getTargetPosition,o=t.value,a=t.size,s=0,u=!0,c=!1,l=void 0;try{for(var f,h=n[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value,d=r(p),v=i(p);o[s+0]=d[0],o[s+1]=d[1],o[s+2]=v[0],o[s+3]=v[1],s+=a}}catch(t){c=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}}},{key:"calculateInstancePositions64Low",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getSourcePosition,o=n.getTargetPosition,a=t.value,s=t.size,u=0,c=!0,l=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value,g=i(v),m=o(v);a[u+0]=d(g[0]),a[u+1]=d(g[1]),a[u+2]=d(m[0]),a[u+3]=d(m[1]),u+=s}}catch(t){l=!0,f=t}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}}else t.value=new Float32Array(4)}}]),e}();m.layerName="ArcLayer",m.defaultProps=g;function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E(t,e,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T=a.t.fp64LowPart,A=[0,0,0,255],k=o.a.LINEAR_MIPMAP_LINEAR,C=o.a.LINEAR,O={iconAtlas:null,iconMapping:{type:"object",value:{},async:!0},sizeScale:1,fp64:!1,getPosition:function(t){return t.position},getIcon:function(t){return t.icon},getColor:A,getSize:1,getAngle:0},M=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,S(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,r["Layer"]),function(t,e,n){e&&x(t.prototype,e),n&&x(t,n)}(e,[{key:"getShaders",value:function(){return{vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  vec2 iconSize = instanceIconFrames.zw;\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : instanceSizes / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * sizeScale * instanceScale;\n  pixelOffset.y *= -1.0;\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, vec3(0.0));\n  gl_Position += project_pixel_to_clipspace(pixelOffset);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vTextureCoords.y = 1.0 - vTextureCoords.y;\n\n  vColor = instanceColors / 255.;\n\n  vColorMode = instanceColorModes;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\n\nconst float MIN_ALPHA = 0.05;\n\nvoid main(void) {\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < MIN_ALPHA) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",update:this.calculateInstanceOffsets},instanceIconFrames:{size:4,accessor:"getIcon",update:this.calculateInstanceIconFrames},instanceColorModes:{size:1,type:o.a.UNSIGNED_BYTE,accessor:"getIcon",update:this.calculateInstanceColorMode},instanceColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:A},instanceAngles:{size:1,transition:!0,accessor:"getAngle",defaultValue:0}})}},{key:"updateState",value:function(t){var n=this,r=t.oldProps,i=t.props,s=t.changeFlags;E(S(e.prototype),"updateState",this).call(this,{props:i,oldProps:r,changeFlags:s});var u,c=i.iconAtlas,l=i.iconMapping;if(r.iconMapping!==l){var f=this.getAttributeManager();f.invalidate("instanceOffsets"),f.invalidate("instanceIconFrames"),f.invalidate("instanceColorModes")}r.iconAtlas!==c&&(c instanceof a.i?(c.setParameters((b(u={},o.a.TEXTURE_MIN_FILTER,k),b(u,o.a.TEXTURE_MAG_FILTER,C),u)),this.setState({iconsTexture:c})):"string"==typeof c&&Object(a.x)(this.context.gl,{urls:[c]}).then(function(t){var e,r=_(t,1)[0];r.setParameters((b(e={},o.a.TEXTURE_MIN_FILTER,k),b(e,o.a.TEXTURE_MAG_FILTER,C),e)),n.setState({iconsTexture:r})}));if(i.fp64!==r.fp64){var h=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(h)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props.sizeScale,r=this.state.iconsTexture;r&&this.state.model.render(Object.assign({},e,{iconsTexture:r,iconsTextureDim:[r.width,r.height],sizeScale:n}))}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLE_FAN,attributes:{positions:new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=T(h[0]),o[a++]=T(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}},{key:"calculateInstanceOffsets",value:function(t){var e=this.props,n=e.data,r=e.iconMapping,i=e.getIcon,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=r[i(l.value)]||{};o[a++]=h.width/2-h.anchorX||0,o[a++]=h.height/2-h.anchorY||0}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}},{key:"calculateInstanceColorMode",value:function(t){var e=this.props,n=e.data,r=e.iconMapping,i=e.getIcon,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value),p=r[h]&&r[h].mask;o[a++]=p?1:0}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}},{key:"calculateInstanceIconFrames",value:function(t){var e=this.props,n=e.data,r=e.iconMapping,i=e.getIcon,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=r[i(l.value)]||{};o[a++]=h.x||0,o[a++]=h.y||0,o[a++]=h.width||0,o[a++]=h.height||0}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}}]),e}();M.layerName="IconLayer",M.defaultProps=O;function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t,e,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=z(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var F=a.t.fp64LowPart,N={fp64:!1,getSourcePosition:function(t){return t.sourcePosition},getTargetPosition:function(t){return t.targetPosition},getColor:[0,0,0,255],getStrokeWidth:1},B=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=null;return Number.isFinite(t.strokeWidth)&&(r.log.deprecated("LineLayer: `strokeWidth`","`getStrokeWidth`")(),n={getStrokeWidth:t.strokeWidth}),R(this,z(e).call(this,t,n))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(e,r["Layer"]),function(t,e,n){e&&L(t.prototype,e),n&&L(t,n)}(e,[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec4 instanceSourceTargetPositions64xyLow;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\n\nvarying vec4 vColor;\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nvoid main(void) {\n  // Position\n  vec4 source = project_position_to_clipspace(instanceSourcePositions, instanceSourceTargetPositions64xyLow.xy, vec3(0.));\n  vec4 target = project_position_to_clipspace(instanceTargetPositions, instanceSourceTargetPositions64xyLow.zw, vec3(0.));\n\n  // linear interpolation of source & target to pick right coord\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n\n  // extrude\n  vec2 offset = getExtrusionOffset(target.xy - source.xy, positions.y);\n  gl_Position = p + vec4(offset, 0.0, 0.0);\n\n  // Color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,transition:!0,accessor:"getTargetPosition"},instanceSourceTargetPositions64xyLow:{size:4,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstanceSourceTargetPositions64xyLow},instanceColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getStrokeWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(j(z(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLE_STRIP,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstanceSourceTargetPositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getSourcePosition,o=n.getTargetPosition,a=t.value,s=t.size,u=0,c=!0,l=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var d=h.value,v=i(d),g=o(d);a[u+0]=F(v[0]),a[u+1]=F(v[1]),a[u+2]=F(g[0]),a[u+3]=F(g[1]),u+=s}}catch(t){l=!0,f=t}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}}else t.value=new Float32Array(4)}}]),e}();B.layerName="LineLayer",B.defaultProps=N;function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function G(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function q(t,e,n){return(q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=W(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function W(t){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Z(t,e){return(Z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var X=a.t.fp64LowPart,H=[0,0,0,255],Y=[0,0,1],K={radiusPixels:10,fp64:!1,getPosition:function(t){return t.position},getNormal:Y,getColor:H,lightSettings:{}},J=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),G(this,W(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Z(t,e)}(e,r["Layer"]),function(t,e,n){e&&V(t.prototype,e),n&&V(t,n)}(e,[{key:"getShaders",value:function(t){return{vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n\n  // Find the center of the point and add the current vertex\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, vec3(0.), position_worldspace);\n  gl_Position += project_pixel_to_clipspace(positions.xy * radiusPixels);\n\n  // Apply lighting\n  float lightWeight = lighting_getLightWeight(position_worldspace.xyz, // the w component is always 1.0\n    project_normal(instanceNormals));\n\n  // Apply opacity to instance color, or return instance picking color\n  vColor = vec4(lightWeight * instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:Y},instanceColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:H}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(q(W(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props.radiusPixels;this.state.model.render(Object.assign({},e,{radiusPixels:n}))}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<3;n++){var r=n/3*Math.PI*2;e.push(2*Math.cos(r),2*Math.sin(r),0)}return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLES,attributes:{positions:new Float32Array(e)}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=X(h[0]),o[a++]=X(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}]),e}();J.layerName="PointCloudLayer",J.defaultProps=K;function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tt(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t,e,n){return(et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=a.t.fp64LowPart,ot={radiusScale:1,radiusMinPixels:0,radiusMaxPixels:Number.MAX_SAFE_INTEGER,strokeWidth:1,outline:!1,fp64:!1,getPosition:function(t){return t.position},getRadius:1,getColor:[0,0,0,255]},at=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),tt(this,nt(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(e,r["Layer"]),function(t,e,n){e&&$(t.prototype,e),n&&$(t,n)}(e,[{key:"getShaders",value:function(t){return{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceRadius;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float outline;\nuniform float strokeWidth;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n  // Multiply out radius and clamp to limits\n  float outerRadiusPixels = clamp(\n    project_scale(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n\n  // outline is centered at the radius\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += outline * strokeWidth / 2.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n  // 0 - solid circle, 1 - stroke with lineWidth=0\n  innerUnitRadius = outline * (1.0 - strokeWidth / outerRadiusPixels);\n\n  vec3 offset = positions * outerRadiusPixels;\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, offset);\n\n  // Apply opacity to instance color, or return instance picking color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0 || distToCenter < innerUnitRadius) {\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceColors:{size:4,transition:!0,type:o.a.UNSIGNED_BYTE,accessor:"getColor",defaultValue:[0,0,0,255]}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(et(nt(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.radiusScale,i=n.radiusMinPixels,o=n.radiusMaxPixels,a=n.outline,s=n.strokeWidth;this.state.model.render(Object.assign({},e,{outline:a?1:0,strokeWidth:s,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o}))}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign(this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLE_FAN,attributes:{positions:new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=it(h[0]),o[a++]=it(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}]),e}();at.layerName="ScatterplotLayer",at.defaultProps=ot;var st=n(37),ut=n.n(st);function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ft(t,e){return!e||"object"!==ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ht(t,e,n){return(ht="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=[0,0,0,0],gt=[0,255,0,255],mt=["minColor","maxColor","colorRange","colorDomain"],yt={cellSizePixels:{value:100,min:1},cellMarginPixels:{value:2,min:0,max:5},colorDomain:null,colorRange:r.experimental.defaultColorRange,getPosition:function(t){return t.position},getWeight:function(t){return 1},gpuAggregation:!0},_t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ft(this,pt(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dt(t,e)}(e,r["Layer"]),function(t,e,n){e&&lt(t.prototype,e),n&&lt(t,n)}(e,[{key:"getShaders",value:function(){var t=Object(a.w)(this.context.gl)?{vs:"#version 300 es\n#define SHADER_NAME screen-grid-layer-vertex-shader\n#define RANGE_COUNT 6\n\nin vec3 vertices;\nin vec3 instancePositions;\nin vec4 instanceCounts;\nin vec3 instancePickingColors;\n\nlayout(std140) uniform;\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform AggregationData\n{\n  vec4 maxCount;\n} aggregationData;\n\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\n\nout vec4 vColor;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  float weight = instanceCounts.g ;\n  float maxWeight = aggregationData.maxCount.w;\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + vertices * cellScale, 1.);\n}\n",fs:"#version 300 es\n#define SHADER_NAME screen-grid-layer-fragment-shader\n\nprecision highp float;\n\nin vec4 vColor;\nout vec4 fragColor;\n\nvoid main(void) {\n  fragColor = vColor;\n\n  fragColor = picking_filterColor(fragColor);\n}\n"}:{vs:"#define SHADER_NAME screen-grid-layer-vertex-shader-webgl1\n#define RANGE_COUNT 6\n\nattribute vec3 vertices;\nattribute vec3 instancePositions;\nattribute vec4 instanceCounts;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform float maxWeight;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\n\nvarying vec4 vColor;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  float weight = instanceCounts.g ;\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + vertices * cellScale, 1.);\n}\n",fs:"#define SHADER_NAME screen-grid-layer-fragment-shader-webgl1\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  gl_FragColor = picking_filterColor(gl_FragColor);\n}\n"};return t.modules=["picking"],t}},{key:"initializeState",value:function(){var t=this.getAttributeManager(),e=this.context.gl;t.addInstanced({instancePositions:{size:3,update:this.calculateInstancePositions},instanceCounts:{size:4,transition:!0,accessor:["getPosition","getWeight"],update:this.calculateInstanceCounts,noAlloc:!0}});var n={id:"".concat(this.id,"-aggregator"),shaderCache:this.context.shaderCache};this.setState({model:this._getModel(e),gpuGridAggregator:new r._GPUGridAggregator(e,n),maxCountBuffer:this._getMaxCountBuffer(e),aggregationData:null}),this._setupUniformBuffer()}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){ht(pt(e.prototype),"updateState",this).call(this,t),this._updateUniforms(t),t.changeFlags.dataChanged&&this._processData();var n=this._getAggregationChangeFlags(t);n&&this._updateAggregation(n)}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.gl,r=this.props.parameters,i=void 0===r?{}:r,s=this.props.minColor||vt,u=this.props.maxColor||gt,c=this.props.colorDomain||[1,0],l=this.state,f=l.model,h=l.maxCountBuffer,p=l.cellScale,d=l.shouldUseMinMax,v=l.colorRange,g=l.maxWeight,m={minColor:s,maxColor:u,cellScale:p,colorRange:v,colorDomain:c,shouldUseMinMax:d};Object(a.w)(n)?h.bind({target:o.a.UNIFORM_BUFFER}):m.maxWeight=g,e=Object.assign(m,e),f.draw({uniforms:e,parameters:Object.assign({depthTest:!1,depthMask:!1},i)}),Object(a.w)(n)&&h.unbind()}},{key:"calculateInstancePositions",value:function(t,e){for(var n=e.numInstances,r=this.context.viewport,i=r.width,o=r.height,a=this.props.cellSizePixels,s=this.state.numCol,u=t.value,c=t.size,l=0;l<n;l++){var f=l%s,h=Math.floor(l/s);u[l*c+0]=f*a/i*2-1,u[l*c+1]=1-h*a/o*2,u[l*c+2]=0}}},{key:"calculateInstanceCounts",value:function(t,e){e.numInstances;var n=this.state.countsBuffer;t.update({buffer:n})}},{key:"getPickingInfo",value:function(t){var e=t.info,n=(t.mode,e.index);if(n>=0){var i=this.state.aggregationData;i||(i={countsData:this.state.countsBuffer.getData(),maxCountData:this.state.maxCountBuffer.getData()},this.setState({aggregationData:i}));var o=i,a=o.countsData,s=o.maxCountData;e.object=r._GPUGridAggregator.getAggregationData({countsData:a,maxCountData:s,pixelIndex:n})}return e}},{key:"_getAggregationChangeFlags",value:function(t){var e=t.oldProps,n=t.props,r=t.changeFlags,i=n.cellSizePixels!==e.cellSizePixels||n.cellMarginPixels!==e.cellMarginPixels,o=r.dataChanged,a=r.viewportChanged;return i||o||a?{cellSizeChanged:i,dataChanged:o,viewportChanged:a}:null}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLE_FAN,attributes:{vertices:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"_getMaxCountBuffer",value:function(t){return new a.b(t,{bytes:16,size:4,index:0})}},{key:"_processData",value:function(){var t=this.props,e=t.data,n=t.getPosition,r=t.getWeight,i=[],o=[],a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value,h=n(f);i.push(h[0]),i.push(h[1]),o.push(r(f))}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}this.setState({positions:i,weights:o})}},{key:"_setupUniformBuffer",value:function(){var t=this.context.gl;if(Object(a.w)(t)){var e=this.state.model.program.handle,n=t.getUniformBlockIndex(e,"AggregationData");t.uniformBlockBinding(e,n,0)}}},{key:"_shouldUseMinMax",value:function(){var t=this.props,e=t.minColor,n=t.maxColor,i=t.colorDomain,o=t.colorRange;return e||n?(r.log.deprecated("ScreenGridLayer props: minColor and maxColor","colorRange, colorDomain")(),!0):!i&&!o}},{key:"_updateAggregation",value:function(t){var e=this.getAttributeManager();(t.cellSizeChanged||t.viewportChanged)&&(this._updateGridParams(),e.invalidateAll());var n=this.props,i=n.cellSizePixels,o=n.gpuAggregation,a=this.state,s=a.positions,u=a.weights,c=a.maxCountBuffer,l=a.countsBuffer,f=this.context.viewport,h=!1,p=null;this.context.viewport instanceof r.WebMercatorViewport?h=!0:(h=!1,p=f.pixelProjectionMatrix);var d=this.state.gpuGridAggregator.run({positions:s,weights:u,cellSize:[i,i],viewport:f,countsBuffer:l,maxCountBuffer:c,changeFlags:t,useGPU:o,projectPoints:h,gridTransformMatrix:p}).maxWeight,v=void 0===d?0:d;this.setState({aggregationData:null,maxWeight:v}),e.invalidate("instanceCounts")}},{key:"_updateUniforms",value:function(t){var e=t.oldProps,n=t.props,r=t.changeFlags,i={};if(mt.some(function(t){return e[t]!==n[t]})&&(i.shouldUseMinMax=this._shouldUseMinMax()),e.colorRange!==n.colorRange){var o=[];ut()(n.colorRange&&6===n.colorRange.length),n.colorRange.forEach(function(t){o.push(t[0],t[1],t[2],t[3]||255)}),i.colorRange=o}if(e.cellMarginPixels!==n.cellMarginPixels||e.cellSizePixels!==n.cellSizePixels||r.viewportChanged){var a=this.context.viewport,s=a.width,u=a.height,c=this.props,l=c.cellSizePixels,f=c.cellMarginPixels,h=l>f?f:0;i.cellScale=new Float32Array([(l-h)/s*2,-(l-h)/u*2,1])}this.setState(i)}},{key:"_updateGridParams",value:function(){var t=this.context.viewport,e=t.width,n=t.height,r=this.props.cellSizePixels,i=this.context.gl,s=Math.ceil(e/r),u=Math.ceil(n/r),c=s*u,l=4*c*4,f=this.state.countsBuffer;f&&f.delete(),f=new a.b(i,{size:4,bytes:l,type:o.a.FLOAT,instanced:1}),this.setState({numCol:s,numRow:u,numInstances:c,countsBuffer:f})}}]),e}();_t.layerName="ScreenGridLayer",_t.defaultProps=yt;function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wt(t,e){return!e||"object"!==bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Et(t,e,n){return(Et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tt=a.t.fp64LowPart,At=[255,0,255,255],kt={cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},extruded:!0,fp64:!1,getPosition:function(t){return t.position},getElevation:1e3,getColor:At,lightSettings:{}},Ct=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wt(this,St(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(e,r["Layer"]),function(t,e,n){e&&xt(t.prototype,e),n&&xt(t,n)}(e,[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME grid-cell-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceElevations;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float extruded;\nuniform float cellSize;\nuniform float coverage;\nuniform float opacity;\nuniform float elevationScale;\n\n// A magic number to scale elevation so that 1 unit approximate to 1 meter\n#define ELEVATION_SCALE 0.8\n\n// Result\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  // if ahpha == 0.0 or z < 0.0, do not render element\n  float noRender = float(instanceColors.a == 0.0 || instanceElevations < 0.0);\n  float finalCellSize = project_scale(cellSize) * mix(1.0, 0.0, noRender);\n\n  float elevation = 0.0;\n\n  if (extruded > 0.5) {\n    elevation = instanceElevations  * (positions.z + 1.0) *\n      ELEVATION_SCALE * elevationScale;\n  }\n\n  // cube geometry vertics are between -1 to 1, scale and transform it to between 0, 1\n  vec3 extrudedPosition = vec3(instancePositions.xy, elevation);\n  vec2 extrudedPosition64xyLow = instancePositions64xyLow;\n  vec3 offset = vec3(\n    (positions.x * coverage + 1.0) / 2.0 * finalCellSize,\n    (positions.y * coverage - 1.0) / 2.0 * finalCellSize,\n    1.0);\n\n  // extrude positions\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(extrudedPosition, extrudedPosition64xyLow, offset, position_worldspace);\n\n  float lightWeight = 1.0;\n\n  if (extruded > 0.5) {\n    lightWeight = lighting_getLightWeight(\n      position_worldspace.xyz, // the w component is always 1.0\n      normals\n    );\n  }\n\n  vec3 lightWeightedColor = lightWeight * instanceColors.rgb;\n  vec4 color = vec4(lightWeightedColor, instanceColors.a * opacity) / 255.0;\n  vColor = color;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME grid-cell-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:At}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(Et(St(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.c,isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.cellSize,i=n.extruded,o=n.elevationScale,a=n.coverage;this.state.model.render(Object.assign({},e,{cellSize:r,extruded:i,elevationScale:o,coverage:a}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=Tt(h[0]),o[a++]=Tt(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}]),e}();Ct.layerName="GridCellLayer",Ct.defaultProps=kt;var Ot=6378e3;function Mt(t,e,n){var r=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=1/0,o=-1/0,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;t=r(f)[1],Number.isFinite(t)&&(i=t<i?t:i,o=t>o?t:o)}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}var h=function(t,e){var n=function(t){return t/Ot*(180/Math.PI)}(t),r=function(t,e){return e/Ot*(180/Math.PI)/Math.cos(t*Math.PI/180)}(e,t);return{yOffset:n,xOffset:r}}(n,(i+o)/2);if(h.xOffset<=0||h.yOffset<=0)return{gridHash:{},gridOffset:h};var p={},d=!0,v=!1,g=void 0;try{for(var m,y=e[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var _=m.value,b=r(_)[1],x=r(_)[0];if(Number.isFinite(b)&&Number.isFinite(x)){var w=Math.floor((b+90)/h.yOffset),E=Math.floor((x+180)/h.xOffset),S="".concat(w,"-").concat(E);p[S]=p[S]||{count:0,points:[]},p[S].count+=1,p[S].points.push(_)}}}catch(t){v=!0,g=t}finally{try{d||null==y.return||y.return()}finally{if(v)throw g}}return{gridHash:p,gridOffset:h}}(t,e,n),i=r.gridHash,o=r.gridOffset;return{gridOffset:o,layerData:function(t,e){return Object.keys(t).reduce(function(n,r,i){var o=r.split("-"),a=parseInt(o[0],10),s=parseInt(o[1],10);return n.push(Object.assign({index:i,position:[e.xOffset*s-180,e.yOffset*a-90]},t[r])),n},[])}(i,o)}}function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rt(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jt(t,e,n){return(jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=r.experimental.BinSorter,Nt=r.experimental.defaultColorRange,Bt=r.experimental.getQuantizeScale,Ut=r.experimental.getLinearScale;function Vt(){}var Gt={colorDomain:null,colorRange:Nt,getColorValue:function(t){return t.length},lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},onSetColorDomain:Vt,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:function(t){return t.length},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:1,onSetElevationDomain:Vt,cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:function(t){return t.position},extruded:!1,fp64:!1,lightSettings:{}},qt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rt(this,zt(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(e,r["CompositeLayer"]),function(t,e,n){e&&Lt(t.prototype,e),n&&Lt(t,n)}(e,[{key:"initializeState",value:function(){this.state={layerData:[],sortedColorBins:null,sortedElevationBins:null,colorValueDomain:null,elevationValueDomain:null,colorScaleFunc:Vt,elevationScaleFunc:Vt,dimensionUpdaters:this.getDimensionUpdaters()}}},{key:"updateState",value:function(t){var e=this,n=t.oldProps,r=t.props,i=t.changeFlags,o=this.needsReProjectPoints(n,r);i.dataChanged||o?this.getLayerData():(this.getDimensionChanges(n,r)||[]).forEach(function(t){return"function"==typeof t&&t.apply(e)})}},{key:"needsReProjectPoints",value:function(t,e){return t.cellSize!==e.cellSize||t.getPosition!==e.getPosition}},{key:"getDimensionUpdaters",value:function(){return{getColor:[{id:"value",triggers:["getColorValue"],updater:this.getSortedColorBins},{id:"domain",triggers:["lowerPercentile","upperPercentile"],updater:this.getColorValueDomain},{id:"scaleFunc",triggers:["colorDomain","colorRange"],updater:this.getColorScale}],getElevation:[{id:"value",triggers:["getElevationValue"],updater:this.getSortedElevationBins},{id:"domain",triggers:["elevationLowerPercentile","elevationUpperPercentile"],updater:this.getElevationValueDomain},{id:"scaleFunc",triggers:["elevationDomain","elevationRange"],updater:this.getElevationScale}]}}},{key:"getDimensionChanges",value:function(t,e){var n=this.state.dimensionUpdaters,r=[];for(var i in n){var o=n[i].find(function(n){return n.triggers.some(function(n){return t[n]!==e[n]})});o&&r.push(o.updater)}return r.length?r:null}},{key:"getPickingInfo",value:function(t){var e=t.info,n=this.state,r=n.sortedColorBins,i=n.sortedElevationBins,o=null;if(e.picked&&e.index>-1){var a=this.state.layerData[e.index],s=r.binMap[a.index]&&r.binMap[a.index].value,u=i.binMap[a.index]&&i.binMap[a.index].value;o=Object.assign({colorValue:s,elevationValue:u},a)}return Object.assign(e,{picked:Boolean(o),object:o})}},{key:"getUpdateTriggers",value:function(){var t=this,e=this.state.dimensionUpdaters,n={},r=function(r){n[r]={};var i=!0,o=!1,a=void 0;try{for(var s,u=e[r][Symbol.iterator]();!(i=(s=u.next()).done);i=!0){s.value.triggers.forEach(function(e){n[r][e]=t.props[e]})}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};for(var i in e)r(i);return n}},{key:"getLayerData",value:function(){var t=this.props,e=Mt(t.data,t.cellSize,t.getPosition).layerData;this.setState({layerData:e}),this.getSortedBins()}},{key:"getValueDomain",value:function(){this.getColorValueDomain(),this.getElevationValueDomain()}},{key:"getSortedBins",value:function(){this.getSortedColorBins(),this.getSortedElevationBins()}},{key:"getSortedColorBins",value:function(){var t=this.props.getColorValue,e=new Ft(this.state.layerData||[],t);this.setState({sortedColorBins:e}),this.getColorValueDomain()}},{key:"getSortedElevationBins",value:function(){var t=this.props.getElevationValue,e=new Ft(this.state.layerData||[],t);this.setState({sortedElevationBins:e}),this.getElevationValueDomain()}},{key:"getColorValueDomain",value:function(){var t=this.props,e=t.lowerPercentile,n=t.upperPercentile,r=t.onSetColorDomain;this.state.colorValueDomain=this.state.sortedColorBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.colorValueDomain),this.getColorScale()}},{key:"getElevationValueDomain",value:function(){var t=this.props,e=t.elevationLowerPercentile,n=t.elevationUpperPercentile,r=t.onSetElevationDomain;this.state.elevationValueDomain=this.state.sortedElevationBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.elevationValueDomain),this.getElevationScale()}},{key:"getColorScale",value:function(){var t=this.props.colorRange,e=this.props.colorDomain||this.state.colorValueDomain;this.state.colorScaleFunc=Bt(e,t)}},{key:"getElevationScale",value:function(){var t=this.props.elevationRange,e=this.props.elevationDomain||this.state.elevationValueDomain;this.state.elevationScaleFunc=Ut(e,t)}},{key:"_onGetSublayerColor",value:function(t){var e=this.state,n=e.sortedColorBins,r=e.colorScaleFunc,i=e.colorValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.colorDomain||i,s=o>=a[0]&&o<=a[a.length-1]?r(o):[0,0,0,0];return s[3]=Number.isFinite(s[3])?s[3]:255,s}},{key:"_onGetSublayerElevation",value:function(t){var e=this.state,n=e.sortedElevationBins,r=e.elevationScaleFunc,i=e.elevationValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.elevationDomain||i;return o>=a[0]&&o<=a[a.length-1]?r(o):-1}},{key:"getSubLayerProps",value:function(){var t=this.props,n=t.elevationScale,r=t.fp64,i=t.extruded,o=t.cellSize,a=t.coverage,s=t.lightSettings,u=t.transitions;return jt(zt(e.prototype),"getSubLayerProps",this).call(this,{id:"grid-cell",data:this.state.layerData,fp64:r,cellSize:o,coverage:a,lightSettings:s,elevationScale:n,extruded:i,getColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:u&&{getColor:u.getColorValue,getElevation:u.getElevationValue},updateTriggers:this.getUpdateTriggers()})}},{key:"getSubLayerClass",value:function(){return Ct}},{key:"renderLayers",value:function(){return new(this.getSubLayerClass())(this.getSubLayerProps())}}]),e}();qt.layerName="GridLayer",qt.defaultProps=Gt;function Wt(t){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return!e||"object"!==Wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ht(t,e,n){return(Ht="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=a.t.fp64LowPart,Qt=[255,0,255,255],$t={hexagonVertices:null,radius:null,angle:null,coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},extruded:!0,fp64:!1,getCentroid:function(t){return t.centroid},getColor:Qt,getElevation:1e3,lightSettings:{}},te=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=!1;return t.hexagonVertices||t.radius&&Number.isFinite(t.angle)?t.hexagonVertices&&(!Array.isArray(t.hexagonVertices)||t.hexagonVertices.length<6)&&(r.log.once(0,"HexagonCellLayer: hexagonVertices needs to be an array of 6 points")(),n=!0):(r.log.once(0,"HexagonCellLayer: Either hexagonVertices or radius and angle are needed to calculate primitive hexagon.")(),n=!0),n&&(r.log.once(0,"Now using 1000 meter as default radius, 0 as default angle")(),t.radius=1e3,t.angle=0),Xt(this,Yt(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kt(t,e)}(e,r["Layer"]),function(t,e,n){e&&Zt(t.prototype,e),n&&Zt(t,n)}(e,[{key:"getShaders",value:function(){return{vs:"\n#define SHADER_NAME hexagon-cell-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec2 instancePositions;\nattribute float instanceElevations;\nattribute vec2 instancePositions64xyLow;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform float extruded;\nuniform float coverage;\nuniform float elevationScale;\n\n// Result\nvarying vec4 vColor;\n\n// A magic number to scale elevation so that 1 unit approximate to 1 meter.\n#define ELEVATION_SCALE 0.8\n\nvoid main(void) {\n\n  // rotate primitive position and normal\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n\n  // calculate elevation, if 3d not enabled set to 0\n  // cylindar gemoetry height are between -0.5 to 0.5, transform it to between 0, 1\n  float elevation = 0.0;\n\n  if (extruded > 0.5) {\n    elevation = instanceElevations * (positions.z + 0.5) *\n      ELEVATION_SCALE * elevationScale;\n  }\n\n  // if ahpha == 0.0 or z < 0.0, do not render element\n  float noRender = float(instanceColors.a == 0.0 || instanceElevations < 0.0);\n  float dotRadius = project_scale(radius) * mix(coverage, 0.0, noRender);\n\n  // project center of hexagon\n  vec3 centroidPosition = vec3(instancePositions, elevation);\n  vec2 centroidPosition64xyLow = instancePositions64xyLow;\n  vec3 offset = vec3(rotationMatrix * positions.xy * dotRadius, 0.);\n\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64xyLow, offset, position_worldspace);\n\n  // Light calculations\n  // Worldspace is the linear space after Mercator projection\n\n  vec3 normals_worldspace = vec3(rotationMatrix * normals.xy, normals.z);\n\n  float lightWeight = 1.0;\n\n  if (extruded > 0.5) {\n    lightWeight = lighting_getLightWeight(\n      position_worldspace.xyz, // the w component is always 1.0\n      normals_worldspace\n    );\n  }\n\n  vec3 lightWeightedColor = lightWeight * instanceColors.rgb;\n\n  // opacity-multiplied instance color\n  vColor = vec4(lightWeightedColor, opacity * instanceColors.a) / 255.0;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME hexagon-cell-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:2,transition:!0,accessor:"getCentroid"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instancePositions64xyLow:{size:2,accessor:"getCentroid",update:this.calculateInstancePositions64xyLow},instanceColors:{size:4,type:o.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:Qt}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(Ht(Yt(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}n.hexagonVertices===r.hexagonVertices&&n.radius===r.radius&&n.angle===r.angle||this.updateRadiusAngle()}},{key:"updateRadiusAngle",value:function(){var t=this.props,e=t.angle,n=t.radius,r=this.props.hexagonVertices;if(Array.isArray(r)&&r.length>=6){var i=this.props.hexagonVertices,o=i[0],a=i[3],s=this.context.viewport.getDistanceScales().pixelsPerMeter,u=this.projectFlat(o),c=this.projectFlat(a),l=u[0]-c[0],f=u[1]-c[1],h=Math.sqrt(l*l+f*f);e=Math.acos(l/h)*-Math.sign(f)+Math.PI/2,n=h/2/s[0]}this.setState({angle:e,radius:n})}},{key:"getCylinderGeometry",value:function(t){return new a.d({radius:t,topRadius:t,bottomRadius:t,topCap:!0,bottomCap:!0,height:1,verticalAxis:"z",nradial:6,nvertical:1})}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:this.getCylinderGeometry(1),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.elevationScale,i=n.extruded,o=n.coverage,a=this.state,s=a.radius,u=a.angle;this.state.model.render(Object.assign({},e,{radius:s,angle:u,extruded:i,coverage:o,elevationScale:r}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getCentroid,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=Jt(h[0]),o[a++]=Jt(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}]),e}();te.layerName="HexagonCellLayer",te.defaultProps=$t;var ee=Math.PI/3,ne=[0,ee,2*ee,3*ee,4*ee,5*ee];function re(t){return t[0]}function ie(t){return t[1]}var oe=function(){var t,e,n,r=0,i=0,o=1,a=1,s=re,u=ie;function c(t){var r,i={},o=[],a=t.length;for(r=0;r<a;++r)if(!isNaN(l=+s.call(null,c=t[r],r,t))&&!isNaN(f=+u.call(null,c,r,t))){var c,l,f,h=Math.round(f/=n),p=Math.round(l=l/e-(1&h)/2),d=f-h;if(3*Math.abs(d)>1){var v=l-p,g=p+(l<p?-1:1)/2,m=h+(f<h?-1:1),y=l-g,_=f-m;v*v+d*d>y*y+_*_&&(p=g+(1&h?1:-1)/2,h=m)}var b=p+"-"+h,x=i[b];x?x.push(c):(o.push(x=i[b]=[c]),x.x=(p+(1&h)/2)*e,x.y=h*n)}return o}function l(t){var e=0,n=0;return ne.map(function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,a=i-e,s=o-n;return e=i,n=o,[a,s]})}return c.hexagon=function(e){return"m"+l(null==e?t:+e).join("l")+"z"},c.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/e),l=u*n;l<a+t;l+=n,++u)for(var f=c*e+(1&u)*e/2;f<o+e/2;f+=e)s.push([f,l]);return s},c.mesh=function(){var e=l(t).slice(0,4).join("l");return c.centers().map(function(t){return"M"+t+"m"+e}).join("")},c.x=function(t){return arguments.length?(s=t,c):s},c.y=function(t){return arguments.length?(u=t,c):u},c.radius=function(r){return arguments.length?(e=2*(t=+r)*Math.sin(ee),n=1.5*t,c):t},c.size=function(t){return arguments.length?(r=i=0,o=+t[0],a=+t[1],c):[o-r,a-i]},c.extent=function(t){return arguments.length?(r=+t[0][0],i=+t[0][1],o=+t[1][0],a=+t[1][1],c):[[r,i],[o,a]]},c.radius(1)};function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ue(t,e){return!e||"object"!==ae(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ce(t,e,n){return(ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=le(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function le(t){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fe(t,e){return(fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var he=r.experimental.BinSorter,pe=r.experimental.getQuantizeScale,de=r.experimental.getLinearScale;function ve(){}var ge={colorDomain:null,colorRange:r.experimental.defaultColorRange,getColorValue:function(t){return t.length},lowerPercentile:0,upperPercentile:100,onSetColorDomain:ve,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:function(t){return t.length},elevationLowerPercentile:0,elevationUpperPercentile:100,elevationScale:{type:"number",min:0,value:1},onSetElevationDomain:ve,radius:1e3,coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){var n=t.data,r=t.radius,i=t.getPosition,o=function(t,e){var n=e.getDistanceScales().pixelsPerMeter;return t*n[0]}(r,e),a=[],s=!0,u=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;a.push(Object.assign({screenCoord:e.projectFlat(i(h))},h))}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}return{hexagons:oe().radius(o).x(function(t){return t.screenCoord[0]}).y(function(t){return t.screenCoord[1]})(a).map(function(t,n){return{centroid:e.unprojectFlat([t.x,t.y]),points:t,index:n}})}},getPosition:function(t){return t.position},fp64:!1,lightSettings:{}},me=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.hexagonAggregator||t.radius||(r.log.once(0,"HexagonLayer: Default hexagonAggregator requires radius prop to be set, Now using 1000 meter as default")(),t.radius=ge.radius),Number.isFinite(t.upperPercentile)&&(t.upperPercentile>100||t.upperPercentile<0)&&(r.log.once(0,"HexagonLayer: upperPercentile should be between 0 and 100. Assign to 100 by default")(),t.upperPercentile=ge.upperPercentile),Number.isFinite(t.lowerPercentile)&&(t.lowerPercentile>100||t.lowerPercentile<0)&&(r.log.once(0,"HexagonLayer: lowerPercentile should be between 0 and 100. Assign to 0 by default")(),t.lowerPercentile=ge.upperPercentile),t.lowerPercentile>=t.upperPercentile&&(r.log.once(0,"HexagonLayer: lowerPercentile should not be bigger than upperPercentile. Assign to 0 by default")(),t.lowerPercentile=ge.lowerPercentile),ue(this,le(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fe(t,e)}(e,r["CompositeLayer"]),function(t,e,n){e&&se(t.prototype,e),n&&se(t,n)}(e,[{key:"initializeState",value:function(){this.state={hexagons:[],hexagonVertices:null,sortedColorBins:null,sortedElevationBins:null,colorValueDomain:null,elevationValueDomain:null,colorScaleFunc:ve,elevationScaleFunc:ve,dimensionUpdaters:this.getDimensionUpdaters()}}},{key:"updateState",value:function(t){var e=this,n=t.oldProps,r=t.props,i=t.changeFlags,o=this.getDimensionChanges(n,r);i.dataChanged||this.needsReProjectPoints(n,r)?this.getHexagons():o&&o.forEach(function(t){return"function"==typeof t&&t.apply(e)})}},{key:"needsReProjectPoints",value:function(t,e){return t.radius!==e.radius||t.hexagonAggregator!==e.hexagonAggregator}},{key:"getDimensionUpdaters",value:function(){return{getColor:[{id:"value",triggers:["getColorValue"],updater:this.getSortedColorBins},{id:"domain",triggers:["lowerPercentile","upperPercentile"],updater:this.getColorValueDomain},{id:"scaleFunc",triggers:["colorDomain","colorRange"],updater:this.getColorScale}],getElevation:[{id:"value",triggers:["getElevationValue"],updater:this.getSortedElevationBins},{id:"domain",triggers:["elevationLowerPercentile","elevationUpperPercentile"],updater:this.getElevationValueDomain},{id:"scaleFunc",triggers:["elevationDomain","elevationRange"],updater:this.getElevationScale}]}}},{key:"getDimensionChanges",value:function(t,e){var n=this.state.dimensionUpdaters,r=[];for(var i in n){var o=n[i].find(function(n){return n.triggers.some(function(n){return t[n]!==e[n]})});o&&r.push(o.updater)}return r.length?r:null}},{key:"getHexagons",value:function(){var t=this.props.hexagonAggregator,e=this.context.viewport,n=t(this.props,e),r=n.hexagons,i=n.hexagonVertices;this.setState({hexagons:r,hexagonVertices:i}),this.getSortedBins()}},{key:"getPickingInfo",value:function(t){var e=t.info,n=this.state,r=n.sortedColorBins,i=n.sortedElevationBins,o=null;if(e.picked&&e.index>-1){var a=this.state.hexagons[e.index],s=r.binMap[a.index]&&r.binMap[a.index].value,u=i.binMap[a.index]&&i.binMap[a.index].value;o=Object.assign({colorValue:s,elevationValue:u},a)}return Object.assign(e,{picked:Boolean(o),object:o})}},{key:"getUpdateTriggers",value:function(){var t=this,e=this.state.dimensionUpdaters,n={},r=function(r){n[r]={};var i=!0,o=!1,a=void 0;try{for(var s,u=e[r][Symbol.iterator]();!(i=(s=u.next()).done);i=!0){s.value.triggers.forEach(function(e){n[r][e]=t.props[e]})}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};for(var i in e)r(i);return n}},{key:"getValueDomain",value:function(){this.getColorValueDomain(),this.getElevationValueDomain()}},{key:"getSortedBins",value:function(){this.getSortedColorBins(),this.getSortedElevationBins()}},{key:"getSortedColorBins",value:function(){var t=this.props.getColorValue,e=new he(this.state.hexagons||[],t);this.setState({sortedColorBins:e}),this.getColorValueDomain()}},{key:"getSortedElevationBins",value:function(){var t=this.props.getElevationValue,e=new he(this.state.hexagons||[],t);this.setState({sortedElevationBins:e}),this.getElevationValueDomain()}},{key:"getColorValueDomain",value:function(){var t=this.props,e=t.lowerPercentile,n=t.upperPercentile,r=t.onSetColorDomain;this.state.colorValueDomain=this.state.sortedColorBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.colorValueDomain),this.getColorScale()}},{key:"getElevationValueDomain",value:function(){var t=this.props,e=t.elevationLowerPercentile,n=t.elevationUpperPercentile,r=t.onSetElevationDomain;this.state.elevationValueDomain=this.state.sortedElevationBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.elevationValueDomain),this.getElevationScale()}},{key:"getColorScale",value:function(){var t=this.props.colorRange,e=this.props.colorDomain||this.state.colorValueDomain;this.state.colorScaleFunc=pe(e,t)}},{key:"getElevationScale",value:function(){var t=this.props.elevationRange,e=this.props.elevationDomain||this.state.elevationValueDomain;this.state.elevationScaleFunc=de(e,t)}},{key:"_onGetSublayerColor",value:function(t){var e=this.state,n=e.sortedColorBins,r=e.colorScaleFunc,i=e.colorValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.colorDomain||i,s=o>=a[0]&&o<=a[a.length-1]?r(o):[0,0,0,0];return s[3]=Number.isFinite(s[3])?s[3]:255,s}},{key:"_onGetSublayerElevation",value:function(t){var e=this.state,n=e.sortedElevationBins,r=e.elevationScaleFunc,i=e.elevationValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.elevationDomain||i;return o>=a[0]&&o<=a[a.length-1]?r(o):-1}},{key:"getSubLayerProps",value:function(){var t=this.props,n=t.radius,r=t.elevationScale,i=t.extruded,o=t.coverage,a=t.lightSettings,s=t.fp64,u=t.transitions;return ce(le(e.prototype),"getSubLayerProps",this).call(this,{id:"hexagon-cell",data:this.state.hexagons,fp64:s,hexagonVertices:this.state.hexagonVertices,radius:n,elevationScale:r,angle:Math.PI/2,extruded:i,coverage:o,lightSettings:a,getColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:u&&{getColor:u.getColorValue,getElevation:u.getElevationValue},updateTriggers:this.getUpdateTriggers()})}},{key:"getSubLayerClass",value:function(){return te}},{key:"renderLayers",value:function(){return new(this.getSubLayerClass())(this.getSubLayerProps())}}]),e}();me.layerName="HexagonLayer",me.defaultProps=ge;var ye="#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float jointType;\nuniform float miterLimit;\nuniform float alignMode;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying float vPathPosition;\nvarying float vPathLength;\n\n// mod doesn't work correctly for negative numbers\nfloat mod2(float a, float b) {\n  return a - floor(a / b) * b;\n}\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n\n// if given position is in the gap part of the dashed line\n// dashArray.x: solid stroke length, relative to width\n// dashArray.y: gap length, relative to width\n// alignMode:\n// 0 - no adjustment\n// o----     ----     ----     ---- o----     -o----     ----     o\n// 1 - stretch to fit, draw half dash at each end for nicer joints\n// o--    ----    ----    ----    --o--      --o--     ----     --o\nbool dash_isFragInGap() {\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n\n  float unitLength = solidLength + gapLength;\n\n  if (unitLength == 0.0) {\n    return false;\n  }\n\n  unitLength = mix(\n    unitLength,\n    vPathLength / round(vPathLength / unitLength),\n    alignMode\n  );\n\n  float offset = alignMode * solidLength / 2.0;\n\n  return gapLength > 0.0 &&\n    vPathPosition >= 0.0 &&\n    vPathPosition <= vPathLength &&\n    mod2(vPathPosition + offset, unitLength) > solidLength;\n}\n\nvoid main(void) {\n  // if joint is rounded, test distance from the corner\n  if (jointType > 0.0 && vMiterLength > 0.0 && length(vCornerOffset) > 1.0) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 1., 0., 1.);\n    // return;\n    discard;\n  }\n  if (jointType == 0.0 && vMiterLength > miterLimit) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 0., 1., 1.);\n    // return;\n    discard;\n  }\n  if (vColor.a == 0.0 || dash_isFragInGap()) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 1., 1., 1.);\n    // return;\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";function _e(t){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xe(t,e){return!e||"object"!==_e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function we(t,e,n){return(we="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ee(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Se(t,e){return(Se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pe=a.t.fp64LowPart,Te=[0,0,0,255],Ae={widthScale:1,widthMinPixels:0,widthMaxPixels:Number.MAX_SAFE_INTEGER,rounded:!1,miterLimit:4,fp64:!1,dashJustified:!1,getPath:function(t){return t.path},getColor:Te,getWidth:1,getDashArray:null},ke=function(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]},Ce={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},Oe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xe(this,Ee(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Se(t,e)}(e,r["Layer"]),function(t,e,n){e&&be(t.prototype,e),n&&be(t,n)}(e,[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"\n#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftDeltas;\nattribute vec3 instanceRightDeltas;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying float vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\nconst float PIXEL_EPSILON = 0.1;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\nvec3 lineJoin(vec2 prevPoint64[2], vec2 currPoint64[2], vec2 nextPoint64[2]) {\n\n  float width = clamp(project_scale(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n\n  vec2 deltaA64[2];\n  vec2 deltaB64[2];\n\n  vec2_sub_fp64(currPoint64, prevPoint64, deltaA64);\n  vec2_sub_fp64(nextPoint64, currPoint64, deltaB64);\n\n  vec2 lengthA64 = vec2_length_fp64(deltaA64);\n  vec2 lengthB64 = vec2_length_fp64(deltaB64);\n\n  vec2 deltaA = vec2(deltaA64[0].x, deltaA64[1].x);\n  vec2 deltaB = vec2(deltaB64[0].x, deltaB64[1].x);\n\n  float lenA = lengthA64.x;\n  float lenB = lengthB64.x;\n\n  vec2 offsetVec;\n  float offsetScale;\n  float offsetDirection;\n\n  // when two points are closer than PIXEL_EPSILON in pixels,\n  // assume they are the same point to avoid precision issue\n  lenA = lenA > PIXEL_EPSILON ? lenA : 0.0;\n  lenB = lenB > PIXEL_EPSILON ? lenB : 0.0;\n  vec2 dirA = lenA > 0. ? deltaA / lenA : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? deltaB / lenB : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // width offset from current position\n  vec2 perp = mix(perpB, perpA, positions.x);\n  float L = mix(lenB, lenA, positions.x);\n\n  // cap super sharp angles\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = mix(\n    flipIfTrue(turnsRight == (positions.y > 0.0)),\n    0.0,\n    positions.z\n  );\n\n  offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  // do not bevel if line segment is too short\n  cornerPosition *= float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n  // trim if inside corner extends further than the line segment\n  offsetScale = mix(\n    offsetScale,\n    min(offsetScale, L / width / max(cosHalfA, EPSILON)),\n    float(cornerPosition < 0.0)\n  );\n\n  vMiterLength = mix(\n    offsetScale * cornerPosition,\n    mix(offsetScale, 0.0, cornerPosition),\n    step(0.0, cornerPosition)\n  ) - sinHalfA * jointType;\n  offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n  offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n\n  // special treatment for start cap and end cap\n  // using a small number as the limit for determining if the lenA or lenB is 0\n  float isStartCap = step(lenA, 1.0e-5);\n  float isEndCap = step(lenB, 1.0e-5);\n  float isCap = max(isStartCap, isEndCap);\n\n  // 0: center, 1: side\n  cornerPosition = isCap * (1.0 - positions.z);\n\n  // start of path: use next - curr\n  offsetVec = mix(offsetVec, mix(dirB, perpB, cornerPosition), isStartCap);\n  // end of path: use curr - prev\n  offsetVec = mix(offsetVec, mix(dirA, perpA, cornerPosition), isEndCap);\n\n  // extend out a triangle to envelope the round cap\n  offsetScale = mix(\n    offsetScale,\n    mix(4.0 * jointType, 1.0, cornerPosition),\n    isCap\n  );\n  vMiterLength = mix(vMiterLength, 1.0 - cornerPosition, isCap);\n\n  offsetDirection = mix(\n    offsetDirection,\n    mix(flipIfTrue(isStartCap > 0.), positions.y, cornerPosition),\n    isCap\n  );\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n\n  // Generate variables for dash calculation\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  float isEnd = positions.x;\n  vec2 offsetFromStartOfPath = mix(vCornerOffset, vCornerOffset + deltaA / width, isEnd);\n  vec2 dir = mix(dirB, dirA, isEnd);\n  vPathPosition = dot(offsetFromStartOfPath, dir);\n\n  return vec3(vCornerOffset * width, 0.0);\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  // Calculate current position 64bit\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  vec2 projected_curr_position[2];\n  project_position_fp64(currPosition.xy, currPosition64xyLow, projected_curr_position);\n  float projected_curr_position_z = project_scale(currPosition.z);\n\n  // Calculate previous position\n\n  vec3 prevPosition = mix(-instanceLeftDeltas, vec3(0.0), isEnd) + instanceStartPositions;\n\n  // Calculate prev position 64bit\n\n  vec2 projected_prev_position[2];\n  project_position_fp64(prevPosition.xy, instanceStartEndPositions64xyLow.xy, projected_prev_position);\n\n  // Calculate next positions\n  vec3 nextPosition = mix(vec3(0.0), instanceRightDeltas, isEnd) + instanceEndPositions;\n\n  // Calculate next position 64bit\n\n  vec2 projected_next_position[2];\n  project_position_fp64(nextPosition.xy, instanceStartEndPositions64xyLow.zw, projected_next_position);\n\n  vec3 pos = lineJoin(projected_prev_position, projected_curr_position, projected_next_position);\n  vec2 vertex_pos_modelspace[4];\n\n  vertex_pos_modelspace[0] = sum_fp64(vec2(pos.x, 0.0), projected_curr_position[0]);\n  vertex_pos_modelspace[1] = sum_fp64(vec2(pos.y, 0.0), projected_curr_position[1]);\n  vertex_pos_modelspace[2] = vec2(pos.z + projected_curr_position_z, 0.0);\n  vertex_pos_modelspace[3] = vec2(1.0, 0.0);\n\n  gl_Position = project_to_clipspace_fp64(vertex_pos_modelspace);\n}\n",fs:ye,modules:["project64","picking"]}:{vs:"#define SHADER_NAME path-layer-vertex-shader-64\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftDeltas;\nattribute vec3 instanceRightDeltas;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying float vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\nconst float PIXEL_EPSILON = 0.1;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  float relativePosition, bool isEnd, bool isJoint,\n  float width\n) {\n  vec2 deltaA = currPoint.xy - prevPoint.xy;\n  vec2 deltaB = nextPoint.xy - currPoint.xy;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  // when two points are closer than PIXEL_EPSILON in pixels,\n  // assume they are the same point to avoid precision issue\n  lenA = lenA > PIXEL_EPSILON ? lenA : 0.0;\n  lenB = lenB > PIXEL_EPSILON ? lenB : 0.0;\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // width offset from current position\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n\n  // cap super sharp angles\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  float offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  float cornerPosition = isJoint ?\n    0.0 :\n    flipIfTrue(turnsRight == (relativePosition > 0.0));\n\n  // do not bevel if line segment is too short\n  cornerPosition *=\n    float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n\n  // trim if inside corner extends further than the line segment\n  if (cornerPosition < 0.0) {\n    offsetScale = min(offsetScale, L / width / max(cosHalfA, EPSILON));\n  }\n\n  vMiterLength = cornerPosition >= 0.0 ?\n    mix(offsetScale, 0.0, cornerPosition) :\n    offsetScale * cornerPosition;\n  vMiterLength -= sinHalfA * jointType;\n\n  float offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n\n  // special treatment for start cap and end cap\n  // TODO - This has an issue. len is always positive because it is length.\n  // Step returns zero if -lenA<0, so practically this is a comparison of\n  // lenA with zero, with lots of problems because of the -lenA. Can we use EPSILON?\n  bool isStartCap = step(0.0, -lenA) > 0.5;\n  bool isEndCap = step(0.0, -lenB) > 0.5;\n  bool isCap = isStartCap || isEndCap;\n\n  // 0: center, 1: side\n  cornerPosition = isCap ? (1.0 - positions.z) : 0.;\n\n  // start of path: use next - curr\n  if (isStartCap) {\n    offsetVec = mix(dirB, perpB, cornerPosition);\n  }\n\n  // end of path: use curr - prev\n  if (isEndCap) {\n    offsetVec = mix(dirA, perpA, cornerPosition);\n  }\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetScale = mix(4.0 * jointType, 1.0, cornerPosition);\n    vMiterLength = 1.0 - cornerPosition;\n    offsetDirection = mix(flipIfTrue(isStartCap), positions.y, cornerPosition);\n  }\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n\n  // Generate variables for dash calculation\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  // vec2 offsetFromStartOfPath = isEnd ? vCornerOffset + deltaA / width : vCornerOffset;\n  vec2 offsetFromStartOfPath = vCornerOffset;\n  if (isEnd) {\n    offsetFromStartOfPath += deltaA / width;\n  }\n  vec2 dir = isEnd ? dirA : dirB;\n  vPathPosition = dot(offsetFromStartOfPath, dir);\n\n  return currPoint + vec3(vCornerOffset * width, 0.0);\n}\n\n// calculate line join positions\n// extract params from attributes and uniforms\nvec3 lineJoin(vec3 prevPoint, vec3 currPoint, vec3 nextPoint) {\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n\n  float relativePosition = positions.y;\n  bool isEnd = positions.x > EPSILON;\n  bool isJoint = positions.z > EPSILON;\n\n  float width = clamp(project_scale(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n\n  return lineJoin(\n    prevPoint, currPoint, nextPoint,\n    relativePosition, isEnd, isJoint,\n    width\n  );\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(-instanceLeftDeltas, vec3(0.0), isEnd) + instanceStartPositions;\n  vec2 prevPosition64xyLow = instanceStartEndPositions64xyLow.xy;\n  prevPosition = project_position(prevPosition, prevPosition64xyLow);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  currPosition = project_position(currPosition, currPosition64xyLow);\n\n  vec3 nextPosition = mix(vec3(0.0), instanceRightDeltas, isEnd) + instanceEndPositions;\n  vec2 nextPosition64xyLow = instanceStartEndPositions64xyLow.zw;\n  nextPosition = project_position(nextPosition, nextPosition64xyLow);\n\n  vec3 pos = lineJoin(prevPosition, currPosition, nextPosition);\n\n  gl_Position = project_to_clipspace(vec4(pos, 1.0));\n}\n",fs:ye,modules:["picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceStartPositions:{size:3,transition:Ce,accessor:"getPath",update:this.calculateStartPositions},instanceEndPositions:{size:3,transition:Ce,accessor:"getPath",update:this.calculateEndPositions},instanceStartEndPositions64xyLow:{size:4,update:this.calculateInstanceStartEndPositions64xyLow},instanceLeftDeltas:{size:3,update:this.calculateLeftDeltas},instanceRightDeltas:{size:3,update:this.calculateRightDeltas},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Ce,update:this.calculateStrokeWidths,defaultValue:1},instanceDashArrays:{size:2,accessor:"getDashArray",update:this.calculateDashArrays},instanceColors:{size:4,type:o.a.UNSIGNED_BYTE,accessor:"getColor",transition:Ce,update:this.calculateColors,defaultValue:Te},instancePickingColors:{size:3,type:o.a.UNSIGNED_BYTE,update:this.calculatePickingColors}})}},{key:"updateState",value:function(t){var n=t.oldProps,r=t.props,i=t.changeFlags;we(Ee(e.prototype),"updateState",this).call(this,{props:r,oldProps:n,changeFlags:i});var o=this.props.getPath,a=this.getAttributeManager();if(r.fp64!==n.fp64){var s=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(s)}),a.invalidateAll()}if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){var u=r.data.map(o),c=u.map(function(t){return t.length-1}),l=c.reduce(function(t,e){return t+e},0);this.setState({paths:u,numInstances:l,bufferLayout:c}),a.invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.rounded,i=n.miterLimit,o=n.widthScale,a=n.widthMinPixels,s=n.widthMaxPixels,u=n.dashJustified;this.state.model.render(Object.assign({},e,{jointType:Number(r),alignMode:Number(u),widthScale:o,miterLimit:i,widthMinPixels:a,widthMaxPixels:s}))}},{key:"_getModel",value:function(t){return new a.h(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new a.g({drawMode:o.a.TRIANGLES,attributes:{indices:new Uint16Array([0,2,1,1,2,4,1,4,3,3,4,5]),positions:new Float32Array([0,0,1,0,-1,0,0,1,0,1,-1,0,1,1,0,1,0,1])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"_getPathLength",value:function(t){return t.length}},{key:"calculateStartPositions",value:function(t){var e=this.state,n=e.paths,r=e.bufferLayout,i=t.value;t.bufferLayout=r;var o=0;n.forEach(function(t){for(var e=t.length-1,n=0;n<e;n++){var r=t[n];i[o++]=r[0],i[o++]=r[1],i[o++]=r[2]||0}})}},{key:"calculateEndPositions",value:function(t){var e=this.state,n=e.paths,r=e.bufferLayout,i=t.value;t.bufferLayout=r;var o=0;n.forEach(function(t){for(var e=1;e<t.length;e++){var n=t[e];i[o++]=n[0],i[o++]=n[1],i[o++]=n[2]||0}})}},{key:"calculateInstanceStartEndPositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.state.paths,r=t.value,i=0;n.forEach(function(t){for(var e=t.length-1,n=0;n<e;n++){var o=t[n],a=t[n+1];r[i++]=Pe(o[0]),r[i++]=Pe(o[1]),r[i++]=Pe(a[0]),r[i++]=Pe(a[1])}})}else t.value=new Float32Array(4)}},{key:"calculateLeftDeltas",value:function(t){var e=this.state.paths,n=t.value,r=0;e.forEach(function(t){for(var e=t.length-1,i=ke(t)?t[t.length-2]:t[0],o=0;o<e;o++){var a=t[o];n[r++]=a[0]-i[0],n[r++]=a[1]-i[1],n[r++]=a[2]-i[2]||0,i=a}})}},{key:"calculateRightDeltas",value:function(t){var e=this.state.paths,n=t.value,r=0;e.forEach(function(t){for(var e=1;e<t.length;e++){var i=t[e],o=t[e+1];o||(o=ke(t)?t[1]:i),n[r++]=o[0]-i[0],n[r++]=o[1]-i[1],n[r++]=o[2]-i[2]||0}})}},{key:"calculateStrokeWidths",value:function(t){var e=this,n=this.props,r=n.data,i=n.getWidth,o=this.state,a=o.paths,s=o.bufferLayout,u=t.value;t.bufferLayout=s;var c=0;a.forEach(function(t,n){for(var o=i(r[n],n),a=e._getPathLength(t),s=1;s<a;s++)u[c++]=o})}},{key:"calculateDashArrays",value:function(t){var e=this,n=this.props,r=n.data,i=n.getDashArray;if(i){var o=this.state.paths,a=t.value,s=0;o.forEach(function(t,n){for(var o=i(r[n],n),u=e._getPathLength(t),c=1;c<u;c++)a[s++]=o[0],a[s++]=o[1]})}}},{key:"calculateColors",value:function(t){var e=this,n=this.props,r=n.data,i=n.getColor,o=this.state,a=o.paths,s=o.bufferLayout,u=t.value;t.bufferLayout=s;var c=0;a.forEach(function(t,n){var o=i(r[n],n);isNaN(o[3])&&(o[3]=255);for(var a=e._getPathLength(t),s=1;s<a;s++)u[c++]=o[0],u[c++]=o[1],u[c++]=o[2],u[c++]=o[3]})}},{key:"calculatePickingColors",value:function(t){var e=this,n=this.state.paths,r=t.value,i=0;n.forEach(function(t,n){for(var o=e.encodePickingColor(n),a=e._getPathLength(t),s=1;s<a;s++)r[i++]=o[0],r[i++]=o[1],r[i++]=o[2]})}}]),e}();Oe.layerName="PathLayer",Oe.defaultProps=Ae;var Me=n(267),Ie=n.n(Me),Le=r.experimental.flattenVertices;function Re(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function je(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]?t:t.concat([e])}function ze(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).dimensions;return Re(t)?[je(t)]:t.map(je)}function De(t){return Re(t)?t.length:t.reduce(function(t,e){return t+e.length},0)}function Fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ne=r.experimental.fillArray,Be=a.t.fp64LowPart;var Ue=[0,0,0,255],Ve=function(){function t(e){var n=e.polygons,r=e.IndexType;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(t){return t.reduce(function(t,e){return t+De(e)},0)}(n=n.map(function(t){return ze(t)}));if(this.polygons=n,this.pointCount=i,this.bufferLayout=n.map(function(t){return De(t)}),this.IndexType=r,r===Uint16Array&&i>65535)throw new Error("Vertex count exceeds browser's limit");this.attributes={pickingColors:function(t){var e=t.polygons,n=t.pointCount,r=new Uint8ClampedArray(3*n),i=0;return e.forEach(function(t,e){var n=function(t){return[255&++t,t>>8&255,t>>16&255]}(e),o=De(t);Ne({target:r,source:n,start:i,count:o}),i+=n.length*o}),r}({polygons:n,pointCount:i})}}return function(t,e,n){e&&Fe(t.prototype,e),n&&Fe(t,n)}(t,[{key:"updatePositions",value:function(t){var e=t.fp64,n=t.extruded,r=this.attributes,i=this.polygons,o=this.pointCount;r.positions=r.positions||new Float32Array(3*o),r.vertexValid=r.vertexValid||new Uint8ClampedArray(o).fill(1),e&&(r.positions64xyLow=r.positions64xyLow||new Float32Array(2*o)),function(t){var e=t.cache,n=e.positions,r=e.positions64xyLow,i=e.vertexValid,o=t.polygons,a=(t.extruded,t.fp64),s=0;o.forEach(function(t,e){t.forEach(function(t){t.forEach(function(t,e){var i=t[0],o=t[1],u=t[2]||0;n[3*s]=i,n[3*s+1]=o,n[3*s+2]=u,a&&(r[2*s]=Be(i),r[2*s+1]=Be(o)),s++}),i[s-1]=0})})}({cache:r,polygons:i,extruded:n,fp64:e})}},{key:"indices",value:function(){return function(t){var e=t.polygons,n=t.IndexType,r=void 0===n?Uint32Array:n,i=3*function(t){return t.reduce(function(t,e){return t+function(t){var e=0,n=!0,r=!0,i=!1,o=void 0;try{for(var a,s=ze(t)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value.length;e+=n?u>=3?u-2:0:u+1,n=!1}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}(e)},0)}(e),o=function(t){var e=new Array(t.length+1);e[0]=0;var n=0;return t.forEach(function(t,r){n+=De(t),e[r+1]=n}),e}(e),a=new r(i),s=0;return e.forEach(function(t,e){var n=!0,r=!1,i=void 0;try{for(var u,c=function(t){var e=function(t){var e=null;if(t.length>1){var n=0;e=[],t.forEach(function(t){n+=t.length,e.push(n)}),e.pop()}return e}(t),n=Le(t,{dimensions:2,result:[]});return Ie()(n,e,2)}(t)[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var l=u.value;a[s++]=l+o[e]}}catch(t){r=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}}),a}({polygons:this.polygons,IndexType:this.IndexType})}},{key:"positions",value:function(){return this.attributes.positions}},{key:"positions64xyLow",value:function(){return this.attributes.positions64xyLow}},{key:"vertexValid",value:function(){return this.attributes.vertexValid}},{key:"elevations",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"elevations":e,r=t.getElevation,i=void 0===r?function(t){return 100}:r,o=this.attributes,a=this.polygons,s=this.pointCount,u=function(t){var e=t.cache,n=t.polygons,r=t.pointCount,i=t.getElevation,o=e||new Float32Array(r),a=0;return n.forEach(function(t,e){var n=i(e),r=De(t);Ne({target:o,source:[n],start:a,count:r}),a+=r}),o}({cache:o[n],polygons:a,pointCount:s,getElevation:i});return o[n]=u,u}},{key:"colors",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=void 0===e?"colors":e,r=t.getColor,i=void 0===r?function(t){return Ue}:r,o=this.attributes,a=this.polygons,s=this.pointCount,u=function(t){var e=t.cache,n=t.polygons,r=t.pointCount,i=t.getColor,o=e||new Uint8ClampedArray(4*r),a=0;return n.forEach(function(t,e){var n=i(e);isNaN(n[3])&&(n[3]=255);var r=De(t);Ne({target:o,source:n,start:a,count:r}),a+=n.length*r}),o}({cache:o[n],polygons:a,pointCount:s,getColor:i});return o[n]=u,u}},{key:"pickingColors",value:function(){return this.attributes.pickingColors}}]),t}();function Ge(t){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function We(t,e){return!e||"object"!==Ge(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ze(t,e,n){return(Ze="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xe(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Xe(t){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ye=[0,0,0,255],Ke={filled:!0,extruded:!1,wireframe:!1,fp64:!1,elevationScale:1,getPolygon:function(t){return t.polygon},getElevation:1e3,getFillColor:Ye,getLineColor:Ye,lightSettings:{}},Je={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},Qe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),We(this,Xe(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(e,r["Layer"]),function(t,e,n){e&&qe(t.prototype,e),n&&qe(t,n)}(e,[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec2 vertexPositions;\nattribute float vertexValid;\nattribute vec3 positions;\nattribute vec2 positions64xyLow;\nattribute vec3 nextPositions;\nattribute vec2 nextPositions64xyLow;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\nuniform bool isSideVertex;\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  vec3 pos;\n  vec2 pos64xyLow;\n  vec3 normal;\n  vec4 colors = isWireframe ? lineColors : fillColors;\n\n  if (isSideVertex) {\n    pos = mix(positions, nextPositions, vertexPositions.x);\n    pos64xyLow = mix(positions64xyLow, nextPositions64xyLow, vertexPositions.x);\n    isValid = vertexValid;\n  } else {\n    pos = positions;\n    pos64xyLow = positions64xyLow;\n    isValid = 1.0;\n  }\n  if (extruded) {\n    pos.z += elevations * vertexPositions.y;\n  }\n  pos.z *= elevationScale;\n\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(pos, pos64xyLow, vec3(0.), position_worldspace);\n\n  float lightWeight = 1.0;\n  \n  if (extruded) {\n    if (isSideVertex) {\n      normal = vec3(positions.y - nextPositions.y, nextPositions.x - positions.x, 0.0);\n      normal = project_normal(normal);\n    } else {\n      normal = vec3(0.0, 0.0, 1.0);\n    }\n\n    lightWeight = lighting_getLightWeight(position_worldspace.xyz, normal);\n  }\n\n  vec3 lightWeightedColor = lightWeight * colors.rgb;\n  vColor = vec4(lightWeightedColor, colors.a * opacity) / 255.0;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(pickingColors);\n}\n",fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid < 0.5) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){var t=this.context.gl;this.setState({numInstances:0,IndexType:Object(a.u)(t,a.e.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array});var e=this.getAttributeManager();e.remove(["instancePickingColors"]),e.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,transition:Je,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0},positions64xyLow:{size:2,update:this.calculatePositionsLow,noAlloc:!0},vertexValid:{size:1,type:o.a.UNSIGNED_BYTE,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:Je,accessor:"getElevation",update:this.calculateElevations,noAlloc:!0},fillColors:{alias:"colors",size:4,type:o.a.UNSIGNED_BYTE,transition:Je,accessor:"getFillColor",update:this.calculateFillColors,defaultValue:Ye,noAlloc:!0},lineColors:{alias:"colors",size:4,type:o.a.UNSIGNED_BYTE,transition:Je,accessor:"getLineColor",update:this.calculateLineColors,defaultValue:Ye,noAlloc:!0},pickingColors:{size:3,type:o.a.UNSIGNED_BYTE,update:this.calculatePickingColors,noAlloc:!0}})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.extruded,i=n.filled,a=n.wireframe,s=n.elevationScale,u=this.state,c=u.topModel,l=u.sideModel,f=Object.assign({},e,{extruded:Boolean(r),elevationScale:s});l&&(l.setUniforms(f),a&&(l.setDrawMode(o.a.LINE_STRIP),l.render({isWireframe:!0})),i&&(l.setDrawMode(o.a.TRIANGLE_FAN),l.render({isWireframe:!1}))),c&&c.render(f)}},{key:"updateState",value:function(t){Ze(Xe(e.prototype),"updateState",this).call(this,t),this.updateGeometry(t);var n=t.props,r=t.oldProps,i=this.getAttributeManager();(n.fp64!==r.fp64||n.filled!==r.filled||n.extruded!==r.extruded)&&(this.state.models&&this.state.models.forEach(function(t){return t.delete()}),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}},{key:"updateGeometry",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags,i=r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon);if(i){var o=e.data.map(e.getPolygon),a=this._getPolygonTesselator(o,this.state.IndexType);this.setState({polygonTesselator:a,numInstances:a.pointCount}),this.getAttributeManager().invalidateAll()}(i||e.extruded!==n.extruded||e.fp64!==n.fp64)&&this.state.polygonTesselator.updatePositions({fp64:this.use64bitPositions(),extruded:e.extruded})}},{key:"_getPolygonTesselator",value:function(t,e){return new Ve({polygons:t,IndexType:this.state.IndexType})}},{key:"updateAttributes",value:function(t){Ze(Xe(e.prototype),"updateAttributes",this).call(this,t);var n=this.getAttributeManager().getChangedAttributes({clearChangedFlags:!0}),r=this.state,i=r.topModel,o=r.sideModel,a=r.vertexCount,s=r.numInstances;if(i&&(i.setVertexCount(a),i.setAttributes(n)),o){o.setInstanceCount(s-1);var u={};for(var c in n){var l=n[c];"indices"!==c&&(u[c]=Object.assign({},l,{isInstanced:!0,buffer:l.getBuffer()}))}u.positions&&(u.nextPositions=Object.assign({},u.positions,{id:"nextPositions",offset:12})),u.positions64xyLow&&(u.nextPositions64xyLow=Object.assign({},u.positions64xyLow,{id:"nextPositions64xyLow",offset:8})),o.setAttributes(u)}}},{key:"_getModels",value:function(t){var e,n,r=this.props,i=r.id,s=r.filled,u=r.extruded;return s&&(e=new a.h(t,Object.assign({},this.getShaders(),{id:"".concat(i,"-top"),geometry:new a.g({drawMode:o.a.TRIANGLES,attributes:{vertexPositions:{size:2,constant:!0,value:new Float32Array([0,1])},nextPositions:{size:3,constant:!0,value:new Float32Array(3)},nextPositions64xyLow:{size:2,constant:!0,value:new Float32Array(2)}}}),uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0,shaderCache:this.context.shaderCache}))),u&&(n=new a.h(t,Object.assign({},this.getShaders(),{id:"".concat(i,"-side"),geometry:new a.g({drawMode:o.a.LINES,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,1,0,1,0,0,1,0])}}}),uniforms:{isSideVertex:!0},isInstanced:1,shaderCache:this.context.shaderCache}))),{models:[n,e].filter(Boolean),topModel:e,sideModel:n}}},{key:"calculateIndices",value:function(t){t.value=this.state.polygonTesselator.indices();var e=t.value.length/t.size;this.setState({vertexCount:e})}},{key:"calculatePositions",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.positions()}},{key:"calculatePositionsLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.polygonTesselator.positions64xyLow():new Float32Array(2)}},{key:"calculateVertexValid",value:function(t){t.value=this.state.polygonTesselator.vertexValid()}},{key:"calculateElevations",value:function(t){var e=this,n=this.state.polygonTesselator;t.bufferLayout=n.bufferLayout;var r=this.props,i=r.extruded,o=r.getElevation;if(i&&"function"==typeof o)t.constant=!1,t.value=n.elevations({getElevation:function(t){return o(e.props.data[t])}});else{var a=i?o:0;t.constant=!0,t.value=new Float32Array([a])}}},{key:"calculateFillColors",value:function(t){var e=this,n=this.state.polygonTesselator;t.bufferLayout=n.bufferLayout,t.value=n.colors({key:"fillColors",getColor:function(t){return e.props.getFillColor(e.props.data[t])}})}},{key:"calculateLineColors",value:function(t){var e=this,n=this.state.polygonTesselator;t.bufferLayout=n.bufferLayout,t.value=n.colors({key:"lineColors",getColor:function(t){return e.props.getLineColor(e.props.data[t])}})}},{key:"calculatePickingColors",value:function(t){t.value=this.state.polygonTesselator.pickingColors()}}]),e}();function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function en(t,e){return!e||"object"!==$e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nn(t){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rn(t,e){return(rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Qe.layerName="SolidPolygonLayer",Qe.defaultProps=Ke;var on={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,lineDashJustified:!1,fp64:!1,getPolygon:function(t){return t.polygon},getFillColor:[0,0,0,255],getLineColor:[0,0,0,255],getLineWidth:1,getLineDashArray:null,getElevation:1e3,lightSettings:{}},an=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),en(this,nn(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rn(t,e)}(e,r["CompositeLayer"]),function(t,e,n){e&&tn(t.prototype,e),n&&tn(t,n)}(e,[{key:"initializeState",value:function(){this.state={paths:[]}}},{key:"updateState",value:function(t){var e=this,n=(t.oldProps,t.props,t.changeFlags);if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var r=this.props,i=r.data,o=r.getPolygon;this.state.paths=[],i.forEach(function(t){ze(o(t)).forEach(function(n){return e.state.paths.push({path:n,object:t})})})}}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.object||e.object})}},{key:"_getAccessor",value:function(t){return"function"==typeof t?function(e){return t(e.object)}:t}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,n=t.stroked,r=t.filled,i=t.extruded,o=t.wireframe,a=t.elevationScale,s=t.transitions,u=this.props,c=u.lineWidthScale,l=u.lineWidthMinPixels,f=u.lineWidthMaxPixels,h=u.lineJointRounded,p=u.lineMiterLimit,d=u.lineDashJustified,v=u.fp64,g=this.props,m=g.getFillColor,y=g.getLineColor,_=g.getLineWidth,b=g.getLineDashArray,x=g.getElevation,w=g.getPolygon,E=g.updateTriggers,S=g.lightSettings,P=this.state.paths,T=e&&e.length>0,A=T&&new Qe(this.getSubLayerProps({id:"fill",updateTriggers:{getElevation:E.getElevation,getFillColor:E.getFillColor,getLineColor:E.getLineColor}}),{data:e,extruded:i,elevationScale:a,fp64:v,filled:r,wireframe:o,getPolygon:w,getElevation:x,getFillColor:m,getLineColor:y,lightSettings:S,transitions:s}),k=!i&&n&&T&&new Oe(this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:E.getLineWidth,getColor:E.getLineColor,getDashArray:E.getLineDashArray}}),{data:P,fp64:v,widthScale:c,widthMinPixels:l,widthMaxPixels:f,rounded:h,miterLimit:p,dashJustified:d,transitions:s&&{getWidth:s.getLineWidth,getColor:s.getLineColor,getPath:s.getPolygon},getPath:function(t){return t.path},getColor:this._getAccessor(y),getWidth:this._getAccessor(_),getDashArray:this._getAccessor(b)});return[!i&&A,k,i&&A]}}]),e}();function sn(t,e){if(!t)throw new Error("deck.gl: ".concat(e))}function un(t,e,n){var r=t.type,i=t.coordinates,o=e.pointFeatures,a=e.lineFeatures,s=e.polygonFeatures,u=e.polygonOutlineFeatures;switch(function(t,e){var n=ln[t];sn(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];sn(e&&Number.isFinite(e[0]),"".concat(t," coordinates are malformed"))}(r,i),r){case"Point":o.push({geometry:t,sourceFeature:n});break;case"MultiPoint":i.forEach(function(t){o.push({geometry:{type:"Point",coordinates:t},sourceFeature:n})});break;case"LineString":a.push({geometry:t,sourceFeature:n});break;case"MultiLineString":i.forEach(function(t){a.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})});break;case"Polygon":s.push({geometry:t,sourceFeature:n}),i.forEach(function(t){u.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})});break;case"MultiPolygon":i.forEach(function(t){s.push({geometry:{type:"Polygon",coordinates:t},sourceFeature:n}),t.forEach(function(t){u.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})})})}}function cn(t){return t.sourceFeature.feature}an.layerName="PolygonLayer",an.defaultProps=on;var ln={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pn(t,e){return!e||"object"!==fn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dn(t){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vn(t,e){return(vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gn={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,lineDashJustified:!1,fp64:!1,getLineColor:[0,0,0,255],getFillColor:[0,0,0,255],getRadius:1,getLineWidth:1,getLineDashArray:null,getElevation:1e3,subLayers:{PointLayer:at,LineLayer:Oe,PolygonLayer:Qe},lightSettings:{}};function mn(t){return t.geometry.coordinates}function yn(t){return"function"!=typeof t?t:function(e){return t(cn(e))}}var _n=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),pn(this,dn(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vn(t,e)}(e,r["CompositeLayer"]),function(t,e,n){e&&hn(t.prototype,e),n&&hn(t,n)}(e,[{key:"initializeState",value:function(){this.state={features:{}}}},{key:"updateState",value:function(t){t.oldProps;var e=t.props;if(t.changeFlags.dataChanged){var n=function(t){if(Array.isArray(t))return t;switch(sn(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return sn(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data);this.state.features=function(t){for(var e={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},n=0;n<t.length;n++){var r=t[n];sn(r&&r.geometry,"GeoJSON does not have geometry");var i=r.geometry,o={feature:r,index:n};if("GeometryCollection"===i.type){sn(Array.isArray(i.geometries),"GeoJSON does not have geometries array");for(var a=i.geometries,s=0;s<a.length;s++)un(a[s],e,o)}else un(i,e,o)}return e}(n)}}},{key:"getPickingInfo",value:function(t){var e=t.info;t.sourceLayer;return Object.assign(e,{object:e.object?cn(e.object):e.object,index:e.object?function(t){return t.sourceFeature.index}(e.object):e.index})}},{key:"renderLayers",value:function(){var t=this.state.features,e=t.pointFeatures,n=t.lineFeatures,r=t.polygonFeatures,i=t.polygonOutlineFeatures,o=this.props,a=o.stroked,s=o.filled,u=o.extruded,c=o.wireframe,l=o.subLayers,f=o.lightSettings,h=o.transitions,p=this.props,d=p.lineWidthScale,v=p.lineWidthMinPixels,g=p.lineWidthMaxPixels,m=p.lineJointRounded,y=p.lineMiterLimit,_=p.pointRadiusScale,b=p.pointRadiusMinPixels,x=p.pointRadiusMaxPixels,w=p.elevationScale,E=p.lineDashJustified,S=p.fp64,P=this.props,T=P.getLineColor,A=P.getFillColor,k=P.getRadius,C=P.getLineWidth,O=P.getLineDashArray,M=P.getElevation,I=P.updateTriggers,L=e&&e.length>0,R=n&&n.length>0,j=i&&i.length>0,z=r&&r.length>0&&new l.PolygonLayer(this.getSubLayerProps({id:"polygon-fill",updateTriggers:{getElevation:I.getElevation,getFillColor:I.getFillColor,getLineColor:I.getLineColor}}),{data:r,fp64:S,extruded:u,elevationScale:w,filled:s,wireframe:c,lightSettings:f,getPolygon:mn,getElevation:yn(M),getFillColor:yn(A),getLineColor:yn(T),transitions:h&&{getPolygon:h.geometry,getElevation:h.getElevation,getFillColor:h.getFillColor,getLineColor:h.getLineColor}}),D=!u&&a&&j&&new l.LineLayer(this.getSubLayerProps({id:"polygon-outline",updateTriggers:{getColor:I.getLineColor,getWidth:I.getLineWidth,getDashArray:I.getLineDashArray}}),{data:i,fp64:S,widthScale:d,widthMinPixels:v,widthMaxPixels:g,rounded:m,miterLimit:y,dashJustified:E,getPath:mn,getColor:yn(T),getWidth:yn(C),getDashArray:yn(O),transitions:h&&{getPath:h.geometry,getColor:h.getLineColor,getWidth:h.getLineWidth}}),F=R&&new l.LineLayer(this.getSubLayerProps({id:"line-paths",updateTriggers:{getColor:I.getLineColor,getWidth:I.getLineWidth,getDashArray:I.getLineDashArray}}),{data:n,fp64:S,widthScale:d,widthMinPixels:v,widthMaxPixels:g,rounded:m,miterLimit:y,dashJustified:E,getPath:mn,getColor:yn(T),getWidth:yn(C),getDashArray:yn(O),transitions:h&&{getPath:h.geometry,getColor:h.getLineColor,getWidth:h.getLineWidth}}),N=L&&new l.PointLayer(this.getSubLayerProps({id:"points",updateTriggers:{getColor:I.getFillColor,getRadius:I.getRadius}}),{data:e,fp64:S,radiusScale:_,radiusMinPixels:b,radiusMaxPixels:x,getPosition:mn,getColor:yn(A),getRadius:yn(k),transitions:h&&{getPosition:h.geometry,getColor:h.getFillColor,getRadius:h.getRadius}});return[!u&&z,D,F,N,u&&z]}}]),e}();_n.layerName="GeoJsonLayer",_n.defaultProps=gn;function bn(t){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wn(t,e){return!e||"object"!==bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function En(t,e,n){return(En="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pn(t,e){return(Pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wn(this,Sn(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pn(t,e)}(e,M),function(t,e,n){e&&xn(t.prototype,e),n&&xn(t,n)}(e,[{key:"getShaders",value:function(){return Object.assign({},En(Sn(e.prototype),"getShaders",this).call(this),{vs:'#define SHADER_NAME multi-icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\n\n// the following three attributes are for the multi-icon layer\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  vec2 iconSize = instanceIconFrames.zw;\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : instanceSizes / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * sizeScale * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, vec3(0.0));\n  gl_Position += project_pixel_to_clipspace(pixelOffset);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vTextureCoords.y = 1.0 - vTextureCoords.y;\n\n  vColor = instanceColors / 255.;\n  picking_setPickingColor(instancePickingColors);\n\n  vColorMode = instanceColorModes;\n}\n'})}},{key:"initializeState",value:function(){En(Sn(e.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(t){En(Sn(e.prototype),"updateState",this).call(this,t);var n=t.changeFlags;n.updateTriggersChanged&&(n.updateTriggersChanged.getAnchorX||n.updateTriggersChanged.getAnchorY)&&this.getAttributeManager().invalidate("instanceOffsets")}},{key:"calculateInstanceOffsets",value:function(t){var e=this.props,n=e.data,r=e.iconMapping,i=e.getIcon,o=e.getAnchorX,a=e.getAnchorY,s=e.getLengthOfQueue,u=e.getShiftInQueue,c=t.value,l=0,f=!0,h=!1,p=void 0;try{for(var d,v=n[Symbol.iterator]();!(f=(d=v.next()).done);f=!0){var g=d.value,m=r[i(g)]||{},y=s(g),_=u(g);c[l++]=(o(g)-1)*y/2+m.width/2+_||0,c[l++]=m.height/2*a(g)||0}}catch(t){h=!0,p=t}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}}]),e}();function An(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Tn.layerName="MultiIconLayer",Tn.defaultProps={getShiftInQueue:function(t){return t.shift||0},getLengthOfQueue:function(t){return t.len||1},getAnchorX:function(t){return t.anchorX||0},getAnchorY:function(t){return t.anchorY||0},getPixelOffset:[0,0]};for(var kn=10242,Cn=10243,On=33071,Mn=1024,In=64,Ln=4,Rn=.9,jn=1.2,zn=[],Dn=32;Dn<128;Dn++)zn.push(String.fromCharCode(Dn));function Fn(t,e,n){t.font="".concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Un(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gn(t,e){return(Gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qn={start:1,middle:0,end:-1},Wn={top:1,center:0,bottom:-1},Zn={fp64:!1,sizeScale:1,fontFamily:"Monaco, monospace",characterSet:zn,getText:function(t){return t.text},getPosition:function(t){return t.position},getColor:[0,0,0,255],getSize:32,getAngle:0,getTextAnchor:"middle",getAlignmentBaseline:"center",getPixelOffset:[0,0]},Xn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Un(this,Vn(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gn(t,e)}(e,r["CompositeLayer"]),function(t,e,n){e&&Bn(t.prototype,e),n&&Bn(t,n)}(e,[{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags,i=n.fontFamily!==e.fontFamily||n.characterSet!==e.characterSet;i&&this.updateFontAtlas(e.fontFamily,e.characterSet),(r.dataChanged||i||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this.transformStringToLetters()}},{key:"updateFontAtlas",value:function(t,e){var n=function(t,e){var n,r=e.fontFamily,i=e.characterSet,o=void 0===i?zn:i,s=e.fontSize,u=void 0===s?In:s,c=e.padding,l=void 0===c?Ln:c,f=document.createElement("canvas"),h=f.getContext("2d"),p=0,d=0,v=u*jn;Fn(h,r,u);var g={};for(var m in Array.from(o).forEach(function(t){var e=h.measureText(t).width;d+e>Mn&&(d=0,p++),g[t]={x:d,y:p*(v+l),width:e,height:v,mask:!0},d+=e+l}),f.width=Mn,f.height=(p+1)*(v+l),Fn(h,r,u),g)h.fillText(m,g[m].x,g[m].y+u*Rn);return{scale:jn,mapping:g,texture:new a.i(t,{pixels:f,parameters:(n={},An(n,kn,On),An(n,Cn,On),n)})}}(this.context.gl,{fontFamily:t,characterSet:e}),r=n.scale,i=n.mapping,o=n.texture;this.setState({scale:r,iconAtlas:o,iconMapping:i})}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.object})}},{key:"transformStringToLetters",value:function(){var t=this.props,e=t.data,n=t.getText,i=this.state.iconMapping;if(e&&0!==e.length){var o=[];e.forEach(function(t){var e=n(t);if(e){var a=[0],s=0;Array.from(e).forEach(function(n,u){var c={text:n,index:u,offsets:a,len:e.length,object:t},l=i[n];l?s+=l.width:(r.log.warn("Missing character: ".concat(n))(),s+=32),a.push(s),o.push(c)})}}),this.setState({data:o})}}},{key:"getLetterOffset",value:function(t){return t.offsets[t.index]}},{key:"getTextLength",value:function(t){return t.offsets[t.offsets.length-1]}},{key:"_getAccessor",value:function(t){return"function"==typeof t?function(e){return t(e.object)}:t}},{key:"getAnchorXFromTextAnchor",value:function(t){return function(e){var n="function"==typeof t?t(e.object):t;if(!qn.hasOwnProperty(n))throw new Error("Invalid text anchor parameter: ".concat(n));return qn[n]}}},{key:"getAnchorYFromAlignmentBaseline",value:function(t){return function(e){var n="function"==typeof t?t(e.object):t;if(!Wn.hasOwnProperty(n))throw new Error("Invalid alignment baseline parameter: ".concat(n));return Wn[n]}}},{key:"renderLayers",value:function(){var t=this,e=this.state,n=e.data,r=e.scale,i=e.iconAtlas,o=e.iconMapping;if(!o||!i||!n)return null;var a=this.props,s=a.getPosition,u=a.getColor,c=a.getSize,l=a.getAngle,f=a.getTextAnchor,h=a.getAlignmentBaseline,p=a.getPixelOffset,d=a.fp64,v=a.sizeScale,g=a.transitions,m=a.updateTriggers;return[new Tn(this.getSubLayerProps({id:"text-multi-icon-layer",data:n,iconAtlas:i,iconMapping:o,getIcon:function(t){return t.text},getPosition:function(t){return s(t.object)},getShiftInQueue:function(e){return t.getLetterOffset(e)},getLengthOfQueue:function(e){return t.getTextLength(e)},getColor:this._getAccessor(u),getSize:this._getAccessor(c),getAngle:this._getAccessor(l),getAnchorX:this.getAnchorXFromTextAnchor(f),getAnchorY:this.getAnchorYFromAlignmentBaseline(h),getPixelOffset:this._getAccessor(p),fp64:d,sizeScale:v*r,transitions:g&&{getPosition:g.getPosition,getAngle:g.getAngle,getColor:g.getColor,getSize:g.getSize,getPixelOffset:m.getPixelOffset},updateTriggers:{getPosition:m.getPosition,getAngle:m.getAngle,getColor:m.getColor,getSize:m.getSize,getPixelOffset:m.getPixelOffset,getAnchorX:m.getTextAnchor,getAnchorY:m.getAlignmentBaseline}}))]}}]),e}();Xn.layerName="TextLayer",Xn.defaultProps=Zn;var Hn=n(179),Yn=n.n(Hn);n.d(e,"experimental",function(){return Kn}),n.d(e,"COORDINATE_SYSTEM",function(){return r.COORDINATE_SYSTEM}),n.d(e,"Deck",function(){return r.Deck}),n.d(e,"Layer",function(){return r.Layer}),n.d(e,"CompositeLayer",function(){return r.CompositeLayer}),n.d(e,"View",function(){return r.View}),n.d(e,"MapView",function(){return r.MapView}),n.d(e,"FirstPersonView",function(){return r.FirstPersonView}),n.d(e,"ThirdPersonView",function(){return r.ThirdPersonView}),n.d(e,"OrbitView",function(){return r.OrbitView}),n.d(e,"PerspectiveView",function(){return r.PerspectiveView}),n.d(e,"OrthographicView",function(){return r.OrthographicView}),n.d(e,"Viewport",function(){return r.Viewport}),n.d(e,"WebMercatorViewport",function(){return r.WebMercatorViewport}),n.d(e,"Controller",function(){return r.Controller}),n.d(e,"MapController",function(){return r.MapController}),n.d(e,"AttributeManager",function(){return r.AttributeManager}),n.d(e,"project",function(){return r.project}),n.d(e,"project64",function(){return r.project64}),n.d(e,"lighting",function(){return r.lighting}),n.d(e,"LayerManager",function(){return r.LayerManager}),n.d(e,"log",function(){return r.log}),n.d(e,"_OrbitController",function(){return r._OrbitController}),n.d(e,"_FirstPersonController",function(){return r._FirstPersonController}),n.d(e,"TRANSITION_EVENTS",function(){return r.TRANSITION_EVENTS}),n.d(e,"LinearInterpolator",function(){return r.LinearInterpolator}),n.d(e,"FlyToInterpolator",function(){return r.FlyToInterpolator}),n.d(e,"_EffectManager",function(){return r._EffectManager}),n.d(e,"_Effect",function(){return r._Effect}),n.d(e,"_ReflectionEffect",function(){return r._ReflectionEffect}),n.d(e,"ArcLayer",function(){return m}),n.d(e,"IconLayer",function(){return M}),n.d(e,"LineLayer",function(){return B}),n.d(e,"PointCloudLayer",function(){return J}),n.d(e,"ScatterplotLayer",function(){return at}),n.d(e,"ScreenGridLayer",function(){return _t}),n.d(e,"GridLayer",function(){return qt}),n.d(e,"GridCellLayer",function(){return Ct}),n.d(e,"HexagonLayer",function(){return me}),n.d(e,"HexagonCellLayer",function(){return te}),n.d(e,"PathLayer",function(){return Oe}),n.d(e,"PolygonLayer",function(){return an}),n.d(e,"GeoJsonLayer",function(){return _n}),n.d(e,"TextLayer",function(){return Xn}),n.d(e,"default",function(){return Yn.a}),n.d(e,"DeckGL",function(){return Hn.DeckGL});var Kn={},Jn=r.experimental.BinSorter,Qn=r.experimental.linearScale,$n=r.experimental.getLinearScale,tr=r.experimental.quantizeScale,er=r.experimental.getQuantizeScale,nr=r.experimental.defaultColorRange,rr=r.experimental.flattenVertices,ir=r.experimental.fillArray;Object.assign(Kn,{BinSorter:Jn,linearScale:Qn,getLinearScale:$n,quantizeScale:tr,getQuantizeScale:er,defaultColorRange:nr,flattenVertices:rr,fillArray:ir})},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(9),o=n(8),a=n(2),s=n(10),u=n(3),c=n(0),l=n(15),f=n(4),h=n.n(f);function p(t){if(!t)return null;if("string"==typeof t)return t;t.toJS&&(t=t.toJS());var e=t.layers.reduce(function(t,e){return Object.assign(t,Object(c.a)({},e.id,e))},{});return t.layers=t.layers.map(function(t){delete(t=Object.assign({},t)).interactive;var n=e[t.ref];return n&&(delete t.ref,void 0!==n.type&&(t.type=n.type),void 0!==n.source&&(t.source=n.source),void 0!==n["source-layer"]&&(t["source-layer"]=n["source-layer"]),void 0!==n.minzoom&&(t.minzoom=n.minzoom),void 0!==n.maxzoom&&(t.maxzoom=n.maxzoom),void 0!==n.filter&&(t.filter=n.filter),void 0!==n.layout&&(t.layout=t.layout||{},t.layout=Object.assign({},t.layout,n.layout))),t}),t}var d=n(239),v=n(268),g=n(151),m=n(231),y=n.n(m),_=n(18),b=n(566),x=n(104);function w(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}var E=function(){function t(){Object(r.a)(this,t),Object(c.a)(this,"propNames",[])}return Object(a.a)(t,[{key:"arePropsEqual",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=(this.propNames||[])[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!Object(x.e)(t[s],e[s]))return!1}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){w(!1,"interpolateProps is not implemented")}}]),t}(),S=n(567),P={longitude:1,bearing:1};function T(t){return Number.isFinite(t)||Array.isArray(t)}function A(t,e,n){return function(t){return t in P}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}var k=["longitude","latitude","zoom","bearing","pitch"],C=["latitude","longitude","zoom","width","height"],O=["bearing","pitch"],M=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return n=Object(i.a)(this,(t=Object(o.a)(e)).call.apply(t,[this].concat(s))),Object(c.a)(Object(u.a)(Object(u.a)(n)),"propNames",k),n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"initializeProps",value:function(t,e){for(var n={},r={},i=0;i<C.length;i++){var o=C[i],a=t[o],s=e[o];w(T(a)&&T(s),"".concat(o," must be supplied for transition")),n[o]=a,r[o]=A(o,a,s)}for(var u=0;u<O.length;u++){var c=O[u],l=t[c]||0,f=e[c]||0;n[c]=l,r[c]=A(c,l,f)}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){for(var r=Object(S.a)(t,e,n),i=0;i<O.length;i++){var o=O[i];r[o]=Object(x.g)(t[o],e[o],n)}return r}}]),e}(E),I=["longitude","latitude","zoom","bearing","pitch"],L=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r.a)(this,e),t=Object(i.a)(this,Object(o.a)(e).call(this)),Object(c.a)(Object(u.a)(Object(u.a)(t)),"around",void 0),Array.isArray(n)&&(n={transitionProps:n}),t.propNames=n.transitionProps||I,n.around&&(t.around=n.around),t}return Object(s.a)(e,t),Object(a.a)(e,[{key:"initializeProps",value:function(t,e){var n={},r={};if(this.around){n.around=this.around;var i=new d.a(t).unproject(this.around);Object.assign(r,e,{around:new d.a(e).project(i),aroundLngLat:i})}var o=!0,a=!1,s=void 0;try{for(var u,c=this.propNames[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,f=t[l],h=e[l];w(T(f)&&T(h),"".concat(l," must be supplied for transition")),n[l]=f,r[l]=A(l,f,h)}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r={},i=!0,o=!1,a=void 0;try{for(var s,u=this.propNames[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r[c]=Object(x.g)(t[c],e[c],n)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}if(e.around){var l=new d.a(Object.assign({},e,r)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:Object(x.g)(t.around,e.around,n)}),f=Object(_.a)(l,2),h=f[0],p=f[1];r.longitude=h,r.latitude=p}return r}}]),e}(E),R={minZoom:0,maxZoom:20,minPitch:0,maxPitch:60},j={pitch:0,bearing:0,altitude:1.5},z=function(){function t(e){var n=e.width,i=e.height,o=e.latitude,a=e.longitude,s=e.zoom,u=e.bearing,l=void 0===u?j.bearing:u,f=e.pitch,h=void 0===f?j.pitch:f,p=e.altitude,d=void 0===p?j.altitude:p,v=e.maxZoom,g=void 0===v?R.maxZoom:v,m=e.minZoom,y=void 0===m?R.minZoom:m,_=e.maxPitch,b=void 0===_?R.maxPitch:_,x=e.minPitch,E=void 0===x?R.minPitch:x,S=e.transitionDuration,P=e.transitionEasing,T=e.transitionInterpolator,A=e.transitionInterruption,k=e.startPanLngLat,C=e.startZoomLngLat,O=e.startBearing,M=e.startPitch,I=e.startZoom;Object(r.a)(this,t),Object(c.a)(this,"_viewportProps",void 0),Object(c.a)(this,"_interactiveState",void 0),w(Number.isFinite(n),"`width` must be supplied"),w(Number.isFinite(i),"`height` must be supplied"),w(Number.isFinite(a),"`longitude` must be supplied"),w(Number.isFinite(o),"`latitude` must be supplied"),w(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:i,latitude:o,longitude:a,zoom:s,bearing:l,pitch:h,altitude:d,maxZoom:g,minZoom:y,maxPitch:b,minPitch:E,transitionDuration:S,transitionEasing:P,transitionInterpolator:T,transitionInterruption:A}),this._interactiveState={startPanLngLat:k,startZoomLngLat:C,startBearing:O,startPitch:M,startZoom:I}}return Object(a.a)(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=this._calculateNewLngLat({startPanLngLat:r,pos:e}),o=Object(_.a)(i,2),a=o[0],s=o[1];return this._getUpdatedMapState({longitude:a,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedMapState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,o=this._interactiveState,a=o.startBearing,s=o.startPitch;if(!Number.isFinite(a)||!Number.isFinite(s))return this;var u=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:a||0,startPitch:s||0}),c=u.pitch,l=u.bearing;return this._getUpdatedMapState({bearing:l,pitch:c})}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;w(r>0,"`scale` must be a positive number");var i=this._interactiveState,o=i.startZoom,a=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,a=this._unproject(n)||this._unproject(e)),w(a,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:o||0}),u=new d.a(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:a,pos:e}),c=Object(_.a)(u,2),l=c[0],f=c[1];return this._getUpdatedMapState({zoom:s,longitude:l,latitude:f})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Object(x.b)(r,n,e);var i=t.maxPitch,o=t.minPitch,a=t.pitch;return t.pitch=Object(x.b)(a,o,i),Object.assign(t,Object(b.a)(t)),t}},{key:"_unproject",value:function(t){var e=new d.a(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new d.a(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom,a=n+Math.log2(e);return Object(x.b)(a,o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=Object(x.b)(n,-1,1);var o=this._viewportProps,a=o.minPitch,s=o.maxPitch,u=i;return n>0?u=i+n*(s-i):n<0&&(u=i-n*(a-i)),{pitch:u,bearing:r+180*e}}}]),t}();function D(t){return t[0].toLowerCase()+t.slice(1)}var F="A valid API access token is required to use Mapbox data",N=Object(l.createContext)({viewport:null,map:null});var B=401,U={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},V=Object.assign({},g.a.propTypes,{width:h.a.oneOfType([h.a.number,h.a.string]),height:h.a.oneOfType([h.a.number,h.a.string]),onResize:h.a.func,preventStyleDiffing:h.a.bool,disableTokenWarning:h.a.bool,visible:h.a.bool,className:h.a.string,style:h.a.object,visibilityConstraints:h.a.object}),G=Object.assign({},g.a.defaultProps,{preventStyleDiffing:!1,disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:R}),q=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,s=new Array(a),f=0;f<a;f++)s[f]=arguments[f];return n=Object(i.a)(this,(t=Object(o.a)(e)).call.apply(t,[this].concat(s))),Object(c.a)(Object(u.a)(Object(u.a)(n)),"state",{accessTokenInvalid:!1}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_mapbox",null),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_map",null),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_mapboxMapRef",Object(l.createRef)()),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_queryParams",{}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_width",0),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_height",0),Object(c.a)(Object(u.a)(Object(u.a)(n)),"getMap",function(){return n._map}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"queryRenderedFeatures",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n._map.queryRenderedFeatures(t,e)}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_mapboxMapError",function(t){(t.error&&t.error.status||t.status)!==B||n.state.accessTokenInvalid||(console.error(F),n.setState({accessTokenInvalid:!0})),n.props.onError(t)}),n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"componentDidMount",value:function(){if(e.supported()){var t=this.props.mapStyle;this._mapbox=new g.a(Object.assign({},this.props,{mapboxgl:y.a,width:this._width,height:this._height,container:this._mapboxMapRef.current,onError:this._mapboxMapError,mapStyle:p(t)})),this._map=this._mapbox.getMap()}}},{key:"componentDidUpdate",value:function(t){this._mapbox&&(this._updateMapStyle(t,this.props),this._updateMapProps(this.props))}},{key:"componentWillUnmount",value:function(){this._mapbox&&(this._mapbox.finalize(),this._mapbox=null,this._map=null)}},{key:"_updateMapSize",value:function(t,e){this._width===t&&this._height===e||(this._width=t,this._height=e,this._updateMapProps(this.props))}},{key:"_updateMapStyle",value:function(t,e){var n=e.mapStyle;n!==t.mapStyle&&this._map.setStyle(p(n),{diff:!this.props.preventStyleDiffing})}},{key:"_updateMapProps",value:function(t){this._mapbox&&this._mapbox.setProps(Object.assign({},t,{width:this._width,height:this._height}))}},{key:"_renderNoTokenWarning",value:function(){if(this.state.accessTokenInvalid&&!this.props.disableTokenWarning){return Object(l.createElement)("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},[Object(l.createElement)("h3",{key:"header"},F),Object(l.createElement)("div",{key:"text"},"For information on setting up your basemap, read"),Object(l.createElement)("a",{key:"link",href:"https://uber.github.io/react-map-gl/#/Documentation/getting-started/about-mapbox-tokens"},"Note on Map Tokens")])}return null}},{key:"_renderOverlays",value:function(t){var e=t.width,n=void 0===e?Number(this.props.width):e,r=t.height,i=void 0===r?Number(this.props.height):r;this._updateMapSize(n,i);var o={viewport:new d.a(Object.assign({},this.props,this.props.viewState,{width:n,height:i})),map:this._map};return Object(l.createElement)(N.Provider,{value:o},Object(l.createElement)("div",{key:"map-overlays",className:"overlays",style:U,children:this.props.children}))}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.width,r=t.height,i=t.style,o=t.visibilityConstraints,a=Object.assign({position:"relative"},i,{width:n,height:r}),s=this.props.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R;for(var n in e){var r=n.slice(0,3),i=D(n.slice(3));if("min"===r&&t[i]<e[n])return!1;if("max"===r&&t[i]>e[n])return!1}return!0}(this.props.viewState||this.props,o),u=Object.assign({},U,{visibility:s?"inherit":"hidden"});return Object(l.createElement)("div",{key:"map-container",style:a,children:[Object(l.createElement)("div",{key:"map-mapbox",ref:this._mapboxMapRef,style:u,className:e}),Object(l.createElement)(v.a,{key:"autosizer",disableWidth:Number.isFinite(n),disableHeight:Number.isFinite(r),onResize:this.props.onResize},this._renderOverlays.bind(this)),this._renderNoTokenWarning()]})}}],[{key:"supported",value:function(){return y.a&&y.a.supported()}}]),e}(l.PureComponent);Object(c.a)(q,"propTypes",V),Object(c.a)(q,"defaultProps",G);var W=function(){};var Z={BREAK:1,SNAP_TO_END:2,IGNORE:3,UPDATE:4},X={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new L,transitionInterruption:Z.BREAK,onTransitionStart:W,onTransitionInterrupt:W,onTransitionEnd:W,onViewportChange:W,onStateChange:W},H=function(){function t(e){var n=this;Object(r.a)(this,t),Object(c.a)(this,"props",void 0),Object(c.a)(this,"state",void 0),Object(c.a)(this,"_animationFrame",null),Object(c.a)(this,"_onTransitionFrame",function(){n._animationFrame=requestAnimationFrame(n._onTransitionFrame),n._updateViewport()}),e&&(this.props=e)}return Object(a.a)(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),r=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===Z.SNAP_TO_END?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===Z.UPDATE)){var i=Date.now(),o=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}(this.state.easing,o),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){return t.transitionDuration>0&&Boolean(t.transitionInterpolator)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===Z.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){w(this._isTransitionEnabled(e),"Transition is not enabled"),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator.initializeProps(t,e),r={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:e.transitionDuration,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:Date.now(),startProps:n.start,endProps:n.end,animation:null,propsInTransition:{},interactionState:r},this._onTransitionFrame(),this.props.onStateChange(r)}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.props.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=Date.now(),e=this.state,n=e.startTime,r=e.duration,i=e.easing,o=e.interpolator,a=e.startProps,s=e.endProps,u=!1,c=(t-n)/r;c>=1&&(c=1,u=!0),c=i(c);var l=o.interpolateProps(a,s,c),f=new z(Object.assign({},this.props,l));this.state.propsInTransition=f.getViewportProps(),this.props.onViewportChange(this.state.propsInTransition,this.state.interactionState,this.props),u&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();Object(c.a)(H,"defaultProps",X);var Y=n(116),K=n.n(Y),J=1,Q=2,$=4,tt={mousedown:J,mousemove:Q,mouseup:$};!function(t){var e=t.prototype.handler;t.prototype.handler=function(t){var n=this.store;t.button>0&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,function(e){return e.pointerId===t.pointerId})||n.push(t)),e.call(this,t)}}(K.a.PointerEventInput),function(t){t.prototype.handler=function(t){var e=tt[t.type];e&J&&t.button>=0&&(this.pressed=!0),e&Q&&0===t.which&&(e=$),this.pressed&&(e&$&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(K.a.MouseInput);var et=K.a.Manager,nt=K.a,rt=nt?[[nt.Rotate,{enable:!1}],[nt.Pinch,{enable:!1}],[nt.Swipe,{enable:!1}],[nt.Pan,{threshold:0,enable:!1}],[nt.Press,{enable:!1}],[nt.Tap,{event:"doubletap",taps:2,enable:!1}],[nt.Tap,{enable:!1}]]:null,it={rotate:["pinch"]},ot={doubletap:["tap"]},at={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},st=["keydown","keyup"],ut=["mousedown","mousemove","mouseup","mouseleave"],ct=["wheel","mousewheel","DOMMouseScroll"],lt={tap:"tap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},ft={click:"tap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseleave:"pointerleave"},ht=n(118),pt=-1!==ht.a.indexOf("firefox"),dt=ct,vt=function(){function t(e,n){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(r.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},o),this.events=dt.concat(o.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(function(t){return e.addEventListener(t,i.handleEvent)})}return Object(a.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){if(this.options.enable){var e=t.deltaY;ht.b.WheelEvent&&(pt&&t.deltaMode===ht.b.WheelEvent.DOM_DELTA_PIXEL&&(e/=ht.b.devicePixelRatio),t.deltaMode===ht.b.WheelEvent.DOM_DELTA_LINE&&(e*=40));var n={x:t.clientX,y:t.clientY};0!==e&&e%4.000244140625==0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}}},{key:"_onWheel",value:function(t,e,n){this.callback({type:"wheel",center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),gt=ut,mt=function(){function t(e,n){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(r.a)(this,t),this.element=e,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},o),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.events=gt.concat(o.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(function(t){return e.addEventListener(t,i.handleEvent)})}return Object(a.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleEvent",value:function(t){if(this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:"pointerleave",srcEvent:t,pointerType:"mouse",target:t.target}),this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}]),t}(),yt=st,_t=function(){function t(e,n){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(r.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},o),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=yt.concat(o.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=1,e.style.outline="none",this.events.forEach(function(t){return e.addEventListener(t,i.handleEvent)})}return Object(a.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach(function(e){return t.element.removeEventListener(e,t.handleEvent)})}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}},{key:"handleEvent",value:function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))}}]),t}(),bt=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(r.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}return Object(a.a)(t,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(t,e){"contextmenu"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){this.options.enable&&this.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),xt=1,wt=2,Et=4,St={pointerdown:xt,pointermove:wt,pointerup:Et,mousedown:xt,mousemove:wt,mouseup:Et},Pt=1,Tt=2,At=3,kt=0,Ct=1,Ot=2,Mt=1,It=2,Lt=4;var Rt=function(){function t(e){Object(r.a)(this,t),this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this)}return Object(a.a)(t,[{key:"isEmpty",value:function(){return 0===this.handlers.length}},{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"root",r=this.handlers,i=this.handlersByElement;i.has(n)||i.set(n,[]);var o={type:t,handler:e,srcElement:n};r.push(o),i.get(n).push(o)}},{key:"remove",value:function(t,e){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);var a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}}},{key:"handleEvent",value:function(t){if(!this.isEmpty()){for(var e=this._normalizeEvent(t),n=t.srcEvent.target;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}}},{key:"_emit",value:function(t,e){var n=this.handlersByElement.get(e);if(n)for(var r=!1,i=function(){t.handled=!0},o=function(){t.handled=!0,r=!0},a=0;a<n.length;a++){var s=n[a],u=s.type;if((0,s.handler)(Object.assign({},t,{type:u,stopPropagation:i,stopImmediatePropagation:o})),r)break}}},{key:"_normalizeEvent",value:function(t){var e=this.eventManager.element;return Object.assign({},t,function(t){var e=St[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,o=n.which,a=!1,s=!1,u=!1;return e===Et||e===wt&&!Number.isFinite(r)?(a=o===Pt,s=o===Tt,u=o===At):e===wt?(a=Boolean(r&Mt),s=Boolean(r&Lt),u=Boolean(r&It)):e===xt&&(a=i===kt,s=i===Ct,u=i===Ot),{leftButton:a,middleButton:s,rightButton:u}}(t),function(t,e){var n=t.srcEvent;if(!t.center&&!Number.isFinite(n.clientX))return null;var r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth,a=i.height/e.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/a}}}(t,e),{handled:!1,rootElement:e})}}]),t}(),jt={events:null,recognizers:null,Manager:et,touchAction:"none"},zt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,t),this.options=Object.assign({},jt,n),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);var i=n.events;i&&this.on(i)}return Object(a.a)(t,[{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||rt}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(it).forEach(function(t){var n=e.manager.get(t);n&&it[t].forEach(function(t){n.recognizeWith(t)})}),this.wheelInput=new vt(t,this._onOtherEvent,{enable:!1}),this.moveInput=new mt(t,this._onOtherEvent,{enable:!1}),this.keyInput=new _t(t,this._onOtherEvent,{enable:!1}),this.contextmenuInput=new bt(t,this._onOtherEvent,{enable:!1});var i=!0,o=!1,a=void 0;try{for(var s,u=this.events[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=Object(_.a)(s.value,2),l=c[0],f=c[1];f.isEmpty()||(this._toggleRecognizer(f.recognizerName,!0),this.manager.on(l,f.handleEvent))}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){if("string"==typeof t)this._addEventHandler(t,e,n);else for(var r in n=e,t)this._addEventHandler(r,t[r],n)}},{key:"off",value:function(t,e){if("string"==typeof t)this._removeEventHandler(t,e);else for(var n in t)this._removeEventHandler(n,t[n])}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});var i=ot[t];i&&!this.options.recognizers&&i.forEach(function(i){var o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e,n){var r=this.manager,i=this.events,o=ft[t]||t,a=i.get(o);a||(a=new Rt(this),i.set(o,a),a.recognizerName=lt[o]||o,r&&r.on(o,a.handleEvent)),this._toggleRecognizer(a.recognizerName,!0),a.add(t,e,n)}},{key:"_removeEventHandler",value:function(t,e){var n=this.events,r=ft[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){var o=i.recognizerName,a=!1,s=!0,u=!1,c=void 0;try{for(var l,f=n.values()[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;if(h.recognizerName===o&&!h.isEmpty()){a=!0;break}}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}a||this._toggleRecognizer(o,!1)}}},{key:"_onBasicInput",value:function(t){var e=t.srcEvent,n=at[e.type];n&&this.manager.emit(n,t)}},{key:"_onOtherEvent",value:function(t){this.manager.emit(t.type,t)}}]),t}(),Dt={transitionDuration:0},Ft={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new L,transitionInterruption:Z.BREAK},Nt=["wheel"],Bt=["panstart","panmove","panend"],Ut=["pinchstart","pinchmove","pinchend"],Vt=["doubletap"],Gt=["keydown"],qt=function(){function t(){var e=this;Object(r.a)(this,t),Object(c.a)(this,"events",[]),Object(c.a)(this,"mapState",void 0),Object(c.a)(this,"onViewportChange",void 0),Object(c.a)(this,"onStateChange",void 0),Object(c.a)(this,"mapStateProps",void 0),Object(c.a)(this,"eventManager",void 0),Object(c.a)(this,"scrollZoom",!0),Object(c.a)(this,"dragPan",!0),Object(c.a)(this,"dragRotate",!0),Object(c.a)(this,"doubleClickZoom",!0),Object(c.a)(this,"touchZoom",!0),Object(c.a)(this,"touchRotate",!1),Object(c.a)(this,"keyboard",!0),Object(c.a)(this,"_state",{isDragging:!1}),Object(c.a)(this,"_events",{}),Object(c.a)(this,"_transitionManager",new H),Object(c.a)(this,"handleEvent",function(t){switch(e.mapState=e.getMapState(),t.type){case"panstart":return e._onPanStart(t);case"panmove":return e._onPan(t);case"panend":return e._onPanEnd(t);case"pinchstart":return e._onPinchStart(t);case"pinchmove":return e._onPinch(t);case"pinchend":return e._onPinchEnd(t);case"doubletap":return e._onDoubleTap(t);case"wheel":return e._onWheel(t);case"keydown":return e._onKeyDown(t);default:return!1}}),Object(c.a)(this,"setState",function(t){Object.assign(e._state,t),e.onStateChange&&e.onStateChange(e._state)})}return Object(a.a)(t,[{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.mapState?this.mapState.getViewportProps():{},i=Object.assign({},t.getViewportProps(),e);Object.keys(i).some(function(t){return r[t]!==i[t]})&&this.onViewportChange(i,n,r),this.setState(Object.assign({},t.getInteractiveState(),n))}},{key:"getMapState",value:function(t){return new z(Object.assign({},this.mapStateProps,this._state,t))}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,r=t.eventManager,i=void 0===r?this.eventManager:r,o=t.isInteractive,a=void 0===o||o,s=t.scrollZoom,u=void 0===s?this.scrollZoom:s,c=t.dragPan,l=void 0===c?this.dragPan:c,f=t.dragRotate,h=void 0===f?this.dragRotate:f,p=t.doubleClickZoom,d=void 0===p?this.doubleClickZoom:p,v=t.touchZoom,g=void 0===v?this.touchZoom:v,m=t.touchRotate,y=void 0===m?this.touchRotate:m,_=t.keyboard,b=void 0===_?this.keyboard:_;this.onViewportChange=e,this.onStateChange=n,this.mapStateProps&&this.mapStateProps.height===t.height||this.updateViewport(new z(t)),this.mapStateProps=t,this._transitionManager.processViewportChange(Object.assign({},t,{onStateChange:this.setState})),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Nt,a&&u),this.toggleEvents(Bt,a&&(l||h)),this.toggleEvents(Ut,a&&(g||y)),this.toggleEvents(Vt,a&&d),this.toggleEvents(Gt,a&&b),this.scrollZoom=u,this.dragPan=l,this.dragRotate=h,this.doubleClickZoom=d,this.touchZoom=g,this.touchRotate=y,this.keyboard=b}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach(function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))})}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,Dt,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return this.isFunctionKeyPressed(t)||t.rightButton?this._onPanRotate(t):this._onPanMove(t)}},{key:"_onPanEnd",value:function(t){var e=this.mapState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isRotating:!1}),!0}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,Dt,{isPanning:!0}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=t.deltaX,n=t.deltaY,r=this.getCenter(t),i=Object(_.a)(r,2)[1],o=i-n,a=this.mapState.getViewportProps(),s=a.width,u=a.height,c=e/s,l=0;n>0?Math.abs(u-o)>5&&(l=n/(o-u)*1.2):n<0&&o>5&&(l=1-i/o),l=Math.min(1,Math.max(-1,l));var f=this.mapState.rotate({deltaScaleX:c,deltaScaleY:l});return this.updateViewport(f,Dt,{isRotating:!0}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.preventDefault();var e=this.getCenter(t),n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.mapState.zoom({pos:e,scale:r});return this.updateViewport(i,Dt,{isZooming:!0}),this.setState({isZooming:!1}),!0}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,Dt,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,o=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-o)/180})}return this.updateViewport(e,Dt,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),!0}},{key:"_onPinchEnd",value:function(t){var e=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),r=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,Object.assign({},Ft,{transitionInterpolator:new L({around:e})})),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:r.zoom-2}):this.getMapState({zoom:r.zoom-1});break;case 187:e=n?this.getMapState({zoom:r.zoom+2}):this.getMapState({zoom:r.zoom+1});break;case 37:e=n?this.getMapState({bearing:r.bearing-15}):this.mapState.pan({pos:[100,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:r.bearing+15}):this.mapState.pan({pos:[-100,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:r.pitch+10}):this.mapState.pan({pos:[0,100],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:r.pitch-10}):this.mapState.pan({pos:[0,-100],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,Ft)}}]),t}(),Wt=[{old:"onChangeViewport",new:"onViewportChange"},{old:"perspectiveEnabled",new:"dragRotate"},{old:"onHoverFeatures",new:"onHover"},{old:"onClickFeatures",new:"onClick"},{old:"touchZoomRotate",new:"touchZoom, touchRotate"},{old:"mapControls",new:"controller"}];function Zt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Wt.forEach(function(e){if(t.hasOwnProperty(e.old)){var n=function(t){return"react-map-gl: `".concat(t,"` is removed.")}(e.old);e.new&&(n="".concat(n," ").concat(function(t){return"Use `".concat(t,"` instead.")}(e.new))),console.warn(n)}})}var Xt=Object(l.createContext)({eventManager:null,isDragging:!1}),Ht=Object.assign({},q.propTypes,{maxZoom:h.a.number,minZoom:h.a.number,maxPitch:h.a.number,minPitch:h.a.number,onViewStateChange:h.a.func,onViewportChange:h.a.func,onInteractionStateChange:h.a.func,transitionDuration:h.a.number,transitionInterpolator:h.a.object,transitionInterruption:h.a.number,transitionEasing:h.a.func,onTransitionStart:h.a.func,onTransitionInterrupt:h.a.func,onTransitionEnd:h.a.func,scrollZoom:h.a.bool,dragPan:h.a.bool,dragRotate:h.a.bool,doubleClickZoom:h.a.bool,touchZoom:h.a.bool,touchRotate:h.a.bool,keyboard:h.a.bool,onHover:h.a.func,onClick:h.a.func,onDblClick:h.a.func,onContextMenu:h.a.func,onMouseDown:h.a.func,onMouseMove:h.a.func,onMouseUp:h.a.func,onTouchStart:h.a.func,onTouchMove:h.a.func,onTouchEnd:h.a.func,onMouseEnter:h.a.func,onMouseLeave:h.a.func,onMouseOut:h.a.func,onWheel:h.a.func,touchAction:h.a.string,clickRadius:h.a.number,interactiveLayerIds:h.a.array,getCursor:h.a.func,controller:h.a.instanceOf(qt)}),Yt=Object.assign({},q.defaultProps,R,H.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}}),Kt=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(o.a)(e).call(this,t)),Object(c.a)(Object(u.a)(Object(u.a)(n)),"state",{isDragging:!1,isHovering:!1}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_controller",void 0),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_eventManager",void 0),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_width",0),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_height",0),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_eventCanvasRef",Object(l.createRef)()),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_staticMapRef",Object(l.createRef)()),Object(c.a)(Object(u.a)(Object(u.a)(n)),"getMap",function(){return n._staticMapRef.current?n._staticMapRef.current.getMap():null}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"queryRenderedFeatures",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.getMap();return r&&r.queryRenderedFeatures(t,e)}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onInteractionStateChange",function(t){var e=t.isDragging,r=void 0!==e&&e;r!==n.state.isDragging&&n.setState({isDragging:r});var i=n.props.onInteractionStateChange;i&&i(t)}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onResize",function(t){var e=t.width,r=t.height;n._width=e,n._height=r,n._setControllerProps(n.props),n.props.onResize({width:e,height:r})}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onViewportChange",function(t,e,r){var i=n.props,o=i.onViewStateChange,a=i.onViewportChange;o&&o({viewState:t,interactionState:e,oldViewState:r}),a&&a(t,e,r)}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onEvent",function(t,e){var r=n.props[t];r&&r(n._normalizeEvent(e))}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onPointerDown",function(t){switch(t.pointerType){case"touch":n._onEvent("onTouchStart",t);break;default:n._onEvent("onMouseDown",t)}}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onPointerUp",function(t){switch(t.pointerType){case"touch":n._onEvent("onTouchEnd",t);break;default:n._onEvent("onMouseUp",t)}}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onPointerMove",function(t){switch(t.pointerType){case"touch":n._onEvent("onTouchMove",t);break;default:n._onEvent("onMouseMove",t)}if(!n.state.isDragging){var e,r=n.props,i=r.onHover,o=r.interactiveLayerIds;(o||i)&&(t=n._normalizeEvent(t),e=n._getFeatures({pos:t.point,radius:n.props.clickRadius})),i&&(t.features=e,i(t));var a=Boolean(o&&e&&e.length>0),s=a&&!n.state.isHovering,u=!a&&n.state.isHovering;s&&n._onEvent("onMouseEnter",t),u&&n._onEvent("onMouseLeave",t),(s||u)&&n.setState({isHovering:a})}}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onClick",function(t){n.props.onClick&&((t=n._normalizeEvent(t)).features=n._getFeatures({pos:t.point,radius:n.props.clickRadius}),n.props.onClick(t))}),Zt(t),n._controller=t.controller||new qt,n._eventManager=new zt(null,{touchAction:t.touchAction}),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"supported",value:function(){return q.supported()}}]),Object(a.a)(e,[{key:"componentDidMount",value:function(){var t=this._eventManager;t.setElement(this._eventCanvasRef.current),t.on({pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointerleave:this._onEvent.bind(this,"onMouseOut"),click:this._onClick,dblclick:this._onEvent.bind(this,"onDblClick"),wheel:this._onEvent.bind(this,"onWheel"),contextmenu:this._onEvent.bind(this,"onContextMenu")}),this._setControllerProps(this.props)}},{key:"componentWillUpdate",value:function(t){this._setControllerProps(t)}},{key:"_setControllerProps",value:function(t){t=Object.assign({},t,t.viewState,{isInteractive:Boolean(t.onViewStateChange||t.onViewportChange),onViewportChange:this._onViewportChange,onStateChange:this._onInteractionStateChange,eventManager:this._eventManager,width:this._width,height:this._height}),this._controller.setOptions(t)}},{key:"_getFeatures",value:function(t){var e,n=t.pos,r=t.radius,i={},o=this.getMap();if(this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds),r){var a=r,s=[[n[0]-a,n[1]+a],[n[0]+a,n[1]-a]];e=o&&o.queryRenderedFeatures(s,i)}else e=o&&o.queryRenderedFeatures(n,i);return e}},{key:"_normalizeEvent",value:function(t){if(t.lngLat)return t;var e=t.offsetCenter,n=[e.x,e.y],r=new d.a(Object.assign({},this.props,{width:this._width,height:this._height}));return t.point=n,t.lngLat=r.unproject(n),t}},{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,r=t.style,i=t.getCursor,o=Object.assign({position:"relative"},r,{width:e,height:n,cursor:i(this.state)}),a={isDragging:this.state.isDragging,eventManager:this._eventManager};return Object(l.createElement)(Xt.Provider,{value:a},Object(l.createElement)("div",{key:"event-canvas",ref:this._eventCanvasRef,style:o},Object(l.createElement)(q,Object.assign({},this.props,{width:"100%",height:"100%",style:null,onResize:this._onResize,ref:this._staticMapRef,children:this.props.children}))))}}]),e}(l.PureComponent);Object(c.a)(Kt,"propTypes",Ht),Object(c.a)(Kt,"defaultProps",Yt);var Jt={captureScroll:h.a.bool,captureDrag:h.a.bool,captureClick:h.a.bool,captureDoubleClick:h.a.bool},Qt=function(t){function e(){var t,n;Object(r.a)(this,e);for(var a=arguments.length,s=new Array(a),f=0;f<a;f++)s[f]=arguments[f];return n=Object(i.a)(this,(t=Object(o.a)(e)).call.apply(t,[this].concat(s))),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_context",{}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_events",null),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_containerRef",Object(l.createRef)()),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onScroll",function(t){n.props.captureScroll&&t.stopPropagation()}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onDragStart",function(t){n.props.captureDrag&&t.stopPropagation()}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onPointerUp",function(t){if(n.props.captureDoubleClick){var e=n._context.eventManager;e.manager.get("doubletap").options.enable&&(e._toggleRecognizer("doubletap",!1),setTimeout(function(){e._toggleRecognizer("doubletap",!0)},0))}}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onClick",function(t){n.props.captureClick&&t.stopPropagation()}),n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;if(t){var e=this._context.eventManager;e&&(this._events={wheel:this._onScroll,panstart:this._onDragStart,click:this._onClick,pointerup:this._onPointerUp},e.on(this._events,t))}}},{key:"componentWillUnmount",value:function(){var t=this._context.eventManager;t&&this._events&&t.off(this._events)}},{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){var t=this;return Object(l.createElement)(Xt.Consumer,null,function(e){return Object(l.createElement)(N.Consumer,null,function(n){return t._context=Object.assign({},e,n),t._render()})})}}]),e}(l.PureComponent);Object(c.a)(Qt,"propTypes",Jt),Object(c.a)(Qt,"defaultProps",{captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0});var $t=n(91),te=Object.assign({},Qt.propTypes,{draggable:h.a.bool,onDrag:h.a.func,onDragEnd:h.a.func,onDragStart:h.a.func}),ee=Object.assign({},Qt.defaultProps,{draggable:!1}),ne=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(o.a)(e).call(this,t)),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onDragStart",function(t){var e=n.props,r=e.draggable,i=e.captureDrag;if((r||i)&&t.stopPropagation(),r){var o=n._getDragEventPosition(t),a=n._getDragEventOffset(t);n.setState({dragPos:o,dragOffset:a}),n._setupDragEvents(),n.props.onDragStart&&(t.lngLat=n._getDragLngLat(o,a),n.props.onDragStart(t))}}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onDrag",function(t){t.stopPropagation();var e=n._getDragEventPosition(t);n.setState({dragPos:e}),n.props.onDrag&&(t.lngLat=n._getDragLngLat(e,n.state.dragOffset),n.props.onDrag(t))}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onDragEnd",function(t){var e=n.state,r=e.dragPos,i=e.dragOffset;t.stopPropagation(),n.setState({dragPos:null,dragOffset:null}),n._removeDragEvents(),n.props.onDragEnd&&(t.lngLat=n._getDragLngLat(r,i),n.props.onDragEnd(t))}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onDragCancel",function(t){t.stopPropagation(),n.setState({dragPos:null,dragOffset:null}),n._removeDragEvents()}),n.state={dragPos:null,dragOffset:null},n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"componentWillUnmount",value:function(){Object($t.a)(Object(o.a)(e.prototype),"componentWillUnmount",this).call(this),this._removeDragEvents()}},{key:"_setupDragEvents",value:function(){var t=this._context.eventManager;t&&(this._dragEvents={panmove:this._onDrag,panend:this._onDragEnd,pancancel:this._onDragCancel},t.on(this._dragEvents))}},{key:"_removeDragEvents",value:function(){var t=this._context.eventManager;t&&this._dragEvents&&(t.off(this._dragEvents),this._dragEvents=null)}},{key:"_getDragEventPosition",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"_getDragEventOffset",value:function(t){var e=t.center,n=e.x,r=e.y,i=this._containerRef.current.getBoundingClientRect();return[i.left-n,i.top-r]}},{key:"_getDraggedPosition",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"_getDragLngLat",value:function(t,e){return this._context.viewport.unproject(this._getDraggedPosition(t,e))}}]),e}(Qt);Object(c.a)(ne,"propTypes",te),Object(c.a)(ne,"defaultProps",ee);var re=Object.assign({},ne.propTypes,{className:h.a.string,longitude:h.a.number.isRequired,latitude:h.a.number.isRequired,offsetLeft:h.a.number,offsetTop:h.a.number,draggable:h.a.bool,onDrag:h.a.func,onDragEnd:h.a.func,onDragStart:h.a.func}),ie=Object.assign({},ne.defaultProps,{className:"",offsetLeft:0,offsetTop:0}),oe=function(t){function e(){return Object(r.a)(this,e),Object(i.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(a.a)(e,[{key:"_render",value:function(){var t=this.props,e=t.className,n=t.longitude,r=t.latitude,i=t.offsetLeft,o=t.offsetTop,a=this.state,s=a.dragPos,u=a.dragOffset,c=s?this._getDraggedPosition(s,u):this._context.viewport.project([n,r]),f=Object(_.a)(c,2),h={position:"absolute",left:f[0]+i,top:f[1]+o};return Object(l.createElement)("div",{className:"mapboxgl-marker ".concat(e),ref:this._containerRef,style:h,children:this.props.children})}}]),e}(ne);Object(c.a)(oe,"propTypes",re),Object(c.a)(oe,"defaultProps",ie);var ae={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},se=Object.keys(ae);var ue=Object.assign({},Qt.propTypes,{className:h.a.string,longitude:h.a.number.isRequired,latitude:h.a.number.isRequired,altitude:h.a.number,offsetLeft:h.a.number,offsetTop:h.a.number,tipSize:h.a.number,closeButton:h.a.bool,closeOnClick:h.a.bool,anchor:h.a.oneOf(Object.keys(ae)),dynamicPosition:h.a.bool,sortByDepth:h.a.bool,onClose:h.a.func}),ce=Object.assign({},Qt.defaultProps,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}}),le=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(o.a)(e).call(this,t)),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onClick",function(t){n.props.captureClick&&t.stopPropagation(),(n.props.closeOnClick||n._closeOnClick)&&n.props.onClose()}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onClose",function(){n._closeOnClick=!0}),n._closeOnClick=!1,n._contentRef=Object(l.createRef)(),n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"componentDidMount",value:function(){Object($t.a)(Object(o.a)(e.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"_getPosition",value:function(t,e){var n=this._context.viewport,r=this.props,i=r.anchor,o=r.dynamicPosition,a=r.tipSize,s=this._contentRef.current;return s&&o?function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.selfWidth,a=t.selfHeight,s=t.anchor,u=t.padding,c=void 0===u?0:u,l=ae[s],f=l.x,h=l.y,p=n-h*a,d=p+a;if(p<c)for(;p<c&&h>=.5;)h-=.5,p+=.5*a;else if(d>i-c)for(;d>i-c&&h<=.5;)h+=.5,d-=.5*a;var v=e-f*o,g=v+o,m=.5;if(.5===h&&(f=Math.floor(f),m=1),v<c)for(;v<c&&f>=m;)f-=m,v+=m*o;else if(g>r-c)for(;g>r-c&&f<=1-m;)f+=m,g-=m*o;return se.find(function(t){var e=ae[t];return e.x===f&&e.y===h})||s}({x:t,y:e,anchor:i,padding:a,width:n.width,height:n.height,selfWidth:s.clientWidth,selfHeight:s.clientHeight}):i}},{key:"_getContainerStyle",value:function(t,e,n,r){var i=this._context.viewport,o=this.props,a=o.offsetLeft,s=o.offsetTop,u=o.sortByDepth,c=ae[r],l={position:"absolute",left:t+a,top:e+s,transform:"translate(".concat(100*-c.x,"%, ").concat(100*-c.y,"%)")};return u?(n>1||n<-1||t<0||t>i.width||e<0||e>i.height?l.display="none":l.zIndex=Math.floor((1-n)/2*1e5),l):l}},{key:"_renderTip",value:function(t){var e=this.props.tipSize;return Object(l.createElement)("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:e}})}},{key:"_renderContent",value:function(){var t=this.props,e=t.closeButton,n=t.children;return Object(l.createElement)("div",{key:"content",ref:this._contentRef,className:"mapboxgl-popup-content"},[e&&Object(l.createElement)("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:this._onClose},""),n])}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.longitude,r=t.latitude,i=t.altitude,o=this._context.viewport.project([n,r,i]),a=Object(_.a)(o,3),s=a[0],u=a[1],c=a[2],f=this._getPosition(s,u),h=this._getContainerStyle(s,u,c,f);return Object(l.createElement)("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(f," ").concat(e),style:h,ref:this._containerRef},[this._renderTip(f),this._renderContent()])}}]),e}(Qt);Object(c.a)(le,"propTypes",ue),Object(c.a)(le,"defaultProps",ce);var fe=Object.assign({},H.defaultProps,{transitionDuration:300}),he=Object.assign({},Qt.propTypes,{className:h.a.string,onViewStateChange:h.a.func,onViewportChange:h.a.func,showCompass:h.a.bool,showZoom:h.a.bool}),pe=Object.assign({},Qt.defaultProps,{className:"",onViewStateChange:function(){},onViewportChange:function(){},showCompass:!0,showZoom:!0}),de=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(o.a)(e).call(this,t)),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onZoomIn",function(){n._updateViewport({zoom:n._context.viewport.zoom+1})}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onZoomOut",function(){n._updateViewport({zoom:n._context.viewport.zoom-1})}),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_onResetNorth",function(){n._updateViewport({bearing:0,pitch:0})}),Zt(t),n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"_updateViewport",value:function(t){var e=this._context.viewport,n=new z(Object.assign({},e,t)),r=Object.assign({},n.getViewportProps(),fe);this.props.onViewStateChange({viewState:r}),this.props.onViewportChange(r)}},{key:"_renderCompass",value:function(){var t=this._context.viewport.bearing;return Object(l.createElement)("span",{className:"mapboxgl-ctrl-compass-arrow",style:{transform:"rotate(".concat(t,"deg)")}})}},{key:"_renderButton",value:function(t,e,n,r){return Object(l.createElement)("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n,children:r})}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.showCompass,r=t.showZoom;return Object(l.createElement)("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef},[r&&this._renderButton("zoom-in","Zoom In",this._onZoomIn),r&&this._renderButton("zoom-out","Zoom Out",this._onZoomOut),n&&this._renderButton("compass","Reset North",this._onResetNorth,this._renderCompass())])}}]),e}(Qt);Object(c.a)(de,"propTypes",he),Object(c.a)(de,"defaultProps",pe);var ve=n(79),ge=Object.assign({},Qt.propTypes,{redraw:h.a.func.isRequired}),me=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(o.a)(e).call(this,t)),Object(c.a)(Object(u.a)(Object(u.a)(n)),"_redraw",function(){var t=n._ctx;if(t){var e=ve.b.devicePixelRatio||1;t.save(),t.scale(e,e);var r=n._context,i=r.viewport,o=r.isDragging;n.props.redraw({width:i.width,height:i.height,ctx:t,isDragging:o,project:i.project.bind(i),unproject:i.unproject.bind(i)}),t.restore()}}),n}return Object(s.a)(e,t),Object(a.a)(e,[{key:"componentDidMount",value:function(){this._canvas=this._containerRef.current,this._ctx=this._canvas.getContext("2d"),this._redraw()}},{key:"_render",value:function(){var t=ve.b.devicePixelRatio||1,e=this._context.viewport,n=e.width,r=e.height;return this._redraw(),Object(l.createElement)("canvas",{ref:this._containerRef,width:n*t,height:r*t,style:{width:"".concat(n,"px"),height:"".concat(r,"px"),position:"absolute",left:0,top:0}})}}]),e}(Qt);me.displayName="CanvasOverlay",me.propTypes=ge,me.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1};var ye=Object.assign({},Qt.propTypes,{redraw:h.a.func.isRequired,style:h.a.object}),_e=function(t){function e(){return Object(r.a)(this,e),Object(i.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(a.a)(e,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0,width:e.width,height:e.height},this.props.style);return Object(l.createElement)("div",{ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),e}(Qt);_e.displayName="HTMLOverlay",_e.propTypes=ye,_e.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1};var be=Object.assign({},Qt.propTypes,{redraw:h.a.func.isRequired,style:h.a.object}),xe=function(t){function e(){return Object(r.a)(this,e),Object(i.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(a.a)(e,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0},this.props.style);return Object(l.createElement)("svg",{width:e.width,height:e.height,ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),e}(Qt);xe.displayName="SVGOverlay",xe.propTypes=be,xe.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1},n.d(e,"default",function(){return Kt}),n.d(e,"InteractiveMap",function(){return Kt}),n.d(e,"StaticMap",function(){return q}),n.d(e,"BaseControl",function(){return Qt}),n.d(e,"Marker",function(){return oe}),n.d(e,"Popup",function(){return le}),n.d(e,"NavigationControl",function(){return de}),n.d(e,"CanvasOverlay",function(){return me}),n.d(e,"HTMLOverlay",function(){return _e}),n.d(e,"SVGOverlay",function(){return xe}),n.d(e,"TRANSITION_EVENTS",function(){return Z}),n.d(e,"TransitionInterpolator",function(){return E}),n.d(e,"LinearInterpolator",function(){return L}),n.d(e,"FlyToInterpolator",function(){return M}),n.d(e,"MapController",function(){return qt}),n.d(e,"_MapContext",function(){return N})},function(t,e,n){"use strict";var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(3),c=n(18),l=n(104),f=n(45),h=n(178),p=n(49),d=n.n(p),v=n(55),g=n.n(v),m=n(33),y=n.n(m),_=n(92),b=n.n(_),x=Object(f.a)(),w=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,i=e.height,o=e.viewMatrix,a=void 0===o?x:o,s=e.projectionMatrix,u=void 0===s?x:s;Object(r.a)(this,t),this.width=n||1,this.height=i||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=u;var c=Object(f.a)();y()(c,c,this.projectionMatrix),y()(c,c,this.viewMatrix),this.viewProjectionMatrix=c;var l=Object(f.a)();d()(l,l,[this.width/2,-this.height/2,1]),g()(l,l,[1,-1,0]),y()(l,l,this.viewProjectionMatrix);var h=b()(Object(f.a)(),l);if(!h)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=h,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(i.a)(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&Object(l.e)(e.projectionMatrix,this.projectionMatrix)&&Object(l.e)(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).topLeft,n=void 0===e||e,r=this.projectPosition(t),i=Object(h.k)(r,this.pixelProjectionMatrix),o=Object(c.a)(i,2),a=o[0],s=o[1],u=n?s:this.height-s;return 2===t.length?[a,u]:[a,u,i[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Object(c.a)(t,3),a=o[0],s=o[1],u=o[2],l=r?s:this.height-s,f=i&&i*this.pixelsPerMeter,p=Object(h.h)([a,l,u],this.pixelUnprojectionMatrix,f),d=this.unprojectPosition(p),v=Object(c.a)(d,3),g=v[0],m=v[1],y=v[2];return Number.isFinite(u)?[g,m,y]:Number.isFinite(i)?[g,m,i]:[g,m]}},{key:"projectPosition",value:function(t){var e=this.projectFlat(t),n=Object(c.a)(e,2);return[n[0],n[1],(t[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(t){var e=this.unprojectFlat(t),n=Object(c.a)(e,2);return[n[0],n[1],(t[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}}]),t}(),E=n(508),S=n(115),P=n.n(S),T=n(148),A=n.n(T);n.d(e,"a",function(){return k});var k=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.width,s=n.height,c=n.latitude,l=void 0===c?0:c,f=n.longitude,p=void 0===f?0:f,d=n.zoom,v=void 0===d?0:d,g=n.pitch,m=void 0===g?0:g,y=n.bearing,_=void 0===y?0:y,b=n.altitude,x=void 0===b?1.5:b,w=n.nearZMultiplier,E=n.farZMultiplier;Object(r.a)(this,e),i=i||1,s=s||1;var S=Object(h.l)(v);x=Math.max(.75,x);var P=Object(h.g)([p,l],S);P[2]=0;var T=Object(h.d)({width:i,height:s,pitch:m,bearing:_,altitude:x,nearZMultiplier:w||1/s,farZMultiplier:E||1.01}),A=Object(h.f)({height:s,center:P,pitch:m,bearing:_,altitude:x,flipY:!0});return(t=Object(o.a)(this,Object(a.a)(e).call(this,{width:i,height:s,viewMatrix:A,projectionMatrix:T}))).latitude=l,t.longitude=p,t.zoom=v,t.pitch=m,t.bearing=_,t.altitude=x,t.scale=S,t.center=P,t.pixelsPerMeter=Object(h.b)(Object(u.a)(Object(u.a)(t))).pixelsPerMeter[2],Object.freeze(Object(u.a)(Object(u.a)(t))),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Object(h.g)(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Object(h.j)(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=t.pos,r=Object(h.h)(n,this.pixelUnprojectionMatrix),i=Object(h.g)(e,this.scale),o=P()([],i,A()([],r)),a=P()([],this.center,o);return Object(h.j)(a,this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=Object(E.a)(Object.assign({width:r,height:i,bounds:t},n));return new e({width:r,height:i,longitude:o.longitude,latitude:o.latitude,zoom:o.zoom})}}]),e}(w)},function(t,e,n){"use strict";n.r(e);var r=n(11),i=n(62),o={name:"project32",dependencies:[i.a],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset, out vec4 worldPosition\n) {\n  vec3 projectedPosition = project_position(position, position64xyLow);\n  worldPosition = vec4(projectedPosition + offset, 1.0);\n  return project_to_clipspace(worldPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset\n) {\n  vec4 worldPosition;\n  return project_position_to_clipspace(position, position64xyLow, offset, worldPosition);\n}\n"},a=n(124),s=n(123);function u(){Object(r.z)([r.s,r.t,i.a,o,a.a,s.a,r.y]),Object(r.A)([i.a])}n.d(e,"initializeShaderModules",function(){return u}),n.d(e,"fp32",function(){return r.s}),n.d(e,"fp64",function(){return r.t}),n.d(e,"picking",function(){return r.y}),n.d(e,"project",function(){return i.a}),n.d(e,"project64",function(){return a.a}),n.d(e,"lighting",function(){return s.a}),u()},function(t,e,n){"use strict";var r={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,a=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,u=Object.getOwnPropertyDescriptor,c=Object.getPrototypeOf,l=c&&c(Object);t.exports=function t(e,n,f){if("string"!=typeof n){if(l){var h=c(n);h&&h!==l&&t(e,h,f)}var p=a(n);s&&(p=p.concat(s(n)));for(var d=0;d<p.length;++d){var v=p[d];if(!(r[v]||i[v]||f&&f[v])){var g=u(n,v);try{o(e,v,g)}catch(t){}}}return e}return e}},function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(41))},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";(function(t){var r=n(29);e.a="undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type||!(void 0===t||"object"!==Object(r.a)(t.versions)||!Boolean(t.versions.electron))||"object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}).call(this,n(68))},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r,i=n(0),o=function(t){return s(t)?void 0:0},a=(r={},Object(i.a)(r,3074,function(t){return s(t)?void 0:36064}),Object(i.a)(r,35723,function(t){return s(t)?void 0:4352}),Object(i.a)(r,35977,o),Object(i.a)(r,32937,o),Object(i.a)(r,36795,function(t,e){var n=s(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0}),Object(i.a)(r,37445,function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)}),Object(i.a)(r,37446,function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)}),Object(i.a)(r,34047,function(t,e){var n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1}),Object(i.a)(r,32883,o),Object(i.a)(r,35071,o),Object(i.a)(r,37447,o),Object(i.a)(r,36063,function(t,e){if(!s(t)){var n=t.getExtension("WEBGL_draw_buffers");return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}}),Object(i.a)(r,35379,o),Object(i.a)(r,35374,o),Object(i.a)(r,35377,o),Object(i.a)(r,34852,function(t){if(!s(t)){var e=t.getExtension("WEBGL_draw_buffers");return e?e.MAX_DRAW_BUFFERS_WEBGL:0}}),Object(i.a)(r,36203,function(t){return t.getExtension("OES_element_index")?2147483647:65535}),Object(i.a)(r,33001,function(t){return t.getExtension("OES_element_index")?16777216:65535}),Object(i.a)(r,33e3,function(t){return 16777216}),Object(i.a)(r,37157,o),Object(i.a)(r,35373,o),Object(i.a)(r,35657,o),Object(i.a)(r,36183,o),Object(i.a)(r,37137,o),Object(i.a)(r,34045,o),Object(i.a)(r,35978,o),Object(i.a)(r,35979,o),Object(i.a)(r,35968,o),Object(i.a)(r,35376,o),Object(i.a)(r,35375,o),Object(i.a)(r,35659,o),Object(i.a)(r,37154,o),Object(i.a)(r,35371,o),Object(i.a)(r,35658,o),Object(i.a)(r,35076,o),Object(i.a)(r,35077,o),Object(i.a)(r,35380,o),r);function s(t){return t&&!0}function u(t,e,n){var r=a[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)}},function(t,e,n){t.exports=function(t,e){var n=r(t[0],t[1],t[2]),a=r(e[0],e[1],e[2]);i(n,n),i(a,a);var s=o(n,a);return s>1?0:Math.acos(s)};var r=n(496),i=n(497),o=n(498)},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}},function(t,e){t.exports=function(t,e,n,r){var i=n[1],o=n[2],a=e[1]-i,s=e[2]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=e[0],t[1]=i+a*c-s*u,t[2]=o+a*u+s*c,t}},function(t,e){t.exports=function(t,e,n,r){var i=n[0],o=n[2],a=e[0]-i,s=e[2]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=i+s*u+a*c,t[1]=e[1],t[2]=o+s*c-a*u,t}},function(t,e){t.exports=function(t,e,n,r){var i=n[0],o=n[1],a=e[0]-i,s=e[1]-o,u=Math.sin(r),c=Math.cos(r);return t[0]=i+a*c-s*u,t[1]=o+a*u+s*c,t[2]=e[2],t}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],p=t[12],d=t[13],v=t[14],g=t[15];return(e*a-n*o)*(f*g-h*v)-(e*s-r*o)*(l*g-h*d)+(e*u-i*o)*(l*v-f*d)+(n*s-r*a)*(c*g-h*p)-(n*u-i*a)*(c*v-f*p)+(r*u-i*s)*(c*d-l*p)}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,p=i*s,d=i*u,v=o*a,g=o*s,m=o*u;return t[0]=1-f-d,t[1]=l+m,t[2]=h-g,t[3]=0,t[4]=l-m,t[5]=1-c-d,t[6]=p+v,t[7]=0,t[8]=h+g,t[9]=p-v,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}},function(t,e){t.exports=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}},function(t,e){t.exports=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}},function(t,e){t.exports=function(t,e,n,r){var i,o,a,s,u,c,l,f,h,p,d,v,g,m,y,_,b,x,w,E,S,P,T,A,k=r[0],C=r[1],O=r[2],M=Math.sqrt(k*k+C*C+O*O);if(Math.abs(M)<1e-6)return null;k*=M=1/M,C*=M,O*=M,i=Math.sin(n),o=Math.cos(n),a=1-o,s=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],p=e[6],d=e[7],v=e[8],g=e[9],m=e[10],y=e[11],_=k*k*a+o,b=C*k*a+O*i,x=O*k*a-C*i,w=k*C*a-O*i,E=C*C*a+o,S=O*C*a+k*i,P=k*O*a+C*i,T=C*O*a-k*i,A=O*O*a+o,t[0]=s*_+f*b+v*x,t[1]=u*_+h*b+g*x,t[2]=c*_+p*b+m*x,t[3]=l*_+d*b+y*x,t[4]=s*w+f*E+v*S,t[5]=u*w+h*E+g*S,t[6]=c*w+p*E+m*S,t[7]=l*w+d*E+y*S,t[8]=s*P+f*T+v*A,t[9]=u*P+h*T+g*A,t[10]=c*P+p*T+m*A,t[11]=l*P+d*T+y*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t}},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}},function(t,e){t.exports=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}},function(t,e){t.exports=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}},function(t,e,n){"use strict";(function(t){var r=n(266),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=!("object"===(void 0===t?"undefined":i(t))&&"[object process]"===String(t)&&!t.browser)||r.a;e.a=o}).call(this,n(68))},function(t,e,n){"use strict";(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.a="undefined"!=typeof window&&"object"===n(window.process)&&"renderer"===window.process.type||!(void 0===t||"object"!==n(t.versions)||!Boolean(t.versions.electron))||"object"===("undefined"==typeof navigator?"undefined":n(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}).call(this,n(68))},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,u,c,l,p,v,g=e&&e.length,m=g?e[0]*n:t.length,y=i(t,0,m,n,!0),_=[];if(!y)return _;if(g&&(y=function(t,e,n,r){var a,s,u,c,l,p=[];for(a=0,s=e.length;a<s;a++)u=e[a]*r,c=a<s-1?e[a+1]*r:t.length,(l=i(t,u,c,r,!1))===l.next&&(l.steiner=!0),p.push(d(l));for(p.sort(f),a=0;a<p.length;a++)h(p[a],n),n=o(n,n.next);return n}(t,e,y,n)),t.length>80*n){r=u=t[0],s=c=t[1];for(var b=n;b<m;b+=n)l=t[b],p=t[b+1],l<r&&(r=l),p<s&&(s=p),l>u&&(u=l),p>c&&(c=p);v=0!==(v=Math.max(u-r,c-s))?1/v:0}return a(y,_,n,r,s,v),_}function i(t,e,n,r,i){var o,a;if(i===P(t,e,n,r)>0)for(o=e;o<n;o+=r)a=w(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=w(o,t[o],t[o+1],a);return a&&y(a,a.next)&&(E(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!y(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(E(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,h){if(t){!h&&f&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,f);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,f?u(t,r,i,f):s(t))e.push(d.i/n),e.push(t.i/n),e.push(v.i/n),E(t),t=v.next,g=v.next;else if((t=v)===g){h?1===h?a(t=c(t,e,n),e,n,r,i,f,2):2===h&&l(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(v(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(m(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=p(s,u,e,n,r),h=p(c,l,e,n,r),d=t.prevZ,g=t.nextZ;d&&d.z>=f&&g&&g.z<=h;){if(d!==t.prev&&d!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;d&&d.z>=f;){if(d!==t.prev&&d!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;g&&g.z<=h;){if(g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!y(i,o)&&_(i,r,r.next,o)&&b(i,o)&&b(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),E(r),E(r.next),r=t=o),r=r.next}while(r!==t);return r}function l(t,e,n,r,i,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&g(u,c)){var l=x(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,e,n,r,i,s),void a(l,e,n,r,i,s)}c=c.next}u=u.next}while(u!==t)}function f(t,e){return t.x-e.x}function h(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,f=n.y,h=1/0;r=n.next;for(;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&v(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<h||u===h&&r.x>n.x)&&b(r,t)&&(n=r,h=u),r=r.next;return n}(t,e)){var n=x(e,t);o(n,n.next)}}function p(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&b(t,e)&&b(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function _(t,e,n,r){return!!(y(t,e)&&y(n,r)||y(t,r)&&y(n,e))||m(t,e,n)>0!=m(t,e,r)>0&&m(n,r,t)>0!=m(n,r,e)>0}function b(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(P(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(P(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,p=r[s+1]*n,d=r[s+2]*n;f+=Math.abs((t[h]-t[d])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[d+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){"use strict";(function(t){var r=n(15);function i(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof self?self:t;var r="undefined"!=typeof document&&document.attachEvent;if(!r){var i=function(){var t=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(t){return n.setTimeout(t,20)};return function(e){return t(e)}}(),o=function(){var t=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.clearTimeout;return function(e){return t(e)}}(),a=function(t){var e=t.__resizeTriggers__,n=e.firstElementChild,r=e.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},s=function(t){if(!(t.target.className.indexOf("contract-trigger")<0&&t.target.className.indexOf("expand-trigger")<0)){var e=this;a(this),this.__resizeRAF__&&o(this.__resizeRAF__),this.__resizeRAF__=i(function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach(function(n){n.call(e,t)}))})}},u=!1,c="",l="animationstart",f="Webkit Moz O ms".split(" "),h="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),p=document.createElement("fakeelement");if(void 0!==p.style.animationName&&(u=!0),!1===u)for(var d=0;d<f.length;d++)if(void 0!==p.style[f[d]+"AnimationName"]){c="-"+f[d].toLowerCase()+"-",l=h[d],u=!0;break}var v="resizeanim",g="@"+c+"keyframes "+v+" { from { opacity: 0; } to { opacity: 0; } } ",m=c+"animation: 1ms "+v+"; "}return{addResizeListener:function(t,i){if(r)t.attachEvent("onresize",i);else{if(!t.__resizeTriggers__){var o=t.ownerDocument,u=n.getComputedStyle(t);u&&"static"==u.position&&(t.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var n=(g||"")+".resize-triggers { "+(m||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=t.head||t.getElementsByTagName("head")[0],i=t.createElement("style");i.id="detectElementResize",i.type="text/css",null!=e&&i.setAttribute("nonce",e),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(t.createTextNode(n)),r.appendChild(i)}}(o),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=o.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),a(t),t.addEventListener("scroll",s,!0),l&&(t.__resizeTriggers__.__animationListener__=function(e){e.animationName==v&&a(t)},t.__resizeTriggers__.addEventListener(l,t.__resizeTriggers__.__animationListener__))}t.__resizeListeners__.push(i)}},removeResizeListener:function(t,e){if(r)t.detachEvent("onresize",e);else if(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),!t.__resizeListeners__.length){t.removeEventListener("scroll",s,!0),t.__resizeTriggers__.__animationListener__&&(t.__resizeTriggers__.removeEventListener(l,t.__resizeTriggers__.__animationListener__),t.__resizeTriggers__.__animationListener__=null);try{t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)}catch(t){}}}}}var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},c=function(t){function e(){var t,n,r;o(this,e);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return n=r=u(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var t=r.props,e=t.disableHeight,n=t.disableWidth,i=t.onResize;if(r._parentNode){var o=r._parentNode.offsetHeight||0,a=r._parentNode.offsetWidth||0,s=window.getComputedStyle(r._parentNode)||{},u=parseInt(s.paddingLeft,10)||0,c=parseInt(s.paddingRight,10)||0,l=parseInt(s.paddingTop,10)||0,f=parseInt(s.paddingBottom,10)||0,h=o-l-f,p=a-u-c;(!e&&r.state.height!==h||!n&&r.state.width!==p)&&(r.setState({height:o-l-f,width:a-u-c}),i({height:o,width:a}))}},r._setRef=function(t){r._autoSizer=t},u(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r["PureComponent"]),a(e,[{key:"componentDidMount",value:function(){var t=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=i(t),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var t=this.props,e=t.children,n=t.className,i=t.disableHeight,o=t.disableWidth,a=t.style,u=this.state,c=u.height,l=u.width,f={overflow:"visible"},h={},p=!1;return i||(0===c&&(p=!0),f.height=0,h.height=c),o||(0===l&&(p=!0),f.width=0,h.width=l),Object(r.createElement)("div",{className:n,ref:this._setRef,style:s({},f,a)},!p&&e(h))}}]),e}();c.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}},e.a=c}).call(this,n(41))},function(t,e,n){"use strict";var r=n(29),i=n(22),o=n(1),a=n(2),s=n(77);var u=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(o.a)(this,t),this.storage=function(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(a.a)(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}(),c=n(48),l=n(78),f={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function h(t){return"string"==typeof t?f[t.toUpperCase()]||f.WHITE:t}function p(t,e){if(!t)throw new Error("Assertion failed. ".concat(e))}n.d(e,"a",function(){return y});var d={debug:s.b&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},v={enabled:!1,priority:0};function g(){}var m={};var y=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id;Object(o.a)(this,t),this.id=e,this.VERSION=s.a,this._startTs=Object(c.a)(),this._deltaTs=Object(c.a)(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new u("__probe-".concat(this.id,"__"),v),this.userData={},this.timeStamp("".concat(this.id," started")),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=!0,o=!1,a=void 0;try{for(var s,u=function(){var n=s.value;"function"==typeof t[n]&&(e.find(function(t){return n===t})||(t[n]=t[n].bind(t)))},c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(t){o=!0,a=t}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}(this),Object.seal(this)}return Object(a.a)(t,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getPriority",value:function(){return this._storage.config.priority}},{key:"getLevel",value:function(){return this._storage.config.priority}},{key:"getTotal",value:function(){return Number((Object(c.a)()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Object(c.a)()-this._deltaTs).toPrecision(10))}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({priority:t}),this}},{key:"warn",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._getLogFunction({message:t,args:n,method:d.warn,once:!0})}},{key:"error",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._getLogFunction({message:t,args:n,method:d.error})}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:d.log,time:!0,once:!0})}},{key:"log",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:d.debug})}},{key:"info",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:console.info})}},{key:"once",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:d.debug||d.info,once:!0})}},{key:"table",value:function(t,e,n){if(e){var r=function(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}(e);return this._getLogFunction({priority:t,message:e,args:n&&[n],tag:r,method:console.table||g})}return g}},{key:"image",value:function(t){var e=t.priority,n=t.image,r=t.message,i=void 0===r?"":r,o=t.scale,a=void 0===o?1:o;return e>this.getPriority()?g:s.b?this._logImageInBrowser({image:n,message:i,scale:a}):this._logImageInNode({image:n,message:i,scale:a})}},{key:"_logImageInNode",value:function(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(490)}catch(t){}return o?function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(function(t){return console.log(t)})}:g}},{key:"_logImageInBrowser",value:function(t){var e=t.image,n=t.message,r=void 0===n?"":n,o=t.scale,a=void 0===o?1:o;if("string"==typeof e){var s=new Image;return s.onload=function(){var t,e=Object(l.a)(s,r,a);(t=console).log.apply(t,Object(i.a)(e))},s.src=e,g}var u,c=e.nodeName||"";if("img"===c.toLowerCase())return(u=console).log.apply(u,Object(i.a)(Object(l.a)(e,r,a))),g;if("canvas"===c.toLowerCase()){var f=new Image;return f.onload=function(){var t;return(t=console).log.apply(t,Object(i.a)(Object(l.a)(f,r,a)))},f.src=e.toDataURL(),g}return g}},{key:"time",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.time?console.time:console.info})}},{key:"timeEnd",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeEnd?console.timeEnd:console.info})}},{key:"timeStamp",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeStamp||g})}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=(n=this._normalizeArguments({priority:t,message:e,opts:n})).collapsed;return this._getLogFunction({priority:t,message:e,opts:n,method:(r?console.groupCollapsed:console.group)||console.info})}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction({priority:t,message:"",method:console.groupEnd||g})}},{key:"withGroup",value:function(t,e,n){var r=this._normalizeArguments({priority:t,message:e});this.group(r);try{n()}finally{this.groupEnd(r.message)}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return 0===(t=this._normalizePriority(t))||this.isEnabled()&&this.getPriority()>=t}},{key:"_getElapsedTime",value:function(){var t=this.getTotal(),e=this.getDelta();return this._deltaTs=Object(c.a)(),{total:t,delta:e}}},{key:"_getLogFunction",value:function(t){if(this._shouldLog(t.priority)){var e=t.method;t=this._parseArguments(t),p(e);var n=t.message,r=t.tag||t.message;if(t.once){if(m[r])return g;m[r]=Object(c.a)()}return n=this._decorateMessage(n,t),e.bind.apply(e,[console,n].concat(Object(i.a)(t.args)))}return g}},{key:"_parseArguments",value:function(t){var e=this._normalizeArguments(t),n=this._getElapsedTime(),r=n.delta,i=n.total;return Object.assign(t,e,{delta:r,total:i})}},{key:"_normalizePriority",value:function(t){var e;switch(Object(r.a)(t)){case"number":e=t;break;case"object":e=t.priority||0;break;default:e=0}return p(Number.isFinite(e)&&e>=0),e}},{key:"_normalizeArguments",value:function(t){var e=t.priority,n=t.message,i=t.args,o=void 0===i?[]:i,a=t.opts,s={priority:this._normalizePriority(e),message:n,args:o};switch(Object(r.a)(e)){case"string":case"function":void 0!==n&&o.unshift(n),Object.assign(s,{message:e});break;case"object":Object.assign(s,e)}return"function"==typeof s.message&&(s.message=this._shouldLog(s.priority)?s.message():""),p("string"==typeof s.message||"object"===Object(r.a)(s.message)),Object.assign(s,a)}},{key:"_decorateMessage",value:function(t,e){if("string"==typeof t){var n="";if(e.time){var r=this._getElapsedTime().total;n=Object(l.c)(Object(l.b)(r))}t=function(t,e,n){return s.b||"string"!=typeof t||(e&&(e=h(e),t="[".concat(e,"m").concat(t,"[39m")),n&&(e=h(n),t="[".concat(n+10,"m").concat(t,"[49m"))),t}(t=e.time?"".concat(this.id,": ").concat(n,"  ").concat(t):"".concat(this.id,": ").concat(t),e.color,e.background)}return t}},{key:"priority",set:function(t){return this._storage.updateConfiguration({priority:t}),this},get:function(){return this._storage.config.priority}}]),t}();y.VERSION=s.a},,function(t,e,n){n(272),t.exports=n(474)},function(t,e,n){"use strict";(function(t){if(n(273),n(470),n(471),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";function r(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&r(Array,t,Function.call.bind([][t]))})}).call(this,n(41))},function(t,e,n){n(274),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(354),n(355),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(173),n(378),n(379),n(203),n(380),n(381),n(382),n(383),n(384),n(206),n(208),n(209),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),t.exports=n(64)},function(t,e,n){"use strict";var r=n(20),i=n(57),o=n(34),a=n(7),s=n(52),u=n(83).KEY,c=n(23),l=n(127),f=n(106),h=n(95),p=n(26),d=n(186),v=n(153),g=n(275),m=n(130),y=n(19),_=n(24),b=n(58),x=n(71),w=n(94),E=n(98),S=n(189),P=n(59),T=n(35),A=n(96),k=P.f,C=T.f,O=S.f,M=r.Symbol,I=r.JSON,L=I&&I.stringify,R=p("_hidden"),j=p("toPrimitive"),z={}.propertyIsEnumerable,D=l("symbol-registry"),F=l("symbols"),N=l("op-symbols"),B=Object.prototype,U="function"==typeof M,V=r.QObject,G=!V||!V.prototype||!V.prototype.findChild,q=o&&c(function(){return 7!=E(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=k(B,e);r&&delete B[e],C(t,e,n),r&&t!==B&&C(B,e,r)}:C,W=function(t){var e=F[t]=E(M.prototype);return e._k=t,e},Z=U&&"symbol"==typeof M.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof M},X=function(t,e,n){return t===B&&X(N,e,n),y(t),e=x(e,!0),y(n),i(F,e)?(n.enumerable?(i(t,R)&&t[R][e]&&(t[R][e]=!1),n=E(n,{enumerable:w(0,!1)})):(i(t,R)||C(t,R,w(1,{})),t[R][e]=!0),q(t,e,n)):C(t,e,n)},H=function(t,e){y(t);for(var n,r=g(e=b(e)),i=0,o=r.length;o>i;)X(t,n=r[i++],e[n]);return t},Y=function(t){var e=z.call(this,t=x(t,!0));return!(this===B&&i(F,t)&&!i(N,t))&&(!(e||!i(this,t)||!i(F,t)||i(this,R)&&this[R][t])||e)},K=function(t,e){if(t=b(t),e=x(e,!0),t!==B||!i(F,e)||i(N,e)){var n=k(t,e);return!n||!i(F,e)||i(t,R)&&t[R][e]||(n.enumerable=!0),n}},J=function(t){for(var e,n=O(b(t)),r=[],o=0;n.length>o;)i(F,e=n[o++])||e==R||e==u||r.push(e);return r},Q=function(t){for(var e,n=t===B,r=O(n?N:b(t)),o=[],a=0;r.length>a;)!i(F,e=r[a++])||n&&!i(B,e)||o.push(F[e]);return o};U||(s((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(N,n),i(this,R)&&i(this[R],t)&&(this[R][t]=!1),q(this,t,w(1,n))};return o&&G&&q(B,t,{configurable:!0,set:e}),W(t)}).prototype,"toString",function(){return this._k}),P.f=K,T.f=X,n(99).f=S.f=J,n(120).f=Y,n(129).f=Q,o&&!n(84)&&s(B,"propertyIsEnumerable",Y,!0),d.f=function(t){return W(p(t))}),a(a.G+a.W+a.F*!U,{Symbol:M});for(var $="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;$.length>tt;)p($[tt++]);for(var et=A(p.store),nt=0;et.length>nt;)v(et[nt++]);a(a.S+a.F*!U,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=M(t)},keyFor:function(t){if(!Z(t))throw TypeError(t+" is not a symbol!");for(var e in D)if(D[e]===t)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!U,"Object",{create:function(t,e){return void 0===e?E(t):H(E(t),e)},defineProperty:X,defineProperties:H,getOwnPropertyDescriptor:K,getOwnPropertyNames:J,getOwnPropertySymbols:Q}),I&&a(a.S+a.F*(!U||c(function(){var t=M();return"[null]"!=L([t])||"{}"!=L({a:t})||"{}"!=L(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(_(e)||void 0!==t)&&!Z(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Z(e))return e}),r[1]=e,L.apply(I,r)}}),M.prototype[j]||n(51)(M.prototype,j,M.prototype.valueOf),f(M,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(t,e,n){var r=n(96),i=n(129),o=n(120);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var r=n(7);r(r.S,"Object",{create:n(98)})},function(t,e,n){var r=n(7);r(r.S+r.F*!n(34),"Object",{defineProperty:n(35).f})},function(t,e,n){var r=n(7);r(r.S+r.F*!n(34),"Object",{defineProperties:n(188)})},function(t,e,n){var r=n(58),i=n(59).f;n(74)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){var r=n(42),i=n(60);n(74)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(42),i=n(96);n(74)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){n(74)("getOwnPropertyNames",function(){return n(189).f})},function(t,e,n){var r=n(24),i=n(83).onFreeze;n(74)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(24),i=n(83).onFreeze;n(74)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(24),i=n(83).onFreeze;n(74)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(24);n(74)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(24);n(74)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(24);n(74)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){var r=n(7);r(r.S+r.F,"Object",{assign:n(190)})},function(t,e,n){var r=n(7);r(r.S,"Object",{is:n(291)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var r=n(7);r(r.S,"Object",{setPrototypeOf:n(157).set})},function(t,e,n){"use strict";var r=n(121),i={};i[n(26)("toStringTag")]="z",i+""!="[object z]"&&n(52)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){var r=n(7);r(r.P,"Function",{bind:n(191)})},function(t,e,n){var r=n(35).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(34)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(24),i=n(60),o=n(26)("hasInstance"),a=Function.prototype;o in a||n(35).f(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(7),i=n(193);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(7),i=n(194);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(20),i=n(57),o=n(66),a=n(159),s=n(71),u=n(23),c=n(99).f,l=n(59).f,f=n(35).f,h=n(107).trim,p=r.Number,d=p,v=p.prototype,g="Number"==o(n(98)(v)),m="trim"in String.prototype,y=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=m?e.trim():h(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,l=u.length;c<l;c++)if((a=u.charCodeAt(c))<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(g?u(function(){v.valueOf.call(n)}):"Number"!=o(n))?a(new d(y(e)),n,p):y(e)};for(var _,b=n(34)?c(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;b.length>x;x++)i(d,_=b[x])&&!i(p,_)&&f(p,_,l(d,_));p.prototype=v,v.constructor=p,n(52)(r,"Number",p)}},function(t,e,n){"use strict";var r=n(7),i=n(73),o=n(195),a=n(160),s=1..toFixed,u=Math.floor,c=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",f=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*c[n],c[n]=r%1e7,r=u(r/1e7)},h=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=u(n/t),n=n%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},d=function(t,e,n){return 0===e?n:e%2==1?d(t,e-1,n*t):d(t*t,e/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(23)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,r,s,u=o(this,l),c=i(t),v="",g="0";if(c<0||c>20)throw RangeError(l);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(v="-",u=-u),u>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(u*d(2,69,1))-69)<0?u*d(2,-e,1):u/d(2,e,1),n*=4503599627370496,(e=52-e)>0){for(f(0,n),r=c;r>=7;)f(1e7,0),r-=7;for(f(d(10,r,1),0),r=e-1;r>=23;)h(1<<23),r-=23;h(1<<r),f(1,1),h(2),g=p()}else f(0,n),f(1<<-e,0),g=p()+a.call("0",c);return g=c>0?v+((s=g.length)<=c?"0."+a.call("0",c-s)+g:g.slice(0,s-c)+"."+g.slice(s-c)):v+g}})},function(t,e,n){"use strict";var r=n(7),i=n(23),o=n(195),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var r=n(7);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(7),i=n(20).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(7);r(r.S,"Number",{isInteger:n(196)})},function(t,e,n){var r=n(7);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(7),i=n(196),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){var r=n(7);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(7);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(7),i=n(194);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var r=n(7),i=n(193);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var r=n(7),i=n(197),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,n){var r=n(7),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(7),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(7),i=n(161);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(7);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(7),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var r=n(7),i=n(162);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var r=n(7);r(r.S,"Math",{fround:n(198)})},function(t,e,n){var r=n(7),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,a=0,s=arguments.length,u=0;a<s;)u<(n=i(arguments[a++]))?(o=o*(r=u/n)*r+1,u=n):o+=n>0?(r=n/u)*r:n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(t,e,n){var r=n(7),i=Math.imul;r(r.S+r.F*n(23)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(7);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(7);r(r.S,"Math",{log1p:n(197)})},function(t,e,n){var r=n(7);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(7);r(r.S,"Math",{sign:n(161)})},function(t,e,n){var r=n(7),i=n(162),o=Math.exp;r(r.S+r.F*n(23)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(7),i=n(162),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var r=n(7);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(7),i=n(97),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,a=0;r>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var r=n(7),i=n(58),o=n(36);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(107)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(163)(!0);n(164)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(7),i=n(163)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(7),i=n(36),o=n(166),a="".endsWith;r(r.P+r.F*n(167)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),s=void 0===n?r:Math.min(i(n),r),u=String(t);return a?a.call(e,u,s):e.slice(s-u.length,s)===u}})},function(t,e,n){"use strict";var r=n(7),i=n(166);r(r.P+r.F*n(167)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(7);r(r.P,"String",{repeat:n(160)})},function(t,e,n){"use strict";var r=n(7),i=n(36),o=n(166),a="".startsWith;r(r.P+r.F*n(167)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return a?a.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(53)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(53)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(53)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(53)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(53)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(53)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(53)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(53)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(53)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(53)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(53)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(53)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(53)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var r=n(7);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(7),i=n(42),o=n(71);r(r.P+r.F*n(23)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(7),i=n(353);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(23),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+("00000"+Math.abs(e)).slice(r?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(t,e,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(52)(r,"toString",function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){var r=n(26)("toPrimitive"),i=Date.prototype;r in i||n(51)(i,r,n(356))},function(t,e,n){"use strict";var r=n(19),i=n(71);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){var r=n(7);r(r.S,"Array",{isArray:n(130)})},function(t,e,n){"use strict";var r=n(65),i=n(7),o=n(42),a=n(199),s=n(168),u=n(36),c=n(169),l=n(170);i(i.S+i.F*!n(132)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,h=o(t),p="function"==typeof this?this:Array,d=arguments.length,v=d>1?arguments[1]:void 0,g=void 0!==v,m=0,y=l(h);if(g&&(v=r(v,d>2?arguments[2]:void 0,2)),void 0==y||p==Array&&s(y))for(n=new p(e=u(h.length));e>m;m++)c(n,m,g?v(h[m],m):h[m]);else for(f=y.call(h),n=new p;!(i=f.next()).done;m++)c(n,m,g?a(f,v,[i.value,m],!0):i.value);return n.length=m,n}})},function(t,e,n){"use strict";var r=n(7),i=n(169);r(r.S+r.F*n(23)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(7),i=n(58),o=[].join;r(r.P+r.F*(n(119)!=Object||!n(67)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(7),i=n(156),o=n(66),a=n(97),s=n(36),u=[].slice;r(r.P+r.F*n(23)(function(){i&&u.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return u.call(this,t,e);for(var i=a(t,n),c=a(e,n),l=s(c-i),f=new Array(l),h=0;h<l;h++)f[h]="String"==r?this.charAt(i+h):this[i+h];return f}})},function(t,e,n){"use strict";var r=n(7),i=n(46),o=n(42),a=n(23),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(67)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,n){"use strict";var r=n(7),i=n(75)(0),o=n(67)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var r=n(24),i=n(130),o=n(26)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(7),i=n(75)(1);r(r.P+r.F*!n(67)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(7),i=n(75)(2);r(r.P+r.F*!n(67)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(7),i=n(75)(3);r(r.P+r.F*!n(67)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(7),i=n(75)(4);r(r.P+r.F*!n(67)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(7),i=n(200);r(r.P+r.F*!n(67)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(7),i=n(200);r(r.P+r.F*!n(67)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(7),i=n(128)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(67)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(7),i=n(58),o=n(73),a=n(36),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(67)(s)),"Array",{lastIndexOf:function(t){if(u)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(7);r(r.P,"Array",{copyWithin:n(201)}),n(85)("copyWithin")},function(t,e,n){var r=n(7);r(r.P,"Array",{fill:n(172)}),n(85)("fill")},function(t,e,n){"use strict";var r=n(7),i=n(75)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(85)("find")},function(t,e,n){"use strict";var r=n(7),i=n(75)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(85)(o)},function(t,e,n){n(100)("Array")},function(t,e,n){var r=n(20),i=n(159),o=n(35).f,a=n(99).f,s=n(131),u=n(133),c=r.RegExp,l=c,f=c.prototype,h=/a/g,p=/a/g,d=new c(h)!==h;if(n(34)&&(!d||n(23)(function(){return p[n(26)("match")]=!1,c(h)!=h||c(p)==p||"/a/i"!=c(h,"i")}))){c=function(t,e){var n=this instanceof c,r=s(t),o=void 0===e;return!n&&r&&t.constructor===c&&o?t:i(d?new l(r&&!o?t.source:t,e):l((r=t instanceof c)?t.source:t,r&&o?u.call(t):e),n?this:f,c)};for(var v=function(t){t in c||o(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})},g=a(l),m=0;g.length>m;)v(g[m++]);f.constructor=c,c.prototype=f,n(52)(r,"RegExp",c)}n(100)("RegExp")},function(t,e,n){"use strict";n(203);var r=n(19),i=n(133),o=n(34),a=/./.toString,s=function(t){n(52)(RegExp.prototype,"toString",t,!0)};n(23)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){n(134)("match",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(134)("replace",2,function(t,e,n){return[function(r,i){"use strict";var o=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},function(t,e,n){n(134)("search",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(134)("split",2,function(t,e,r){"use strict";var i=n(131),o=r,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var s=void 0===/()??/.exec("")[1];r=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(n,t,e);var r,u,c,l,f,h=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,v=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,p+"g");for(s||(r=new RegExp("^"+g.source+"$(?!\\s)",p));(u=g.exec(n))&&!((c=u.index+u[0].length)>d&&(h.push(n.slice(d,u.index)),!s&&u.length>1&&u[0].replace(r,function(){for(f=1;f<arguments.length-2;f++)void 0===arguments[f]&&(u[f]=void 0)}),u.length>1&&u.index<n.length&&a.apply(h,u.slice(1)),l=u[0].length,d=c,h.length>=v));)g.lastIndex===u.index&&g.lastIndex++;return d===n.length?!l&&g.test("")||h.push(""):h.push(n.slice(d)),h.length>v?h.slice(0,v):h}}else"0".split(void 0,0).length&&(r=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,i){var o=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},function(t,e,n){"use strict";var r,i,o,a,s=n(84),u=n(20),c=n(65),l=n(121),f=n(7),h=n(24),p=n(46),d=n(101),v=n(102),g=n(135),m=n(174).set,y=n(175)(),_=n(176),b=n(204),x=n(136),w=n(205),E=u.TypeError,S=u.process,P=S&&S.versions,T=P&&P.v8||"",A=u.Promise,k="process"==l(S),C=function(){},O=i=_.f,M=!!function(){try{var t=A.resolve(1),e=(t.constructor={})[n(26)("species")]=function(t){t(C,C)};return(k||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==T.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),I=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(i||(2==t._h&&z(t),t._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===e.promise?c(E("Promise-chain cycle")):(o=I(n))?o.call(n,u,c):u(n)):c(r)}catch(t){l&&!a&&l.exit(),c(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&R(t)})}},R=function(t){m.call(u,function(){var e,n,r,i=t._v,o=j(t);if(o&&(e=b(function(){k?S.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=k||j(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},j=function(t){return 1!==t._h&&0===(t._a||t._c).length},z=function(t){m.call(u,function(){var e;k?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},F=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw E("Promise can't be resolved itself");(e=I(t))?y(function(){var r={_w:n,_d:!1};try{e.call(t,c(F,r,1),c(D,r,1))}catch(t){D.call(r,t)}}):(n._v=t,n._s=1,L(n,!1))}catch(t){D.call({_w:n,_d:!1},t)}}};M||(A=function(t){d(this,A,"Promise","_h"),p(t),r.call(this);try{t(c(F,this,1),c(D,this,1))}catch(t){D.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(103)(A.prototype,{then:function(t,e){var n=O(g(this,A));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=k?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(F,t,1),this.reject=c(D,t,1)},_.f=O=function(t){return t===A||t===a?new o(t):i(t)}),f(f.G+f.W+f.F*!M,{Promise:A}),n(106)(A,"Promise"),n(100)("Promise"),a=n(64).Promise,f(f.S+f.F*!M,"Promise",{reject:function(t){var e=O(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(s||!M),"Promise",{resolve:function(t){return w(s&&this===a?A:this,t)}}),f(f.S+f.F*!(M&&n(132)(function(t){A.all(t).catch(C)})),"Promise",{all:function(t){var e=this,n=O(e),r=n.resolve,i=n.reject,o=b(function(){var n=[],o=0,a=1;v(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=O(e),r=n.reject,i=b(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(210),i=n(109);n(137)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r=n(7),i=n(138),o=n(177),a=n(19),s=n(97),u=n(36),c=n(24),l=n(20).ArrayBuffer,f=n(135),h=o.ArrayBuffer,p=o.DataView,d=i.ABV&&l.isView,v=h.prototype.slice,g=i.VIEW;r(r.G+r.W+r.F*(l!==h),{ArrayBuffer:h}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return d&&d(t)||c(t)&&g in t}}),r(r.P+r.U+r.F*n(23)(function(){return!new h(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==v&&void 0===e)return v.call(a(this),t);for(var n=a(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),o=new(f(this,h))(u(i-r)),c=new p(this),l=new p(o),d=0;r<i;)l.setUint8(d++,c.getUint8(r++));return o}}),n(100)("ArrayBuffer")},function(t,e,n){var r=n(7);r(r.G+r.W+r.F*!n(138).ABV,{DataView:n(177).DataView})},function(t,e,n){n(80)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(80)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(80)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){var r=n(7),i=n(46),o=n(19),a=(n(20).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(23)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var r=i(t),u=o(n);return a?a(r,e,u):s.call(r,e,u)}})},function(t,e,n){var r=n(7),i=n(98),o=n(46),a=n(19),s=n(24),u=n(23),c=n(191),l=(n(20).Reflect||{}).construct,f=u(function(){function t(){}return!(l(function(){},[],t)instanceof t)}),h=!u(function(){l(function(){})});r(r.S+r.F*(f||h),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(h&&!f)return l(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var u=n.prototype,p=i(s(u)?u:Object.prototype),d=Function.apply.call(t,p,e);return s(d)?d:p}})},function(t,e,n){var r=n(35),i=n(7),o=n(19),a=n(71);i(i.S+i.F*n(23)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t),e=a(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(7),i=n(59).f,o=n(19);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(7),i=n(19),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(165)(o,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){var r=n(59),i=n(60),o=n(57),a=n(7),s=n(24),u=n(19);a(a.S,"Reflect",{get:function t(e,n){var a,c,l=arguments.length<3?e:arguments[2];return u(e)===l?e[n]:(a=r.f(e,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(c=i(e))?t(c,n,l):void 0}})},function(t,e,n){var r=n(59),i=n(7),o=n(19);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},function(t,e,n){var r=n(7),i=n(60),o=n(19);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,n){var r=n(7);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(7),i=n(19),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,n){var r=n(7);r(r.S,"Reflect",{ownKeys:n(212)})},function(t,e,n){var r=n(7),i=n(19),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(35),i=n(59),o=n(60),a=n(57),s=n(7),u=n(94),c=n(19),l=n(24);s(s.S,"Reflect",{set:function t(e,n,s){var f,h,p=arguments.length<4?e:arguments[3],d=i.f(c(e),n);if(!d){if(l(h=o(e)))return t(h,n,s,p);d=u(0)}if(a(d,"value")){if(!1===d.writable||!l(p))return!1;if(f=i.f(p,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,r.f(p,n,f)}else r.f(p,n,u(0,s));return!0}return void 0!==d.set&&(d.set.call(p,s),!0)}})},function(t,e,n){var r=n(7),i=n(157);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(7),i=n(128)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(85)("includes")},function(t,e,n){"use strict";var r=n(7),i=n(213),o=n(42),a=n(36),s=n(46),u=n(171);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return s(t),e=a(r.length),n=u(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(85)("flatMap")},function(t,e,n){"use strict";var r=n(7),i=n(213),o=n(42),a=n(36),s=n(73),u=n(171);r(r.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=a(e.length),r=u(e,0);return i(r,e,e,n,0,void 0===t?1:s(t)),r}}),n(85)("flatten")},function(t,e,n){"use strict";var r=n(7),i=n(163)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(7),i=n(214),o=n(136);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(7),i=n(214),o=n(136);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(107)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(107)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var r=n(7),i=n(72),o=n(36),a=n(131),s=n(133),u=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};n(165)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in u?String(t.flags):s.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new c(r,e)}})},function(t,e,n){n(153)("asyncIterator")},function(t,e,n){n(153)("observable")},function(t,e,n){var r=n(7),i=n(212),o=n(58),a=n(59),s=n(169);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),u=a.f,c=i(r),l={},f=0;c.length>f;)void 0!==(n=u(r,e=c[f++]))&&s(l,e,n);return l}})},function(t,e,n){var r=n(7),i=n(215)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(7),i=n(215)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(7),i=n(42),o=n(46),a=n(35);n(34)&&r(r.P+n(139),"Object",{__defineGetter__:function(t,e){a.f(i(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(7),i=n(42),o=n(46),a=n(35);n(34)&&r(r.P+n(139),"Object",{__defineSetter__:function(t,e){a.f(i(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(7),i=n(42),o=n(71),a=n(60),s=n(59).f;n(34)&&r(r.P+n(139),"Object",{__lookupGetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.get}while(n=a(n))}})},function(t,e,n){"use strict";var r=n(7),i=n(42),o=n(71),a=n(60),s=n(59).f;n(34)&&r(r.P+n(139),"Object",{__lookupSetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.set}while(n=a(n))}})},function(t,e,n){var r=n(7);r(r.P+r.R,"Map",{toJSON:n(216)("Map")})},function(t,e,n){var r=n(7);r(r.P+r.R,"Set",{toJSON:n(216)("Set")})},function(t,e,n){n(140)("Map")},function(t,e,n){n(140)("Set")},function(t,e,n){n(140)("WeakMap")},function(t,e,n){n(140)("WeakSet")},function(t,e,n){n(141)("Map")},function(t,e,n){n(141)("Set")},function(t,e,n){n(141)("WeakMap")},function(t,e,n){n(141)("WeakSet")},function(t,e,n){var r=n(7);r(r.G,{global:n(20)})},function(t,e,n){var r=n(7);r(r.S,"System",{global:n(20)})},function(t,e,n){var r=n(7),i=n(66);r(r.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){var r=n(7);r(r.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var r=n(7);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var r=n(7),i=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){var r=n(7),i=n(218),o=n(198);r(r.S,"Math",{fscale:function(t,e,n,r,a){return o(i(t,e,n,r,a))}})},function(t,e,n){var r=n(7);r(r.S,"Math",{iaddh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(t,e,n){var r=n(7);r(r.S,"Math",{isubh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(t,e,n){var r=n(7);r(r.S,"Math",{imulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>16,s=r>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}})},function(t,e,n){var r=n(7);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var r=n(7),i=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){var r=n(7);r(r.S,"Math",{scale:n(218)})},function(t,e,n){var r=n(7);r(r.S,"Math",{umulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}})},function(t,e,n){var r=n(7);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var r=n(7),i=n(64),o=n(20),a=n(135),s=n(205);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(7),i=n(176),o=n(204);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var r=n(81),i=n(19),o=r.key,a=r.set;r.exp({defineMetadata:function(t,e,n,r){a(t,e,i(n),o(r))}})},function(t,e,n){var r=n(81),i=n(19),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(e),n,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var u=s.get(e);return u.delete(n),!!u.size||s.delete(e)}})},function(t,e,n){var r=n(81),i=n(19),o=n(60),a=r.has,s=r.get,u=r.key,c=function(t,e,n){if(a(t,e,n))return s(t,e,n);var r=o(e);return null!==r?c(t,r,n):void 0};r.exp({getMetadata:function(t,e){return c(t,i(e),arguments.length<3?void 0:u(arguments[2]))}})},function(t,e,n){var r=n(208),i=n(217),o=n(81),a=n(19),s=n(60),u=o.keys,c=o.key,l=function(t,e){var n=u(t,e),o=s(t);if(null===o)return n;var a=l(o,e);return a.length?n.length?i(new r(n.concat(a))):a:n};o.exp({getMetadataKeys:function(t){return l(a(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,n){var r=n(81),i=n(19),o=r.get,a=r.key;r.exp({getOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(81),i=n(19),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,n){var r=n(81),i=n(19),o=n(60),a=r.has,s=r.key,u=function(t,e,n){if(a(t,e,n))return!0;var r=o(e);return null!==r&&u(t,r,n)};r.exp({hasMetadata:function(t,e){return u(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var r=n(81),i=n(19),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(81),i=n(19),o=n(46),a=r.key,s=r.set;r.exp({metadata:function(t,e){return function(n,r){s(t,e,(void 0!==r?i:o)(n),a(r))}}})},function(t,e,n){var r=n(7),i=n(175)(),o=n(20).process,a="process"==n(66)(o);r(r.G,{asap:function(t){var e=a&&o.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var r=n(7),i=n(20),o=n(64),a=n(175)(),s=n(26)("observable"),u=n(46),c=n(19),l=n(101),f=n(103),h=n(51),p=n(102),d=p.RETURN,v=function(t){return null==t?void 0:u(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},m=function(t){return void 0===t._o},y=function(t){m(t)||(t._o=void 0,g(t))},_=function(t,e){c(t),this._c=void 0,this._o=t,t=new b(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:u(n),this._c=n)}catch(e){return void t.error(e)}m(this)&&g(this)};_.prototype=f({},{unsubscribe:function(){y(this)}});var b=function(t){this._s=t};b.prototype=f({},{next:function(t){var e=this._s;if(!m(e)){var n=e._o;try{var r=v(n.next);if(r)return r.call(n,t)}catch(t){try{y(e)}finally{throw t}}}},error:function(t){var e=this._s;if(m(e))throw t;var n=e._o;e._o=void 0;try{var r=v(n.error);if(!r)throw t;t=r.call(n,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!m(e)){var n=e._o;e._o=void 0;try{var r=v(n.complete);t=r?r.call(n,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var x=function(t){l(this,x,"Observable","_f")._f=u(t)};f(x.prototype,{subscribe:function(t){return new _(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||i.Promise)(function(n,r){u(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:n})})}}),f(x,{from:function(t){var e="function"==typeof this?this:x,n=v(c(t)[s]);if(n){var r=c(n.call(t));return r.constructor===e?r:new e(function(t){return r.subscribe(t)})}return new e(function(e){var n=!1;return a(function(){if(!n){try{if(p(t,!1,function(t){if(e.next(t),n)return d})===d)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:x)(function(t){var e=!1;return a(function(){if(!e){for(var r=0;r<n.length;++r)if(t.next(n[r]),e)return;t.complete()}}),function(){e=!0}})}}),h(x.prototype,s,function(){return this}),r(r.G,{Observable:x}),n(100)("Observable")},function(t,e,n){var r=n(20),i=n(7),o=n(136),a=[].slice,s=/MSIE .\./.test(o),u=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)})},function(t,e,n){var r=n(7),i=n(174);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(173),i=n(96),o=n(52),a=n(20),s=n(51),u=n(108),c=n(26),l=c("iterator"),f=c("toStringTag"),h=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(p),v=0;v<d.length;v++){var g,m=d[v],y=p[m],_=a[m],b=_&&_.prototype;if(b&&(b[l]||s(b,l,h),b[f]||s(b,f,m),u[m]=h,y))for(g in r)b[g]||o(b,g,r[g],!0)}},function(t,e,n){(function(e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c="object"==typeof t,l=e.regeneratorRuntime;if(l)c&&(t.exports=l);else{(l=e.regeneratorRuntime=c?t.exports:{}).wrap=b;var f="suspendedStart",h="suspendedYield",p="executing",d="completed",v={},g={};g[a]=function(){return this};var m=Object.getPrototypeOf,y=m&&m(m(M([])));y&&y!==r&&i.call(y,a)&&(g=y);var _=S.prototype=w.prototype=Object.create(g);E.prototype=_.constructor=S,S.constructor=E,S[u]=E.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(_),t},l.awrap=function(t){return{__await:t}},P(T.prototype),T.prototype[s]=function(){return this},l.AsyncIterator=T,l.async=function(t,e,n,r){var i=new T(b(t,e,n,r));return l.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},P(_),_[u]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=M,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return s.type="throw",s.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:M(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function b(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,o=Object.create(i.prototype),a=new O(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return I()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=x(t,e,n);if("normal"===u.type){if(r=n.done?d:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function w(){}function E(){}function S(){}function P(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function T(t){function n(e,r,o,a){var s=x(t[e],t,r);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,o,a)},function(t){n("throw",t,o,a)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},a)}a(s.arg)}var r;"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(t,e){function i(){return new Promise(function(r,i){n(t,e,r,i)})}return r=r?r.then(i,i):i()}}function A(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,A(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=x(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function M(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:n,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,n(41))},function(t,e,n){n(472),t.exports=n(64).RegExp.escape},function(t,e,n){var r=n(7),i=n(473)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){"use strict";var r=u(n(15)),i=u(n(476)),o=n(565),a=u(n(483)),s=u(n(487));function u(t){return t&&t.__esModule?t:{default:t}}i.default.render(r.default.createElement(o.Provider,{store:a.default},r.default.createElement(s.default,null)),document.getElementById("app"))},function(t,e,n){"use strict";
/** @license React v16.5.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(219),i="function"==typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,f=i?Symbol.for("react.context"):60110,h=i?Symbol.for("react.async_mode"):60111,p=i?Symbol.for("react.forward_ref"):60112;i&&Symbol.for("react.placeholder");var d="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(t,e,n,r,i,o,a,s){if(!t){if(t=void 0,void 0===e)t=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,o,a,s],c=0;(t=Error(e.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw t.framesToPop=1,t}}(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||g}function _(){}function b(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&v("85"),this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},_.prototype=y.prototype;var x=b.prototype=new _;x.constructor=b,r(x,y.prototype),x.isPureReactComponent=!0;var w={current:null,currentDispatcher:null},E=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function P(t,e,n){var r=void 0,i={},a=null,s=null;if(null!=e)for(r in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)E.call(e,r)&&!S.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:t,key:a,ref:s,props:i,_owner:w.current}}function T(t){return"object"==typeof t&&null!==t&&t.$$typeof===o}var A=/\/+/g,k=[];function C(t,e,n,r){if(k.length){var i=k.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function O(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>k.length&&k.push(t)}function M(t,e,n){return null==t?0:function t(e,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case o:case a:u=!0}}if(u)return r(i,e,""===n?"."+I(e,0):n),1;if(u=0,n=""===n?".":n+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=n+I(s=e[c],c);u+=t(s,l,r,i)}else if(l=null===e||"object"!=typeof e?null:"function"==typeof(l=d&&e[d]||e["@@iterator"])?l:null,"function"==typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=t(s=s.value,l=n+I(s,c++),r,i);else"object"===s&&v("31","[object Object]"==(r=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":r,"");return u}(t,"",e,n)}function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}(t.key):e.toString(36)}function L(t,e){t.func.call(t.context,e,t.count++)}function R(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?j(t,r,n,function(t){return t}):null!=t&&(T(t)&&(t=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(A,"$&/")+"/")+n)),r.push(t))}function j(t,e,n,r,i){var o="";null!=n&&(o=(""+n).replace(A,"$&/")+"/"),M(t,R,e=C(e,o,r,i)),O(e)}var z={Children:{map:function(t,e,n){if(null==t)return t;var r=[];return j(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;M(t,L,e=C(null,null,e,n)),O(e)},count:function(t){return M(t,function(){return null},null)},toArray:function(t){var e=[];return j(t,e,null,function(t){return t}),e},only:function(t){return T(t)||v("143"),t}},createRef:function(){return{current:null}},Component:y,PureComponent:b,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:f,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,Provider:null,Consumer:null,unstable_read:null}).Provider={$$typeof:l,_context:t},t.Consumer=t,t.unstable_read=function(t,e){var n=w.currentDispatcher;return null===n&&v("277"),n.readContext(t,e)}.bind(null,t),t},forwardRef:function(t){return{$$typeof:p,render:t}},Fragment:s,StrictMode:u,unstable_AsyncMode:h,unstable_Profiler:c,createElement:P,cloneElement:function(t,e,n){(null===t||void 0===t)&&v("267",t);var i=void 0,a=r({},t.props),s=t.key,u=t.ref,c=t._owner;if(null!=e){void 0!==e.ref&&(u=e.ref,c=w.current),void 0!==e.key&&(s=""+e.key);var l=void 0;for(i in t.type&&t.type.defaultProps&&(l=t.type.defaultProps),e)E.call(e,i)&&!S.hasOwnProperty(i)&&(a[i]=void 0===e[i]&&void 0!==l?l[i]:e[i])}if(1===(i=arguments.length-2))a.children=n;else if(1<i){l=Array(i);for(var f=0;f<i;f++)l[f]=arguments[f+2];a.children=l}return{$$typeof:o,type:t.type,key:s,ref:u,props:a,_owner:c}},createFactory:function(t){var e=P.bind(null,t);return e.type=t,e},isValidElement:T,version:"16.5.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:w,assign:r}},D={default:z},F=D&&z||D;t.exports=F.default||F},function(t,e,n){"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n(477)},function(t,e,n){"use strict";
/** @license React v16.5.2
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(15),i=n(219),o=n(478);function a(t){for(var e=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(t,e,n,r,i,o,a,s){if(!t){if(t=void 0,void 0===e)t=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,o,a,s],c=0;(t=Error(e.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw t.framesToPop=1,t}}(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}r||a("227");var s=!1,u=null,c=!1,l=null,f={onError:function(t){s=!0,u=t}};function h(t,e,n,r,i,o,a,c,l){s=!1,u=null,function(t,e,n,r,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(t){this.onError(t)}}.apply(f,arguments)}var p=null,d={};function v(){if(p)for(var t in d){var e=d[t],n=p.indexOf(t);if(-1<n||a("96",t),!m[n])for(var r in e.extractEvents||a("97",t),m[n]=e,n=e.eventTypes){var i=void 0,o=n[r],s=e,u=r;y.hasOwnProperty(u)&&a("99",u),y[u]=o;var c=o.phasedRegistrationNames;if(c){for(i in c)c.hasOwnProperty(i)&&g(c[i],s,u);i=!0}else o.registrationName?(g(o.registrationName,s,u),i=!0):i=!1;i||a("98",r,t)}}}function g(t,e,n){_[t]&&a("100",t),_[t]=e,b[t]=e.eventTypes[n].dependencies}var m=[],y={},_={},b={},x=null,w=null,E=null;function S(t,e,n,r){e=t.type||"unknown-event",t.currentTarget=E(r),function(t,e,n,r,i,o,f,p,d){if(h.apply(this,arguments),s){if(s){var v=u;s=!1,u=null}else a("198"),v=void 0;c||(c=!0,l=v)}}(e,n,void 0,t),t.currentTarget=null}function P(t,e){return null==e&&a("30"),null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function T(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}var A=null;function k(t,e){if(t){var n=t._dispatchListeners,r=t._dispatchInstances;if(Array.isArray(n))for(var i=0;i<n.length&&!t.isPropagationStopped();i++)S(t,e,n[i],r[i]);else n&&S(t,e,n,r);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function C(t){return k(t,!0)}function O(t){return k(t,!1)}var M={injectEventPluginOrder:function(t){p&&a("101"),p=Array.prototype.slice.call(t),v()},injectEventPluginsByName:function(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var r=t[e];d.hasOwnProperty(e)&&d[e]===r||(d[e]&&a("102",e),d[e]=r,n=!0)}n&&v()}};function I(t,e){var n=t.stateNode;if(!n)return null;var r=x(n);if(!r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}return t?null:(n&&"function"!=typeof n&&a("231",e,typeof n),n)}function L(t,e){if(null!==t&&(A=P(A,t)),t=A,A=null,t&&(T(t,e?C:O),A&&a("95"),c))throw e=l,c=!1,l=null,e}var R=Math.random().toString(36).slice(2),j="__reactInternalInstance$"+R,z="__reactEventHandlers$"+R;function D(t){if(t[j])return t[j];for(;!t[j];){if(!t.parentNode)return null;t=t.parentNode}return 7===(t=t[j]).tag||8===t.tag?t:null}function F(t){return!(t=t[j])||7!==t.tag&&8!==t.tag?null:t}function N(t){if(7===t.tag||8===t.tag)return t.stateNode;a("33")}function B(t){return t[z]||null}function U(t){do{t=t.return}while(t&&7!==t.tag);return t||null}function V(t,e,n){(e=I(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=P(n._dispatchListeners,e),n._dispatchInstances=P(n._dispatchInstances,t))}function G(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,n=[];e;)n.push(e),e=U(e);for(e=n.length;0<e--;)V(n[e],"captured",t);for(e=0;e<n.length;e++)V(n[e],"bubbled",t)}}function q(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=I(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=P(n._dispatchListeners,e),n._dispatchInstances=P(n._dispatchInstances,t))}function W(t){t&&t.dispatchConfig.registrationName&&q(t._targetInst,null,t)}function Z(t){T(t,G)}var X=!("undefined"==typeof window||!window.document||!window.document.createElement);function H(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Y={animationend:H("Animation","AnimationEnd"),animationiteration:H("Animation","AnimationIteration"),animationstart:H("Animation","AnimationStart"),transitionend:H("Transition","TransitionEnd")},K={},J={};function Q(t){if(K[t])return K[t];if(!Y[t])return t;var e,n=Y[t];for(e in n)if(n.hasOwnProperty(e)&&e in J)return K[t]=n[e];return t}X&&(J=document.createElement("div").style,"AnimationEvent"in window||(delete Y.animationend.animation,delete Y.animationiteration.animation,delete Y.animationstart.animation),"TransitionEvent"in window||delete Y.transitionend.transition);var $=Q("animationend"),tt=Q("animationiteration"),et=Q("animationstart"),nt=Q("transitionend"),rt="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),it=null,ot=null,at=null;function st(){if(at)return at;var t,e,n=ot,r=n.length,i="value"in it?it.value:it.textContent,o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return at=i.slice(t,1<e?1-e:void 0)}function ut(){return!0}function ct(){return!1}function lt(t,e,n,r){for(var i in this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ut:ct,this.isPropagationStopped=ct,this}function ft(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function ht(t){t instanceof this||a("279"),t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function pt(t){t.eventPool=[],t.getPooled=ft,t.release=ht}i(lt.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=ut)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=ut)},persist:function(){this.isPersistent=ut},isPersistent:ct,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=ct,this._dispatchInstances=this._dispatchListeners=null}}),lt.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},lt.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var o=new e;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,t),n.extend=r.extend,pt(n),n},pt(lt);var dt=lt.extend({data:null}),vt=lt.extend({data:null}),gt=[9,13,27,32],mt=X&&"CompositionEvent"in window,yt=null;X&&"documentMode"in document&&(yt=document.documentMode);var _t=X&&"TextEvent"in window&&!yt,bt=X&&(!mt||yt&&8<yt&&11>=yt),xt=String.fromCharCode(32),wt={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},Et=!1;function St(t,e){switch(t){case"keyup":return-1!==gt.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function Pt(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Tt=!1;var At={eventTypes:wt,extractEvents:function(t,e,n,r){var i=void 0,o=void 0;if(mt)t:{switch(t){case"compositionstart":i=wt.compositionStart;break t;case"compositionend":i=wt.compositionEnd;break t;case"compositionupdate":i=wt.compositionUpdate;break t}i=void 0}else Tt?St(t,n)&&(i=wt.compositionEnd):"keydown"===t&&229===n.keyCode&&(i=wt.compositionStart);return i?(bt&&"ko"!==n.locale&&(Tt||i!==wt.compositionStart?i===wt.compositionEnd&&Tt&&(o=st()):(ot="value"in(it=r)?it.value:it.textContent,Tt=!0)),i=dt.getPooled(i,e,n,r),o?i.data=o:null!==(o=Pt(n))&&(i.data=o),Z(i),o=i):o=null,(t=_t?function(t,e){switch(t){case"compositionend":return Pt(e);case"keypress":return 32!==e.which?null:(Et=!0,xt);case"textInput":return(t=e.data)===xt&&Et?null:t;default:return null}}(t,n):function(t,e){if(Tt)return"compositionend"===t||!mt&&St(t,e)?(t=st(),at=ot=it=null,Tt=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return bt&&"ko"!==e.locale?null:e.data;default:return null}}(t,n))?((e=vt.getPooled(wt.beforeInput,e,n,r)).data=t,Z(e)):e=null,null===o?e:null===e?o:[o,e]}},kt=null,Ct=null,Ot=null;function Mt(t){if(t=w(t)){"function"!=typeof kt&&a("280");var e=x(t.stateNode);kt(t.stateNode,t.type,e)}}function It(t){Ct?Ot?Ot.push(t):Ot=[t]:Ct=t}function Lt(){if(Ct){var t=Ct,e=Ot;if(Ot=Ct=null,Mt(t),e)for(t=0;t<e.length;t++)Mt(e[t])}}function Rt(t,e){return t(e)}function jt(t,e,n){return t(e,n)}function zt(){}var Dt=!1;function Ft(t,e){if(Dt)return t(e);Dt=!0;try{return Rt(t,e)}finally{Dt=!1,(null!==Ct||null!==Ot)&&(zt(),Lt())}}var Nt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bt(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Nt[t.type]:"textarea"===e}function Ut(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function Vt(t){if(!X)return!1;var e=(t="on"+t)in document;return e||((e=document.createElement("div")).setAttribute(t,"return;"),e="function"==typeof e[t]),e}function Gt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function qt(t){t._valueTracker||(t._valueTracker=function(t){var e=Gt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Wt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Gt(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}var Zt=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xt=/^(.*)[\\\/]/,Ht="function"==typeof Symbol&&Symbol.for,Yt=Ht?Symbol.for("react.element"):60103,Kt=Ht?Symbol.for("react.portal"):60106,Jt=Ht?Symbol.for("react.fragment"):60107,Qt=Ht?Symbol.for("react.strict_mode"):60108,$t=Ht?Symbol.for("react.profiler"):60114,te=Ht?Symbol.for("react.provider"):60109,ee=Ht?Symbol.for("react.context"):60110,ne=Ht?Symbol.for("react.async_mode"):60111,re=Ht?Symbol.for("react.forward_ref"):60112,ie=Ht?Symbol.for("react.placeholder"):60113,oe="function"==typeof Symbol&&Symbol.iterator;function ae(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=oe&&t[oe]||t["@@iterator"])?t:null}function se(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case ne:return"AsyncMode";case Jt:return"Fragment";case Kt:return"Portal";case $t:return"Profiler";case Qt:return"StrictMode";case ie:return"Placeholder"}if("object"==typeof t){switch(t.$$typeof){case ee:return"Context.Consumer";case te:return"Context.Provider";case re:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef")}if("function"==typeof t.then&&(t=1===t._reactStatus?t._reactResult:null))return se(t)}return null}function ue(t){var e="";do{t:switch(t.tag){case 4:case 0:case 1:case 2:case 3:case 7:case 10:var n=t._debugOwner,r=t._debugSource,i=se(t.type),o=null;n&&(o=se(n.type)),n=i,i="",r?i=" (at "+r.fileName.replace(Xt,"")+":"+r.lineNumber+")":o&&(i=" (created by "+o+")"),o="\n    in "+(n||"Unknown")+i;break t;default:o=""}e+=o,t=t.return}while(t);return e}var ce=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,le=Object.prototype.hasOwnProperty,fe={},he={};function pe(t,e,n,r,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e}var de={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){de[t]=new pe(t,0,!1,t,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];de[e]=new pe(e,1,!1,t[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){de[t]=new pe(t,2,!1,t.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){de[t]=new pe(t,2,!1,t,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){de[t]=new pe(t,3,!1,t.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(t){de[t]=new pe(t,3,!0,t,null)}),["capture","download"].forEach(function(t){de[t]=new pe(t,4,!1,t,null)}),["cols","rows","size","span"].forEach(function(t){de[t]=new pe(t,6,!1,t,null)}),["rowSpan","start"].forEach(function(t){de[t]=new pe(t,5,!1,t.toLowerCase(),null)});var ve=/[\-:]([a-z])/g;function ge(t){return t[1].toUpperCase()}function me(t,e,n,r){var i=de.hasOwnProperty(e)?de[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,n,r){if(null===e||void 0===e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!le.call(he,t)||!le.call(fe,t)&&(ce.test(t)?he[t]=!0:(fe[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}function ye(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function _e(t,e){var n=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function be(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=ye(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function xe(t,e){null!=(e=e.checked)&&me(t,"checked",e,!1)}function we(t,e){xe(t,e);var n=ye(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?Se(t,e.type,n):e.hasOwnProperty("defaultValue")&&Se(t,e.type,ye(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Ee(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!t.defaultChecked,t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function Se(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ve,ge);de[e]=new pe(e,1,!1,t,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ve,ge);de[e]=new pe(e,1,!1,t,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ve,ge);de[e]=new pe(e,1,!1,t,"http://www.w3.org/XML/1998/namespace")}),de.tabIndex=new pe("tabIndex",1,!1,"tabindex",null);var Pe={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Te(t,e,n){return(t=lt.getPooled(Pe.change,t,e,n)).type="change",It(n),Z(t),t}var Ae=null,ke=null;function Ce(t){L(t,!1)}function Oe(t){if(Wt(N(t)))return t}function Me(t,e){if("change"===t)return e}var Ie=!1;function Le(){Ae&&(Ae.detachEvent("onpropertychange",Re),ke=Ae=null)}function Re(t){"value"===t.propertyName&&Oe(ke)&&Ft(Ce,t=Te(ke,t,Ut(t)))}function je(t,e,n){"focus"===t?(Le(),ke=n,(Ae=e).attachEvent("onpropertychange",Re)):"blur"===t&&Le()}function ze(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Oe(ke)}function De(t,e){if("click"===t)return Oe(e)}function Fe(t,e){if("input"===t||"change"===t)return Oe(e)}X&&(Ie=Vt("input")&&(!document.documentMode||9<document.documentMode));var Ne={eventTypes:Pe,_isInputEventSupported:Ie,extractEvents:function(t,e,n,r){var i=e?N(e):window,o=void 0,a=void 0,s=i.nodeName&&i.nodeName.toLowerCase();if("select"===s||"input"===s&&"file"===i.type?o=Me:Bt(i)?Ie?o=Fe:(o=ze,a=je):(s=i.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=De),o&&(o=o(t,e)))return Te(o,n,r);a&&a(t,i,e),"blur"===t&&(t=i._wrapperState)&&t.controlled&&"number"===i.type&&Se(i,"number",i.value)}},Be=lt.extend({view:null,detail:null}),Ue={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ve(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Ue[t])&&!!e[t]}function Ge(){return Ve}var qe=0,We=0,Ze=!1,Xe=!1,He=Be.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Ge,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=qe;return qe=t.screenX,Ze?"mousemove"===t.type?t.screenX-e:0:(Ze=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=We;return We=t.screenY,Xe?"mousemove"===t.type?t.screenY-e:0:(Xe=!0,0)}}),Ye=He.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Ke={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Je={eventTypes:Ke,extractEvents:function(t,e,n,r){var i="mouseover"===t||"pointerover"===t,o="mouseout"===t||"pointerout"===t;if(i&&(n.relatedTarget||n.fromElement)||!o&&!i)return null;if(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=e,e=(e=n.relatedTarget||n.toElement)?D(e):null):o=null,o===e)return null;var a=void 0,s=void 0,u=void 0,c=void 0;"mouseout"===t||"mouseover"===t?(a=He,s=Ke.mouseLeave,u=Ke.mouseEnter,c="mouse"):"pointerout"!==t&&"pointerover"!==t||(a=Ye,s=Ke.pointerLeave,u=Ke.pointerEnter,c="pointer");var l=null==o?i:N(o);if(i=null==e?i:N(e),(t=a.getPooled(s,o,n,r)).type=c+"leave",t.target=l,t.relatedTarget=i,(n=a.getPooled(u,e,n,r)).type=c+"enter",n.target=i,n.relatedTarget=l,r=e,o&&r)t:{for(i=r,c=0,a=e=o;a;a=U(a))c++;for(a=0,u=i;u;u=U(u))a++;for(;0<c-a;)e=U(e),c--;for(;0<a-c;)i=U(i),a--;for(;c--;){if(e===i||e===i.alternate)break t;e=U(e),i=U(i)}e=null}else e=null;for(i=e,e=[];o&&o!==i&&(null===(c=o.alternate)||c!==i);)e.push(o),o=U(o);for(o=[];r&&r!==i&&(null===(c=r.alternate)||c!==i);)o.push(r),r=U(r);for(r=0;r<e.length;r++)q(e[r],"bubbled",t);for(r=o.length;0<r--;)q(o[r],"captured",n);return[t,n]}},Qe=Object.prototype.hasOwnProperty;function $e(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function tn(t,e){if($e(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Qe.call(e,n[r])||!$e(t[n[r]],e[n[r]]))return!1;return!0}function en(t){var e=t;if(t.alternate)for(;e.return;)e=e.return;else{if(0!=(2&e.effectTag))return 1;for(;e.return;)if(0!=(2&(e=e.return).effectTag))return 1}return 5===e.tag?2:3}function nn(t){2!==en(t)&&a("188")}function rn(t){if(!(t=function(t){var e=t.alternate;if(!e)return 3===(e=en(t))&&a("188"),1===e?null:t;for(var n=t,r=e;;){var i=n.return,o=i?i.alternate:null;if(!i||!o)break;if(i.child===o.child){for(var s=i.child;s;){if(s===n)return nn(i),t;if(s===r)return nn(i),e;s=s.sibling}a("188")}if(n.return!==r.return)n=i,r=o;else{s=!1;for(var u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}s||a("189")}}n.alternate!==r&&a("190")}return 5!==n.tag&&a("188"),n.stateNode.current===n?t:e}(t)))return null;for(var e=t;;){if(7===e.tag||8===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}var on=lt.extend({animationName:null,elapsedTime:null,pseudoElement:null}),an=lt.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),sn=Be.extend({relatedTarget:null});function un(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}var cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ln={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fn=Be.extend({key:function(t){if(t.key){var e=cn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=un(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?ln[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Ge,charCode:function(t){return"keypress"===t.type?un(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?un(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),hn=He.extend({dataTransfer:null}),pn=Be.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Ge}),dn=lt.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),vn=He.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),gn=[["abort","abort"],[$,"animationEnd"],[tt,"animationIteration"],[et,"animationStart"],["canplay","canPlay"],["canplaythrough","canPlayThrough"],["drag","drag"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["gotpointercapture","gotPointerCapture"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["loadstart","loadStart"],["lostpointercapture","lostPointerCapture"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["playing","playing"],["pointermove","pointerMove"],["pointerout","pointerOut"],["pointerover","pointerOver"],["progress","progress"],["scroll","scroll"],["seeking","seeking"],["stalled","stalled"],["suspend","suspend"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchmove","touchMove"],[nt,"transitionEnd"],["waiting","waiting"],["wheel","wheel"]],mn={},yn={};function _n(t,e){var n=t[0],r="on"+((t=t[1])[0].toUpperCase()+t.slice(1));e={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[n],isInteractive:e},mn[t]=e,yn[n]=e}[["blur","blur"],["cancel","cancel"],["click","click"],["close","close"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["auxclick","auxClick"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragstart","dragStart"],["drop","drop"],["focus","focus"],["input","input"],["invalid","invalid"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["mousedown","mouseDown"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["pointercancel","pointerCancel"],["pointerdown","pointerDown"],["pointerup","pointerUp"],["ratechange","rateChange"],["reset","reset"],["seeked","seeked"],["submit","submit"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchstart","touchStart"],["volumechange","volumeChange"]].forEach(function(t){_n(t,!0)}),gn.forEach(function(t){_n(t,!1)});var bn={eventTypes:mn,isInteractiveTopLevelEventType:function(t){return void 0!==(t=yn[t])&&!0===t.isInteractive},extractEvents:function(t,e,n,r){var i=yn[t];if(!i)return null;switch(t){case"keypress":if(0===un(n))return null;case"keydown":case"keyup":t=fn;break;case"blur":case"focus":t=sn;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=He;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=hn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=pn;break;case $:case tt:case et:t=on;break;case nt:t=dn;break;case"scroll":t=Be;break;case"wheel":t=vn;break;case"copy":case"cut":case"paste":t=an;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Ye;break;default:t=lt}return Z(e=t.getPooled(i,e,n,r)),e}},xn=bn.isInteractiveTopLevelEventType,wn=[];function En(t){var e=t.targetInst,n=e;do{if(!n){t.ancestors.push(n);break}var r;for(r=n;r.return;)r=r.return;if(!(r=5!==r.tag?null:r.stateNode.containerInfo))break;t.ancestors.push(n),n=D(r)}while(n);for(n=0;n<t.ancestors.length;n++){e=t.ancestors[n];var i=Ut(t.nativeEvent);r=t.topLevelType;for(var o=t.nativeEvent,a=null,s=0;s<m.length;s++){var u=m[s];u&&(u=u.extractEvents(r,e,o,i))&&(a=P(a,u))}L(a,!1)}}var Sn=!0;function Pn(t,e){if(!e)return null;var n=(xn(t)?An:kn).bind(null,t);e.addEventListener(t,n,!1)}function Tn(t,e){if(!e)return null;var n=(xn(t)?An:kn).bind(null,t);e.addEventListener(t,n,!0)}function An(t,e){jt(kn,t,e)}function kn(t,e){if(Sn){var n=Ut(e);if(null===(n=D(n))||"number"!=typeof n.tag||2===en(n)||(n=null),wn.length){var r=wn.pop();r.topLevelType=t,r.nativeEvent=e,r.targetInst=n,t=r}else t={topLevelType:t,nativeEvent:e,targetInst:n,ancestors:[]};try{Ft(En,t)}finally{t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>wn.length&&wn.push(t)}}}var Cn={},On=0,Mn="_reactListenersID"+(""+Math.random()).slice(2);function In(t){return Object.prototype.hasOwnProperty.call(t,Mn)||(t[Mn]=On++,Cn[t[Mn]]={}),Cn[t[Mn]]}function Ln(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Rn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jn(t,e){var n,r=Rn(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=Rn(r)}}function zn(){for(var t=window,e=Ln();e instanceof t.HTMLIFrameElement;){try{t=e.contentDocument.defaultView}catch(t){break}e=Ln(t.document)}return e}function Dn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var Fn=X&&"documentMode"in document&&11>=document.documentMode,Nn={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Bn=null,Un=null,Vn=null,Gn=!1;function qn(t,e){var n=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;return Gn||null==Bn||Bn!==Ln(n)?null:("selectionStart"in(n=Bn)&&Dn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Vn&&tn(Vn,n)?null:(Vn=n,(t=lt.getPooled(Nn.select,Un,t,e)).type="select",t.target=Bn,Z(t),t))}var Wn={eventTypes:Nn,extractEvents:function(t,e,n,r){var i,o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(i=!o)){t:{o=In(o),i=b.onSelect;for(var a=0;a<i.length;a++){var s=i[a];if(!o.hasOwnProperty(s)||!o[s]){o=!1;break t}}o=!0}i=!o}if(i)return null;switch(o=e?N(e):window,t){case"focus":(Bt(o)||"true"===o.contentEditable)&&(Bn=o,Un=e,Vn=null);break;case"blur":Vn=Un=Bn=null;break;case"mousedown":Gn=!0;break;case"contextmenu":case"mouseup":case"dragend":return Gn=!1,qn(n,r);case"selectionchange":if(Fn)break;case"keydown":case"keyup":return qn(n,r)}return null}};function Zn(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return r.Children.forEach(t,function(t){null!=t&&(e+=t)}),e}(e.children))&&(t.children=e),t}function Xn(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ye(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function Hn(t,e){return null!=e.dangerouslySetInnerHTML&&a("91"),i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Yn(t,e){var n=e.value;null==n&&(n=e.defaultValue,null!=(e=e.children)&&(null!=n&&a("92"),Array.isArray(e)&&(1>=e.length||a("93"),e=e[0]),n=e),null==n&&(n="")),t._wrapperState={initialValue:ye(n)}}function Kn(t,e){var n=ye(e.value),r=ye(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function Jn(t){var e=t.textContent;e===t._wrapperState.initialValue&&(t.value=e)}M.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),x=B,w=F,E=N,M.injectEventPluginsByName({SimpleEventPlugin:bn,EnterLeaveEventPlugin:Je,ChangeEventPlugin:Ne,SelectEventPlugin:Wn,BeforeInputEventPlugin:At});var Qn={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function $n(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tr(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?$n(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var er=void 0,nr=function(t){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n)})}:t}(function(t,e){if(t.namespaceURI!==Qn.svg||"innerHTML"in t)t.innerHTML=e;else{for((er=er||document.createElement("div")).innerHTML="<svg>"+e+"</svg>",e=er.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rr(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ir={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},or=["Webkit","ms","Moz","O"];function ar(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=n,o=e[n];i=null==o||"boolean"==typeof o||""===o?"":r||"number"!=typeof o||0===o||ir.hasOwnProperty(i)&&ir[i]?(""+o).trim():o+"px","float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(ir).forEach(function(t){or.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ir[e]=ir[t]})});var sr=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ur(t,e){e&&(sr[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML)&&a("137",t,""),null!=e.dangerouslySetInnerHTML&&(null!=e.children&&a("60"),"object"==typeof e.dangerouslySetInnerHTML&&"__html"in e.dangerouslySetInnerHTML||a("61")),null!=e.style&&"object"!=typeof e.style&&a("62",""))}function cr(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function lr(t,e){var n=In(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=b[e];for(var r=0;r<e.length;r++){var i=e[r];if(!n.hasOwnProperty(i)||!n[i]){switch(i){case"scroll":Tn("scroll",t);break;case"focus":case"blur":Tn("focus",t),Tn("blur",t),n.blur=!0,n.focus=!0;break;case"cancel":case"close":Vt(i)&&Tn(i,t);break;case"invalid":case"submit":case"reset":break;default:-1===rt.indexOf(i)&&Pn(i,t)}n[i]=!0}}}function fr(){}var hr=null,pr=null;function dr(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function vr(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}function gr(t){for(t=t.nextSibling;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t}function mr(t){for(t=t.firstChild;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t}new Set;var yr=[],_r=-1;function br(t){0>_r||(t.current=yr[_r],yr[_r]=null,_r--)}function xr(t,e){yr[++_r]=t.current,t.current=e}var wr={},Er={current:wr},Sr={current:!1},Pr=wr;function Tr(t,e){var n=t.type.contextTypes;if(!n)return wr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Ar(t){return null!==(t=t.childContextTypes)&&void 0!==t}function kr(t){br(Sr),br(Er)}function Cr(t){br(Sr),br(Er)}function Or(t,e,n){Er.current!==wr&&a("168"),xr(Er,e),xr(Sr,n)}function Mr(t,e,n){var r=t.stateNode;if(t=e.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())o in t||a("108",se(e)||"Unknown",o);return i({},n,r)}function Ir(t){var e=t.stateNode;return e=e&&e.__reactInternalMemoizedMergedChildContext||wr,Pr=Er.current,xr(Er,e),xr(Sr,Sr.current),!0}function Lr(t,e,n){var r=t.stateNode;r||a("169"),n?(e=Mr(t,e,Pr),r.__reactInternalMemoizedMergedChildContext=e,br(Sr),br(Er),xr(Er,e)):br(Sr),xr(Sr,n)}var Rr=null,jr=null;function zr(t){return function(e){try{return t(e)}catch(t){}}}function Dr(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=null,this.index=0,this.ref=null,this.pendingProps=e,this.firstContextDependency=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Fr(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Nr(t,e,n){var r=t.alternate;return null===r?((r=new Dr(t.tag,e,t.key,t.mode)).type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.effectTag=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childExpirationTime=t.childExpirationTime,r.expirationTime=e!==t.pendingProps?n:t.expirationTime,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,r.firstContextDependency=t.firstContextDependency,r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Br(t,e,n){var r=t.type,i=t.key;t=t.props;var o=void 0;if("function"==typeof r)o=Fr(r)?2:4;else if("string"==typeof r)o=7;else t:switch(r){case Jt:return Ur(t.children,e,n,i);case ne:o=10,e|=3;break;case Qt:o=10,e|=2;break;case $t:return(r=new Dr(15,t,i,4|e)).type=$t,r.expirationTime=n,r;case ie:o=16;break;default:if("object"==typeof r&&null!==r)switch(r.$$typeof){case te:o=12;break t;case ee:o=11;break t;case re:o=13;break t;default:if("function"==typeof r.then){o=4;break t}}a("130",null==r?r:typeof r,"")}return(e=new Dr(o,t,i,e)).type=r,e.expirationTime=n,e}function Ur(t,e,n,r){return(t=new Dr(9,t,r,e)).expirationTime=n,t}function Vr(t,e,n){return(t=new Dr(8,t,null,e)).expirationTime=n,t}function Gr(t,e,n){return(e=new Dr(6,null!==t.children?t.children:[],t.key,e)).expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qr(t,e){t.didError=!1;var n=t.earliestPendingTime;0===n?t.earliestPendingTime=t.latestPendingTime=e:n>e?t.earliestPendingTime=e:t.latestPendingTime<e&&(t.latestPendingTime=e),Wr(e,t)}function Wr(t,e){var n=e.earliestSuspendedTime,r=e.latestSuspendedTime,i=e.earliestPendingTime,o=e.latestPingedTime;0===(i=0!==i?i:o)&&(0===t||r>t)&&(i=r),0!==(t=i)&&0!==n&&n<t&&(t=n),e.nextExpirationTimeToWorkOn=i,e.expirationTime=t}var Zr=!1;function Xr(t){return{baseState:t,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Hr(t){return{baseState:t.baseState,firstUpdate:t.firstUpdate,lastUpdate:t.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Yr(t){return{expirationTime:t,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function Kr(t,e){null===t.lastUpdate?t.firstUpdate=t.lastUpdate=e:(t.lastUpdate.next=e,t.lastUpdate=e)}function Jr(t,e){var n=t.alternate;if(null===n){var r=t.updateQueue,i=null;null===r&&(r=t.updateQueue=Xr(t.memoizedState))}else r=t.updateQueue,i=n.updateQueue,null===r?null===i?(r=t.updateQueue=Xr(t.memoizedState),i=n.updateQueue=Xr(n.memoizedState)):r=t.updateQueue=Hr(i):null===i&&(i=n.updateQueue=Hr(r));null===i||r===i?Kr(r,e):null===r.lastUpdate||null===i.lastUpdate?(Kr(r,e),Kr(i,e)):(Kr(r,e),i.lastUpdate=e)}function Qr(t,e){var n=t.updateQueue;null===(n=null===n?t.updateQueue=Xr(t.memoizedState):$r(t,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=e:(n.lastCapturedUpdate.next=e,n.lastCapturedUpdate=e)}function $r(t,e){var n=t.alternate;return null!==n&&e===n.updateQueue&&(e=t.updateQueue=Hr(e)),e}function ti(t,e,n,r,o,a){switch(n.tag){case 1:return"function"==typeof(t=n.payload)?t.call(a,r,o):t;case 3:t.effectTag=-1025&t.effectTag|64;case 0:if(null===(o="function"==typeof(t=n.payload)?t.call(a,r,o):t)||void 0===o)break;return i({},r,o);case 2:Zr=!0}return r}function ei(t,e,n,r,i){Zr=!1;for(var o=(e=$r(t,e)).baseState,a=null,s=0,u=e.firstUpdate,c=o;null!==u;){var l=u.expirationTime;l>i?(null===a&&(a=u,o=c),(0===s||s>l)&&(s=l)):(c=ti(t,0,u,c,n,r),null!==u.callback&&(t.effectTag|=32,u.nextEffect=null,null===e.lastEffect?e.firstEffect=e.lastEffect=u:(e.lastEffect.nextEffect=u,e.lastEffect=u))),u=u.next}for(l=null,u=e.firstCapturedUpdate;null!==u;){var f=u.expirationTime;f>i?(null===l&&(l=u,null===a&&(o=c)),(0===s||s>f)&&(s=f)):(c=ti(t,0,u,c,n,r),null!==u.callback&&(t.effectTag|=32,u.nextEffect=null,null===e.lastCapturedEffect?e.firstCapturedEffect=e.lastCapturedEffect=u:(e.lastCapturedEffect.nextEffect=u,e.lastCapturedEffect=u))),u=u.next}null===a&&(e.lastUpdate=null),null===l?e.lastCapturedUpdate=null:t.effectTag|=32,null===a&&null===l&&(o=c),e.baseState=o,e.firstUpdate=a,e.firstCapturedUpdate=l,t.expirationTime=s,t.memoizedState=c}function ni(t,e,n){null!==e.firstCapturedUpdate&&(null!==e.lastUpdate&&(e.lastUpdate.next=e.firstCapturedUpdate,e.lastUpdate=e.lastCapturedUpdate),e.firstCapturedUpdate=e.lastCapturedUpdate=null),ri(e.firstEffect,n),e.firstEffect=e.lastEffect=null,ri(e.firstCapturedEffect,n),e.firstCapturedEffect=e.lastCapturedEffect=null}function ri(t,e){for(;null!==t;){var n=t.callback;if(null!==n){t.callback=null;var r=e;"function"!=typeof n&&a("191",n),n.call(r)}t=t.nextEffect}}function ii(t,e){return{value:t,source:e,stack:ue(e)}}var oi={current:null},ai=null,si=null,ui=null;function ci(t,e){var n=t.type._context;xr(oi,n._currentValue),n._currentValue=e}function li(t){var e=oi.current;br(oi),t.type._context._currentValue=e}function fi(t){ai=t,ui=si=null,t.firstContextDependency=null}function hi(t,e){return ui!==t&&!1!==e&&0!==e&&("number"==typeof e&&1073741823!==e||(ui=t,e=1073741823),e={context:t,observedBits:e,next:null},null===si?(null===ai&&a("277"),ai.firstContextDependency=si=e):si=si.next=e),t._currentValue}var pi={},di={current:pi},vi={current:pi},gi={current:pi};function mi(t){return t===pi&&a("174"),t}function yi(t,e){xr(gi,e),xr(vi,t),xr(di,pi);var n=e.nodeType;switch(n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:tr(null,"");break;default:e=tr(e=(n=8===n?e.parentNode:e).namespaceURI||null,n=n.tagName)}br(di),xr(di,e)}function _i(t){br(di),br(vi),br(gi)}function bi(t){mi(gi.current);var e=mi(di.current),n=tr(e,t.type);e!==n&&(xr(vi,t),xr(di,n))}function xi(t){vi.current===t&&(br(di),br(vi))}var wi=(new r.Component).refs;function Ei(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:i({},e,n),t.memoizedState=n,null!==(r=t.updateQueue)&&0===t.expirationTime&&(r.baseState=n)}var Si={isMounted:function(t){return!!(t=t._reactInternalFiber)&&2===en(t)},enqueueSetState:function(t,e,n){t=t._reactInternalFiber;var r=aa(),i=Yr(r=Io(r,t));i.payload=e,void 0!==n&&null!==n&&(i.callback=n),Jr(t,i),Lo(t,r)},enqueueReplaceState:function(t,e,n){t=t._reactInternalFiber;var r=aa(),i=Yr(r=Io(r,t));i.tag=1,i.payload=e,void 0!==n&&null!==n&&(i.callback=n),Jr(t,i),Lo(t,r)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var n=aa(),r=Yr(n=Io(n,t));r.tag=2,void 0!==e&&null!==e&&(r.callback=e),Jr(t,r),Lo(t,n)}};function Pi(t,e,n,r,i,o,a){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,o,a):!e.prototype||!e.prototype.isPureReactComponent||(!tn(n,r)||!tn(i,o))}function Ti(t,e,n,r){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Si.enqueueReplaceState(e,e.state,null)}function Ai(t,e,n,r){var i=t.stateNode,o=Ar(e)?Pr:Er.current;i.props=n,i.state=t.memoizedState,i.refs=wi,i.context=Tr(t,o),null!==(o=t.updateQueue)&&(ei(t,o,n,i,r),i.state=t.memoizedState),"function"==typeof(o=e.getDerivedStateFromProps)&&(Ei(t,e,o,n),i.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(e=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&Si.enqueueReplaceState(i,i.state,null),null!==(o=t.updateQueue)&&(ei(t,o,n,i,r),i.state=t.memoizedState)),"function"==typeof i.componentDidMount&&(t.effectTag|=4)}var ki=Array.isArray;function Ci(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){var r=void 0;(n=n._owner)&&(2!==n.tag&&3!==n.tag&&a("110"),r=n.stateNode),r||a("147",t);var i=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===i?e.ref:((e=function(t){var e=r.refs;e===wi&&(e=r.refs={}),null===t?delete e[i]:e[i]=t})._stringRef=i,e)}"string"!=typeof t&&a("284"),n._owner||a("254",t)}return t}function Oi(t,e){"textarea"!==t.type&&a("31","[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,"")}function Mi(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e,n){return(t=Nr(t,e,n)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.effectTag=2,n):r:(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function u(t,e,n,r){return null===e||8!==e.tag?((e=Vr(n,t.mode,r)).return=t,e):((e=i(e,n,r)).return=t,e)}function c(t,e,n,r){return null!==e&&e.type===n.type?((r=i(e,n.props,r)).ref=Ci(t,e,n),r.return=t,r):((r=Br(n,t.mode,r)).ref=Ci(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||6!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Gr(n,t.mode,r)).return=t,e):((e=i(e,n.children||[],r)).return=t,e)}function f(t,e,n,r,o){return null===e||9!==e.tag?((e=Ur(n,t.mode,r,o)).return=t,e):((e=i(e,n,r)).return=t,e)}function h(t,e,n){if("string"==typeof e||"number"==typeof e)return(e=Vr(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case Yt:return(n=Br(e,t.mode,n)).ref=Ci(t,null,e),n.return=t,n;case Kt:return(e=Gr(e,t.mode,n)).return=t,e}if(ki(e)||ae(e))return(e=Ur(e,t.mode,n,null)).return=t,e;Oi(t,e)}return null}function p(t,e,n,r){var i=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:u(t,e,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Yt:return n.key===i?n.type===Jt?f(t,e,n.props.children,r,i):c(t,e,n,r):null;case Kt:return n.key===i?l(t,e,n,r):null}if(ki(n)||ae(n))return null!==i?null:f(t,e,n,r,null);Oi(t,n)}return null}function d(t,e,n,r,i){if("string"==typeof r||"number"==typeof r)return u(e,t=t.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Yt:return t=t.get(null===r.key?n:r.key)||null,r.type===Jt?f(e,t,r.props.children,i,r.key):c(e,t,r,i);case Kt:return l(e,t=t.get(null===r.key?n:r.key)||null,r,i)}if(ki(r)||ae(r))return f(e,t=t.get(n)||null,r,i,null);Oi(e,r)}return null}function v(i,a,s,u){for(var c=null,l=null,f=a,v=a=0,g=null;null!==f&&v<s.length;v++){f.index>v?(g=f,f=null):g=f.sibling;var m=p(i,f,s[v],u);if(null===m){null===f&&(f=g);break}t&&f&&null===m.alternate&&e(i,f),a=o(m,a,v),null===l?c=m:l.sibling=m,l=m,f=g}if(v===s.length)return n(i,f),c;if(null===f){for(;v<s.length;v++)(f=h(i,s[v],u))&&(a=o(f,a,v),null===l?c=f:l.sibling=f,l=f);return c}for(f=r(i,f);v<s.length;v++)(g=d(f,i,v,s[v],u))&&(t&&null!==g.alternate&&f.delete(null===g.key?v:g.key),a=o(g,a,v),null===l?c=g:l.sibling=g,l=g);return t&&f.forEach(function(t){return e(i,t)}),c}function g(i,s,u,c){var l=ae(u);"function"!=typeof l&&a("150"),null==(u=l.call(u))&&a("151");for(var f=l=null,v=s,g=s=0,m=null,y=u.next();null!==v&&!y.done;g++,y=u.next()){v.index>g?(m=v,v=null):m=v.sibling;var _=p(i,v,y.value,c);if(null===_){v||(v=m);break}t&&v&&null===_.alternate&&e(i,v),s=o(_,s,g),null===f?l=_:f.sibling=_,f=_,v=m}if(y.done)return n(i,v),l;if(null===v){for(;!y.done;g++,y=u.next())null!==(y=h(i,y.value,c))&&(s=o(y,s,g),null===f?l=y:f.sibling=y,f=y);return l}for(v=r(i,v);!y.done;g++,y=u.next())null!==(y=d(v,i,g,y.value,c))&&(t&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=o(y,s,g),null===f?l=y:f.sibling=y,f=y);return t&&v.forEach(function(t){return e(i,t)}),l}return function(t,r,o,u){var c="object"==typeof o&&null!==o&&o.type===Jt&&null===o.key;c&&(o=o.props.children);var l="object"==typeof o&&null!==o;if(l)switch(o.$$typeof){case Yt:t:{for(l=o.key,c=r;null!==c;){if(c.key===l){if(9===c.tag?o.type===Jt:c.type===o.type){n(t,c.sibling),(r=i(c,o.type===Jt?o.props.children:o.props,u)).ref=Ci(t,c,o),r.return=t,t=r;break t}n(t,c);break}e(t,c),c=c.sibling}o.type===Jt?((r=Ur(o.props.children,t.mode,u,o.key)).return=t,t=r):((u=Br(o,t.mode,u)).ref=Ci(t,r,o),u.return=t,t=u)}return s(t);case Kt:t:{for(c=o.key;null!==r;){if(r.key===c){if(6===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(t,r.sibling),(r=i(r,o.children||[],u)).return=t,t=r;break t}n(t,r);break}e(t,r),r=r.sibling}(r=Gr(o,t.mode,u)).return=t,t=r}return s(t)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&8===r.tag?(n(t,r.sibling),(r=i(r,o,u)).return=t,t=r):(n(t,r),(r=Vr(o,t.mode,u)).return=t,t=r),s(t);if(ki(o))return v(t,r,o,u);if(ae(o))return g(t,r,o,u);if(l&&Oi(t,o),void 0===o&&!c)switch(t.tag){case 2:case 3:case 0:a("152",(u=t.type).displayName||u.name||"Component")}return n(t,r)}}var Ii=Mi(!0),Li=Mi(!1),Ri=null,ji=null,zi=!1;function Di(t,e){var n=new Dr(7,null,null,0);n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function Fi(t,e){switch(t.tag){case 7:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 8:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);default:return!1}}function Ni(t){if(zi){var e=ji;if(e){var n=e;if(!Fi(t,e)){if(!(e=gr(n))||!Fi(t,e))return t.effectTag|=2,zi=!1,void(Ri=t);Di(Ri,n)}Ri=t,ji=mr(e)}else t.effectTag|=2,zi=!1,Ri=t}}function Bi(t){for(t=t.return;null!==t&&7!==t.tag&&5!==t.tag;)t=t.return;Ri=t}function Ui(t){if(t!==Ri)return!1;if(!zi)return Bi(t),zi=!0,!1;var e=t.type;if(7!==t.tag||"head"!==e&&"body"!==e&&!vr(e,t.memoizedProps))for(e=ji;e;)Di(t,e),e=gr(e);return Bi(t),ji=Ri?gr(t.stateNode):null,!0}function Vi(){ji=Ri=null,zi=!1}var Gi=Zt.ReactCurrentOwner;function qi(t,e,n,r){e.child=null===t?Li(e,null,n,r):Ii(e,t.child,n,r)}function Wi(t,e,n,r,i){n=n.render;var o=e.ref;return Sr.current||e.memoizedProps!==r||o!==(null!==t?t.ref:null)?(qi(t,e,n=n(r,o),i),e.memoizedProps=r,e.child):Qi(t,e,i)}function Zi(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function Xi(t,e,n,r,i){var o=Ar(n)?Pr:Er.current;return o=Tr(e,o),fi(e),n=n(r,o),e.effectTag|=1,qi(t,e,n,i),e.memoizedProps=r,e.child}function Hi(t,e,n,r,i){if(Ar(n)){var o=!0;Ir(e)}else o=!1;if(fi(e),null===t)if(null===e.stateNode){var a=Ar(n)?Pr:Er.current,s=n.contextTypes,u=null!==s&&void 0!==s,c=new n(r,s=u?Tr(e,a):wr);e.memoizedState=null!==c.state&&void 0!==c.state?c.state:null,c.updater=Si,e.stateNode=c,c._reactInternalFiber=e,u&&((u=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,u.__reactInternalMemoizedMaskedChildContext=s),Ai(e,n,r,i),r=!0}else{a=e.stateNode,s=e.memoizedProps,a.props=s;var l=a.context;u=Tr(e,u=Ar(n)?Pr:Er.current);var f=n.getDerivedStateFromProps;(c="function"==typeof f||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Ti(e,a,r,u),Zr=!1;var h=e.memoizedState;l=a.state=h;var p=e.updateQueue;null!==p&&(ei(e,p,r,a,i),l=e.memoizedState),s!==r||h!==l||Sr.current||Zr?("function"==typeof f&&(Ei(e,n,f,r),l=e.memoizedState),(s=Zr||Pi(e,n,s,r,h,l,u))?(c||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(e.effectTag|=4)):("function"==typeof a.componentDidMount&&(e.effectTag|=4),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"==typeof a.componentDidMount&&(e.effectTag|=4),r=!1)}else a=e.stateNode,s=e.memoizedProps,a.props=s,l=a.context,u=Tr(e,u=Ar(n)?Pr:Er.current),(c="function"==typeof(f=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Ti(e,a,r,u),Zr=!1,l=e.memoizedState,h=a.state=l,null!==(p=e.updateQueue)&&(ei(e,p,r,a,i),h=e.memoizedState),s!==r||l!==h||Sr.current||Zr?("function"==typeof f&&(Ei(e,n,f,r),h=e.memoizedState),(f=Zr||Pi(e,n,s,r,l,h,u))?(c||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,h,u),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,h,u)),"function"==typeof a.componentDidUpdate&&(e.effectTag|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(e.effectTag|=256)):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=u,r=f):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),r=!1);return Yi(t,e,n,r,o,i)}function Yi(t,e,n,r,i,o){Zi(t,e);var a=0!=(64&e.effectTag);if(!r&&!a)return i&&Lr(e,n,!1),Qi(t,e,o);r=e.stateNode,Gi.current=e;var s=a?null:r.render();return e.effectTag|=1,null!==t&&a&&(qi(t,e,null,o),e.child=null),qi(t,e,s,o),e.memoizedState=r.state,e.memoizedProps=r.props,i&&Lr(e,n,!0),e.child}function Ki(t){var e=t.stateNode;e.pendingContext?Or(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Or(0,e.context,!1),yi(t,e.containerInfo)}function Ji(t,e){if(t&&t.defaultProps)for(var n in e=i({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}function Qi(t,e,n){null!==t&&(e.firstContextDependency=t.firstContextDependency);var r=e.childExpirationTime;if(0===r||r>n)return null;if(null!==t&&e.child!==t.child&&a("153"),null!==e.child){for(n=Nr(t=e.child,t.pendingProps,t.expirationTime),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Nr(t,t.pendingProps,t.expirationTime)).return=e;n.sibling=null}return e.child}function $i(t,e,n){var r=e.expirationTime;if(!Sr.current&&(0===r||r>n)){switch(e.tag){case 5:Ki(e),Vi();break;case 7:bi(e);break;case 2:Ar(e.type)&&Ir(e);break;case 3:Ar(e.type._reactResult)&&Ir(e);break;case 6:yi(e,e.stateNode.containerInfo);break;case 12:ci(e,e.memoizedProps.value)}return Qi(t,e,n)}switch(e.expirationTime=0,e.tag){case 4:return function(t,e,n,r){null!==t&&a("155");var i=e.pendingProps;if("object"==typeof n&&null!==n&&"function"==typeof n.then){var o=n=function(t){switch(t._reactStatus){case 1:return t._reactResult;case 2:throw t._reactResult;case 0:throw t;default:throw t._reactStatus=0,t.then(function(e){if(0===t._reactStatus){if(t._reactStatus=1,"object"==typeof e&&null!==e){var n=e.default;e=void 0!==n&&null!==n?n:e}t._reactResult=e}},function(e){0===t._reactStatus&&(t._reactStatus=2,t._reactResult=e)}),t}}(n);o="function"==typeof o?Fr(o)?3:1:void 0!==o&&null!==o&&o.$$typeof?14:4,o=e.tag=o;var s=Ji(n,i);switch(o){case 1:return Xi(t,e,n,s,r);case 3:return Hi(t,e,n,s,r);case 14:return Wi(t,e,n,s,r);default:a("283",n)}}if(o=Tr(e,Er.current),fi(e),o=n(i,o),e.effectTag|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){e.tag=2,Ar(n)?(s=!0,Ir(e)):s=!1,e.memoizedState=null!==o.state&&void 0!==o.state?o.state:null;var u=n.getDerivedStateFromProps;return"function"==typeof u&&Ei(e,n,u,i),o.updater=Si,e.stateNode=o,o._reactInternalFiber=e,Ai(e,n,i,r),Yi(t,e,n,!0,s,r)}return e.tag=0,qi(t,e,o,r),e.memoizedProps=i,e.child}(t,e,e.type,n);case 0:return Xi(t,e,e.type,e.pendingProps,n);case 1:var i=e.type._reactResult;return t=Xi(t,e,i,Ji(i,r=e.pendingProps),n),e.memoizedProps=r,t;case 2:return Hi(t,e,e.type,e.pendingProps,n);case 3:return t=Hi(t,e,i=e.type._reactResult,Ji(i,r=e.pendingProps),n),e.memoizedProps=r,t;case 5:return Ki(e),null===(r=e.updateQueue)&&a("282"),i=null!==(i=e.memoizedState)?i.element:null,ei(e,r,e.pendingProps,null,n),(r=e.memoizedState.element)===i?(Vi(),e=Qi(t,e,n)):(i=e.stateNode,(i=(null===t||null===t.child)&&i.hydrate)&&(ji=mr(e.stateNode.containerInfo),Ri=e,i=zi=!0),i?(e.effectTag|=2,e.child=Li(e,null,r,n)):(qi(t,e,r,n),Vi()),e=e.child),e;case 7:bi(e),null===t&&Ni(e),r=e.type,i=e.pendingProps;var o=null!==t?t.memoizedProps:null,s=i.children;return vr(r,i)?s=null:null!==o&&vr(r,o)&&(e.effectTag|=16),Zi(t,e),1073741823!==n&&1&e.mode&&i.hidden?(e.expirationTime=1073741823,e.memoizedProps=i,e=null):(qi(t,e,s,n),e.memoizedProps=i,e=e.child),e;case 8:return null===t&&Ni(e),e.memoizedProps=e.pendingProps,null;case 16:return null;case 6:return yi(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=Ii(e,null,r,n):qi(t,e,r,n),e.memoizedProps=r,e.child;case 13:return Wi(t,e,e.type,e.pendingProps,n);case 14:return t=Wi(t,e,i=e.type._reactResult,Ji(i,r=e.pendingProps),n),e.memoizedProps=r,t;case 9:return qi(t,e,r=e.pendingProps,n),e.memoizedProps=r,e.child;case 10:return qi(t,e,r=e.pendingProps.children,n),e.memoizedProps=r,e.child;case 15:return qi(t,e,(r=e.pendingProps).children,n),e.memoizedProps=r,e.child;case 12:t:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,e.memoizedProps=i,ci(e,o),null!==s){var u=s.value;if(0===(o=u===o&&(0!==u||1/u==1/o)||u!=u&&o!=o?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(u,o):1073741823))){if(s.children===i.children&&!Sr.current){e=Qi(t,e,n);break t}}else for(null!==(s=e.child)&&(s.return=e);null!==s;){if(null!==(u=s.firstContextDependency))do{if(u.context===r&&0!=(u.observedBits&o)){if(2===s.tag||3===s.tag){var c=Yr(n);c.tag=2,Jr(s,c)}(0===s.expirationTime||s.expirationTime>n)&&(s.expirationTime=n),null!==(c=s.alternate)&&(0===c.expirationTime||c.expirationTime>n)&&(c.expirationTime=n);for(var l=s.return;null!==l;){if(c=l.alternate,0===l.childExpirationTime||l.childExpirationTime>n)l.childExpirationTime=n,null!==c&&(0===c.childExpirationTime||c.childExpirationTime>n)&&(c.childExpirationTime=n);else{if(null===c||!(0===c.childExpirationTime||c.childExpirationTime>n))break;c.childExpirationTime=n}l=l.return}}c=s.child,u=u.next}while(null!==u);else c=12===s.tag&&s.type===e.type?null:s.child;if(null!==c)c.return=s;else for(c=s;null!==c;){if(c===e){c=null;break}if(null!==(s=c.sibling)){s.return=c.return,c=s;break}c=c.return}s=c}}qi(t,e,i.children,n),e=e.child}return e;case 11:return o=e.type,i=(r=e.pendingProps).children,fi(e),i=i(o=hi(o,r.unstable_observedBits)),e.effectTag|=1,qi(t,e,i,n),e.memoizedProps=r,e.child;default:a("156")}}function to(t){t.effectTag|=4}var eo=void 0,no=void 0,ro=void 0;function io(t,e){var n=e.source,r=e.stack;null===r&&null!==n&&(r=ue(n)),null!==n&&se(n.type),e=e.value,null!==t&&2===t.tag&&se(t.type);try{console.error(e)}catch(t){setTimeout(function(){throw t})}}function oo(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Mo(t,e)}else e.current=null}function ao(t){switch("function"==typeof jr&&jr(t),t.tag){case 2:case 3:oo(t);var e=t.stateNode;if("function"==typeof e.componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Mo(t,e)}break;case 7:oo(t);break;case 6:co(t)}}function so(t){return 7===t.tag||5===t.tag||6===t.tag}function uo(t){t:{for(var e=t.return;null!==e;){if(so(e)){var n=e;break t}e=e.return}a("160"),n=void 0}var r=e=void 0;switch(n.tag){case 7:e=n.stateNode,r=!1;break;case 5:case 6:e=n.stateNode.containerInfo,r=!0;break;default:a("161")}16&n.effectTag&&(rr(e,""),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||so(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;7!==n.tag&&8!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||6===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}for(var i=t;;){if(7===i.tag||8===i.tag)if(n)if(r){var o=e,s=i.stateNode,u=n;8===o.nodeType?o.parentNode.insertBefore(s,u):o.insertBefore(s,u)}else e.insertBefore(i.stateNode,n);else r?(o=e,s=i.stateNode,8===o.nodeType?(u=o.parentNode).insertBefore(s,o):(u=o).appendChild(s),null===u.onclick&&(u.onclick=fr)):e.appendChild(i.stateNode);else if(6!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function co(t){for(var e=t,n=!1,r=void 0,i=void 0;;){if(!n){n=e.return;t:for(;;){switch(null===n&&a("160"),n.tag){case 7:r=n.stateNode,i=!1;break t;case 5:case 6:r=n.stateNode.containerInfo,i=!0;break t}n=n.return}n=!0}if(7===e.tag||8===e.tag){t:for(var o=e,s=o;;)if(ao(s),null!==s.child&&6!==s.tag)s.child.return=s,s=s.child;else{if(s===o)break;for(;null===s.sibling;){if(null===s.return||s.return===o)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}i?(o=r,s=e.stateNode,8===o.nodeType?o.parentNode.removeChild(s):o.removeChild(s)):r.removeChild(e.stateNode)}else if(6===e.tag?(r=e.stateNode.containerInfo,i=!0):ao(e),null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return;6===(e=e.return).tag&&(n=!1)}e.sibling.return=e.return,e=e.sibling}}function lo(t,e){switch(e.tag){case 2:case 3:break;case 7:var n=e.stateNode;if(null!=n){var r=e.memoizedProps,i=null!==t?t.memoizedProps:r;t=e.type;var o=e.updateQueue;if(e.updateQueue=null,null!==o){for(n[z]=r,"input"===t&&"radio"===r.type&&null!=r.name&&xe(n,r),cr(t,i),e=cr(t,r),i=0;i<o.length;i+=2){var s=o[i],u=o[i+1];"style"===s?ar(n,u):"dangerouslySetInnerHTML"===s?nr(n,u):"children"===s?rr(n,u):me(n,s,u,e)}switch(t){case"input":we(n,r);break;case"textarea":Kn(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?Xn(n,!!r.multiple,o,!1):t!==!!r.multiple&&(null!=r.defaultValue?Xn(n,!!r.multiple,r.defaultValue,!0):Xn(n,!!r.multiple,r.multiple?[]:"",!1))}}}break;case 8:null===e.stateNode&&a("162"),e.stateNode.nodeValue=e.memoizedProps;break;case 5:case 15:case 16:break;default:a("163")}}function fo(t,e,n){(n=Yr(n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){pa(r),io(t,e)},n}function ho(t,e,n){(n=Yr(n)).tag=3;var r=t.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(n.callback=function(){null===To?To=new Set([this]):To.add(this);var n=e.value,r=e.stack;io(t,e),this.componentDidCatch(n,{componentStack:null!==r?r:""})}),n}function po(t){switch(t.tag){case 2:Ar(t.type)&&kr();var e=t.effectTag;return 1024&e?(t.effectTag=-1025&e|64,t):null;case 3:return Ar(t.type._reactResult)&&kr(),1024&(e=t.effectTag)?(t.effectTag=-1025&e|64,t):null;case 5:return _i(),Cr(),0!=(64&(e=t.effectTag))&&a("285"),t.effectTag=-1025&e|64,t;case 7:return xi(t),null;case 16:return 1024&(e=t.effectTag)?(t.effectTag=-1025&e|64,t):null;case 6:return _i(),null;case 12:return li(t),null;default:return null}}eo=function(){},no=function(t,e,n,r,o){var a=t.memoizedProps;if(a!==r){var s=e.stateNode;switch(mi(di.current),t=null,n){case"input":a=_e(s,a),r=_e(s,r),t=[];break;case"option":a=Zn(s,a),r=Zn(s,r),t=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),t=[];break;case"textarea":a=Hn(s,a),r=Hn(s,r),t=[];break;default:"function"!=typeof a.onClick&&"function"==typeof r.onClick&&(s.onclick=fr)}ur(n,r),s=n=void 0;var u=null;for(n in a)if(!r.hasOwnProperty(n)&&a.hasOwnProperty(n)&&null!=a[n])if("style"===n){var c=a[n];for(s in c)c.hasOwnProperty(s)&&(u||(u={}),u[s]="")}else"dangerouslySetInnerHTML"!==n&&"children"!==n&&"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(_.hasOwnProperty(n)?t||(t=[]):(t=t||[]).push(n,null));for(n in r){var l=r[n];if(c=null!=a?a[n]:void 0,r.hasOwnProperty(n)&&l!==c&&(null!=l||null!=c))if("style"===n)if(c){for(s in c)!c.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(u||(u={}),u[s]="");for(s in l)l.hasOwnProperty(s)&&c[s]!==l[s]&&(u||(u={}),u[s]=l[s])}else u||(t||(t=[]),t.push(n,u)),u=l;else"dangerouslySetInnerHTML"===n?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(t=t||[]).push(n,""+l)):"children"===n?c===l||"string"!=typeof l&&"number"!=typeof l||(t=t||[]).push(n,""+l):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&(_.hasOwnProperty(n)?(null!=l&&lr(o,n),t||c===l||(t=[])):(t=t||[]).push(n,l))}u&&(t=t||[]).push("style",u),o=t,(e.updateQueue=o)&&to(e)}},ro=function(t,e,n,r){n!==r&&to(e)};var vo={readContext:hi},go=Zt.ReactCurrentOwner,mo=0,yo=0,_o=!1,bo=null,xo=null,wo=0,Eo=!1,So=null,Po=!1,To=null;function Ao(){if(null!==bo)for(var t=bo.return;null!==t;){var e=t;switch(e.tag){case 2:var n=e.type.childContextTypes;null!==n&&void 0!==n&&kr();break;case 3:null!==(n=e.type._reactResult.childContextTypes)&&void 0!==n&&kr();break;case 5:_i(),Cr();break;case 7:xi(e);break;case 6:_i();break;case 12:li(e)}t=t.return}xo=null,wo=0,Eo=!1,bo=null}function ko(t){for(;;){var e=t.alternate,n=t.return,r=t.sibling;if(0==(512&t.effectTag)){var o=e,s=(e=t).pendingProps;switch(e.tag){case 0:case 1:break;case 2:Ar(e.type)&&kr();break;case 3:Ar(e.type._reactResult)&&kr();break;case 5:_i(),Cr(),(s=e.stateNode).pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==o&&null!==o.child||(Ui(e),e.effectTag&=-3),eo(e);break;case 7:xi(e);var u=mi(gi.current),c=e.type;if(null!==o&&null!=e.stateNode)no(o,e,c,s,u),o.ref!==e.ref&&(e.effectTag|=128);else if(s){var l=mi(di.current);if(Ui(e)){o=(s=e).stateNode;var f=s.type,h=s.memoizedProps,p=u;switch(o[j]=s,o[z]=h,c=void 0,u=f){case"iframe":case"object":Pn("load",o);break;case"video":case"audio":for(f=0;f<rt.length;f++)Pn(rt[f],o);break;case"source":Pn("error",o);break;case"img":case"image":case"link":Pn("error",o),Pn("load",o);break;case"form":Pn("reset",o),Pn("submit",o);break;case"details":Pn("toggle",o);break;case"input":be(o,h),Pn("invalid",o),lr(p,"onChange");break;case"select":o._wrapperState={wasMultiple:!!h.multiple},Pn("invalid",o),lr(p,"onChange");break;case"textarea":Yn(o,h),Pn("invalid",o),lr(p,"onChange")}for(c in ur(u,h),f=null,h)h.hasOwnProperty(c)&&(l=h[c],"children"===c?"string"==typeof l?o.textContent!==l&&(f=["children",l]):"number"==typeof l&&o.textContent!==""+l&&(f=["children",""+l]):_.hasOwnProperty(c)&&null!=l&&lr(p,c));switch(u){case"input":qt(o),Ee(o,h,!0);break;case"textarea":qt(o),Jn(o);break;case"select":case"option":break;default:"function"==typeof h.onClick&&(o.onclick=fr)}c=f,s.updateQueue=c,(s=null!==c)&&to(e)}else{h=e,o=c,p=s,f=9===u.nodeType?u:u.ownerDocument,l===Qn.html&&(l=$n(o)),l===Qn.html?"script"===o?((o=f.createElement("div")).innerHTML="<script><\/script>",f=o.removeChild(o.firstChild)):"string"==typeof p.is?f=f.createElement(o,{is:p.is}):(f=f.createElement(o),"select"===o&&p.multiple&&(f.multiple=!0)):f=f.createElementNS(l,o),(o=f)[j]=h,o[z]=s;t:for(h=o,p=e,f=p.child;null!==f;){if(7===f.tag||8===f.tag)h.appendChild(f.stateNode);else if(6!==f.tag&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===p)break;for(;null===f.sibling;){if(null===f.return||f.return===p)break t;f=f.return}f.sibling.return=f.return,f=f.sibling}p=o;var d=u,v=cr(f=c,h=s);switch(f){case"iframe":case"object":Pn("load",p),u=h;break;case"video":case"audio":for(u=0;u<rt.length;u++)Pn(rt[u],p);u=h;break;case"source":Pn("error",p),u=h;break;case"img":case"image":case"link":Pn("error",p),Pn("load",p),u=h;break;case"form":Pn("reset",p),Pn("submit",p),u=h;break;case"details":Pn("toggle",p),u=h;break;case"input":be(p,h),u=_e(p,h),Pn("invalid",p),lr(d,"onChange");break;case"option":u=Zn(p,h);break;case"select":p._wrapperState={wasMultiple:!!h.multiple},u=i({},h,{value:void 0}),Pn("invalid",p),lr(d,"onChange");break;case"textarea":Yn(p,h),u=Hn(p,h),Pn("invalid",p),lr(d,"onChange");break;default:u=h}ur(f,u),l=void 0;var g=f,m=p,y=u;for(l in y)if(y.hasOwnProperty(l)){var b=y[l];"style"===l?ar(m,b):"dangerouslySetInnerHTML"===l?null!=(b=b?b.__html:void 0)&&nr(m,b):"children"===l?"string"==typeof b?("textarea"!==g||""!==b)&&rr(m,b):"number"==typeof b&&rr(m,""+b):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(_.hasOwnProperty(l)?null!=b&&lr(d,l):null!=b&&me(m,l,b,v))}switch(f){case"input":qt(p),Ee(p,h,!1);break;case"textarea":qt(p),Jn(p);break;case"option":null!=h.value&&p.setAttribute("value",""+ye(h.value));break;case"select":(u=p).multiple=!!h.multiple,null!=(p=h.value)?Xn(u,!!h.multiple,p,!1):null!=h.defaultValue&&Xn(u,!!h.multiple,h.defaultValue,!0);break;default:"function"==typeof u.onClick&&(p.onclick=fr)}(s=dr(c,s))&&to(e),e.stateNode=o}null!==e.ref&&(e.effectTag|=128)}else null===e.stateNode&&a("166");break;case 8:o&&null!=e.stateNode?ro(o,e,o.memoizedProps,s):("string"!=typeof s&&(null===e.stateNode&&a("166")),o=mi(gi.current),mi(di.current),Ui(e)?(c=(s=e).stateNode,o=s.memoizedProps,c[j]=s,(s=c.nodeValue!==o)&&to(e)):(c=e,(s=(9===o.nodeType?o:o.ownerDocument).createTextNode(s))[j]=c,e.stateNode=s));break;case 13:case 14:case 16:case 9:case 10:case 15:break;case 6:_i(),eo(e);break;case 12:li(e);break;case 11:break;case 4:a("167");default:a("156")}if(e=bo=null,s=t,1073741823===wo||1073741823!==s.childExpirationTime){for(c=0,o=s.child;null!==o;)u=o.expirationTime,h=o.childExpirationTime,(0===c||0!==u&&u<c)&&(c=u),(0===c||0!==h&&h<c)&&(c=h),o=o.sibling;s.childExpirationTime=c}if(null!==e)return e;null!==n&&0==(512&n.effectTag)&&(null===n.firstEffect&&(n.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=t.firstEffect),n.lastEffect=t.lastEffect),1<t.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=t:n.firstEffect=t,n.lastEffect=t))}else{if(null!==(t=po(t)))return t.effectTag&=511,t;null!==n&&(n.firstEffect=n.lastEffect=null,n.effectTag|=512)}if(null!==r)return r;if(null===n)break;t=n}return null}function Co(t){var e=$i(t.alternate,t,wo);return null===e&&(e=ko(t)),go.current=null,e}function Oo(t,e,n){_o&&a("243"),_o=!0,go.currentDispatcher=vo;var r=t.nextExpirationTimeToWorkOn;r===wo&&t===xo&&null!==bo||(Ao(),wo=r,bo=Nr((xo=t).current,null,wo),t.pendingCommitExpirationTime=0);for(var i=!1;;){try{if(e)for(;null!==bo&&!ha();)bo=Co(bo);else for(;null!==bo;)bo=Co(bo)}catch(t){if(null===bo)i=!0,pa(t);else{null===bo&&a("271");var o=bo,s=o.return;if(null!==s){t:{var u=s,c=o,l=t;s=wo,c.effectTag|=512,c.firstEffect=c.lastEffect=null,Eo=!0,l=ii(l,c);do{switch(u.tag){case 5:u.effectTag|=1024,u.expirationTime=s,Qr(u,s=fo(u,l,s));break t;case 2:case 3:c=l;var f=u.stateNode;if(0==(64&u.effectTag)&&null!==f&&"function"==typeof f.componentDidCatch&&(null===To||!To.has(f))){u.effectTag|=1024,u.expirationTime=s,Qr(u,s=ho(u,c,s));break t}}u=u.return}while(null!==u)}bo=ko(o);continue}i=!0,pa(t)}}break}if(_o=!1,ui=si=ai=go.currentDispatcher=null,i)xo=null,t.finishedWork=null;else if(null!==bo)t.finishedWork=null;else{if(null===(e=t.current.alternate)&&a("281"),xo=null,Eo){if(i=t.latestPendingTime,o=t.latestSuspendedTime,s=t.latestPingedTime,0!==i&&i>r||0!==o&&o>r||0!==s&&s>r)return t.didError=!1,0!==(n=t.latestPingedTime)&&n<=r&&(t.latestPingedTime=0),n=t.earliestPendingTime,e=t.latestPendingTime,n===r?t.earliestPendingTime=e===r?t.latestPendingTime=0:e:e===r&&(t.latestPendingTime=n),n=t.earliestSuspendedTime,e=t.latestSuspendedTime,0===n?t.earliestSuspendedTime=t.latestSuspendedTime=r:n>r?t.earliestSuspendedTime=r:e<r&&(t.latestSuspendedTime=r),Wr(r,t),void(t.expirationTime=t.expirationTime);if(!t.didError&&!n)return t.didError=!0,t.nextExpirationTimeToWorkOn=r,r=t.expirationTime=1,void(t.expirationTime=r)}t.pendingCommitExpirationTime=r,t.finishedWork=e}}function Mo(t,e){var n;t:{for(_o&&!Po&&a("263"),n=t.return;null!==n;){switch(n.tag){case 2:case 3:var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromCatch||"function"==typeof r.componentDidCatch&&(null===To||!To.has(r))){Jr(n,t=ho(n,t=ii(e,t),1)),Lo(n,1),n=void 0;break t}break;case 5:Jr(n,t=fo(n,t=ii(e,t),1)),Lo(n,1),n=void 0;break t}n=n.return}5===t.tag&&(Jr(t,n=fo(t,n=ii(e,t),1)),Lo(t,1)),n=void 0}return n}function Io(t,e){return 0!==yo?t=yo:_o?t=Po?1:wo:1&e.mode?(t=Yo?2+10*(1+((t-2+15)/10|0)):2+25*(1+((t-2+500)/25|0)),null!==xo&&t===wo&&(t+=1)):t=1,Yo&&(0===Vo||t>Vo)&&(Vo=t),t}function Lo(t,e){t:{(0===t.expirationTime||t.expirationTime>e)&&(t.expirationTime=e);var n=t.alternate;null!==n&&(0===n.expirationTime||n.expirationTime>e)&&(n.expirationTime=e);var r=t.return;if(null===r&&5===t.tag)t=t.stateNode;else{for(;null!==r;){if(n=r.alternate,(0===r.childExpirationTime||r.childExpirationTime>e)&&(r.childExpirationTime=e),null!==n&&(0===n.childExpirationTime||n.childExpirationTime>e)&&(n.childExpirationTime=e),null===r.return&&5===r.tag){t=r.stateNode;break t}r=r.return}t=null}}null!==t&&(!_o&&0!==wo&&e<wo&&Ao(),qr(t,e),_o&&!Po&&xo===t||(e=t,t=t.expirationTime,null===e.nextScheduledRoot?(e.expirationTime=t,null===zo?(jo=zo=e,e.nextScheduledRoot=e):(zo=zo.nextScheduledRoot=e).nextScheduledRoot=jo):(0===(n=e.expirationTime)||t<n)&&(e.expirationTime=t),No||(Xo?Ho&&(Bo=e,Uo=1,la(e,1,!0)):1===t?ca(1,null):oa(e,t))),ea>ta&&(ea=0,a("185")))}function Ro(t,e,n,r,i){var o=yo;yo=1;try{return t(e,n,r,i)}finally{yo=o}}var jo=null,zo=null,Do=0,Fo=void 0,No=!1,Bo=null,Uo=0,Vo=0,Go=!1,qo=!1,Wo=null,Zo=null,Xo=!1,Ho=!1,Yo=!1,Ko=null,Jo=o.unstable_now(),Qo=2+(Jo/10|0),$o=Qo,ta=50,ea=0,na=null,ra=1;function ia(){Qo=2+((o.unstable_now()-Jo)/10|0)}function oa(t,e){if(0!==Do){if(e>Do)return;null!==Fo&&o.unstable_cancelScheduledWork(Fo)}Do=e,t=o.unstable_now()-Jo,Fo=o.unstable_scheduleWork(ua,{timeout:10*(e-2)-t})}function aa(){return No?$o:(sa(),0!==Uo&&1073741823!==Uo||(ia(),$o=Qo),$o)}function sa(){var t=0,e=null;if(null!==zo)for(var n=zo,r=jo;null!==r;){var i=r.expirationTime;if(0===i){if((null===n||null===zo)&&a("244"),r===r.nextScheduledRoot){jo=zo=r.nextScheduledRoot=null;break}if(r===jo)jo=i=r.nextScheduledRoot,zo.nextScheduledRoot=i,r.nextScheduledRoot=null;else{if(r===zo){(zo=n).nextScheduledRoot=jo,r.nextScheduledRoot=null;break}n.nextScheduledRoot=r.nextScheduledRoot,r.nextScheduledRoot=null}r=n.nextScheduledRoot}else{if((0===t||i<t)&&(t=i,e=r),r===zo)break;if(1===t)break;n=r,r=r.nextScheduledRoot}}Bo=e,Uo=t}function ua(t){if(t.didTimeout&&null!==jo){ia();var e=jo;do{var n=e.expirationTime;0!==n&&Qo>=n&&(e.nextExpirationTimeToWorkOn=Qo),e=e.nextScheduledRoot}while(e!==jo)}ca(0,t)}function ca(t,e){if(Zo=e,sa(),null!==Zo)for(ia(),$o=Qo;null!==Bo&&0!==Uo&&(0===t||t>=Uo)&&(!Go||Qo>=Uo);)la(Bo,Uo,Qo>=Uo),sa(),ia(),$o=Qo;else for(;null!==Bo&&0!==Uo&&(0===t||t>=Uo);)la(Bo,Uo,!0),sa();if(null!==Zo&&(Do=0,Fo=null),0!==Uo&&oa(Bo,Uo),Zo=null,Go=!1,ea=0,na=null,null!==Ko)for(t=Ko,Ko=null,e=0;e<t.length;e++){var n=t[e];try{n._onComplete()}catch(t){qo||(qo=!0,Wo=t)}}if(qo)throw t=Wo,Wo=null,qo=!1,t}function la(t,e,n){if(No&&a("245"),No=!0,null===Zo||n){var r=t.finishedWork;null!==r?fa(t,r,e):(t.finishedWork=null,Oo(t,!1,n),null!==(r=t.finishedWork)&&fa(t,r,e))}else null!==(r=t.finishedWork)?fa(t,r,e):(t.finishedWork=null,Oo(t,!0,n),null!==(r=t.finishedWork)&&(ha()?t.finishedWork=r:fa(t,r,e)));No=!1}function fa(t,e,n){var r=t.firstBatch;if(null!==r&&r._expirationTime<=n&&(null===Ko?Ko=[r]:Ko.push(r),r._defer))return t.finishedWork=e,void(t.expirationTime=0);t.finishedWork=null,t===na?ea++:(na=t,ea=0),Po=_o=!0,t.current===e&&a("177"),0===(n=t.pendingCommitExpirationTime)&&a("261"),t.pendingCommitExpirationTime=0,r=e.expirationTime;var i=e.childExpirationTime;if(r=0===r||0!==i&&i<r?i:r,t.didError=!1,0===r?(t.earliestPendingTime=0,t.latestPendingTime=0,t.earliestSuspendedTime=0,t.latestSuspendedTime=0,t.latestPingedTime=0):(0!==(i=t.latestPendingTime)&&(i<r?t.earliestPendingTime=t.latestPendingTime=0:t.earliestPendingTime<r&&(t.earliestPendingTime=t.latestPendingTime)),0===(i=t.earliestSuspendedTime)?qr(t,r):r>t.latestSuspendedTime?(t.earliestSuspendedTime=0,t.latestSuspendedTime=0,t.latestPingedTime=0,qr(t,r)):r<i&&qr(t,r)),Wr(0,t),go.current=null,1<e.effectTag?null!==e.lastEffect?(e.lastEffect.nextEffect=e,r=e.firstEffect):r=e:r=e.firstEffect,hr=Sn,Dn(i=zn())){if("selectionStart"in i)var o={start:i.selectionStart,end:i.selectionEnd};else t:{var s=(o=(o=i.ownerDocument)&&o.defaultView||window).getSelection&&o.getSelection();if(s&&0!==s.rangeCount){o=s.anchorNode;var u=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{o.nodeType,c.nodeType}catch(t){o=null;break t}var l=0,f=-1,h=-1,p=0,d=0,v=i,g=null;e:for(;;){for(var m;v!==o||0!==u&&3!==v.nodeType||(f=l+u),v!==c||0!==s&&3!==v.nodeType||(h=l+s),3===v.nodeType&&(l+=v.nodeValue.length),null!==(m=v.firstChild);)g=v,v=m;for(;;){if(v===i)break e;if(g===o&&++p===u&&(f=l),g===c&&++d===s&&(h=l),null!==(m=v.nextSibling))break;g=(v=g).parentNode}v=m}o=-1===f||-1===h?null:{start:f,end:h}}else o=null}o=o||{start:0,end:0}}else o=null;for(pr={focusedElem:i,selectionRange:o},Sn=!1,So=r;null!==So;){i=!1,o=void 0;try{for(;null!==So;){if(256&So.effectTag){var y=So.alternate;t:switch(u=So,u.tag){case 2:case 3:if(256&u.effectTag&&null!==y){var _=y.memoizedProps,b=y.memoizedState,x=u.stateNode;x.props=u.memoizedProps,x.state=u.memoizedState;var w=x.getSnapshotBeforeUpdate(_,b);x.__reactInternalSnapshotBeforeUpdate=w}break t;case 5:case 7:case 8:case 6:break t;default:a("163")}}So=So.nextEffect}}catch(t){i=!0,o=t}i&&(null===So&&a("178"),Mo(So,o),null!==So&&(So=So.nextEffect))}for(So=r;null!==So;){y=!1,_=void 0;try{for(;null!==So;){var E=So.effectTag;if(16&E&&rr(So.stateNode,""),128&E){var S=So.alternate;if(null!==S){var P=S.ref;null!==P&&("function"==typeof P?P(null):P.current=null)}}switch(14&E){case 2:uo(So),So.effectTag&=-3;break;case 6:uo(So),So.effectTag&=-3,lo(So.alternate,So);break;case 4:lo(So.alternate,So);break;case 8:co(b=So),b.return=null,b.child=null,b.alternate&&(b.alternate.child=null,b.alternate.return=null)}So=So.nextEffect}}catch(t){y=!0,_=t}y&&(null===So&&a("178"),Mo(So,_),null!==So&&(So=So.nextEffect))}if(P=pr,S=zn(),E=P.focusedElem,_=P.selectionRange,S!==E&&E&&E.ownerDocument&&function t(e,n){return!(!e||!n)&&(e===n||(!e||3!==e.nodeType)&&(n&&3===n.nodeType?t(e,n.parentNode):"contains"in e?e.contains(n):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(n))))}(E.ownerDocument.documentElement,E)){null!==_&&Dn(E)&&(S=_.start,void 0===(P=_.end)&&(P=S),"selectionStart"in E?(E.selectionStart=S,E.selectionEnd=Math.min(P,E.value.length)):(S=((y=E.ownerDocument||document)&&y.defaultView||window).getSelection(),b=E.textContent.length,P=Math.min(_.start,b),_=void 0===_.end?P:Math.min(_.end,b),!S.extend&&P>_&&(b=_,_=P,P=b),b=jn(E,P),x=jn(E,_),b&&x&&(1!==S.rangeCount||S.anchorNode!==b.node||S.anchorOffset!==b.offset||S.focusNode!==x.node||S.focusOffset!==x.offset)&&((y=y.createRange()).setStart(b.node,b.offset),S.removeAllRanges(),P>_?(S.addRange(y),S.extend(x.node,x.offset)):(y.setEnd(x.node,x.offset),S.addRange(y))))),S=[];for(P=E;P=P.parentNode;)1===P.nodeType&&S.push({element:P,left:P.scrollLeft,top:P.scrollTop});for("function"==typeof E.focus&&E.focus(),E=0;E<S.length;E++)(P=S[E]).element.scrollLeft=P.left,P.element.scrollTop=P.top}for(pr=null,Sn=!!hr,hr=null,t.current=e,So=r;null!==So;){r=!1,E=void 0;try{for(S=n;null!==So;){var T=So.effectTag;if(36&T){var A=So.alternate;switch(y=S,(P=So).tag){case 2:case 3:var k=P.stateNode;if(4&P.effectTag)if(null===A)k.props=P.memoizedProps,k.state=P.memoizedState,k.componentDidMount();else{var C=A.memoizedProps,O=A.memoizedState;k.props=P.memoizedProps,k.state=P.memoizedState,k.componentDidUpdate(C,O,k.__reactInternalSnapshotBeforeUpdate)}var M=P.updateQueue;null!==M&&(k.props=P.memoizedProps,k.state=P.memoizedState,ni(0,M,k));break;case 5:var I=P.updateQueue;if(null!==I){if(_=null,null!==P.child)switch(P.child.tag){case 7:_=P.child.stateNode;break;case 2:case 3:_=P.child.stateNode}ni(0,I,_)}break;case 7:var L=P.stateNode;null===A&&4&P.effectTag&&dr(P.type,P.memoizedProps)&&L.focus();break;case 8:case 6:case 15:case 16:break;default:a("163")}}if(128&T){var R=So.ref;if(null!==R){var j=So.stateNode;switch(So.tag){case 7:var z=j;break;default:z=j}"function"==typeof R?R(z):R.current=z}}var D=So.nextEffect;So.nextEffect=null,So=D}}catch(t){r=!0,E=t}r&&(null===So&&a("178"),Mo(So,E),null!==So&&(So=So.nextEffect))}_o=Po=!1,"function"==typeof Rr&&Rr(e.stateNode),T=e.expirationTime,e=e.childExpirationTime,0===(e=0===T||0!==e&&e<T?e:T)&&(To=null),t.expirationTime=e,t.finishedWork=null}function ha(){return!!Go||!(null===Zo||Zo.timeRemaining()>ra)&&(Go=!0)}function pa(t){null===Bo&&a("246"),Bo.expirationTime=0,qo||(qo=!0,Wo=t)}function da(t,e){var n=Xo;Xo=!0;try{return t(e)}finally{(Xo=n)||No||ca(1,null)}}function va(t,e){if(Xo&&!Ho){Ho=!0;try{return t(e)}finally{Ho=!1}}return t(e)}function ga(t,e,n){if(Yo)return t(e,n);Xo||No||0===Vo||(ca(Vo,null),Vo=0);var r=Yo,i=Xo;Xo=Yo=!0;try{return t(e,n)}finally{Yo=r,(Xo=i)||No||ca(1,null)}}function ma(t,e,n,r,i){var o=e.current;return n=function(t){if(!t)return wr;t=t._reactInternalFiber;t:{(2!==en(t)||2!==t.tag&&3!==t.tag)&&a("170");var e=t;do{switch(e.tag){case 5:e=e.stateNode.context;break t;case 2:if(Ar(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}break;case 3:if(Ar(e.type._reactResult)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);a("171"),e=void 0}if(2===t.tag){var n=t.type;if(Ar(n))return Mr(t,n,e)}else if(3===t.tag&&Ar(n=t.type._reactResult))return Mr(t,n,e);return e}(n),null===e.context?e.context=n:e.pendingContext=n,e=i,(i=Yr(r)).payload={element:t},null!==(e=void 0===e?null:e)&&(i.callback=e),Jr(o,i),Lo(o,r),r}function ya(t,e,n,r){var i=e.current;return ma(t,e,n,i=Io(aa(),i),r)}function _a(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 7:default:return t.child.stateNode}}function ba(t){var e=2+25*(1+((aa()-2+500)/25|0));e<=mo&&(e=mo+1),this._expirationTime=mo=e,this._root=t,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function xa(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function wa(t,e,n){t={current:e=new Dr(5,null,null,e?3:0),containerInfo:t,pendingChildren:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:-1,context:null,pendingContext:null,hydrate:n,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null},this._internalRoot=e.stateNode=t}function Ea(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Sa(t,e,n,r,i){Ea(n)||a("200");var o=n._reactRootContainer;if(o){if("function"==typeof i){var s=i;i=function(){var t=_a(o._internalRoot);s.call(t)}}null!=t?o.legacy_renderSubtreeIntoContainer(t,e,i):o.render(e,i)}else{if(o=n._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new wa(t,!1,e)}(n,r),"function"==typeof i){var u=i;i=function(){var t=_a(o._internalRoot);u.call(t)}}va(function(){null!=t?o.legacy_renderSubtreeIntoContainer(t,e,i):o.render(e,i)})}return _a(o._internalRoot)}function Pa(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Ea(e)||a("200"),function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Kt,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)}kt=function(t,e,n){switch(e){case"input":if(we(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=B(r);i||a("90"),Wt(r),we(r,i)}}}break;case"textarea":Kn(t,n);break;case"select":null!=(e=n.value)&&Xn(t,!!n.multiple,e,!1)}},ba.prototype.render=function(t){this._defer||a("250"),this._hasChildren=!0,this._children=t;var e=this._root._internalRoot,n=this._expirationTime,r=new xa;return ma(t,e,null,n,r._onCommit),r},ba.prototype.then=function(t){if(this._didComplete)t();else{var e=this._callbacks;null===e&&(e=this._callbacks=[]),e.push(t)}},ba.prototype.commit=function(){var t=this._root._internalRoot,e=t.firstBatch;if(this._defer&&null!==e||a("251"),this._hasChildren){var n=this._expirationTime;if(e!==this){this._hasChildren&&(n=this._expirationTime=e._expirationTime,this.render(this._children));for(var r=null,i=e;i!==this;)r=i,i=i._next;null===r&&a("251"),r._next=i._next,this._next=e,t.firstBatch=this}this._defer=!1,e=n,No&&a("253"),Bo=t,Uo=e,la(t,e,!0),ca(1,null),e=this._next,this._next=null,null!==(e=t.firstBatch=e)&&e._hasChildren&&e.render(e._children)}else this._next=null,this._defer=!1},ba.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var t=this._callbacks;if(null!==t)for(var e=0;e<t.length;e++)(0,t[e])()}},xa.prototype.then=function(t){if(this._didCommit)t();else{var e=this._callbacks;null===e&&(e=this._callbacks=[]),e.push(t)}},xa.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var t=this._callbacks;if(null!==t)for(var e=0;e<t.length;e++){var n=t[e];"function"!=typeof n&&a("191",n),n()}}},wa.prototype.render=function(t,e){var n=this._internalRoot,r=new xa;return null!==(e=void 0===e?null:e)&&r.then(e),ya(t,n,null,r._onCommit),r},wa.prototype.unmount=function(t){var e=this._internalRoot,n=new xa;return null!==(t=void 0===t?null:t)&&n.then(t),ya(null,e,null,n._onCommit),n},wa.prototype.legacy_renderSubtreeIntoContainer=function(t,e,n){var r=this._internalRoot,i=new xa;return null!==(n=void 0===n?null:n)&&i.then(n),ya(e,r,t,i._onCommit),i},wa.prototype.createBatch=function(){var t=new ba(this),e=t._expirationTime,n=this._internalRoot,r=n.firstBatch;if(null===r)n.firstBatch=t,t._next=null;else{for(n=null;null!==r&&r._expirationTime<=e;)n=r,r=r._next;t._next=r,null!==n&&(n._next=t)}return t},Rt=da,jt=ga,zt=function(){No||0===Vo||(ca(Vo,null),Vo=0)};var Ta={createPortal:Pa,findDOMNode:function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;return void 0===e&&("function"==typeof t.render?a("188"):a("268",Object.keys(t))),t=null===(t=rn(e))?null:t.stateNode},hydrate:function(t,e,n){return Sa(null,t,e,!0,n)},render:function(t,e,n){return Sa(null,t,e,!1,n)},unstable_renderSubtreeIntoContainer:function(t,e,n,r){return(null==t||void 0===t._reactInternalFiber)&&a("38"),Sa(t,e,n,!1,r)},unmountComponentAtNode:function(t){return Ea(t)||a("40"),!!t._reactRootContainer&&(va(function(){Sa(null,null,t,!1,function(){t._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return Pa.apply(void 0,arguments)},unstable_batchedUpdates:da,unstable_interactiveUpdates:ga,flushSync:function(t,e){No&&a("187");var n=Xo;Xo=!0;try{return Ro(t,e)}finally{Xo=n,ca(1,null)}},unstable_flushControlled:function(t){var e=Xo;Xo=!0;try{Ro(t)}finally{(Xo=e)||No||ca(1,null)}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[F,N,B,M.injectEventPluginsByName,y,Z,function(t){T(t,W)},It,Lt,kn,L]},unstable_createRoot:function(t,e){return Ea(t)||a("278"),new wa(t,!0,null!=e&&!0===e.hydrate)}};!function(t){var e=t.findFiberByHostInstance;(function(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);Rr=zr(function(t){return e.onCommitFiberRoot(n,t)}),jr=zr(function(t){return e.onCommitFiberUnmount(n,t)})}catch(t){}})(i({},t,{findHostInstanceByFiber:function(t){return null===(t=rn(t))?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null}}))}({findFiberByHostInstance:D,bundleType:0,version:"16.5.2",rendererPackageName:"react-dom"});var Aa={default:Ta},ka=Aa&&Ta||Aa;t.exports=ka.default||ka},function(t,e,n){"use strict";t.exports=n(479)},function(t,e,n){"use strict";
/** @license React v16.5.2
 * schedule.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(e,"__esModule",{value:!0});var r=null,i=!1,o=!1,a="object"==typeof performance&&"function"==typeof performance.now,s={timeRemaining:a?function(){var t=v()-performance.now();return 0<t?t:0}:function(){var t=v()-Date.now();return 0<t?t:0},didTimeout:!1};function u(){if(!i){var t=r.timesOutAt;o?d():o=!0,p(l,t)}}function c(){var t=r,e=r.next;if(r===e)r=null;else{var n=r.previous;r=n.next=e,e.previous=n}t.next=t.previous=null,(t=t.callback)(s)}function l(t){i=!0,s.didTimeout=t;try{if(t)for(;null!==r;){var n=e.unstable_now();if(!(r.timesOutAt<=n))break;do{c()}while(null!==r&&r.timesOutAt<=n)}else if(null!==r)do{c()}while(null!==r&&0<v()-e.unstable_now())}finally{i=!1,null!==r?u():o=!1}}var f,h,p,d,v,g=Date,m="function"==typeof setTimeout?setTimeout:void 0,y="function"==typeof clearTimeout?clearTimeout:void 0,_="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,b="function"==typeof cancelAnimationFrame?cancelAnimationFrame:void 0;function x(t){f=_(function(e){y(h),t(e)}),h=m(function(){b(f),t(e.unstable_now())},100)}if(a){var w=performance;e.unstable_now=function(){return w.now()}}else e.unstable_now=function(){return g.now()};if("undefined"==typeof window){var E=-1;p=function(t){E=setTimeout(t,0,!0)},d=function(){clearTimeout(E)},v=function(){return 0}}else if(window._schedMock){var S=window._schedMock;p=S[0],d=S[1],v=S[2]}else{"undefined"!=typeof console&&("function"!=typeof _&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof b&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var P=null,T=!1,A=-1,k=!1,C=!1,O=0,M=33,I=33;v=function(){return O};var L="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(t){if(t.source===window&&t.data===L){T=!1;var n=e.unstable_now();if(t=!1,0>=O-n){if(!(-1!==A&&A<=n))return void(k||(k=!0,x(R)));t=!0}if(A=-1,n=P,P=null,null!==n){C=!0;try{n(t)}finally{C=!1}}}},!1);var R=function(t){k=!1;var e=t-O+I;e<I&&M<I?(8>e&&(e=8),I=e<M?M:e):M=e,O=t+I,T||(T=!0,window.postMessage(L,"*"))};p=function(t,e){P=t,A=e,C?window.postMessage(L,"*"):k||(k=!0,x(R))},d=function(){P=null,T=!1,A=-1}}e.unstable_scheduleWork=function(t,n){var i=e.unstable_now();if(t={callback:t,timesOutAt:n=void 0!==n&&null!==n&&null!==n.timeout&&void 0!==n.timeout?i+n.timeout:i+5e3,next:null,previous:null},null===r)r=t.next=t.previous=t,u();else{i=null;var o=r;do{if(o.timesOutAt>n){i=o;break}o=o.next}while(o!==r);null===i?i=r:i===r&&(r=t,u()),(n=i.previous).next=i.previous=t,t.next=i,t.previous=n}return t},e.unstable_cancelScheduledWork=function(t){var e=t.next;if(null!==e){if(e===t)r=null;else{t===r&&(r=e);var n=t.previous;n.next=e,e.previous=n}t.next=t.previous=null}}},function(t,e,n){"use strict";var r=n(481);function i(){}t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=i,n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(183),i=s(n(484)),o=s(n(485)),a=n(486);function s(t){return t&&t.__esModule?t:{default:t}}var u=(0,r.createStore)(i.default,(0,r.applyMiddleware)(o.default,(0,a.createLogger)()));e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return arguments[1],t}},function(t,e,n){"use strict";function r(t){return function(e){var n=e.dispatch,r=e.getState;return function(e){return function(i){return"function"==typeof i?i(n,r,t):e(i)}}}}n.r(e);var i=r();i.withExtraArgument=r,e.default=i},function(t,e,n){(function(t){!function(e){"use strict";function n(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function r(t,e){Object.defineProperty(this,"kind",{value:t,enumerable:!0}),e&&e.length&&Object.defineProperty(this,"path",{value:e,enumerable:!0})}function i(t,e,n){i.super_.call(this,"E",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function o(t,e){o.super_.call(this,"N",t),Object.defineProperty(this,"rhs",{value:e,enumerable:!0})}function a(t,e){a.super_.call(this,"D",t),Object.defineProperty(this,"lhs",{value:e,enumerable:!0})}function s(t,e,n){s.super_.call(this,"A",t),Object.defineProperty(this,"index",{value:e,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(t,e,n){var r=t.slice((n||e)+1||t.length);return t.length=e<0?t.length+e:e,t.push.apply(t,r),t}function c(t){var e=void 0===t?"undefined":w(t);return"object"!==e?e:t===Math?"math":null===t?"null":Array.isArray(t)?"array":"[object Date]"===Object.prototype.toString.call(t)?"date":"function"==typeof t.toString&&/^\/.*\//.test(t.toString())?"regexp":"object"}function l(t,e,n,r,f,h,p){f=f||[],p=p||[];var d=f.slice(0);if(void 0!==h){if(r){if("function"==typeof r&&r(d,h))return;if("object"===(void 0===r?"undefined":w(r))){if(r.prefilter&&r.prefilter(d,h))return;if(r.normalize){var v=r.normalize(d,h,t,e);v&&(t=v[0],e=v[1])}}}d.push(h)}"regexp"===c(t)&&"regexp"===c(e)&&(t=t.toString(),e=e.toString());var g=void 0===t?"undefined":w(t),m=void 0===e?"undefined":w(e),y="undefined"!==g||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(h),_="undefined"!==m||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(h);if(!y&&_)n(new o(d,e));else if(!_&&y)n(new a(d,t));else if(c(t)!==c(e))n(new i(d,t,e));else if("date"===c(t)&&t-e!=0)n(new i(d,t,e));else if("object"===g&&null!==t&&null!==e)if(p.filter(function(e){return e.lhs===t}).length)t!==e&&n(new i(d,t,e));else{if(p.push({lhs:t,rhs:e}),Array.isArray(t)){var b;for(t.length,b=0;b<t.length;b++)b>=e.length?n(new s(d,b,new a(void 0,t[b]))):l(t[b],e[b],n,r,d,b,p);for(;b<e.length;)n(new s(d,b,new o(void 0,e[b++])))}else{var x=Object.keys(t),E=Object.keys(e);x.forEach(function(i,o){var a=E.indexOf(i);a>=0?(l(t[i],e[i],n,r,d,i,p),E=u(E,a)):l(t[i],void 0,n,r,d,i,p)}),E.forEach(function(t){l(void 0,e[t],n,r,d,t,p)})}p.length=p.length-1}else t!==e&&("number"===g&&isNaN(t)&&isNaN(e)||n(new i(d,t,e)))}function f(t,e,n,r){return r=r||[],l(t,e,function(t){t&&r.push(t)},n),r.length?r:void 0}function h(t,e,n){if(t&&e&&n&&n.kind){for(var r=t,i=-1,o=n.path?n.path.length-1:0;++i<o;)void 0===r[n.path[i]]&&(r[n.path[i]]="number"==typeof n.path[i]?[]:{}),r=r[n.path[i]];switch(n.kind){case"A":!function t(e,n,r){if(r.path&&r.path.length){var i,o=e[n],a=r.path.length-1;for(i=0;i<a;i++)o=o[r.path[i]];switch(r.kind){case"A":t(o[r.path[i]],r.index,r.item);break;case"D":delete o[r.path[i]];break;case"E":case"N":o[r.path[i]]=r.rhs}}else switch(r.kind){case"A":t(e[n],r.index,r.item);break;case"D":e=u(e,n);break;case"E":case"N":e[n]=r.rhs}return e}(n.path?r[n.path[i]]:r,n.index,n.item);break;case"D":delete r[n.path[i]];break;case"E":case"N":r[n.path[i]]=n.rhs}}}function p(t,e,n,r){var i=f(t,e);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(t){n.log("diff")}i?i.forEach(function(t){var e=t.kind,r=function(t){var e=t.kind,n=t.path,r=t.lhs,i=t.rhs,o=t.index,a=t.item;switch(e){case"E":return[n.join("."),r,"",i];case"N":return[n.join("."),i];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+o+"]",a];default:return[]}}(t);n.log.apply(n,["%c "+P[e].text,function(t){return"color: "+P[t].color+"; font-weight: bold"}(e)].concat(E(r)))}):n.log(" no diff ");try{n.groupEnd()}catch(t){n.log(" diff end  ")}}function d(t,e,n,r){switch(void 0===t?"undefined":w(t)){case"object":return"function"==typeof t[r]?t[r].apply(t,E(n)):t[r];case"function":return t(e);default:return t}}function v(t,e){var n=e.logger,r=e.actionTransformer,i=e.titleFormatter,o=void 0===i?function(t){var e=t.timestamp,n=t.duration;return function(t,r,i){var o=["action"];return o.push("%c"+String(t.type)),e&&o.push("%c@ "+r),n&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}(e):i,a=e.collapsed,s=e.colors,u=e.level,c=e.diff,l=void 0===e.titleFormatter;t.forEach(function(i,f){var h=i.started,v=i.startedTime,g=i.action,m=i.prevState,y=i.error,_=i.took,x=i.nextState,w=t[f+1];w&&(x=w.prevState,_=w.started-h);var E=r(g),S="function"==typeof a?a(function(){return x},g,i):a,P=b(v),T=s.title?"color: "+s.title(E)+";":"",A=["color: gray; font-weight: lighter;"];A.push(T),e.timestamp&&A.push("color: gray; font-weight: lighter;"),e.duration&&A.push("color: gray; font-weight: lighter;");var k=o(E,P,_);try{S?s.title&&l?n.groupCollapsed.apply(n,["%c "+k].concat(A)):n.groupCollapsed(k):s.title&&l?n.group.apply(n,["%c "+k].concat(A)):n.group(k)}catch(t){n.log(k)}var C=d(u,E,[m],"prevState"),O=d(u,E,[E],"action"),M=d(u,E,[y,m],"error"),I=d(u,E,[x],"nextState");if(C)if(s.prevState){var L="color: "+s.prevState(m)+"; font-weight: bold";n[C]("%c prev state",L,m)}else n[C]("prev state",m);if(O)if(s.action){var R="color: "+s.action(E)+"; font-weight: bold";n[O]("%c action    ",R,E)}else n[O]("action    ",E);if(y&&M)if(s.error){var j="color: "+s.error(y,m)+"; font-weight: bold;";n[M]("%c error     ",j,y)}else n[M]("error     ",y);if(I)if(s.nextState){var z="color: "+s.nextState(x)+"; font-weight: bold";n[I]("%c next state",z,x)}else n[I]("next state",x);c&&p(m,x,n,S);try{n.groupEnd()}catch(t){n.log(" log end ")}})}function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},T,t),n=e.logger,r=e.stateTransformer,i=e.errorTransformer,o=e.predicate,a=e.logErrors,s=e.diffPredicate;if(void 0===n)return function(){return function(t){return function(e){return t(e)}}};if(t.getState&&t.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(t){return function(e){return t(e)}}};var u=[];return function(t){var n=t.getState;return function(t){return function(c){if("function"==typeof o&&!o(n,c))return t(c);var l={};u.push(l),l.started=x.now(),l.startedTime=new Date,l.prevState=r(n()),l.action=c;var f=void 0;if(a)try{f=t(c)}catch(t){l.error=i(t)}else f=t(c);l.took=x.now()-l.started,l.nextState=r(n());var h=e.diff&&"function"==typeof s?s(n,c):e.diff;if(v(u,Object.assign({},e,{diff:h})),u.length=0,l.error)throw l.error;return f}}}}var m,y,_=function(t,e){return function(t,e){return new Array(e+1).join(t)}("0",e-t.toString().length)+t},b=function(t){return _(t.getHours(),2)+":"+_(t.getMinutes(),2)+":"+_(t.getSeconds(),2)+"."+_(t.getMilliseconds(),3)},x="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},S=[];m="object"===(void 0===t?"undefined":w(t))&&t?t:"undefined"!=typeof window?window:{},(y=m.DeepDiff)&&S.push(function(){void 0!==y&&m.DeepDiff===f&&(m.DeepDiff=y,y=void 0)}),n(i,r),n(o,r),n(a,r),n(s,r),Object.defineProperties(f,{diff:{value:f,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:function(t,e,n){t&&e&&l(t,e,function(r){n&&!n(t,e,r)||h(t,e,r)})},enumerable:!0},applyChange:{value:h,enumerable:!0},revertChange:{value:function(t,e,n){if(t&&e&&n&&n.kind){var r,i,o=t;for(i=n.path.length-1,r=0;r<i;r++)void 0===o[n.path[r]]&&(o[n.path[r]]={}),o=o[n.path[r]];switch(n.kind){case"A":!function t(e,n,r){if(r.path&&r.path.length){var i,o=e[n],a=r.path.length-1;for(i=0;i<a;i++)o=o[r.path[i]];switch(r.kind){case"A":t(o[r.path[i]],r.index,r.item);break;case"D":case"E":o[r.path[i]]=r.lhs;break;case"N":delete o[r.path[i]]}}else switch(r.kind){case"A":t(e[n],r.index,r.item);break;case"D":case"E":e[n]=r.lhs;break;case"N":e=u(e,n)}return e}(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==y},enumerable:!0},noConflict:{value:function(){return S&&(S.forEach(function(t){t()}),S=null),f},enumerable:!0}});var P={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},T={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(t){return t},actionTransformer:function(t){return t},errorTransformer:function(t){return t},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dispatch,n=t.getState;return"function"==typeof e||"function"==typeof n?g()({dispatch:e,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=T,e.createLogger=g,e.logger=A,e.default=A,Object.defineProperty(e,"__esModule",{value:!0})}(e)}).call(this,n(41))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(n(15)),i=n(488);e.default=function(){return r.default.createElement("div",null,r.default.createElement(i.Main,null))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(489);Object.defineProperty(e,"Main",{enumerable:!0,get:function(){return a(r).default}});var i=n(531);Object.defineProperty(e,"ReactMap",{enumerable:!0,get:function(){return a(i).default}});var o=n(534);function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"MapboxMap",{enumerable:!0,get:function(){return a(o).default}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=v(n(15)),a=n(237),s=v(a),u=n(224),c=v(n(225)),l=d(n(236)),f=n(180),h=(d(n(122)),v(n(530))),p=v(n(238));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function v(t){return t&&t.__esModule?t:{default:t}}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}("next")})}}l.easeCubicInOut;var y=new a.LinearInterpolator(["bearing"]),_=[[213,62,79],[252,141,89],[254,224,139],[230,245,152],[153,213,148],[50,136,189]].reverse(),b={lightsPosition:[-73.8,40.5,8e3,-74.2,40.9,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2},x=function(t){function e(t){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._fetchStaticData=m(regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.default.get("https://www.newyorkled.com/maps/geojson/layer/10/");case 2:e=t.sent,r=e.data,i.setState({hospitals:r.features});case 5:case"end":return t.stop()}},t,n)})),i._resize=function(){i._onViewportChange({width:window.innerWidth,height:window.innerHeight})},i._onHover=function(t){var e=t.x,n=t.y,r=t.object;i.setState({x:e,y:n,hoveredObject:r,clickedObject:{}})},i._onObjectClick=function(t){var e=t.object;i.setState({clickedObject:e})},i._onViewportChange=function(t){i.setState({viewport:r({},i.state.viewport,t)})},i._loadMap=function(){i.setState({firstLoad:!1})},i._updateLayerSettings=function(t){i.setState({settings:t})},i._getHordeSize=function(t){return t.hordeSize},i._onLoad=function(){i._rotateCamera()},i._onViewStateChange=function(t){var e=t.viewState;i.setState({viewport:e})},i._rotateCamera=function(){var t=i.state.viewport.bearing+80;i.setState({viewport:r({},i.state.viewport,{bearing:t,transitionDuration:3e4,transitionInterpolator:y,onTransitionEnd:i._rotateCamera})}),i._resize()},i._renderTooltipHover=function(){if(i.state.hoveredObject){if(i.state.hoveredObject.type&&"Dead"===i.state.hoveredObject.type)return o.default.createElement("div",{style:r({},f.tooltipStyle,{transform:"translate("+i.state.x+"px, "+i.state.y+"px)"})},o.default.createElement("div",null,o.default.createElement("p",null,"Type: ",JSON.stringify(i.state.hoveredObject.type))));if(i.state.hoveredObject.properties)return o.default.createElement("div",{style:r({},f.tooltipStyle,{transform:"translate("+i.state.x+"px, "+i.state.y+"px)"})},o.default.createElement("div",null,o.default.createElement("p",null,"Type: Hospital")));if(i.state.hoveredObject.Precinct)return o.default.createElement("div",{style:r({},f.tooltipStyle,{transform:"translate("+i.state.x+"px, "+i.state.y+"px)"})},o.default.createElement("div",null,o.default.createElement("p",null,"Type: Armory")))}},i._renderClickedIcon=function(){if(i.state.clickedObject){if(i.state.clickedObject.type&&"Dead"===i.state.clickedObject.type)return console.log("clickedonzombie"),o.default.createElement("div",{style:r({},f.clickedIconStyle,{transform:"translate("+i.state.x+"px, "+i.state.y+"px)"})},o.default.createElement("div",null,o.default.createElement("p",null,"Horde Size: ",i.state.clickedObject.hordeSize)));if(i.state.clickedObject.properties)return console.log("clicked on hospital"),o.default.createElement("div",{style:r({},f.clickedIconStyle,{transform:"translate("+i.state.x+"px, "+i.state.y+"px)"})},o.default.createElement("div",null,o.default.createElement("p",null,i.state.clickedObject.properties.markername)));if(i.state.clickedObject.Precinct)return o.default.createElement("div",{style:r({},f.clickedIconStyle,{transform:"translate("+i.state.x+"px, "+i.state.y+"px)"})},o.default.createElement("div",null,o.default.createElement("p",null,i.state.clickedObject.Precinct,o.default.createElement("br",null),i.state.clickedObject.Address)))}},i.state={firstLoad:!0,viewport:{width:window.innerWidth,height:window.innerHeight,latitude:40.72445,longitude:-73.98507,zoom:12.65,pitch:57.62,altitude:2,bearing:70},points:[],hospitals:[],police:[],x:0,y:0,hoveredObject:null,clickedObject:null,settings:r({},Object.keys(u.SCATTERPLOT_CONTROLS).reduce(function(t,e){return r({},t,g({},e,u.SCATTERPLOT_CONTROLS[e].value))},{}),Object.keys(u.HEXAGON_CONTROLS).reduce(function(t,e){return r({},t,g({},e,u.HEXAGON_CONTROLS[e].value))},{}))},i.startAnimationTimer=null,i.intervalTimer=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default.Component),i(e,[{key:"componentDidMount",value:function(){this._processData(),window.addEventListener("resize",this._resize),this._resize(),this._fetchStaticData(),this.setState({police:h.default})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"_processData",value:function(){var t=this,e=function(){var e=m(regeneratorRuntime.mark(function e(){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.default.get("/api/bus");case 2:n=e.sent,r=n.data,i=r.reduce(function(t,e){var n=function(t){return Math.floor(25*Math.random())+1==1?parseInt(t)+(Math.floor(3*Math.random())+1):t}(e.trip.route_id.replace(/\D/,""));return n>0&&t.push({position:[Number(e.position.longitude),Number(e.position.latitude)],type:"Dead",hordeSize:n}),t},[]),t.setState({points:i});case 6:case"end":return e.stop()}},e,t)}));return function(){return e.apply(this,arguments)}}();setInterval(e,2e3)}},{key:"render",value:function(){var t=this;console.log("viewport",this.state.viewport);var e=new a.ScatterplotLayer(r({id:"zombie-layer",data:[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(this.state.points)),pickable:!0,opacity:.4,radiusScale:20,radiusMinPixels:1,radiusMaxPixels:100,getPosition:function(t){return t.position},getRadius:function(t){return Math.sqrt(t.hordeSize)},getColor:function(t){return[166,16,30]}},this.state.settings,{onHover:function(e){return t._onHover(e)},onClick:function(e){return t._onObjectClick(e)}})),n=new a.ScatterplotLayer({id:"hospital-layer",data:this.state.hospitals,pickable:!0,extruded:!0,getColor:function(t){return[255,255,255]},getRadius:10,getElevation:function(t){return 10},getPosition:function(t){return t.geometry.coordinates},radiusScale:10,radiusMinPixels:1,radiusMaxPixels:50,onHover:function(e){return t._onHover(e)},onClick:function(e){return t._onObjectClick(e)}}),i=new a.ScatterplotLayer({id:"police-layer",data:h.default,pickable:!0,extruded:!0,getColor:function(t){return[30,144,255]},getRadius:10,getElevation:function(t){return 10},getPosition:function(t){return[t.Longitude,t.Latitude]},radiusScale:10,radiusMinPixels:1,radiusMaxPixels:50,onHover:function(e){return t._onHover(e)},onClick:function(e){return t._onObjectClick(e)}}),c=new a.HexagonLayer(r({id:"zombie-heatmap",data:this.state.points,colorRange:_,elevationRange:[1,4200],elevationScale:3,extruded:!0,getPosition:function(t){return t.position},lightSettings:b,opacity:.5,pickable:!0,radius:100},this.state.settings)),l=this.state.settings.showHexagon?[c]:[e,n,i];return o.default.createElement("div",null,this.state.hoveredObject!=={}?this._renderTooltipHover():"",this.state.clickedObject!=={}?this._renderClickedIcon():"",o.default.createElement(u.LayerControls,{settings:this.state.settings,propTypes:u.HEXAGON_CONTROLS,onChange:function(e){return t._updateLayerSettings(e)}}),o.default.createElement(p.default,r({mapboxApiAccessToken:"pk.eyJ1IjoiamFzb254aGFuZyIsImEiOiJjam1pNjJ5ajIwMW1lM3JwazVyZWE1bW4xIn0.xt5U4JljOeJoD7ArM66mIA"},this.state.viewport,{onViewportChange:function(e){return t._onViewportChange(e)},mapStyle:"mapbox://styles/mapbox/dark-v9"}),o.default.createElement(s.default,r({onLoad:this._onLoad,onViewStateChange:function(e){return t._onViewStateChange(e)},controller:!0,onHover:function(e){return t._onHover(e)}},this.state.viewport,{layers:l},this.state.settings))))}}]),e}();e.default=x},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){(function(t,r){var i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),u=r[n];n<o;u=r[++n])v(u)||!b(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,i){if(y(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function c(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=l(t,i,r)),i}var o=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(v(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(E(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(_(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return f(n)}var c,b="",S=!1,P=["{","}"];(p(n)&&(S=!0,P=["[","]"]),E(n))&&(b=" [Function"+(n.name?": "+n.name:"")+"]");return _(n)&&(b=" "+RegExp.prototype.toString.call(n)),x(n)&&(b=" "+Date.prototype.toUTCString.call(n)),w(n)&&(b=" "+f(n)),0!==a.length||S&&0!=n.length?r<0?_(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=S?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)A(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}(t,n,r,s,a):a.map(function(e){return h(t,n,r,s,e,S)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,b,P)):P[0]+b+P[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=v(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return"number"==typeof t}function m(t){return"string"==typeof t}function y(t){return void 0===t}function _(t){return b(t)&&"[object RegExp]"===S(t)}function b(t){return"object"==typeof t&&null!==t}function x(t){return b(t)&&"[object Date]"===S(t)}function w(t){return b(t)&&("[object Error]"===S(t)||t instanceof Error)}function E(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function P(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(o)&&(o=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=_,e.isObject=b,e.isDate=x,e.isError=w,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(494);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),T[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(495),e._extend=function(t,e){if(!e||!b(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(41),n(68))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){t.exports=function(t,e,n){var r=new Float32Array(3);return r[0]=t,r[1]=e,r[2]=n,r}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o);return t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(112),c=n(259),l=n.n(c),f=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"cross",value:function(t){return l()(this,this,t),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),e}(u.a)},function(t,e,n){t.exports=n(502)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){(0,r.installParameterDefinitions)(),console.log("luma.gl: WebGL debug support installed")};var r=n(503),i=n(506);(void 0!==t?t:window).WebGLDebug=i,console.log("luma.gl: WebGL debug support imported")}).call(this,n(41))},function(t,e,n){"use strict";var r=n(504);Object.defineProperty(e,"__esModule",{value:!0}),e.installParameterDefinitions=function(){},e.TEXTURE_PARAMETERS=e.SAMPLER_PARAMETERS=e.RENDERBUFFER_PARAMETERS=e.PROGRAM_PARAMETERS=e.FRAMEBUFFER_STATUS=e.FRAMEBUFFER_ATTACHMENT_PARAMETERS=e.FENCE_SYNC_PARAMETERS=e.BUFFER_PARAMETERS=e.GLboolean=e.GLuint=e.GLint=e.GLfloat=e.GLenum=void 0;var i,o,a,s,u,c,l=r(n(505));e.GLenum="GLenum";e.GLfloat="GLfloat";e.GLint="GLint";e.GLuint="GLint";e.GLboolean="GLboolean";var f=(i={},(0,l.default)(i,34660,{webgl1:0}),(0,l.default)(i,34661,{webgl1:0}),i);e.BUFFER_PARAMETERS=f;e.FENCE_SYNC_PARAMETERS=[37138,37140,37139,37141];e.FRAMEBUFFER_ATTACHMENT_PARAMETERS=[36049,36048,36051,36050,33296,36052,33298,33299,33300,33301,33302,33303,33297];var h=(o={},(0,l.default)(o,36053,"Success. Framebuffer is correctly set up"),(0,l.default)(o,36054,"Framebuffer attachment types mismatched or some attachment point not attachment complete"),(0,l.default)(o,36055,"Framebuffer has no attachment"),(0,l.default)(o,36057,"Framebuffer attachments do not have the same size"),(0,l.default)(o,36061,"Framebuffer attachment format not supported or depth and stencil attachments are not same"),(0,l.default)(o,36182,"Framebuffer attachement SAMPLES differs among renderbuffers, or are mixed with textures"),o);e.FRAMEBUFFER_STATUS=h;var p=(a={},(0,l.default)(a,35712,{webgl1:0}),(0,l.default)(a,35714,{webgl1:0}),(0,l.default)(a,35715,{webgl1:0}),(0,l.default)(a,35717,{webgl1:0}),(0,l.default)(a,35721,{webgl1:0}),(0,l.default)(a,35718,{webgl1:0}),(0,l.default)(a,35967,{webgl2:0}),(0,l.default)(a,35971,{webgl2:0}),(0,l.default)(a,35382,{webgl2:0}),a);e.PROGRAM_PARAMETERS=p;var d=(s={},(0,l.default)(s,36162,{webgl1:0}),(0,l.default)(s,36163,{webgl1:0}),(0,l.default)(s,36164,{type:"GLenum",webgl1:32854}),(0,l.default)(s,36177,{webgl1:0}),(0,l.default)(s,36178,{webgl1:0}),(0,l.default)(s,36176,{webgl1:0}),(0,l.default)(s,36179,{webgl1:0}),(0,l.default)(s,36180,{webgl1:0}),(0,l.default)(s,36181,{webgl1:0}),(0,l.default)(s,36011,{webgl2:1}),s);e.RENDERBUFFER_PARAMETERS=d;var v=(u={},(0,l.default)(u,10240,{webgl2:!0}),(0,l.default)(u,10241,{webgl2:!0}),(0,l.default)(u,10242,{webgl2:!0}),(0,l.default)(u,10243,{webgl2:!0}),(0,l.default)(u,32882,{webgl2:!0}),(0,l.default)(u,33084,{webgl2:!0}),(0,l.default)(u,33085,{webgl2:!0}),(0,l.default)(u,34893,{webgl2:!0}),(0,l.default)(u,34892,{webgl2:!0}),(0,l.default)(u,33082,{webgl2:!0}),(0,l.default)(u,33083,{webgl2:!0}),u);e.SAMPLER_PARAMETERS=v;var g=(c={},(0,l.default)(c,10240,{type:"GLenum",webgl1:9729}),(0,l.default)(c,10241,{type:"GLenum",webgl1:9986}),(0,l.default)(c,10242,{type:"GLenum",webgl1:10497}),(0,l.default)(c,10243,{type:"GLenum",webgl1:10497}),(0,l.default)(c,32882,{type:"GLenum",webgl2:10497}),(0,l.default)(c,33084,{webgl2:0}),(0,l.default)(c,33085,{webgl2:1e3}),(0,l.default)(c,34893,{type:"GLenum",webgl2:515}),(0,l.default)(c,34892,{type:"GLenum",webgl2:0}),(0,l.default)(c,33082,{webgl2:-1e3}),(0,l.default)(c,33083,{webgl2:1e3}),(0,l.default)(c,4096,{webgl1:0}),(0,l.default)(c,4097,{webgl1:0}),c);e.TEXTURE_PARAMETERS=g},function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){(function(e){WebGLDebugUtils=function(){var t;void 0===t&&(t=e);var n=function(e){t.console&&t.console.error?t.console.error(e):function(e){t.console&&t.console.log&&t.console.log(e)}(e)},r={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},i=null,o=null;function a(t){if(null==i)for(var e in i={},o={},t)"number"==typeof t[e]&&(i[t[e]]=e,o[e]=t[e])}function s(){if(null==i)throw"WebGLDebugUtils.init(ctx) not called"}function u(t){s();var e=i[t];return void 0!==e?"gl."+e:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function c(t,e,n,i){var a;if(void 0!==(a=r[t])&&(void 0!==(a=a[e])&&a[n])){if("object"==typeof a[n]&&void 0!==a[n].enumBitwiseOr){for(var s=a[n].enumBitwiseOr,c=0,l=[],f=0;f<s.length;++f){var h=o[s[f]];0!=(i&h)&&(c|=h,l.push(u(h)))}return c===i?l.join(" | "):u(i)}return u(i)}return null===i?"null":void 0===i?"undefined":i.toString()}function l(t,e,n){t.__defineGetter__(n,function(){return e[n]}),t.__defineSetter__(n,function(t){e[n]=t})}function f(t){var e=!!t.createTransformFeedback;e&&t.bindVertexArray(null);var n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r);for(var i=0;i<n;++i)t.disableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(i,0),e&&t.vertexAttribDivisor(i,0);t.deleteBuffer(r);var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);for(i=0;i<o;++i)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null),e&&(t.bindTexture(t.TEXTURE_2D_ARRAY,null),t.bindTexture(t.TEXTURE_3D,null),t.bindSampler(i,null));if(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),e){t.drawBuffers([t.BACK]),t.readBuffer(t.BACK),t.bindBuffer(t.COPY_READ_BUFFER,null),t.bindBuffer(t.COPY_WRITE_BUFFER,null),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),t.bindBuffer(t.PIXEL_UNPACK_BUFFER,null);var a=t.getParameter(t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(i=0;i<a;++i)t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,null);var s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);for(i=0;i<s;++i)t.bindBufferBase(t.UNIFORM_BUFFER,i,null);t.disable(t.RASTERIZER_DISCARD),t.pixelStorei(t.UNPACK_IMAGE_HEIGHT,0),t.pixelStorei(t.UNPACK_SKIP_IMAGES,0),t.pixelStorei(t.UNPACK_ROW_LENGTH,0),t.pixelStorei(t.UNPACK_SKIP_ROWS,0),t.pixelStorei(t.UNPACK_SKIP_PIXELS,0),t.pixelStorei(t.PACK_ROW_LENGTH,0),t.pixelStorei(t.PACK_SKIP_ROWS,0),t.pixelStorei(t.PACK_SKIP_PIXELS,0),t.hint(t.FRAGMENT_SHADER_DERIVATIVE_HINT,t.DONT_CARE)}for(;t.getError(););}return{init:a,mightBeEnum:function(t){return s(),void 0!==i[t]},glEnumToString:u,glFunctionArgToString:c,glFunctionArgsToString:function(t,e){for(var n="",r=e.length,i=0;i<r;++i)n+=(0==i?"":", ")+c(t,r,i,e[i]);return n},makeDebugContext:function t(e,r,i,o){o=o||e,a(e),r=r||function(t,e,r){for(var i="",o=r.length,a=0;a<o;++a)i+=(0==a?"":", ")+c(e,o,a,r[a]);n("WebGL error "+u(t)+" in "+e+"("+i+")")};var s={};function f(t,e){return function(){i&&i(e,arguments);var n=t[e].apply(t,arguments),a=o.getError();return 0!=a&&(s[a]=!0,r(a,e,arguments)),n}}var h={};for(var p in e)if("function"==typeof e[p])if("getExtension"!=p)h[p]=f(e,p);else{var d=f(e,p);h[p]=function(){var n=d.apply(e,arguments);return n?t(n,r,i,o):null}}else l(h,e,p);return h.getError=function(){for(var t in s)if(s.hasOwnProperty(t)&&s[t])return s[t]=!1,t;return e.NO_ERROR},h},makeLostContextSimulatingCanvas:function(e){var n,r,i=[],o=[],a={},s=1,u=!1,c=[],h=0,p=0,d=!1,v=0,g={};function m(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}e.getContext=function(i){return function(){var o=i.apply(e,arguments);if(o instanceof WebGLRenderingContext||t.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext){if(o!=n){if(n)throw"got different context";r=t.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext,a=function(t){for(var e in t)"function"==typeof t[e]?a[e]=x(t,e):l(a,t,e);a.getError=function(){if(b(),!u)for(;t=n.getError();)g[t]=!0;for(var t in g)if(g[t])return delete g[t],t;return a.NO_ERROR};var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];r&&i.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var o=0;o<i.length;++o){var f=i[o];a[f]=function(e){return function(){if(b(),u)return null;var n=e.apply(t,arguments);return n.__webglDebugContextLostId__=s,c.push(n),n}}(t[f])}var h=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];r&&h.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(var o=0;o<h.length;++o){var f=h[o];a[f]=function(e){return function(){return b(),u?null:e.apply(t,arguments)}}(a[f])}var p=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];r&&p.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(var o=0;o<p.length;++o){var f=p[o];a[f]=function(e){return function(){return b(),!u&&e.apply(t,arguments)}}(a[f])}return a.checkFramebufferStatus=function(e){return function(){return b(),u?a.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(a.checkFramebufferStatus),a.getAttribLocation=function(e){return function(){return b(),u?-1:e.apply(t,arguments)}}(a.getAttribLocation),a.getVertexAttribOffset=function(e){return function(){return b(),u?0:e.apply(t,arguments)}}(a.getVertexAttribOffset),a.isContextLost=function(){return u},r&&(a.getFragDataLocation=function(e){return function(){return b(),u?-1:e.apply(t,arguments)}}(a.getFragDataLocation),a.clientWaitSync=function(e){return function(){return b(),u?a.WAIT_FAILED:e.apply(t,arguments)}}(a.clientWaitSync),a.getUniformBlockIndex=function(e){return function(){return b(),u?a.INVALID_INDEX:e.apply(t,arguments)}}(a.getUniformBlockIndex)),a}(n=o)}return a}return o}}(e.getContext);var y=function(t){i.push(m(t))},_=function(t){o.push(m(t))};function b(){++p,u||h==p&&e.loseContext()}function x(t,e){var n=t[e];return function(){if(b(),!u)return n.apply(t,arguments)}}function w(t){return{statusMessage:t,preventDefault:function(){d=!0}}}return function(t){var e=t.addEventListener;t.addEventListener=function(n,r,i){switch(n){case"webglcontextlost":y(r);break;case"webglcontextrestored":_(r);break;default:e.apply(t,arguments)}}}(e),e.loseContext=function(){if(!u){for(u=!0,h=0,++s;n.getError(););!function(){for(var t=Object.keys(g),e=0;e<t.length;++e)delete g[t[e]]}(),g[n.CONTEXT_LOST_WEBGL]=!0;var t=w("context lost"),r=i.slice();setTimeout(function(){for(var n=0;n<r.length;++n)r[n](t);v>=0&&setTimeout(function(){e.restoreContext()},v)},0)}},e.restoreContext=function(){u&&o.length&&setTimeout(function(){if(!d)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var t=0;t<c.length;++t){var e=c[t];e instanceof WebGLBuffer?n.deleteBuffer(e):e instanceof WebGLFramebuffer?n.deleteFramebuffer(e):e instanceof WebGLProgram?n.deleteProgram(e):e instanceof WebGLRenderbuffer?n.deleteRenderbuffer(e):e instanceof WebGLShader?n.deleteShader(e):e instanceof WebGLTexture?n.deleteTexture(e):r&&(e instanceof WebGLQuery?n.deleteQuery(e):e instanceof WebGLSampler?n.deleteSampler(e):e instanceof WebGLSync?n.deleteSync(e):e instanceof WebGLTransformFeedback?n.deleteTransformFeedback(e):e instanceof WebGLVertexArrayObject&&n.deleteVertexArray(e))}}(),f(n),u=!1,p=0,d=!1;for(var t=o.slice(),e=w("context restored"),i=0;i<t.length;++i)t[i](e)},0)},e.loseContextInNCalls=function(t){if(u)throw"You can not ask a lost contet to be lost";h=p+t},e.getNumCalls=function(){return p},e.setRestoreTimeout=function(t){v=t},e},resetToInitialState:f}}(),t.exports=WebGLDebugUtils}).call(this,n(41))},function(t,e,n){"use strict";t.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(18),i=n(239),o=n(93);function a(t){var e=t.width,n=t.height,a=t.bounds,s=t.padding,u=void 0===s?0:s,c=t.offset,l=void 0===c?[0,0]:c,f=Object(r.a)(a,2),h=Object(r.a)(f[0],2),p=h[0],d=h[1],v=Object(r.a)(f[1],2),g=v[0],m=v[1];if(Number.isFinite(u)){u={top:u,bottom:u,left:u,right:u}}else Object(o.a)(Number.isFinite(u.top)&&Number.isFinite(u.bottom)&&Number.isFinite(u.left)&&Number.isFinite(u.right));var y=new i.a({width:e,height:n,longitude:0,latitude:0,zoom:0}),_=y.project([p,m]),b=y.project([g,d]),x=[Math.abs(b[0]-_[0]),Math.abs(b[1]-_[1])],w=[e-u.left-u.right-2*Math.abs(l[0]),n-u.top-u.bottom-2*Math.abs(l[1])];Object(o.a)(w[0]>0&&w[1]>0);var E=w[0]/x[0],S=w[1]/x[1],P=(u.right-u.left)/2/E,T=(u.bottom-u.top)/2/S,A=[(b[0]+_[0])/2+P,(b[1]+_[1])/2+T],k=y.unproject(A),C=y.zoom+Math.log2(Math.abs(Math.min(E,S)));return{longitude:k[0],latitude:k[1],zoom:C}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};r.get||r.set?Object.defineProperty(e,n,r):e[n]=t[n]}return e.default=t,e}(n(15)),i=l(n(4)),o=n(13),a=l(n(510)),s=n(222),u=l(n(511)),c=l(n(223));function l(t){return t&&t.__esModule?t:{default:t}}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var g=o.Deck.getPropTypes(i.default),m=o.Deck.defaultProps,y=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?v(t):e}(this,p(e).call(this,t))).state={width:0,height:0,viewState:t.initialViewState},n.children=[],(0,c.default)(v(v(n))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,r.default.PureComponent),function(t,e,n){e&&h(t.prototype,e),n&&h(t,n)}(e,[{key:"componentDidMount",value:function(){var t=this.props.Deck||o.Deck;this.deck=this.deck||new t(Object.assign({},this.props,{initialViewState:null,canvas:this.deckCanvas,viewState:this._getViewState(this.props),onViewStateChange:this._onViewStateChange,onResize:this._onResize}))}},{key:"componentWillUnmount",value:function(){this.deck.finalize()}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o;return this.deck.pickObject({x:e,y:n,radius:i,layerIds:a})}},{key:"pickMultipleObjects",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o,s=t.depth,u=void 0===s?10:s;return this.deck.pickMultipleObjects({x:e,y:n,radius:i,layerIds:a,depth:u})}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o,s=t.layerIds,u=void 0===s?null:s;return this.deck.pickObjects({x:e,y:n,width:i,height:a,layerIds:u})}},{key:"queryObject",value:function(t){o.log.removed("queryObject","pickObject")()}},{key:"queryVisibleObjects",value:function(t){o.log.removed("queryVisibleObjects","pickObjects")()}},{key:"_onResize",value:function(t){this.setState(t),this.props.onResize(t)}},{key:"_onViewStateChange",value:function(t){var e=this.props.onViewStateChange(t)||t.viewState;this.state.viewState&&this.setState({viewState:Object.assign({},this.state.viewState,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t.viewId,e))})}},{key:"_updateFromProps",value:function(t){if(this.deck){(t.viewports||t.viewport)&&o.log.removed("DeckGL.viewport(s)","DeckGL.views")();var e=(0,a.default)(t),n=e.layers,r=e.views,i=e.children,s=Object.assign({},t,{onViewStateChange:this._onViewStateChange,onResize:this._onResize,layers:n,views:r}),u=this._getViewState(t);u&&(s.viewState=u),this.deck.setProps(s),this.children=i}}},{key:"_getViewState",value:function(t){if(!t.viewState&&"latitude"in t&&"longitude"in t&&"zoom"in t){("maxZoom"in t||"minZoom"in t)&&o.log.removed("maxZoom/minZoom","viewState");var e=t.latitude,n=t.longitude,r=t.zoom,i=t.pitch,a=void 0===i?0:i,s=t.bearing;return{latitude:e,longitude:n,zoom:r,pitch:a,bearing:void 0===s?0:s}}return t.viewState||this.state.viewState}},{key:"_positionChildrenUnderViews",value:function(t){var e=(this.deck||{}).viewManager;if(!e||!e.views.length)return[];var n=e.views[0].id;return t.map(function(t,i){t.props.viewportId&&o.log.removed("viewportId","<View>")(),t.props.viewId&&o.log.removed("viewId","<View>")();var a=n,c=t;(0,s.inheritsFrom)(t.type,o.View)&&(a=t.props.id||n,c=t.props.children);var l=e.getViewport(a),f=e.getViewState(a);if(!l)return null;var h=l.x,p=l.y,d=l.width,v=l.height;c=(0,u.default)(c,{x:h,y:p,width:d,height:v,viewport:l,viewState:f});var g={position:"absolute",left:h,top:p,width:d,height:v},m="view-child-".concat(a,"-").concat(i);return(0,r.createElement)("div",{key:m,id:m,style:g},c)})}},{key:"render",value:function(){var t=this;this._updateFromProps(this.props);var e=this._positionChildrenUnderViews(this.children),n=Object.assign({},{position:"absolute",left:0,top:0},this.props.style),i=(0,r.createElement)("canvas",{ref:function(e){return t.deckCanvas=e},key:"deck-canvas",id:this.props.id,style:n});return e.push(i),(0,r.createElement)("div",{id:"deckgl-wrapper"},e)}}]),e}();e.default=y,y.propTypes=g,y.defaultProps=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.children,n=t.layers,s=t.views,u=[],c=[],l={};r.default.Children.forEach(a(e),function(t){if(t){var e=t.type;if((0,i.inheritsFrom)(e,o.Layer)){var n=new e(t.props);c.push(n)}else u.push(t);if(e!==o.View&&(0,i.inheritsFrom)(e,o.View)&&t.props.id){var r=new e(t.props);l[r.id]=r}}}),Object.keys(l).length>0&&(Array.isArray(s)?s.forEach(function(t){l[t.id]=t}):s&&(l[s.id]=s),s=Object.values(l));return{layers:n=c.length>0?c.concat(function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(n)):n,children:u,views:s}};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};r.get||r.set?Object.defineProperty(e,n,r):e[n]=t[n]}return e.default=t,e}(n(15)),i=n(222),o=n(13);function a(t){return t?"function"==typeof t?(0,r.createElement)(o.View,{},t):Array.isArray(t)?t.map(a):((0,i.inheritsFrom)(t.type,o.View),t):t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(e,n){if(!e)return e;if("function"==typeof e)return e(n);if(Array.isArray(e))return e.map(function(e){return t(e,n)});return(0,r.cloneElement)(e,n)};var r=n(15)},function(t,e,n){"use strict";var r=n(61),i=n(226),o=n(514),a=n(181);function s(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var u=s(a);u.Axios=o,u.create=function(t){return s(r.merge(a,t))},u.Cancel=n(230),u.CancelToken=n(528),u.isCancel=n(229),u.all=function(t){return Promise.all(t)},u.spread=n(529),t.exports=u,t.exports.default=u},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){"use strict";var r=n(181),i=n(61),o=n(523),a=n(524);function s(t){this.defaults=t,this.interceptors={request:new o,response:new o}}s.prototype.request=function(t){"string"==typeof t&&(t=i.merge({url:arguments[0]},arguments[1])),(t=i.merge(r,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[a,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)n=n.then(e.shift(),e.shift());return n},i.forEach(["delete","get","head","options"],function(t){s.prototype[t]=function(e,n){return this.request(i.merge(n||{},{method:t,url:e}))}}),i.forEach(["post","put","patch"],function(t){s.prototype[t]=function(e,n,r){return this.request(i.merge(r||{},{method:t,url:e,data:n}))}}),t.exports=s},function(t,e,n){"use strict";var r=n(61);t.exports=function(t,e){r.forEach(t,function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])})}},function(t,e,n){"use strict";var r=n(228);t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t}},function(t,e,n){"use strict";var r=n(61);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var a=[];r.forEach(e,function(t,e){null!==t&&void 0!==t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))}))}),o=a.join("&")}return o&&(t+=(-1===t.indexOf("?")?"?":"&")+o),t}},function(t,e,n){"use strict";var r=n(61),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}}),a):a}},function(t,e,n){"use strict";var r=n(61);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(){this.message="String contains an invalid character"}i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",t.exports=function(t){for(var e,n,o=String(t),a="",s=0,u=r;o.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&e>>8-s%1*8)){if((n=o.charCodeAt(s+=.75))>255)throw new i;e=e<<8|n}return a}},function(t,e,n){"use strict";var r=n(61);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";var r=n(61);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=i},function(t,e,n){"use strict";var r=n(61),i=n(525),o=n(229),a=n(181),s=n(526),u=n(527);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!s(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return c(t),e.data=i(e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(c(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,n){"use strict";var r=n(61);t.exports=function(t,e,n){return r.forEach(n,function(n){t=n(t,e)}),t}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var r=n(230);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var n=this;t(function(t){n.reason||(n.reason=new r(t),e(n.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i(function(e){t=e}),cancel:t}},t.exports=i},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";t.exports=[{Precinct:"1st Precinct","Phone Number":"212-334-0611",Address:"16 Ericsson Place",City:"New York, NY",Latitude:40.72027,Longitude:-74.007198,Coordinates:"40.72027, -74.007198"},{Precinct:"5th Precinct","Phone Number":"212-334-0711",Address:"19 Elizabeth Street",City:"New York, NY",Latitude:40.716187,Longitude:-73.997465,Coordinates:"40.716187, -73.997465"},{Precinct:"6th Precinct","Phone Number":"212-741-4811",Address:"233 West 10 Street",City:"New York, NY",Latitude:40.734233,Longitude:-74.005453,Coordinates:"40.734233, -74.005453"},{Precinct:"7th Precinct","Phone Number":"212-477-7311",Address:"19 1/2 Pitt Street",City:"New York, NY",Latitude:40.716362,Longitude:-73.983934,Coordinates:"40.716362, -73.983934"},{Precinct:"9th Precinct","Phone Number":"212-477-7811",Address:"321 East 5 Street",City:"New York, NY",Latitude:40.726559,Longitude:-73.987824,Coordinates:"40.726559, -73.987824"},{Precinct:"10th Precinct","Phone Number":"212-741-8211",Address:"230 West 20th Street",City:"New York, NY",Latitude:40.742706,Longitude:-73.998636,Coordinates:"40.742706, -73.998636"},{Precinct:"13th Precinct","Phone Number":"212-477-7411",Address:"230 East 21st Street",City:"New York, NY",Latitude:40.736788,Longitude:-73.982908,Coordinates:"40.736788, -73.982908"},{Precinct:"Midtown South Precinct","Phone Number":"212-239-9811",Address:"357 West 35th Street",City:"New York, NY",Latitude:40.75389,Longitude:-73.994894,Coordinates:"40.75389, -73.994894"},{Precinct:"17th Precinct","Phone Number":"212-826-3211",Address:"167 East 51st Street",City:"New York, NY",Latitude:40.756762,Longitude:-73.970786,Coordinates:"40.756762, -73.970786"},{Precinct:"Midtown North Precinct","Phone Number":"212-767-8400",Address:"306 West 54th Street",City:"New York, NY",Latitude:40.764952,Longitude:-73.985138,Coordinates:"40.764952, -73.985138"},{Precinct:"19th Precinct","Phone Number":"212-452-0600",Address:"153 East 67th Street",City:"New York, NY",Latitude:40.767144,Longitude:-73.963764,Coordinates:"40.767144, -73.963764"},{Precinct:"20th Precinct","Phone Number":"212-580-6411",Address:"120 West 82nd Street",City:"New York, NY",Latitude:40.784181,Longitude:-73.974986,Coordinates:"40.784181, -73.974986"},{Precinct:"Central Park Precinct","Phone Number":"212-570-4820",Address:"86th St & Transverse Road",City:"New York, NY",Latitude:40.783819,Longitude:-73.965569,Coordinates:"40.783819, -73.965569"},{Precinct:"23rd Precinct","Phone Number":"212-860-6411",Address:"164 East 102nd Street",City:"New York, NY",Latitude:40.789181,Longitude:-73.947217,Coordinates:"40.789181, -73.947217"},{Precinct:"24th Precinct","Phone Number":"212-678-1811",Address:"151 West 100th Street",City:"New York, NY",Latitude:40.796506,Longitude:-73.967346,Coordinates:"40.796506, -73.967346"},{Precinct:"25th Precinct","Phone Number":"212-860-6511",Address:"120 East 119th Street",City:"New York, NY",Latitude:40.800697,Longitude:-73.941103,Coordinates:"40.800697, -73.941103"},{Precinct:"26th Precinct","Phone Number":"212-678-1311",Address:"520 West 126th Street",City:"New York, NY",Latitude:40.814741,Longitude:-73.956406,Coordinates:"40.814741, -73.956406"},{Precinct:"28th Precinct","Phone Number":"212-678-1611",Address:"2271-89 8th Avenue",City:"New York, NY",Latitude:40.808854,Longitude:-73.952629,Coordinates:"40.808854, -73.952629"},{Precinct:"30th Precinct","Phone Number":"212-690-8811",Address:"451 West 151st Street",City:"New York, NY",Latitude:40.828757,Longitude:-73.943651,Coordinates:"40.828757, -73.943651"},{Precinct:"32nd Precinct","Phone Number":"212-690-6311",Address:"250 West 135th Street",City:"New York, NY",Latitude:40.815731,Longitude:-73.945359,Coordinates:"40.815731, -73.945359"},{Precinct:"33rd Precinct","Phone Number":"212-927-3200",Address:"2207 Amsterdam Avenue",City:"New York, NY",Latitude:40.840689,Longitude:-73.935707,Coordinates:"40.840689, -73.935707"},{Precinct:"34th Precinct","Phone Number":"212-927-9711",Address:"4295 Broadway",City:"New York, NY",Latitude:40.851546,Longitude:-73.935385,Coordinates:"40.851546, -73.935385"},{Precinct:"40th Precinct","Phone Number":"718-402-2270",Address:"257 Alexander Avenue",City:"New York, NY",Latitude:40.810374,Longitude:-73.925293,Coordinates:"40.810374, -73.925293"},{Precinct:"41st Precinct","Phone Number":"718-542-4771",Address:"1035 Longwood Avenue",City:"New York, NY",Latitude:40.816325,Longitude:-73.895656,Coordinates:"40.816325, -73.895656"},{Precinct:"42nd Precinct","Phone Number":"718-402-3887",Address:"830 Washington Avenue",City:"New York, NY",Latitude:40.822557,Longitude:-73.911384,Coordinates:"40.822557, -73.911384"},{Precinct:"43rd Precinct","Phone Number":"718-542-0888",Address:"900 Fteley Avenue",City:"New York, NY",Latitude:40.823071,Longitude:-73.869794,Coordinates:"40.823071, -73.869794"},{Precinct:"44th Precinct","Phone Number":"718-590-5511",Address:"2 East 169th Street",City:"New York, NY",Latitude:40.837204,Longitude:-73.919908,Coordinates:"40.837204, -73.919908"},{Precinct:"45th Precinct","Phone Number":"718-822-5411",Address:"2877 Barkley Avenue",City:"New York, NY",Latitude:40.83086,Longitude:-73.827341,Coordinates:"40.83086, -73.827341"},{Precinct:"46th Precinct","Phone Number":"718-220-5211",Address:"2120 Ryer Avenue",City:"New York, NY",Latitude:40.853988,Longitude:-73.900112,Coordinates:"40.853988, -73.900112"},{Precinct:"47th Precinct","Phone Number":"718-920-1211",Address:"4111 Laconia Avenue",City:"New York, NY",Latitude:40.887545,Longitude:-73.847512,Coordinates:"40.887545, -73.847512"},{Precinct:"48th Precinct","Phone Number":"718-299-3900",Address:"450 Cross Bronx Expressway",City:"New York, NY",Latitude:40.843923,Longitude:-73.900446,Coordinates:"40.843923, -73.900446"},{Precinct:"49th Precinct","Phone Number":"718-918-2000",Address:"2121 Eastchester Road",City:"New York, NY",Latitude:40.856026,Longitude:-73.844421,Coordinates:"40.856026, -73.844421"},{Precinct:"50th Precinct","Phone Number":"718-543-5700",Address:"3450 Kingsbridge Avenue",City:"New York, NY",Latitude:40.883569,Longitude:-73.902317,Coordinates:"40.883569, -73.902317"},{Precinct:"52nd Precinct","Phone Number":"718-220-5811",Address:"3016 Webster Avenue",City:"New York, NY",Latitude:40.869083,Longitude:-73.879625,Coordinates:"40.869083, -73.879625"},{Precinct:"60th Precinct","Phone Number":"718-946-3311",Address:"2951 West 8th Street",City:"New York, NY",Latitude:40.576552,Longitude:-73.976116,Coordinates:"40.576552, -73.976116"},{Precinct:"61st Precinct","Phone Number":"718-627-6611",Address:"2575 Coney Island Avenue",City:"New York, NY",Latitude:40.594152,Longitude:-73.960504,Coordinates:"40.594152, -73.960504"},{Precinct:"62nd Precinct","Phone Number":"718-236-2611",Address:"1925 Bath Avenue",City:"New York, NY",Latitude:40.602502,Longitude:-74.003135,Coordinates:"40.602502, -74.003135"},{Precinct:"63rd Precinct","Phone Number":"718-258-4411",Address:"1844 Brooklyn Avenue",City:"New York, NY",Latitude:40.627949,Longitude:-73.941631,Coordinates:"40.627949, -73.941631"},{Precinct:"66th Precinct","Phone Number":"718-851-5611",Address:"5822 16th Avenue",City:"New York, NY",Latitude:40.625712,Longitude:-73.991385,Coordinates:"40.625712, -73.991385"},{Precinct:"67th Precinct","Phone Number":"718-287-3211",Address:"2820 Snyder Avenue",City:"New York, NY",Latitude:40.648665,Longitude:-73.950264,Coordinates:"40.648665, -73.950264"},{Precinct:"68th Precinct","Phone Number":"718-439-4211",Address:"333 65th Street",City:"New York, NY",Latitude:40.763955,Longitude:-73.960125,Coordinates:"40.763955, -73.960125"},{Precinct:"69th Precinct","Phone Number":"718-257-6211",Address:"9720 Foster Avenue",City:"New York, NY",Latitude:40.648479,Longitude:-73.904981,Coordinates:"40.648479, -73.904981"},{Precinct:"70th Precinct","Phone Number":"718-851-5511",Address:"154 Lawrence Avenue",City:"New York, NY",Latitude:40.630338,Longitude:-73.973682,Coordinates:"40.630338, -73.973682"},{Precinct:"71st Precinct","Phone Number":"718-735-0511",Address:"421 Empire Boulevard",City:"New York, NY",Latitude:40.664592,Longitude:-73.94783,Coordinates:"40.664592, -73.94783"},{Precinct:"72nd Precinct","Phone Number":"718-965-6311",Address:"830 4th Avenue",City:"New York, NY",Latitude:40.658322,Longitude:-74.000862,Coordinates:"40.658322, -74.000862"},{Precinct:"73rd Precinct","Phone Number":"718-495-5411",Address:"1470 East New York Avenue",City:"New York, NY",Latitude:40.670799,Longitude:-73.913524,Coordinates:"40.670799, -73.913524"},{Precinct:"75th Precinct","Phone Number":"718-827-3511",Address:"1000 Sutter Avenue",City:"New York, NY",Latitude:40.671183,Longitude:-73.881554,Coordinates:"40.671183, -73.881554"},{Precinct:"76th Precinct","Phone Number":"718-834-3211",Address:"191 Union Street",City:"New York, NY",Latitude:40.683818,Longitude:-74.00022,Coordinates:"40.683818, -74.00022"},{Precinct:"77th Precinct","Phone Number":"718-735-0611",Address:"127 Utica Avenue",City:"New York, NY",Latitude:40.674649,Longitude:-73.930241,Coordinates:"40.674649, -73.930241"},{Precinct:"78th Precinct","Phone Number":"718-636-6411",Address:"65 6th Avenue",City:"New York, NY",Latitude:40.721556,Longitude:-74.005506,Coordinates:"40.721556, -74.005506"},{Precinct:"79th Precinct","Phone Number":"718-636-6611",Address:"263 Tompkins Avenue",City:"New York, NY",Latitude:40.688814,Longitude:-73.944843,Coordinates:"40.688814, -73.944843"},{Precinct:"81st Precinct","Phone Number":"718-574-0411",Address:"30 Ralph Avenue",City:"New York, NY",Latitude:40.689557,Longitude:-73.924317,Coordinates:"40.689557, -73.924317"},{Precinct:"83rd Precinct","Phone Number":"718-574-1605",Address:"480 Knickerbocker Avenue",City:"New York, NY",Latitude:40.698147,Longitude:-73.917841,Coordinates:"40.698147, -73.917841"},{Precinct:"84th Precinct","Phone Number":"718-875-6811",Address:"301 Gold Street",City:"New York, NY",Latitude:40.695543,Longitude:-73.982911,Coordinates:"40.695543, -73.982911"},{Precinct:"88th Precinct","Phone Number":"718-636-6511",Address:"298 Classon Avenue",City:"New York, NY",Latitude:40.690065,Longitude:-73.960527,Coordinates:"40.690065, -73.960527"},{Precinct:"90th Precinct","Phone Number":"718-963-5311",Address:"211 Union Avenue",City:"New York, NY",Latitude:40.706273,Longitude:-73.950769,Coordinates:"40.706273, -73.950769"},{Precinct:"94th Precinct","Phone Number":"718-383-3879",Address:"100 Meserole Avenue",City:"New York, NY",Latitude:40.726674,Longitude:-73.953295,Coordinates:"40.726674, -73.953295"},{Precinct:"100th Precinct","Phone Number":"718-318-4200",Address:"92-24 Rockaway Beach Boulevard",City:"New York, NY",Latitude:40.586248,Longitude:-73.816477,Coordinates:"40.586248, -73.816477"},{Precinct:"101st Precinct","Phone Number":"718-868-3400",Address:"16-12 Mott Avenue",City:"New York, NY",Latitude:40.602909,Longitude:-73.749925,Coordinates:"40.602909, -73.749925"},{Precinct:"102nd Precinct","Phone Number":"718-805-3200",Address:"87-34 118th Street",City:"New York, NY",Latitude:40.698715,Longitude:-73.831568,Coordinates:"40.698715, -73.831568"},{Precinct:"103rd Precinct","Phone Number":"718-657-8181",Address:"168-02 P.O Edward Byrne Ave.",City:"New York, NY",Latitude:40.707081,Longitude:-73.792645,Coordinates:"40.707081, -73.792645"},{Precinct:"104th Precinct","Phone Number":"718-386-3004",Address:"64-2 Catalpa Avenue",City:"New York, NY",Latitude:40.704357,Longitude:-73.893649,Coordinates:"40.704357, -73.893649"},{Precinct:"105th Precinct","Phone Number":"718-776-9090",Address:"92-08 222nd Street",City:"New York, NY",Latitude:40.726225,Longitude:-73.735144,Coordinates:"40.726225, -73.735144"},{Precinct:"106th Precinct","Phone Number":"718-845-2211",Address:"103-53 101st Street",City:"New York, NY",Latitude:40.682174,Longitude:-73.839718,Coordinates:"40.682174, -73.839718"},{Precinct:"107th Precinct","Phone Number":"718-969-5100",Address:"71-01 Parsons Boulevard",City:"New York, NY",Latitude:40.729909,Longitude:-73.810614,Coordinates:"40.729909, -73.810614"},{Precinct:"108th Precinct","Phone Number":"718-784-5411",Address:"5-47 50th Avenue",City:"New York, NY",Latitude:40.743083,Longitude:-73.954672,Coordinates:"40.743083, -73.954672"},{Precinct:"109th Precinct","Phone Number":"718-321-2250",Address:"37-05 Union Street",City:"New York, NY",Latitude:40.762361,Longitude:-73.82702,Coordinates:"40.762361, -73.82702"},{Precinct:"110th Precinct","Phone Number":"718-476-9311",Address:"94-41 43rd Avenue",City:"New York, NY",Latitude:40.745219,Longitude:-73.870069,Coordinates:"40.745219, -73.870069"},{Precinct:"111th Precinct","Phone Number":"718-279-5200",Address:"45-06 215th Street",City:"New York, NY",Latitude:40.760244,Longitude:-73.767781,Coordinates:"40.760244, -73.767781"},{Precinct:"112th Precinct","Phone Number":"718-520-9311",Address:"68-40 Austin Street",City:"New York, NY",Latitude:40.722358,Longitude:-73.851468,Coordinates:"40.722358, -73.851468"},{Precinct:"113th Precinct","Phone Number":"718-712-7733",Address:"167-02 Baisley Boulevard",City:"New York, NY",Latitude:40.679801,Longitude:-73.775686,Coordinates:"40.679801, -73.775686"},{Precinct:"114th Precinct","Phone Number":"718-626-9311",Address:"34-16 Astoria Boulevard",City:"New York, NY",Latitude:40.769282,Longitude:-73.915328,Coordinates:"40.769282, -73.915328"},{Precinct:"115th Precinct","Phone Number":"718-533-2002",Address:"92-15 Northern Boulevard",City:"New York, NY",Latitude:40.756875,Longitude:-73.87549,Coordinates:"40.756875, -73.87549"},{Precinct:"120th Precinct","Phone Number":"718-876-8500",Address:"78 Richmond Terrace",City:"New York, NY",Latitude:40.644628,Longitude:-74.077423,Coordinates:"40.644628, -74.077423"},{Precinct:"121st Precinct","Phone Number":"718-697-8700",Address:"970 Richmond Avenue",City:"New York, NY",Latitude:40.623676,Longitude:-74.150343,Coordinates:"40.623676, -74.150343"},{Precinct:"122nd Precinct","Phone Number":"718-667-2211",Address:"2320 Hylan Boulevard",City:"New York, NY",Latitude:40.574118,Longitude:-74.105506,Coordinates:"40.574118, -74.105506"},{Precinct:"123rd Precinct","Phone Number":"718-948-9311",Address:"116 Main Street",City:"New York, NY",Latitude:40.713577,Longitude:-73.816632,Coordinates:"40.713577, -73.816632"}]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(15),a=f(o),s=f(n(238)),u=f(n(532)),c=n(224),l=n(180);n(533),f(n(225));function f(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._onViewportChange=function(t){var e=Object.assign({},n.state.viewport,t);n.setState({viewport:e})},n.state={viewport:{width:window.innerWidth,height:window.innerHeight,longitude:-74,latitude:40.7,zoom:11,maxZoom:16},points:[],settings:r({},Object.keys(c.SCATTERPLOT_CONTROLS).reduce(function(t,e){return r({},t,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,c.SCATTERPLOT_CONTROLS[e].value))},{})),x:0,y:0,hoveredObject:null,status:"LOADING"},n._resize=n._resize.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"componentDidMount",value:function(){console.log("dataaaa, data"),this._processData(),window.addEventListener("resize",this._resize),this._resize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"_processData",value:function(){if(bikeData){this.setState({status:"LOADED"});var t=bikeData.data.stations.reduce(function(t,e){return t.push({position:[Number(e.lon),Number(e.lat)],pickup:!0}),t},[]);this.setState({points:t,status:"READY"})}}},{key:"_onHover",value:function(t){var e=t.x,n=t.y,r=t.object;this.setState({x:e,y:n,hoveredObject:r})}},{key:"_resize",value:function(){this._onViewportChange({width:window.innerWidth,height:window.innerHeight})}},{key:"_updateLayerSettings",value:function(t){this.setState({settings:t})}},{key:"render",value:function(){var t=this;return console.log("STATE",this.state),console.log("POINTS",this.state.points),a.default.createElement("div",null,this.state.hoveredObject&&a.default.createElement("div",{style:r({},l.tooltipStyle,{transform:"translate("+this.state.x+"px, "+this.state.y+"px)"})},a.default.createElement("div",null,JSON.stringify(this.state.hoveredObject))),a.default.createElement(c.LayerControls,{settings:this.state.settings,propTypes:c.SCATTERPLOT_CONTROLS,title:"TESTSETSTEST",onChange:function(e){return t._updateLayerSettings(e)}}),a.default.createElement(s.default,r({},this.state.viewport,{mapStyle:"mapbox://styles/mapbox/dark-v9",onViewportChange:function(e){return t._onViewportChange(e)},mapboxApiAccessToken:"pk.eyJ1IjoiamFzb254aGFuZyIsImEiOiJjam1pNjJ5ajIwMW1lM3JwazVyZWE1bW4xIn0.xt5U4JljOeJoD7ArM66mIA"}),a.default.createElement(u.default,r({viewport:this.state.viewport,data:this.state.points,onHover:function(e){return t._onHover(e)}},this.state.settings))))}}]),e}();e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(15),a=c(o),s=n(237),u=c(s);function c(t){return t&&t.__esModule?t:{default:t}}var l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(236)).easeCubicInOut,f=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"render",value:function(){if(!this.props.data)return null;var t=[new s.ScatterplotLayer(r({id:"scatterplot",pickable:!0,opacity:.6,radiusScale:10,radiusMinPixels:1,radiusMaxPixels:150},this.props,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({getPosition:function(t){return t.position},getRadius:function(t){return 5},getColor:function(t){return[166,16,30]},transitions:!0},"transitions",{getPositions:{duration:600,easing:l,enter:function(t){return t.properties.fill.concat(0)}}})))];return a.default.createElement(u.default,r({},this.props.viewport,{layers:t}))}}]),e}();e.default=f},function(t,e,n){"use strict"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=u(n(15)),o=n(535),a=u(o),s=u(n(122));function u(t){return t&&t.__esModule?t:{default:t}}var c=(0,a.default)({accessToken:"pk.eyJ1IjoiamFzb254aGFuZyIsImEiOiJjam1pNjJ5ajIwMW1lM3JwazVyZWE1bW4xIn0.xt5U4JljOeJoD7ArM66mIA"}),l=[-74.009,40.705],f=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"componentDidMount",value:function(){this.map=new s.default.Map({container:this.mapContainer,style:"mapbox://styles/mapbox/streets-v9",center:l,zoom:12})}},{key:"componentWillUnmount",value:function(){this.map.remove()}},{key:"render",value:function(){return i.default.createElement(c,{style:"mapbox://styles/mapbox/streets-v9",containerStyle:{height:"100vh",width:"100vw"}},i.default.createElement(o.Layer,{type:"symbol",id:"marker",layout:{"icon-image":"marker-15"}},i.default.createElement(o.Feature,{coordinates:[-.481747846041145,51.3233379650232]})))}}]),e}();e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(536);e.Map=r.default;var i=n(545),o=n(546),a=n(547);e.GeoJSONLayer=a.default;var s=n(548);e.Feature=s.default;var u=n(549);e.ZoomControl=u.default;var c=n(550);e.Popup=c.default;var l=n(552);e.ScaleControl=l.default;var f=n(553);e.Marker=f.default;var h=n(554);e.Source=h.default;var p=n(555);e.Cluster=p.default;var d=n(564);e.RotationControl=d.default;var v=n(82).withMap(o.default(i.default));e.Layer=v,e.default=r.default},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(122),a=n(15),s=n(537),u=n(82),c=n(182),l=[11],f=[-.2416815,51.5285582];e.default=function(t){var e,h=t.accessToken,p=t.apiUrl,d=t.minZoom,v=void 0===d?0:d,g=t.maxZoom,m=void 0===g?20:g,y=t.hash,_=void 0!==y&&y,b=t.preserveDrawingBuffer,x=void 0!==b&&b,w=t.scrollZoom,E=void 0===w||w,S=t.interactive,P=void 0===S||S,T=t.dragRotate,A=void 0===T||T,k=t.attributionControl,C=void 0===k||k,O=t.customAttribution,M=t.logoPosition,I=void 0===M?"bottom-left":M,L=t.renderWorldCopies,R=void 0===L||L,j=t.trackResize,z=void 0===j||j,D=t.touchZoomRotate,F=void 0===D||D,N=t.doubleClickZoom,B=void 0===N||N,U=t.keyboard,V=void 0===U||U,G=t.dragPan,q=void 0===G||G,W=t.boxZoom,Z=void 0===W||W,X=t.refreshExpiredTiles,H=void 0===X||X,Y=t.failIfMajorPerformanceCaveat,K=void 0!==Y&&Y,J=t.bearingSnap,Q=void 0===J?7:J,$=t.injectCSS,tt=void 0===$||$,et=t.transformRequest;return tt&&n(540),(e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={map:void 0,ready:!1},e.listeners={},e._isMounted=!0,e.calcCenter=function(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]},e.setRef=function(t){e.container=t},e}return r(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props,n=e.style,r=e.onStyleLoad,i=e.center,a=e.pitch,u=e.zoom,c=e.fitBounds,l=e.fitBoundsOptions,d=e.bearing,g=e.maxBounds;if(o.accessToken=h,p&&(o.config.API_URL=p),!Array.isArray(u))throw new Error("zoom need to be an array type of length 1 for reliable update");var y={preserveDrawingBuffer:x,hash:_,zoom:u[0],minZoom:v,maxZoom:m,maxBounds:g,container:this.container,center:c&&i===f?this.calcCenter(c):i,style:n,scrollZoom:E,attributionControl:C,customAttribution:O,interactive:P,dragRotate:A,renderWorldCopies:R,trackResize:z,touchZoomRotate:F,doubleClickZoom:B,keyboard:V,dragPan:q,boxZoom:Z,refreshExpiredTiles:H,logoPosition:I,bearingSnap:Q,failIfMajorPerformanceCaveat:K,transformRequest:et};if(d){if(!Array.isArray(d))throw new Error("bearing need to be an array type of length 1 for reliable update");y.bearing=d[0]}if(a){if(!Array.isArray(a))throw new Error("pitch need to be an array type of length 1 for reliable update");y.pitch=a[0]}var b=new o.Map(y);this.setState({map:b}),c&&b.fitBounds(c,l),b.on("load",function(e){t._isMounted&&t.setState({ready:!0}),r&&r(b,e)}),this.listeners=s.listenEvents(s.events,this.props,b)},e.prototype.componentWillUnmount=function(){var t=this.state.map;this._isMounted=!1,t&&t.remove()},e.prototype.componentWillReceiveProps=function(t){var e=this.state.map;if(!e)return null;this.listeners=s.updateEvents(this.listeners,t,e);var n=e.getCenter(),r=e.getZoom(),o=e.getBearing(),a=e.getPitch(),u=this.props.zoom!==t.zoom&&(t.zoom&&t.zoom[0])!==r,l=this.props.center!==t.center&&((t.center&&t.center[0])!==n.lng||(t.center&&t.center[1])!==n.lat),f=this.props.bearing!==t.bearing&&(t.bearing&&t.bearing[0])!==o,h=this.props.pitch!==t.pitch&&(t.pitch&&t.pitch[0])!==a;if(t.maxBounds&&this.props.maxBounds!==t.maxBounds&&e.setMaxBounds(t.maxBounds),t.fitBounds){var p=this.props.fitBounds;p===t.fitBounds&&t.fitBounds.length===(p&&p.length)&&!p.filter(function(e,n){var r=t.fitBounds&&t.fitBounds[n];return e[0]!==(r&&r[0])||e[1]!==(r&&r[1])})[0]&&c(this.props.fitBoundsOptions,t.fitBoundsOptions)||e.fitBounds(t.fitBounds,t.fitBoundsOptions)}if(u||l||f||h){var d=t.movingMethod||"flyTo",v=t.flyToOptions,g=t.animationOptions;e[d](i({},g,v,{zoom:u&&t.zoom?t.zoom[0]:r,center:l?t.center:n,bearing:f?t.bearing:o,pitch:h?t.pitch:a}))}return c(this.props.style,t.style)||e.setStyle(t.style),null},e.prototype.render=function(){var t=this.props,e=t.containerStyle,n=t.className,r=t.children,o=this.state.ready;return a.createElement(u.MapContext.Provider,{value:this.state.map},a.createElement("div",{ref:this.setRef,className:n,style:i({},e)},o&&r))},e}(a.Component)).defaultProps={onStyleLoad:function(t,e){return null},center:f,zoom:l,bearing:0,movingMethod:"flyTo",pitch:0,containerStyle:{textAlign:"left"}},e}},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.events={onResize:"resize",onDblClick:"dblclick",onClick:"click",onMouseMove:"mousemove",onMouseOut:"mouseout",onMoveStart:"movestart",onMove:"move",onMoveEnd:"moveend",onMouseUp:"mouseup",onMouseDown:"mousedown",onDragStart:"dragstart",onDrag:"drag",onDragEnd:"dragend",onZoomStart:"zoomstart",onZoom:"zoom",onZoomEnd:"zoomend",onPitch:"pitch",onPitchStart:"pitchstart",onPitchEnd:"pitchend",onWebGlContextLost:"webglcontextlost",onWebGlContextRestored:"webglcontextrestored",onRemove:"remove",onContextMenu:"contextmenu",onRender:"render",onError:"error",onSourceData:"sourcedata",onDataLoading:"dataloading",onStyleDataLoading:"styledataloading",onTouchCancel:"touchcancel",onData:"data",onSourceDataLoading:"sourcedataloading",onTouchMove:"touchmove",onTouchEnd:"touchend",onTouchStart:"touchstart",onStyleData:"styledata",onBoxZoomStart:"boxzoomstart",onBoxZoomEnd:"boxzoomend",onBoxZoomCancel:"boxzoomcancel",onRotateStart:"rotatestart",onRotate:"rotate",onRotateEnd:"rotateend"},e.listenEvents=function(t,e,n){return Object.keys(t).reduce(function(r,i){var o=e[i];if(o){var a=function(t){o(n,t)};n.on(t[i],a),r[i]=a}return r},{})},e.updateEvents=function(t,n,i){Object.keys(e.events).filter(function(e){return t[e]&&"function"!=typeof n[e]}).forEach(function(n){i.off(e.events[n],t[n]),delete t[n]});var o=Object.keys(e.events).filter(function(e){return!t[e]&&"function"==typeof n[e]}).reduce(function(t,n){return t[n]=e.events[n],t},{}),a=e.listenEvents(o,n,i);return r({},t,a)}},function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n},function(t,e){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function i(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=n?r:i).supported=r,e.unsupported=i},function(t,e,n){var r=n(541);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(543)(r,i);r.locals&&(t.exports=r.locals)},function(t,e,n){(t.exports=n(542)(!1)).push([t.i,".mapboxgl-map {\n    font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n    overflow: hidden;\n    position: relative;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n\n.mapboxgl-map:-webkit-full-screen {\n    width: 100%;\n    height: 100%;\n}\n\n.mapboxgl-canary {\n    background-color: salmon;\n}\n\n.mapboxgl-canvas-container.mapboxgl-interactive,\n.mapboxgl-ctrl-group > button.mapboxgl-ctrl-compass {\n    cursor: -webkit-grab;\n    cursor: -moz-grab;\n    cursor: grab;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n.mapboxgl-canvas-container.mapboxgl-interactive:active,\n.mapboxgl-ctrl-group > button.mapboxgl-ctrl-compass:active {\n    cursor: -webkit-grabbing;\n    cursor: -moz-grabbing;\n    cursor: grabbing;\n}\n\n.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,\n.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas {\n    touch-action: pan-x pan-y;\n}\n\n.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,\n.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas {\n    touch-action: pinch-zoom;\n}\n\n.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,\n.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas {\n    touch-action: none;\n}\n\n.mapboxgl-ctrl-top-left,\n.mapboxgl-ctrl-top-right,\n.mapboxgl-ctrl-bottom-left,\n.mapboxgl-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }\n.mapboxgl-ctrl-top-left     { top: 0; left: 0; }\n.mapboxgl-ctrl-top-right    { top: 0; right: 0; }\n.mapboxgl-ctrl-bottom-left  { bottom: 0; left: 0; }\n.mapboxgl-ctrl-bottom-right { right: 0; bottom: 0; }\n\n.mapboxgl-ctrl { clear: both; pointer-events: auto; }\n.mapboxgl-ctrl-top-left .mapboxgl-ctrl     { margin: 10px 0 0 10px; float: left; }\n.mapboxgl-ctrl-top-right .mapboxgl-ctrl    { margin: 10px 10px 0 0; float: right; }\n.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl  { margin: 0 0 10px 10px; float: left; }\n.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl { margin: 0 10px 10px 0; float: right; }\n\n.mapboxgl-ctrl-group {\n    border-radius: 4px;\n    overflow: hidden;\n    background: #fff;\n}\n\n.mapboxgl-ctrl-group:not(:empty) {\n    -moz-box-shadow: 0 0 2px rgba(0, 0, 0, 0.1);\n    -webkit-box-shadow: 0 0 2px rgba(0, 0, 0, 0.1);\n    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);\n}\n\n.mapboxgl-ctrl-group > button {\n    width: 30px;\n    height: 30px;\n    display: block;\n    padding: 0;\n    outline: none;\n    border: 0;\n    box-sizing: border-box;\n    background-color: transparent;\n    cursor: pointer;\n}\n\n.mapboxgl-ctrl-group > button + button {\n    border-top: 1px solid #ddd;\n}\n\n/* https://bugzilla.mozilla.org/show_bug.cgi?id=140562 */\n.mapboxgl-ctrl > button::-moz-focus-inner {\n    border: 0;\n    padding: 0;\n}\n\n.mapboxgl-ctrl > button:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n}\n\n.mapboxgl-ctrl-icon,\n.mapboxgl-ctrl-icon > .mapboxgl-ctrl-compass-arrow {\n    speak: none;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n}\n\n.mapboxgl-ctrl-icon {\n    padding: 5px;\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-zoom-out {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath style='fill:%23333333;' d='m 7,9 c -0.554,0 -1,0.446 -1,1 0,0.554 0.446,1 1,1 l 6,0 c 0.554,0 1,-0.446 1,-1 0,-0.554 -0.446,-1 -1,-1 z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-zoom-in {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath style='fill:%23333333;' d='M 10 6 C 9.446 6 9 6.4459904 9 7 L 9 9 L 7 9 C 6.446 9 6 9.446 6 10 C 6 10.554 6.446 11 7 11 L 9 11 L 9 13 C 9 13.55401 9.446 14 10 14 C 10.554 14 11 13.55401 11 13 L 11 11 L 13 11 C 13.554 11 14 10.554 14 10 C 14 9.446 13.554 9 13 9 L 11 9 L 11 7 C 11 6.4459904 10.554 6 10 6 z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E %3Cpath d='M10 4C9 4 9 5 9 5L9 5.1A5 5 0 0 0 5.1 9L5 9C5 9 4 9 4 10 4 11 5 11 5 11L5.1 11A5 5 0 0 0 9 14.9L9 15C9 15 9 16 10 16 11 16 11 15 11 15L11 14.9A5 5 0 0 0 14.9 11L15 11C15 11 16 11 16 10 16 9 15 9 15 9L14.9 9A5 5 0 0 0 11 5.1L11 5C11 5 11 4 10 4zM10 6.5A3.5 3.5 0 0 1 13.5 10 3.5 3.5 0 0 1 10 13.5 3.5 3.5 0 0 1 6.5 10 3.5 3.5 0 0 1 10 6.5zM10 8.3A1.8 1.8 0 0 0 8.3 10 1.8 1.8 0 0 0 10 11.8 1.8 1.8 0 0 0 11.8 10 1.8 1.8 0 0 0 10 8.3z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate:disabled {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E %3Cpath d='M10 4C9 4 9 5 9 5L9 5.1A5 5 0 0 0 5.1 9L5 9C5 9 4 9 4 10 4 11 5 11 5 11L5.1 11A5 5 0 0 0 9 14.9L9 15C9 15 9 16 10 16 11 16 11 15 11 15L11 14.9A5 5 0 0 0 14.9 11L15 11C15 11 16 11 16 10 16 9 15 9 15 9L14.9 9A5 5 0 0 0 11 5.1L11 5C11 5 11 4 10 4zM10 6.5A3.5 3.5 0 0 1 13.5 10 3.5 3.5 0 0 1 10 13.5 3.5 3.5 0 0 1 6.5 10 3.5 3.5 0 0 1 10 6.5zM10 8.3A1.8 1.8 0 0 0 8.3 10 1.8 1.8 0 0 0 10 11.8 1.8 1.8 0 0 0 11.8 10 1.8 1.8 0 0 0 10 8.3z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E %3Cpath d='M10 4C9 4 9 5 9 5L9 5.1A5 5 0 0 0 5.1 9L5 9C5 9 4 9 4 10 4 11 5 11 5 11L5.1 11A5 5 0 0 0 9 14.9L9 15C9 15 9 16 10 16 11 16 11 15 11 15L11 14.9A5 5 0 0 0 14.9 11L15 11C15 11 16 11 16 10 16 9 15 9 15 9L14.9 9A5 5 0 0 0 11 5.1L11 5C11 5 11 4 10 4zM10 6.5A3.5 3.5 0 0 1 13.5 10 3.5 3.5 0 0 1 10 13.5 3.5 3.5 0 0 1 6.5 10 3.5 3.5 0 0 1 10 6.5zM10 8.3A1.8 1.8 0 0 0 8.3 10 1.8 1.8 0 0 0 10 11.8 1.8 1.8 0 0 0 11.8 10 1.8 1.8 0 0 0 10 8.3z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E %3Cpath d='M10 4C9 4 9 5 9 5L9 5.1A5 5 0 0 0 5.1 9L5 9C5 9 4 9 4 10 4 11 5 11 5 11L5.1 11A5 5 0 0 0 9 14.9L9 15C9 15 9 16 10 16 11 16 11 15 11 15L11 14.9A5 5 0 0 0 14.9 11L15 11C15 11 16 11 16 10 16 9 15 9 15 9L14.9 9A5 5 0 0 0 11 5.1L11 5C11 5 11 4 10 4zM10 6.5A3.5 3.5 0 0 1 13.5 10 3.5 3.5 0 0 1 10 13.5 3.5 3.5 0 0 1 6.5 10 3.5 3.5 0 0 1 10 6.5zM10 8.3A1.8 1.8 0 0 0 8.3 10 1.8 1.8 0 0 0 10 11.8 1.8 1.8 0 0 0 11.8 10 1.8 1.8 0 0 0 10 8.3z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E %3Cpath d='M 10,4 C 9,4 9,5 9,5 L 9,5.1 C 7.0357113,5.5006048 5.5006048,7.0357113 5.1,9 L 5,9 c 0,0 -1,0 -1,1 0,1 1,1 1,1 l 0.1,0 c 0.4006048,1.964289 1.9357113,3.499395 3.9,3.9 L 9,15 c 0,0 0,1 1,1 1,0 1,-1 1,-1 l 0,-0.1 c 1.964289,-0.400605 3.499395,-1.935711 3.9,-3.9 l 0.1,0 c 0,0 1,0 1,-1 C 16,9 15,9 15,9 L 14.9,9 C 14.499395,7.0357113 12.964289,5.5006048 11,5.1 L 11,5 c 0,0 0,-1 -1,-1 z m 0,2.5 c 1.932997,0 3.5,1.5670034 3.5,3.5 0,1.932997 -1.567003,3.5 -3.5,3.5 C 8.0670034,13.5 6.5,11.932997 6.5,10 6.5,8.0670034 8.0670034,6.5 10,6.5 Z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E %3Cpath d='M 10,4 C 9,4 9,5 9,5 L 9,5.1 C 7.0357113,5.5006048 5.5006048,7.0357113 5.1,9 L 5,9 c 0,0 -1,0 -1,1 0,1 1,1 1,1 l 0.1,0 c 0.4006048,1.964289 1.9357113,3.499395 3.9,3.9 L 9,15 c 0,0 0,1 1,1 1,0 1,-1 1,-1 l 0,-0.1 c 1.964289,-0.400605 3.499395,-1.935711 3.9,-3.9 l 0.1,0 c 0,0 1,0 1,-1 C 16,9 15,9 15,9 L 14.9,9 C 14.499395,7.0357113 12.964289,5.5006048 11,5.1 L 11,5 c 0,0 0,-1 -1,-1 z m 0,2.5 c 1.932997,0 3.5,1.5670034 3.5,3.5 0,1.932997 -1.567003,3.5 -3.5,3.5 C 8.0670034,13.5 6.5,11.932997 6.5,10 6.5,8.0670034 8.0670034,6.5 10,6.5 Z'/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting {\n    -webkit-animation: mapboxgl-spin 2s infinite linear;\n    -moz-animation: mapboxgl-spin 2s infinite linear;\n    -o-animation: mapboxgl-spin 2s infinite linear;\n    -ms-animation: mapboxgl-spin 2s infinite linear;\n    animation: mapboxgl-spin 2s infinite linear;\n}\n\n@-webkit-keyframes mapboxgl-spin {\n    0% { -webkit-transform: rotate(0deg); }\n    100% { -webkit-transform: rotate(360deg); }\n}\n\n@-moz-keyframes mapboxgl-spin {\n    0% { -moz-transform: rotate(0deg); }\n    100% { -moz-transform: rotate(360deg); }\n}\n\n@-o-keyframes mapboxgl-spin {\n    0% { -o-transform: rotate(0deg); }\n    100% { -o-transform: rotate(360deg); }\n}\n\n@-ms-keyframes mapboxgl-spin {\n    0% { -ms-transform: rotate(0deg); }\n    100% { -ms-transform: rotate(360deg); }\n}\n\n@keyframes mapboxgl-spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-fullscreen {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath d='M 5 4 C 4.5 4 4 4.5 4 5 L 4 6 L 4 9 L 4.5 9 L 5.7773438 7.296875 C 6.7771319 8.0602131 7.835765 8.9565728 8.890625 10 C 7.8257121 11.0633 6.7761791 11.951675 5.78125 12.707031 L 4.5 11 L 4 11 L 4 15 C 4 15.5 4.5 16 5 16 L 9 16 L 9 15.5 L 7.2734375 14.205078 C 8.0428931 13.187886 8.9395441 12.133481 9.9609375 11.068359 C 11.042371 12.14699 11.942093 13.2112 12.707031 14.21875 L 11 15.5 L 11 16 L 14 16 L 15 16 C 15.5 16 16 15.5 16 15 L 16 14 L 16 11 L 15.5 11 L 14.205078 12.726562 C 13.177985 11.949617 12.112718 11.043577 11.037109 10.009766 C 12.151856 8.981061 13.224345 8.0798624 14.228516 7.3046875 L 15.5 9 L 16 9 L 16 5 C 16 4.5 15.5 4 15 4 L 11 4 L 11 4.5 L 12.703125 5.7773438 C 11.932647 6.7864834 11.026693 7.8554712 9.9707031 8.9199219 C 8.9584739 7.8204943 8.0698767 6.7627188 7.3046875 5.7714844 L 9 4.5 L 9 4 L 6 4 L 5 4 z '/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-shrink {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath style='fill:%23000000;' d='M 4.2421875 3.4921875 A 0.750075 0.750075 0 0 0 3.71875 4.78125 L 5.9648438 7.0273438 L 4 8.5 L 4 9 L 8 9 C 8.500001 8.9999988 9 8.4999992 9 8 L 9 4 L 8.5 4 L 7.0175781 5.9550781 L 4.78125 3.71875 A 0.750075 0.750075 0 0 0 4.2421875 3.4921875 z M 15.734375 3.4921875 A 0.750075 0.750075 0 0 0 15.21875 3.71875 L 12.984375 5.953125 L 11.5 4 L 11 4 L 11 8 C 11 8.4999992 11.499999 8.9999988 12 9 L 16 9 L 16 8.5 L 14.035156 7.0273438 L 16.28125 4.78125 A 0.750075 0.750075 0 0 0 15.734375 3.4921875 z M 4 11 L 4 11.5 L 5.9648438 12.972656 L 3.71875 15.21875 A 0.75130096 0.75130096 0 1 0 4.78125 16.28125 L 7.0273438 14.035156 L 8.5 16 L 9 16 L 9 12 C 9 11.500001 8.500001 11.000001 8 11 L 4 11 z M 12 11 C 11.499999 11.000001 11 11.500001 11 12 L 11 16 L 11.5 16 L 12.972656 14.035156 L 15.21875 16.28125 A 0.75130096 0.75130096 0 1 0 16.28125 15.21875 L 14.035156 12.972656 L 16 11.5 L 16 11 L 12 11 z '/%3E %3C/svg%3E\");\n}\n\n.mapboxgl-ctrl-icon.mapboxgl-ctrl-compass > .mapboxgl-ctrl-compass-arrow {\n    width: 20px;\n    height: 20px;\n    margin: 5px;\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E %3Cpolygon fill='%23333333' points='6,9 10,1 14,9'/%3E %3Cpolygon fill='%23CCCCCC' points='6,11 10,19 14,11 '/%3E %3C/svg%3E\");\n    background-repeat: no-repeat;\n    display: inline-block;\n}\n\na.mapboxgl-ctrl-logo {\n    width: 85px;\n    height: 21px;\n    margin: 0 0 -3px -3px;\n    display: block;\n    background-repeat: no-repeat;\n    cursor: pointer;\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3C?xml version='1.0' encoding='utf-8'?%3E%3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 84.49 21' style='enable-background:new 0 0 84.49 21;' xml:space='preserve'%3E%3Cg%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M83.25,14.26c0,0.12-0.09,0.21-0.21,0.21h-1.61c-0.13,0-0.24-0.06-0.3-0.17l-1.44-2.39l-1.44,2.39 c-0.06,0.11-0.18,0.17-0.3,0.17h-1.61c-0.04,0-0.08-0.01-0.12-0.03c-0.09-0.06-0.13-0.19-0.06-0.28l0,0l2.43-3.68L76.2,6.84 c-0.02-0.03-0.03-0.07-0.03-0.12c0-0.12,0.09-0.21,0.21-0.21h1.61c0.13,0,0.24,0.06,0.3,0.17l1.41,2.36l1.4-2.35 c0.06-0.11,0.18-0.17,0.3-0.17H83c0.04,0,0.08,0.01,0.12,0.03c0.09,0.06,0.13,0.19,0.06,0.28l0,0l-2.37,3.63l2.43,3.67 C83.24,14.18,83.25,14.22,83.25,14.26z'/%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M66.24,9.59c-0.39-1.88-1.96-3.28-3.84-3.28c-1.03,0-2.03,0.42-2.73,1.18V3.51c0-0.13-0.1-0.23-0.23-0.23h-1.4 c-0.13,0-0.23,0.11-0.23,0.23v10.72c0,0.13,0.1,0.23,0.23,0.23h1.4c0.13,0,0.23-0.11,0.23-0.23V13.5c0.71,0.75,1.7,1.18,2.73,1.18 c1.88,0,3.45-1.41,3.84-3.29C66.37,10.79,66.37,10.18,66.24,9.59L66.24,9.59z M62.08,13c-1.32,0-2.39-1.11-2.41-2.48v-0.06 c0.02-1.38,1.09-2.48,2.41-2.48s2.42,1.12,2.42,2.51S63.41,13,62.08,13z'/%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M71.67,6.32c-1.98-0.01-3.72,1.35-4.16,3.29c-0.13,0.59-0.13,1.19,0,1.77c0.44,1.94,2.17,3.32,4.17,3.3 c2.35,0,4.26-1.87,4.26-4.19S74.04,6.32,71.67,6.32z M71.65,13.01c-1.33,0-2.42-1.12-2.42-2.51s1.08-2.52,2.42-2.52 c1.33,0,2.42,1.12,2.42,2.51S72.99,13,71.65,13.01L71.65,13.01z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M62.08,7.98c-1.32,0-2.39,1.11-2.41,2.48v0.06C59.68,11.9,60.75,13,62.08,13s2.42-1.12,2.42-2.51 S63.41,7.98,62.08,7.98z M62.08,11.76c-0.63,0-1.14-0.56-1.17-1.25v-0.04c0.01-0.69,0.54-1.25,1.17-1.25 c0.63,0,1.17,0.57,1.17,1.27C63.24,11.2,62.73,11.76,62.08,11.76z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M71.65,7.98c-1.33,0-2.42,1.12-2.42,2.51S70.32,13,71.65,13s2.42-1.12,2.42-2.51S72.99,7.98,71.65,7.98z M71.65,11.76c-0.64,0-1.17-0.57-1.17-1.27c0-0.7,0.53-1.26,1.17-1.26s1.17,0.57,1.17,1.27C72.82,11.21,72.29,11.76,71.65,11.76z'/%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M45.74,6.53h-1.4c-0.13,0-0.23,0.11-0.23,0.23v0.73c-0.71-0.75-1.7-1.18-2.73-1.18 c-2.17,0-3.94,1.87-3.94,4.19s1.77,4.19,3.94,4.19c1.04,0,2.03-0.43,2.73-1.19v0.73c0,0.13,0.1,0.23,0.23,0.23h1.4 c0.13,0,0.23-0.11,0.23-0.23V6.74c0-0.12-0.09-0.22-0.22-0.22C45.75,6.53,45.75,6.53,45.74,6.53z M44.12,10.53 C44.11,11.9,43.03,13,41.71,13s-2.42-1.12-2.42-2.51s1.08-2.52,2.4-2.52c1.33,0,2.39,1.11,2.41,2.48L44.12,10.53z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M41.71,7.98c-1.33,0-2.42,1.12-2.42,2.51S40.37,13,41.71,13s2.39-1.11,2.41-2.48v-0.06 C44.1,9.09,43.03,7.98,41.71,7.98z M40.55,10.49c0-0.7,0.52-1.27,1.17-1.27c0.64,0,1.14,0.56,1.17,1.25v0.04 c-0.01,0.68-0.53,1.24-1.17,1.24C41.08,11.75,40.55,11.19,40.55,10.49z'/%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M52.41,6.32c-1.03,0-2.03,0.42-2.73,1.18V6.75c0-0.13-0.1-0.23-0.23-0.23h-1.4c-0.13,0-0.23,0.11-0.23,0.23 v10.72c0,0.13,0.1,0.23,0.23,0.23h1.4c0.13,0,0.23-0.1,0.23-0.23V13.5c0.71,0.75,1.7,1.18,2.74,1.18c2.17,0,3.94-1.87,3.94-4.19 S54.58,6.32,52.41,6.32z M52.08,13.01c-1.32,0-2.39-1.11-2.42-2.48v-0.07c0.02-1.38,1.09-2.49,2.4-2.49c1.32,0,2.41,1.12,2.41,2.51 S53.4,13,52.08,13.01L52.08,13.01z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M52.08,7.98c-1.32,0-2.39,1.11-2.42,2.48v0.06c0.03,1.38,1.1,2.48,2.42,2.48s2.41-1.12,2.41-2.51 S53.4,7.98,52.08,7.98z M52.08,11.76c-0.63,0-1.14-0.56-1.17-1.25v-0.04c0.01-0.69,0.54-1.25,1.17-1.25c0.63,0,1.17,0.58,1.17,1.27 S52.72,11.76,52.08,11.76z'/%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M36.08,14.24c0,0.13-0.1,0.23-0.23,0.23h-1.41c-0.13,0-0.23-0.11-0.23-0.23V9.68c0-0.98-0.74-1.71-1.62-1.71 c-0.8,0-1.46,0.7-1.59,1.62l0.01,4.66c0,0.13-0.11,0.23-0.23,0.23h-1.41c-0.13,0-0.23-0.11-0.23-0.23V9.68 c0-0.98-0.74-1.71-1.62-1.71c-0.85,0-1.54,0.79-1.6,1.8v4.48c0,0.13-0.1,0.23-0.23,0.23h-1.4c-0.13,0-0.23-0.11-0.23-0.23V6.74 c0.01-0.13,0.1-0.22,0.23-0.22h1.4c0.13,0,0.22,0.11,0.23,0.22V7.4c0.5-0.68,1.3-1.09,2.16-1.1h0.03c1.09,0,2.09,0.6,2.6,1.55 c0.45-0.95,1.4-1.55,2.44-1.56c1.62,0,2.93,1.25,2.9,2.78L36.08,14.24z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M84.34,13.59l-0.07-0.13l-1.96-2.99l1.94-2.95c0.44-0.67,0.26-1.56-0.41-2.02c-0.02,0-0.03,0-0.04-0.01 c-0.23-0.15-0.5-0.22-0.78-0.22h-1.61c-0.56,0-1.08,0.29-1.37,0.78L79.72,6.6l-0.34-0.56C79.09,5.56,78.57,5.27,78,5.27h-1.6 c-0.6,0-1.13,0.37-1.35,0.92c-2.19-1.66-5.28-1.47-7.26,0.45c-0.35,0.34-0.65,0.72-0.89,1.14c-0.9-1.62-2.58-2.72-4.5-2.72 c-0.5,0-1.01,0.07-1.48,0.23V3.51c0-0.82-0.66-1.48-1.47-1.48h-1.4c-0.81,0-1.47,0.66-1.47,1.47v3.75 c-0.95-1.36-2.5-2.18-4.17-2.19c-0.74,0-1.46,0.16-2.12,0.47c-0.24-0.17-0.54-0.26-0.84-0.26h-1.4c-0.45,0-0.87,0.21-1.15,0.56 c-0.02-0.03-0.04-0.05-0.07-0.08c-0.28-0.3-0.68-0.47-1.09-0.47h-1.39c-0.3,0-0.6,0.09-0.84,0.26c-0.67-0.3-1.39-0.46-2.12-0.46 c-1.83,0-3.43,1-4.37,2.5c-0.2-0.46-0.48-0.89-0.83-1.25c-0.8-0.81-1.89-1.25-3.02-1.25h-0.01c-0.89,0.01-1.75,0.33-2.46,0.88 c-0.74-0.57-1.64-0.88-2.57-0.88H28.1c-0.29,0-0.58,0.03-0.86,0.11c-0.28,0.06-0.56,0.16-0.82,0.28c-0.21-0.12-0.45-0.18-0.7-0.18 h-1.4c-0.82,0-1.47,0.66-1.47,1.47v7.5c0,0.82,0.66,1.47,1.47,1.47h1.4c0.82,0,1.48-0.66,1.48-1.48l0,0V9.79 c0.03-0.36,0.23-0.59,0.36-0.59c0.18,0,0.38,0.18,0.38,0.47v4.57c0,0.82,0.66,1.47,1.47,1.47h1.41c0.82,0,1.47-0.66,1.47-1.47 l-0.01-4.57c0.06-0.32,0.25-0.47,0.35-0.47c0.18,0,0.38,0.18,0.38,0.47v4.57c0,0.82,0.66,1.47,1.47,1.47h1.41 c0.82,0,1.47-0.66,1.47-1.47v-0.38c0.96,1.29,2.46,2.06,4.06,2.06c0.74,0,1.46-0.16,2.12-0.47c0.24,0.17,0.54,0.26,0.84,0.26h1.39 c0.3,0,0.6-0.09,0.84-0.26v2.01c0,0.82,0.66,1.47,1.47,1.47h1.4c0.82,0,1.47-0.66,1.47-1.47v-1.77c0.48,0.15,0.99,0.23,1.49,0.22 c1.7,0,3.22-0.87,4.17-2.2v0.52c0,0.82,0.66,1.47,1.47,1.47h1.4c0.3,0,0.6-0.09,0.84-0.26c0.66,0.31,1.39,0.47,2.12,0.47 c1.92,0,3.6-1.1,4.49-2.73c1.54,2.65,4.95,3.53,7.58,1.98c0.18-0.11,0.36-0.22,0.53-0.36c0.22,0.55,0.76,0.91,1.35,0.9H78 c0.56,0,1.08-0.29,1.37-0.78l0.37-0.61l0.37,0.61c0.29,0.48,0.81,0.78,1.38,0.78h1.6c0.81,0,1.46-0.66,1.45-1.46 C84.49,14.02,84.44,13.8,84.34,13.59L84.34,13.59z M35.86,14.47h-1.41c-0.13,0-0.23-0.11-0.23-0.23V9.68 c0-0.98-0.74-1.71-1.62-1.71c-0.8,0-1.46,0.7-1.59,1.62l0.01,4.66c0,0.13-0.1,0.23-0.23,0.23h-1.41c-0.13,0-0.23-0.11-0.23-0.23 V9.68c0-0.98-0.74-1.71-1.62-1.71c-0.85,0-1.54,0.79-1.6,1.8v4.48c0,0.13-0.1,0.23-0.23,0.23h-1.4c-0.13,0-0.23-0.11-0.23-0.23 V6.74c0.01-0.13,0.11-0.22,0.23-0.22h1.4c0.13,0,0.22,0.11,0.23,0.22V7.4c0.5-0.68,1.3-1.09,2.16-1.1h0.03 c1.09,0,2.09,0.6,2.6,1.55c0.45-0.95,1.4-1.55,2.44-1.56c1.62,0,2.93,1.25,2.9,2.78l0.01,5.16C36.09,14.36,35.98,14.46,35.86,14.47 L35.86,14.47z M45.97,14.24c0,0.13-0.1,0.23-0.23,0.23h-1.4c-0.13,0-0.23-0.11-0.23-0.23V13.5c-0.7,0.76-1.69,1.18-2.72,1.18 c-2.17,0-3.94-1.87-3.94-4.19s1.77-4.19,3.94-4.19c1.03,0,2.02,0.43,2.73,1.18V6.74c0-0.13,0.1-0.23,0.23-0.23h1.4 c0.12-0.01,0.22,0.08,0.23,0.21c0,0.01,0,0.01,0,0.02v7.51h-0.01V14.24z M52.41,14.67c-1.03,0-2.02-0.43-2.73-1.18v3.97 c0,0.13-0.1,0.23-0.23,0.23h-1.4c-0.13,0-0.23-0.1-0.23-0.23V6.75c0-0.13,0.1-0.22,0.23-0.22h1.4c0.13,0,0.23,0.11,0.23,0.23v0.73 c0.71-0.76,1.7-1.18,2.73-1.18c2.17,0,3.94,1.86,3.94,4.18S54.58,14.67,52.41,14.67z M66.24,11.39c-0.39,1.87-1.96,3.29-3.84,3.29 c-1.03,0-2.02-0.43-2.73-1.18v0.73c0,0.13-0.1,0.23-0.23,0.23h-1.4c-0.13,0-0.23-0.11-0.23-0.23V3.51c0-0.13,0.1-0.23,0.23-0.23 h1.4c0.13,0,0.23,0.11,0.23,0.23v3.97c0.71-0.75,1.7-1.18,2.73-1.17c1.88,0,3.45,1.4,3.84,3.28C66.37,10.19,66.37,10.8,66.24,11.39 L66.24,11.39L66.24,11.39z M71.67,14.68c-2,0.01-3.73-1.35-4.17-3.3c-0.13-0.59-0.13-1.19,0-1.77c0.44-1.94,2.17-3.31,4.17-3.3 c2.36,0,4.26,1.87,4.26,4.19S74.03,14.68,71.67,14.68L71.67,14.68z M83.04,14.47h-1.61c-0.13,0-0.24-0.06-0.3-0.17l-1.44-2.39 l-1.44,2.39c-0.06,0.11-0.18,0.17-0.3,0.17h-1.61c-0.04,0-0.08-0.01-0.12-0.03c-0.09-0.06-0.13-0.19-0.06-0.28l0,0l2.43-3.68 L76.2,6.84c-0.02-0.03-0.03-0.07-0.03-0.12c0-0.12,0.09-0.21,0.21-0.21h1.61c0.13,0,0.24,0.06,0.3,0.17l1.41,2.36l1.41-2.36 c0.06-0.11,0.18-0.17,0.3-0.17h1.61c0.04,0,0.08,0.01,0.12,0.03c0.09,0.06,0.13,0.19,0.06,0.28l0,0l-2.38,3.64l2.43,3.67 c0.02,0.03,0.03,0.07,0.03,0.12C83.25,14.38,83.16,14.47,83.04,14.47L83.04,14.47L83.04,14.47z'/%3E %3Cpath class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' d='M10.5,1.24c-5.11,0-9.25,4.15-9.25,9.25s4.15,9.25,9.25,9.25s9.25-4.15,9.25-9.25 C19.75,5.38,15.61,1.24,10.5,1.24z M14.89,12.77c-1.93,1.93-4.78,2.31-6.7,2.31c-0.7,0-1.41-0.05-2.1-0.16c0,0-1.02-5.64,2.14-8.81 c0.83-0.83,1.95-1.28,3.13-1.28c1.27,0,2.49,0.51,3.39,1.42C16.59,8.09,16.64,11,14.89,12.77z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M10.5-0.01C4.7-0.01,0,4.7,0,10.49s4.7,10.5,10.5,10.5S21,16.29,21,10.49C20.99,4.7,16.3-0.01,10.5-0.01z M10.5,19.74c-5.11,0-9.25-4.15-9.25-9.25s4.14-9.26,9.25-9.26s9.25,4.15,9.25,9.25C19.75,15.61,15.61,19.74,10.5,19.74z'/%3E %3Cpath class='st1' style='opacity:0.35; enable-background:new;' d='M14.74,6.25C12.9,4.41,9.98,4.35,8.23,6.1c-3.16,3.17-2.14,8.81-2.14,8.81s5.64,1.02,8.81-2.14 C16.64,11,16.59,8.09,14.74,6.25z M12.47,10.34l-0.91,1.87l-0.9-1.87L8.8,9.43l1.86-0.9l0.9-1.87l0.91,1.87l1.86,0.9L12.47,10.34z'/%3E %3Cpolygon class='st0' style='opacity:0.9; fill: %23FFFFFF; enable-background: new;' points='14.33,9.43 12.47,10.34 11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 '/%3E%3C/g%3E%3C/svg%3E\");\n}\n\na.mapboxgl-ctrl-logo.mapboxgl-compact {\n    width: 21px;\n    height: 21px;\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3C?xml version='1.0' encoding='utf-8'?%3E %3Csvg version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 21 21' style='enable-background:new 0 0 21 21;' xml:space='preserve'%3E%3Cg transform='translate(0,0.01)'%3E%3Cpath d='m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z' style='opacity:0.9;fill:%23ffffff;enable-background:new' class='st0'/%3E%3Cpath d='M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z' style='opacity:0.35;enable-background:new' class='st1'/%3E%3Cpath d='M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z' style='opacity:0.35;enable-background:new' class='st1'/%3E%3Cpolygon points='11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 ' style='opacity:0.9;fill:%23ffffff;enable-background:new' class='st0'/%3E%3C/g%3E%3C/svg%3E\");\n}\n\n.mapboxgl-ctrl.mapboxgl-ctrl-attrib {\n    padding: 0 5px;\n    background-color: rgba(255, 255, 255, 0.5);\n    margin: 0;\n}\n\n@media screen {\n    .mapboxgl-ctrl-attrib.mapboxgl-compact {\n        margin: 10px;\n        position: relative;\n        background-color: #fff;\n        border-radius: 3px 12px 12px 3px;\n    }\n\n    .mapboxgl-ctrl-attrib.mapboxgl-compact:hover {\n        padding: 2px 24px 2px 4px;\n        visibility: visible;\n    }\n\n    .mapboxgl-ctrl-top-left > .mapboxgl-ctrl-attrib.mapboxgl-compact:hover,\n    .mapboxgl-ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact:hover {\n        padding: 2px 4px 2px 24px;\n        border-radius: 12px 3px 3px 12px;\n    }\n\n    .mapboxgl-ctrl-attrib.mapboxgl-compact > * {\n        display: none;\n    }\n\n    .mapboxgl-ctrl-attrib.mapboxgl-compact:hover > * {\n        display: inline;\n    }\n\n    .mapboxgl-ctrl-attrib.mapboxgl-compact::after {\n        content: '';\n        cursor: pointer;\n        position: absolute;\n        background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E %3Cpath fill='%23333333' fill-rule='evenodd' d='M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0'/%3E %3C/svg%3E\");\n        background-color: rgba(255, 255, 255, 0.5);\n        width: 24px;\n        height: 24px;\n        box-sizing: border-box;\n        border-radius: 12px;\n    }\n\n    .mapboxgl-ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after {\n        bottom: 0;\n        right: 0;\n    }\n\n    .mapboxgl-ctrl-top-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after {\n        top: 0;\n        right: 0;\n    }\n\n    .mapboxgl-ctrl-top-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after {\n        top: 0;\n        left: 0;\n    }\n\n    .mapboxgl-ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after {\n        bottom: 0;\n        left: 0;\n    }\n}\n\n.mapboxgl-ctrl-attrib a {\n    color: rgba(0, 0, 0, 0.75);\n    text-decoration: none;\n}\n\n.mapboxgl-ctrl-attrib a:hover {\n    color: inherit;\n    text-decoration: underline;\n}\n\n/* stylelint-disable-next-line selector-class-pattern */\n.mapboxgl-ctrl-attrib .mapbox-improve-map {\n    font-weight: bold;\n    margin-left: 2px;\n}\n\n.mapboxgl-attrib-empty {\n    display: none;\n}\n\n.mapboxgl-ctrl-scale {\n    background-color: rgba(255, 255, 255, 0.75);\n    font-size: 10px;\n    border-width: medium 2px 2px;\n    border-style: none solid solid;\n    border-color: #333;\n    padding: 0 5px;\n    color: #333;\n    box-sizing: border-box;\n}\n\n.mapboxgl-popup {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: -webkit-flex;\n    display: flex;\n    will-change: transform;\n    pointer-events: none;\n}\n\n.mapboxgl-popup-anchor-top,\n.mapboxgl-popup-anchor-top-left,\n.mapboxgl-popup-anchor-top-right {\n    -webkit-flex-direction: column;\n    flex-direction: column;\n}\n\n.mapboxgl-popup-anchor-bottom,\n.mapboxgl-popup-anchor-bottom-left,\n.mapboxgl-popup-anchor-bottom-right {\n    -webkit-flex-direction: column-reverse;\n    flex-direction: column-reverse;\n}\n\n.mapboxgl-popup-anchor-left {\n    -webkit-flex-direction: row;\n    flex-direction: row;\n}\n\n.mapboxgl-popup-anchor-right {\n    -webkit-flex-direction: row-reverse;\n    flex-direction: row-reverse;\n}\n\n.mapboxgl-popup-tip {\n    width: 0;\n    height: 0;\n    border: 10px solid transparent;\n    z-index: 1;\n}\n\n.mapboxgl-popup-anchor-top .mapboxgl-popup-tip {\n    -webkit-align-self: center;\n    align-self: center;\n    border-top: none;\n    border-bottom-color: #fff;\n}\n\n.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip {\n    -webkit-align-self: flex-start;\n    align-self: flex-start;\n    border-top: none;\n    border-left: none;\n    border-bottom-color: #fff;\n}\n\n.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip {\n    -webkit-align-self: flex-end;\n    align-self: flex-end;\n    border-top: none;\n    border-right: none;\n    border-bottom-color: #fff;\n}\n\n.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip {\n    -webkit-align-self: center;\n    align-self: center;\n    border-bottom: none;\n    border-top-color: #fff;\n}\n\n.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip {\n    -webkit-align-self: flex-start;\n    align-self: flex-start;\n    border-bottom: none;\n    border-left: none;\n    border-top-color: #fff;\n}\n\n.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip {\n    -webkit-align-self: flex-end;\n    align-self: flex-end;\n    border-bottom: none;\n    border-right: none;\n    border-top-color: #fff;\n}\n\n.mapboxgl-popup-anchor-left .mapboxgl-popup-tip {\n    -webkit-align-self: center;\n    align-self: center;\n    border-left: none;\n    border-right-color: #fff;\n}\n\n.mapboxgl-popup-anchor-right .mapboxgl-popup-tip {\n    -webkit-align-self: center;\n    align-self: center;\n    border-right: none;\n    border-left-color: #fff;\n}\n\n.mapboxgl-popup-close-button {\n    position: absolute;\n    right: 0;\n    top: 0;\n    border: 0;\n    border-radius: 0 3px 0 0;\n    cursor: pointer;\n    background-color: transparent;\n}\n\n.mapboxgl-popup-close-button:hover {\n    background-color: rgba(0, 0, 0, 0.05);\n}\n\n.mapboxgl-popup-content {\n    position: relative;\n    background: #fff;\n    border-radius: 3px;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n    padding: 10px 10px 15px;\n    pointer-events: auto;\n}\n\n.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content {\n    border-top-left-radius: 0;\n}\n\n.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content {\n    border-top-right-radius: 0;\n}\n\n.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content {\n    border-bottom-left-radius: 0;\n}\n\n.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content {\n    border-bottom-right-radius: 0;\n}\n\n.mapboxgl-marker {\n    position: absolute;\n    top: 0;\n    left: 0;\n    will-change: transform;\n}\n\n.mapboxgl-user-location-dot {\n    background-color: #1da1f2;\n    width: 15px;\n    height: 15px;\n    border-radius: 50%;\n    box-shadow: 0 0 2px rgba(0, 0, 0, 0.25);\n}\n\n.mapboxgl-user-location-dot::before {\n    background-color: #1da1f2;\n    content: '';\n    width: 15px;\n    height: 15px;\n    border-radius: 50%;\n    position: absolute;\n    -webkit-animation: mapboxgl-user-location-dot-pulse 2s infinite;\n    -moz-animation: mapboxgl-user-location-dot-pulse 2s infinite;\n    -ms-animation: mapboxgl-user-location-dot-pulse 2s infinite;\n    animation: mapboxgl-user-location-dot-pulse 2s infinite;\n}\n\n.mapboxgl-user-location-dot::after {\n    border-radius: 50%;\n    border: 2px solid #fff;\n    content: '';\n    height: 19px;\n    left: -2px;\n    position: absolute;\n    top: -2px;\n    width: 19px;\n    box-sizing: border-box;\n}\n\n@-webkit-keyframes mapboxgl-user-location-dot-pulse {\n    0%   { -webkit-transform: scale(1); opacity: 1; }\n    70%  { -webkit-transform: scale(3); opacity: 0; }\n    100% { -webkit-transform: scale(1); opacity: 0; }\n}\n\n@-ms-keyframes mapboxgl-user-location-dot-pulse {\n    0%   { -ms-transform: scale(1); opacity: 1; }\n    70%  { -ms-transform: scale(3); opacity: 0; }\n    100% { -ms-transform: scale(1); opacity: 0; }\n}\n\n@keyframes mapboxgl-user-location-dot-pulse {\n    0%   { transform: scale(1); opacity: 1; }\n    70%  { transform: scale(3); opacity: 0; }\n    100% { transform: scale(1); opacity: 0; }\n}\n\n.mapboxgl-user-location-dot-stale {\n    background-color: #aaa;\n}\n\n.mapboxgl-user-location-dot-stale::after {\n    display: none;\n}\n\n.mapboxgl-crosshair,\n.mapboxgl-crosshair .mapboxgl-interactive,\n.mapboxgl-crosshair .mapboxgl-interactive:active {\n    cursor: crosshair;\n}\n\n.mapboxgl-boxzoom {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 0;\n    height: 0;\n    background: #fff;\n    border: 2px dotted #202020;\n    opacity: 0.5;\n}\n\n@media print {\n    /* stylelint-disable-next-line selector-class-pattern */\n    .mapbox-improve-map {\n        display: none;\n    }\n}\n",""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r),o=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(o).concat([i]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){var r={},i=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),o=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),a=null,s=0,u=[],c=n(544);function l(t,e){for(var n=0;n<t.length;n++){var i=t[n],o=r[i.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](i.parts[a]);for(;a<i.parts.length;a++)o.parts.push(g(i.parts[a],e))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(g(i.parts[a],e));r[i.id]={id:i.id,refs:1,parts:s}}}}function f(t,e){for(var n=[],r={},i=0;i<t.length;i++){var o=t[i],a=e.base?o[0]+e.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function h(t,e){var n=o(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),u.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(t.insertAt.before,n);n.insertBefore(e,i)}}function p(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function d(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=function(){0;return n.nc}();r&&(t.attrs.nonce=r)}return v(e,t.attrs),h(t,e),e}function v(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function g(t,e){var n,r,i,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var u=s++;n=a||(a=d(e)),r=y.bind(null,n,u,!1),i=y.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),h(t,e),e}(e),r=function(t,e,n){var r=n.css,i=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||o)&&(r=c(r));i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),i=function(){p(n),n.href&&URL.revokeObjectURL(n.href)}):(n=d(e),r=function(t,e){var n=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){p(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=i()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=f(t,e);return l(n,e),function(t){for(var i=[],o=0;o<n.length;o++){var a=n[o];(s=r[a.id]).refs--,i.push(s)}t&&l(f(t,e),e);for(o=0;o<i.length;o++){var s;if(0===(s=i[o]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete r[s.id]}}}};var m=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function y(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=m(e,i);else{var o=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(182),s=n(232),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.source=i({type:"geojson"},e.props.geoJSONSourceOptions,{data:{type:"FeatureCollection",features:[]}}),e.geometry=function(t){switch(e.props.type){case"symbol":case"circle":return{type:"Point",coordinates:t};case"fill":return t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t};case"line":return{type:"LineString",coordinates:t};default:return{type:"Point",coordinates:t}}},e.makeFeature=function(t,n){return{type:"Feature",geometry:e.geometry(t.coordinates),properties:i({},t.properties,{id:n})}},e.initialize=function(){var t=e.props,n=t.type,r=t.layout,i=t.paint,o=t.sourceId,a=t.before,s=t.images,u=t.id,c=t.metadata,l=t.sourceLayer,f=t.minZoom,h=t.maxZoom,p=t.filter,d=e.props.map,v={id:u,source:o||u,type:n,layout:r,paint:i,metadata:c};(l&&(v["source-layer"]=l),f&&(v.minzoom=f),h&&(v.maxzoom=h),p&&(v.filter=p),s)&&(Array.isArray(s[0])?s:[s]).forEach(function(t){d.addImage(t[0],t[1],t[2])});o||d.getSource(u)||d.addSource(u,e.source),d.getLayer(u)||d.addLayer(v,a)},e.onStyleDataChange=function(){e.props.map.getLayer(e.props.id)||(e.initialize(),e.forceUpdate())},e.getChildren=function(){var t=e.props.children;return t?Array.isArray(t)?t.reduce(function(t,e){return t.concat(e)},[]):[t]:[]},e}return r(e,t),e.prototype.componentWillMount=function(){var t=this.props.map;this.initialize(),t.on("styledata",this.onStyleDataChange)},e.prototype.componentWillUnmount=function(){var t=this.props.map,e=this.props,n=e.images,r=e.id;if(t&&t.getStyle()){if(t.getLayer(r)&&t.removeLayer(r),this.props.sourceId||t.removeSource(r),n)(Array.isArray(n[0])?n:[n]).map(function(t){var e=t[0];t.slice(1);return e}).forEach(t.removeImage);t.off("styledata",this.onStyleDataChange)}},e.prototype.componentWillReceiveProps=function(t){var e=this.props,n=e.paint,r=e.layout,i=e.before,o=e.filter,u=e.id,c=e.minZoom,l=e.maxZoom,f=this.props.map;if(!a(t.paint,n)){var h=s.default(n,t.paint);Object.keys(h).forEach(function(t){f.setPaintProperty(u,t,h[t])})}if(!a(t.layout,r)){var p=s.default(r,t.layout);Object.keys(p).forEach(function(t){f.setLayoutProperty(u,t,p[t])})}t.filter&&o&&!a(t.filter,o)&&f.setFilter(u,t.filter||[]),i!==t.before&&f.moveLayer(u,t.before),c===t.minZoom&&l===t.maxZoom||f.setLayerZoomRange(u,t.minZoom,t.maxZoom)},e.prototype.render=function(){var t=this,e=this.props.map,n=this.props,r=n.sourceId,i=n.draggedChildren,o=this.getChildren();if(i){var a=i.map(function(t){return t.key});o=o.map(function(t){var e=a.indexOf(t.key);return-1!==e?i[e]:t})}var s=o.map(function(e,n){var r=e.props;return t.makeFeature(r,n)}).filter(Boolean),u=e.getSource(r||this.props.id);return u&&!r&&u.setData&&u.setData({type:"FeatureCollection",features:s}),null},e.defaultProps={type:"symbol",layout:{},paint:{}},e}(o.Component);e.default=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(233);function s(t){return function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.hover=[],t.draggedChildren=void 0,t.id=t.props.id||"layer-"+a.generateID(),t.getChildren=function(){return[].concat(t.props.children).filter(function(t){return void 0!==t})},t.getChildFromId=function(t,e){return t[e]},t.areFeaturesDraggable=function(e,n){return void 0===n&&(n=t.hover),!!n.map(function(n){return!!t.getChildFromId(e,n)&&t.getChildFromId(e,n).props.draggable}).filter(Boolean).length},t.onClick=function(e){var n=e.features,r=t.getChildren(),o=t.props.map;n&&n.forEach(function(n){var a=n.properties.id;if(r){var s=t.getChildFromId(r,a),u=s&&s.props.onClick;u&&u(i({},e,{feature:n,map:o}))}})},t.onMouseEnter=function(e){var n=t.getChildren(),r=t.props.map;t.hover=[],e.features.forEach(function(o){var a=o.properties.id,s=t.getChildFromId(n,a);t.hover.push(a);var u=s&&s.props.onMouseEnter;u&&u(i({},e,{feature:o,map:r}))}),t.areFeaturesDraggable(n)&&r.dragPan.disable()},t.onMouseLeave=function(e){var n=t.getChildren(),r=t.props.map;t.areFeaturesDraggable(n)&&r.dragPan.enable(),t.hover.forEach(function(o){var a=t.getChildFromId(n,o),s=a&&a.props.onMouseLeave;s&&s(i({},e,{map:r}))}),t.draggedChildren||(t.hover=[])},t.onMouseDown=function(){t.hover.length&&t.onFeatureDown("mousedown")},t.onTouchStart=function(e){t.hover=e.features.map(function(t){return t.properties.id}),t.hover.length&&t.onFeatureDown("touchstart")},t.onFeatureDown=function(e){var n="mousedown"===e?"mousemove":"touchmove",r="mousedown"===e?"mouseup":"touchend",i=t.props.map;i.once(n,t.onFeatureDragStart),i.on(n,t.onFeatureDrag),i.once(r,function(e){i.off(n,t.onFeatureDragStart),i.off(n,t.onFeatureDrag),t.onFeatureDragEnd(e)})},t.onFeatureDragStart=function(e){var n=t.props.map,r=t.getChildren();t.hover.forEach(function(o){var a=t.getChildFromId(r,o);if(!a||a.props.draggable){var s=a&&a.props.onDragStart;s&&s(i({},e,{map:n}))}})},t.onFeatureDrag=function(e){var n=t.getChildren(),r=t.props.map,a=e.lngLat,s=a.lng,u=a.lat;t.draggedChildren=[],t.hover.forEach(function(a){var c=t.getChildFromId(n,a),l=c&&c.props.onDrag;c&&c.props.draggable&&(t.draggedChildren.push(o.cloneElement(c,{coordinates:[s,u]})),l&&l(i({},e,{map:r})))}),t.forceUpdate()},t.onFeatureDragEnd=function(e){var n=t.props.map,r=t.getChildren();t.hover.forEach(function(o){var a=t.getChildFromId(r,o),s=a&&a.props.onDragEnd;s&&a.props.draggable&&t.draggedChildren&&s(i({},e,{map:n}))}),t.draggedChildren=void 0},t}return r(n,e),n.prototype.componentWillMount=function(){var t=this.props.map;t.on("click",this.id,this.onClick),t.on("mouseenter",this.id,this.onMouseEnter),t.on("mouseleave",this.id,this.onMouseLeave),t.on("mousedown",this.id,this.onMouseDown),t.on("touchstart",this.id,this.onTouchStart)},n.prototype.componentWillUnmount=function(){var t=this.props.map;t.off("click",this.onClick),t.off("mouseenter",this.onMouseEnter),t.off("mouseleave",this.onMouseLeave),t.off("mousedown",this.onMouseDown),t.off("touchstart",this.onTouchStart)},n.prototype.render=function(){return o.createElement(t,i({},this.props,{id:this.id,map:this.props.map,draggedChildren:this.draggedChildren}))},n}(o.Component)}e.layerMouseTouchEvents=s,e.default=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(182),s=n(232),u=n(233),c=n(82),l=["symbol","line","fill","fill-extrusion","circle"],f=function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toLowerCase():t.toUpperCase()}).replace(/[\s+]|-/g,"")},h={mousemove:"OnMouseMove",mouseenter:"OnMouseEnter",mouseleave:"OnMouseLeave",mousedown:"OnMouseDown",mouseup:"OnMouseUp",click:"OnClick"},p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=e.props.id||"geojson-"+u.generateID(),e.source=i({type:"geojson"},e.props.sourceOptions,{data:e.props.data}),e.layerIds=[],e.buildLayerId=function(t){return e.id+"-"+t},e.createLayer=function(t){var n=e.props,r=n.before,o=n.layerOptions,a=n.map,s=e.buildLayerId(t);e.layerIds.push(s);var u=e.props[f(t)+"Paint"]||{},c=Object.keys(u).length?"visible":"none",l=e.props[f(t)+"Layout"]||{visibility:c};a.addLayer(i({id:s,source:e.id,type:t,paint:u,layout:l},o),r),e.mapLayerMouseHandlers(t)},e.mapLayerMouseHandlers=function(t){var n=e.props.map,r=e.buildLayerId(t);Object.keys(h).forEach(function(i){var o=e.props[""+f(t)+h[i]]||null;o&&n.on(i,r,o)})},e.onStyleDataChange=function(){e.props.map.getSource(e.id)||(e.unbind(),e.initialize(),e.forceUpdate())},e.isGeoJSONSource=function(t){return!!t&&"function"==typeof t.setData},e}return r(e,t),e.prototype.initialize=function(){this.props.map.addSource(this.id,this.source),this.createLayer("symbol"),this.createLayer("line"),this.createLayer("fill"),this.createLayer("fill-extrusion"),this.createLayer("circle")},e.prototype.unbind=function(){var t=this,e=this.props.map;if(e.getSource(this.id)){var n=e.getStyle().layers;n&&n.filter(function(e){return e.source===t.id}).forEach(function(t){return e.removeLayer(t.id)}),e.removeSource(this.id)}l.forEach(function(n){Object.keys(h).forEach(function(r){var i=f(n)+h[r];t.props[i]&&e.off(r,t.buildLayerId(n),t.props[i])})}),this.layerIds.forEach(function(t){e.getLayer(t)&&e.removeLayer(t)})},e.prototype.componentWillMount=function(){var t=this.props.map;this.initialize(),t.on("styledata",this.onStyleDataChange)},e.prototype.componentWillUnmount=function(){var t=this.props.map;t&&t.getStyle()&&(t.off("styledata",this.onStyleDataChange),this.unbind())},e.prototype.componentWillReceiveProps=function(t){var e=this,n=this.props,r=n.data,o=n.before,u=n.layerOptions,c=n.map,p=c.getSource(this.id);if(this.isGeoJSONSource(p)){t.data!==r&&(p.setData(t.data),this.source=i({type:"geojson"},t.sourceOptions,{data:t.data}));var d=t.layerOptions&&u&&!a(t.layerOptions.filter,u.filter);l.forEach(function(n){var r=e.buildLayerId(n);t.layerOptions&&d&&c.setFilter(r,t.layerOptions.filter||[]);var i=f(n)+"Paint";if(!a(t[i],e.props[i])){var u=s.default(e.props[i],t[i]);Object.keys(u).forEach(function(t){c.setPaintProperty(r,t,u[t])})}var l=f(n)+"Layout";if(!a(t[l],e.props[l])){var p=s.default(e.props[l],t[l]);Object.keys(p).forEach(function(t){c.setLayoutProperty(r,t,p[t])})}Object.keys(h).forEach(function(i){var o=f(n)+h[i];t[o]!==e.props[o]&&(e.props[o]&&c.off(i,r,e.props[o]),t[o]&&c.on(i,r,t[o]))}),o!==t.before&&c.moveLayer(r,t.before)})}},e.prototype.render=function(){return null},e}(o.Component);e.GeoJSONLayer=p,e.default=c.withMap(p)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.render=function(){return null},e}(n(15).Component);e.Feature=i,e.default=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(82),s={position:"absolute",zIndex:10,display:"flex",flexDirection:"column",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)"},u={"top-right":{top:10,right:10,bottom:"auto",left:"auto"},"top-left":{top:10,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:10,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:10,left:10,top:"auto",right:"auto"}},c={backgroundColor:"#f9f9f9",opacity:.95,transition:"background-color 0.16s ease-out",cursor:"pointer",border:0,height:26,width:26,backgroundImage:"url('https://api.mapbox.com/mapbox.js/v2.4.0/images/icons-000000@2x.png')",backgroundPosition:"0px 0px",backgroundSize:"26px 260px",outline:0},l={backgroundColor:"#fff",opacity:1},f={borderBottom:"1px solid rgba(0, 0, 0, 0.1)",borderTopLeftRadius:2,borderTopRightRadius:2},h={backgroundPosition:"0px -26px",borderBottomLeftRadius:2,borderBottomRightRadius:2},p=[0,1],d=p[0],v=p[1],g=Object.keys(u),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={hover:void 0},e.onMouseOut=function(){e.setState({hover:void 0})},e.plusOver=function(){d!==e.state.hover&&e.setState({hover:d})},e.minusOver=function(){v!==e.state.hover&&e.setState({hover:v})},e.onClickPlus=function(){e.props.onControlClick(e.props.map,e.props.zoomDiff)},e.onClickMinus=function(){e.props.onControlClick(e.props.map,-e.props.zoomDiff)},e}return r(e,t),e.prototype.render=function(){var t=this.props,e=t.position,n=t.style,r=t.className,a=t.tabIndex,p=this.state.hover,g=i({},c,f,p===d?l:{}),m=i({},c,h,p===v?l:{});return o.createElement("div",{className:r,tabIndex:a,style:i({},s,u[e],n)},o.createElement("button",{id:"zoomIn",type:"button",style:g,"aria-label":"Zoom in",onMouseOver:this.plusOver,onMouseOut:this.onMouseOut,onClick:this.onClickPlus}),o.createElement("button",{id:"zoomOut",type:"button",style:m,"aria-label":"Zoom out",onMouseOver:this.minusOver,onMouseOut:this.onMouseOut,onClick:this.onClickMinus}))},e.defaultProps={position:g[0],zoomDiff:.5,onControlClick:function(t,e){t.zoomTo(t.getZoom()+e)}},e}(o.Component);e.ZoomControl=m,e.default=a.withMap(m)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(234),s=n(235);e.defaultClassName=["mapboxgl-popup"];var u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return r(n,t),n.prototype.render=function(){var t=this.props,n=t.children,r=t.className,u=i({},this.props,{children:void 0}),c=s.getClassName(e.defaultClassName,r);return o.createElement(a.default,i({},u,{type:"popup",className:c}),o.createElement("div",{className:"mapboxgl-popup-tip"}),o.createElement("div",{className:"mapboxgl-popup-content"},n))},n}(o.Component);e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(122);e.anchors=["center","top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"],e.anchorTranslates={center:"translate(-50%, -50%)",top:"translate(-50%, 0)",left:"translate(0, -50%)",right:"translate(-100%, -50%)",bottom:"translate(-50%, -100%)","top-left":"translate(0, 0)","top-right":"translate(-100%, 0)","bottom-left":"translate(0, -100%)","bottom-right":"translate(-100%, -100%)"};var i={offsetWidth:0,offsetHeight:0},o=[0,0],a=function(t){if(!t)return a(new r.Point(0,0));if("number"==typeof t){var n=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{center:new r.Point(t,t),top:new r.Point(0,t),bottom:new r.Point(0,-t),left:new r.Point(t,0),right:new r.Point(-t,0),"top-left":new r.Point(n,n),"top-right":new r.Point(-n,n),"bottom-left":new r.Point(n,-n),"bottom-right":new r.Point(-n,-n)}}return t instanceof r.Point||Array.isArray(t)?e.anchors.reduce(function(e,n){return e[n]=r.Point.convert(t),e},{}):e.anchors.reduce(function(e,n){return e[n]=r.Point.convert(t[n]||o),e},{})};e.overlayState=function(t,n,o){var s=function(t,e){return t.project(r.LngLat.convert(e))}(n,t.coordinates),u=a(t.offset),c=t.anchor||function(t,n,r,o){var a=void 0===o?i:o,s=a.offsetHeight,u=a.offsetWidth,c=[];return r.y+n.bottom.y-s<0?c=[e.anchors[1]]:r.y+n.top.y+s>t.transform.height&&(c=[e.anchors[2]]),r.x<u/2?c.push(e.anchors[3]):r.x>t.transform.width-u/2&&c.push(e.anchors[4]),0===c.length?e.anchors[2]:c.join("-")}(n,u,s,o);return{anchor:c,position:s,offset:u[c]}};var s=function(t){return t?"translate("+t.x.toFixed(0)+"px, "+t.y.toFixed(0)+"px)":""};e.overlayTransform=function(t){var n=t.anchor,r=t.position,i=t.offset,o=[];return r&&o.push(s(r)),i&&void 0!==i.x&&void 0!==i.y&&o.push(s(i)),n&&o.push(e.anchorTranslates[n]),o}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(82),s=[.01,.02,.05,.1,.2,.5,1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4],u={"top-right":{top:10,right:10,bottom:"auto",left:"auto"},"top-left":{top:10,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:10,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:10,left:10,top:"auto",right:"auto"}},c={position:"absolute",zIndex:10,boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)",right:50,backgroundColor:"#fff",opacity:.85,display:"flex",flexDirection:"row",alignItems:"baseline",padding:"3px 7px"},l={border:"2px solid #7e8490",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",borderTop:"none",height:7,borderBottomLeftRadius:1,borderBottomRightRadius:1},f=Object.keys(u),h=["km","mi"],p=60,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={chosenScale:0,scaleWidth:p},e.setScale=function(){var t=e.props,n=t.measurement,r=t.map,i=r._canvas.clientWidth,o=r.getBounds(),a=o._ne,u=o._sw,c=e._getDistanceTwoPoints([u.lng,a.lat],[a.lng,a.lat],n),l=c/i*p,f=s.reduce(function(t,e){return!t&&e>l?e:t},0),h=f/c*i;e.setState({chosenScale:f,scaleWidth:h})},e}return r(e,t),e.prototype.componentWillMount=function(){this.setScale(),this.props.map.on("zoomend",this.setScale)},e.prototype.componentWillUnmount=function(){this.props.map&&this.props.map.off("zoomend",this.setScale)},e.prototype._getDistanceTwoPoints=function(t,e,n){void 0===n&&(n="km");var r=t[0],i=t[1],o=e[0],a=e[1],s="km"===n?6371:6371/1.60934,u=this._deg2rad(a-i),c=this._deg2rad(o-r),l=Math.sin(u/2)*Math.sin(u/2)+Math.cos(this._deg2rad(i))*Math.cos(this._deg2rad(a))*Math.sin(c/2)*Math.sin(c/2);return s*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},e.prototype._deg2rad=function(t){return t*(Math.PI/180)},e.prototype._displayMeasurement=function(t,e){return e>=1?e+" "+t:"mi"===t?Math.floor(5280*e)+" ft":Math.floor(1e3*e)+" m"},e.prototype.render=function(){var t=this.props,e=t.measurement,n=t.style,r=t.position,a=t.className,s=t.tabIndex,f=this.state,h=f.chosenScale,p=f.scaleWidth;return o.createElement("div",{tabIndex:s,style:i({},c,u[r],n),className:a},o.createElement("div",{style:i({},l,{width:p})}),o.createElement("div",{style:{paddingLeft:10}},this._displayMeasurement(e,h)))},e.defaultProps={measurement:h[0],position:f[2]},e}(o.Component);e.ScaleControl=d,e.default=a.withMap(d)},function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),o=n(234),a=n(235),s=["mapboxgl-marker"];e.Marker=function(t){return i.createElement(o.default,r({},r({},t),{type:"marker",className:a.getClassName(s,t.className)}))},e.default=e.Marker},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(82),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=e.props.id,e.onStyleDataChange=function(){e.props.map.getLayer(e.id)||(e.initialize(),e.forceUpdate())},e.initialize=function(){var t=e.props.map,n=e.props,r=n.geoJsonSource,i=n.tileJsonSource,o=n.onSourceAdded;t.getSource(e.id)||!r&&!i||(r?t.addSource(e.id,r):i&&t.addSource(e.id,i),t.on("sourcedata",e.onData),o&&o(t.getSource(e.id)))},e.onData=function(){var t=e.props.map,n=t.getSource(e.props.id);if(n&&t.isSourceLoaded(e.props.id)){var r=e.props.onSourceLoaded;n&&r&&r(n),n&&e.props.geoJsonSource&&e.props.geoJsonSource.data&&n.setData(e.props.geoJsonSource.data),t.off("sourcedata",e.onData)}},e}return r(e,t),e.prototype.componentWillMount=function(){this.props.map.on("styledata",this.onStyleDataChange),this.initialize()},e.prototype.removeSource=function(){var t=this,e=this.props.map;if(e.getSource(this.id)){var n=e.getStyle().layers,r=void 0===n?[]:n;return(r=r.map(function(t,e){var n=(r[e+1]||{id:void 0}).id;return i({},t,{before:n})}).filter(function(e){return e.source===t.id})).forEach(function(t){return e.removeLayer(t.id)}),e.removeSource(this.id),r.reverse()}return[]},e.prototype.componentWillUnmount=function(){var t=this.props.map;t&&t.getStyle()&&(t.off("styledata",this.onStyleDataChange),this.removeSource())},e.prototype.componentWillReceiveProps=function(t){var e=this.props,n=e.geoJsonSource,r=e.tileJsonSource,i=e.map;if(r&&t.tileJsonSource&&(r.url!==t.tileJsonSource.url||r.tiles!==t.tileJsonSource.tiles||r.minzoom!==t.tileJsonSource.minzoom||r.maxzoom!==t.tileJsonSource.maxzoom)){var o=this.removeSource();i.addSource(this.id,t.tileJsonSource),o.forEach(function(t){return i.addLayer(t,t.before)})}n&&t.geoJsonSource&&t.geoJsonSource.data!==n.data&&t.geoJsonSource.data&&i.getSource(this.id)&&i.getSource(this.id).setData(t.geoJsonSource.data)},e.prototype.render=function(){return null},e}(o.Component);e.Source=s,e.default=a.withMap(s)},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),o=n(122),a=n(556),s=n(561),u=n(563),c=n(82),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={superC:a.default({radius:e.props.radius,maxZoom:e.props.maxZoom,minZoom:e.props.minZoom,extent:e.props.extent,nodeSize:e.props.nodeSize,log:e.props.log}),clusterPoints:[]},e.featureClusterMap=new WeakMap,e.childrenChange=function(t){var n=e.state.superC;e.featureClusterMap=new WeakMap;var r=e.childrenToFeatures(t);n.load(r)},e.mapChange=function(t){void 0===t&&(t=!1);var n=e.props.map,r=e.state,i=r.superC,o=r.clusterPoints,a=n.getZoom(),c=n.getCanvas(),l=c.width,f=c.height,h=n.unproject([0,0]).toArray(),p=n.unproject([l,0]).toArray(),d=n.unproject([l,f]).toArray(),v=n.unproject([0,f]).toArray(),g=i.getClusters(s(u.polygon([[h,p,d,v,h]])),Math.round(a));(g.length!==o.length||t)&&e.setState({clusterPoints:g})},e.childrenToFeatures=function(t){return t.map(function(t){var n=e.feature(t&&t.props.coordinates);return e.featureClusterMap.set(n,t),n})},e.getLeaves=function(t,n,r){return e.state.superC.getLeaves(t.properties&&t.properties.cluster_id,n||1/0,r).map(function(t){return e.featureClusterMap.get(t)})},e.zoomToClusterBounds=function(t){var n=Array.prototype.slice.call(t.currentTarget.children),r=e.findMarkerElement(t.currentTarget,t.target),i=n.indexOf(r),a=e.state.clusterPoints[i];if(a.properties&&a.properties.cluster_id){var c=e.state.superC.getLeaves(a.properties&&a.properties.cluster_id,1/0),l=s(u.featureCollection(c));e.props.map.fitBounds(o.LngLatBounds.convert(l),{padding:e.props.zoomOnClickPadding})}},e}return r(e,t),e.prototype.componentWillMount=function(){var t=this.props,e=t.children,n=t.map;e&&this.childrenChange(e),n.on("move",this.mapChange),n.on("zoom",this.mapChange),this.mapChange()},e.prototype.componentWillReceiveProps=function(t){this.props.children!==t.children&&t.children&&(this.childrenChange(t.children),this.mapChange(!0))},e.prototype.feature=function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:{}}},e.prototype.findMarkerElement=function(t,e){return e.parentElement===t?e:this.findMarkerElement(t,e.parentElement)},e.prototype.render=function(){var t=this,e=this.props,n=e.ClusterMarkerFactory,r=e.style,o=e.className,a=e.tabIndex,s=this.state.clusterPoints;return i.createElement("div",{style:r,className:o,tabIndex:a,onClick:this.props.zoomOnClick?this.zoomToClusterBounds:void 0},s.map(function(e){return e.properties&&e.properties.cluster?n(e.geometry.coordinates,e.properties.point_count,t.getLeaves.bind(t,e)):t.featureClusterMap.get(e)}))},e.defaultProps={radius:60,minZoom:0,maxZoom:16,extent:512,nodeSize:64,log:!1,zoomOnClick:!1,zoomOnClickPadding:20},e}(i.Component);e.Cluster=l,e.default=c.withMap(l)},function(t,e,n){"use strict";var r=n(557);function i(t){return new o(t)}function o(t){this.options=h(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function a(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function s(t,e){var n=t.geometry.coordinates;return{x:l(n[0]),y:f(n[1]),zoom:1/0,id:e,parentId:-1}}function u(t){return{type:"Feature",properties:c(t),geometry:{type:"Point",coordinates:[function(t){return 360*(t-.5)}(t.x),function(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}(t.y)]}}}function c(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return h(h({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function l(t){return t/360+.5}function f(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function h(t,e){for(var n in e)t[n]=e[n];return t}function p(t){return t.x}function d(t){return t.y}t.exports=i,t.exports.default=i,o.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;for(var i=[],o=0;o<t.length;o++)t[o].geometry&&i.push(s(t[o],o));this.trees[this.options.maxZoom+1]=r(i,p,d,this.options.nodeSize,Float32Array),e&&console.timeEnd(n);for(var a=this.options.maxZoom;a>=this.options.minZoom;a--){var u=+Date.now();i=this._cluster(i,a),this.trees[a]=r(i,p,d,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",a,i.length,+Date.now()-u)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){if(t[0]>t[2]){var n=this.getClusters([t[0],t[1],180,t[3]],e),r=this.getClusters([-180,t[1],t[2],t[3]],e);return n.concat(r)}for(var i=this.trees[this._limitZoom(e)],o=i.range(l(t[0]),f(t[3]),l(t[2]),f(t[1])),a=[],s=0;s<o.length;s++){var c=i.points[o[s]];a.push(c.numPoints?u(c):this.points[c.id])}return a},getChildren:function(t){var e=t>>5,n=t%32,r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),c=[],l=0;l<s.length;l++){var f=i.points[s[l]];f.parentId===t&&c.push(f.numPoints?u(f):this.points[f.id])}if(0===c.length)throw new Error(r);return c},getLeaves:function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},getTile:function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,s,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,s,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,s,a/i,u),r.points,-1,n,i,c),c.features.length?c:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,r,i){for(var o=this.getChildren(e),a=0;a<o.length;a++){var s=o[a].properties;if(s&&s.cluster?i+s.point_count<=r?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,n,r,i):i<r?i++:t.push(o[a]),t.length===n)break}return i},_addTileFeatures:function(t,e,n,r,i,o){for(var a=0;a<t.length;a++){var s=e[t[a]];o.features.push({type:1,geometry:[[Math.round(this.options.extent*(s.x*i-n)),Math.round(this.options.extent*(s.y*i-r))]],tags:s.numPoints?c(s):this.points[s.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],r=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var o=t[i];if(!(o.zoom<=e)){o.zoom=e;var s=this.trees[e+1],u=s.within(o.x,o.y,r),c=o.numPoints||1,l=o.x*c,f=o.y*c,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,o));for(var p=(i<<5)+(e+1),d=0;d<u.length;d++){var v=s.points[u[d]];if(!(v.zoom<=e)){v.zoom=e;var g=v.numPoints||1;l+=v.x*g,f+=v.y*g,c+=g,v.parentId=p,this.options.reduce&&this._accumulate(h,v)}}1===c?n.push(o):(o.parentId=p,n.push(a(l/c,f/c,p,c,h)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,n)}}},function(t,e,n){"use strict";var r=n(558),i=n(559),o=n(560);function a(t,e,n,i,o){e=e||s,n=n||u,o=o||Array,this.nodeSize=i||64,this.points=t,this.ids=new o(t.length),this.coords=new o(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=e(t[a]),this.coords[2*a+1]=n(t[a]);r(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function s(t){return t[0]}function u(t){return t[1]}t.exports=function(t,e,n,r,i){return new a(t,e,n,r,i)},a.prototype={range:function(t,e,n,r){return i(this.ids,this.coords,t,e,n,r,this.nodeSize)},within:function(t,e,n){return o(this.ids,this.coords,t,e,n,this.nodeSize)}}},function(t,e,n){"use strict";function r(t,e,n,r){i(t,n,r),i(e,2*n,2*r),i(e,2*n+1,2*r+1)}function i(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}t.exports=function t(e,n,i,o,a,s){if(a-o<=i)return;var u=Math.floor((o+a)/2);!function t(e,n,i,o,a,s){for(;a>o;){if(a-o>600){var u=a-o+1,c=i-o+1,l=Math.log(u),f=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*f*(u-f)/u)*(c-u/2<0?-1:1),p=Math.max(o,Math.floor(i-c*f/u+h)),d=Math.min(a,Math.floor(i+(u-c)*f/u+h));t(e,n,i,p,d,s)}var v=n[2*i+s],g=o,m=a;for(r(e,n,o,i),n[2*a+s]>v&&r(e,n,o,a);g<m;){for(r(e,n,g,m),g++,m--;n[2*g+s]<v;)g++;for(;n[2*m+s]>v;)m--}n[2*o+s]===v?r(e,n,o,m):r(e,n,++m,a),m<=i&&(o=m+1),i<=m&&(a=m-1)}}(e,n,u,o,a,s%2);t(e,n,i,o,u-1,s+1);t(e,n,i,u+1,a,s+1)}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i,o,a){var s,u,c=[0,t.length-1,0],l=[];for(;c.length;){var f=c.pop(),h=c.pop(),p=c.pop();if(h-p<=a)for(var d=p;d<=h;d++)s=e[2*d],u=e[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[d]);else{var v=Math.floor((p+h)/2);s=e[2*v],u=e[2*v+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[v]);var g=(f+1)%2;(0===f?n<=s:r<=u)&&(c.push(p),c.push(v-1),c.push(g)),(0===f?i>=s:o>=u)&&(c.push(v+1),c.push(h),c.push(g))}}return l}},function(t,e,n){"use strict";function r(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}t.exports=function(t,e,n,i,o,a){var s=[0,t.length-1,0],u=[],c=o*o;for(;s.length;){var l=s.pop(),f=s.pop(),h=s.pop();if(f-h<=a)for(var p=h;p<=f;p++)r(e[2*p],e[2*p+1],n,i)<=c&&u.push(t[p]);else{var d=Math.floor((h+f)/2),v=e[2*d],g=e[2*d+1];r(v,g,n,i)<=c&&u.push(t[d]);var m=(l+1)%2;(0===l?n-o<=v:i-o<=g)&&(s.push(h),s.push(d-1),s.push(m)),(0===l?n+o>=v:i+o>=g)&&(s.push(d+1),s.push(f),s.push(m))}}return u}},function(t,e,n){var r=n(562).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return r(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},function(t,e,n){"use strict";function r(t,e,n){if(null!==t){var i,o,a,s,u,c,l,f,h,p,d=0,v=0,g=t.type,m="FeatureCollection"===g,y="Feature"===g,_=m?t.features.length:1;for(i=0;i<_;i++)for(l=(p=!!(h=m?t.features[i].geometry:y?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1,o=0;o<l;o++){var b=0;if(null!==(c=p?h.geometries[o]:h)){f=c.coordinates;var x=c.type;switch(d=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":e(f,v,i,b),v++,b++;break;case"LineString":case"MultiPoint":for(a=0;a<f.length;a++)e(f[a],v,i,b),v++,"MultiPoint"===x&&b++;"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(a=0;a<f.length;a++){for(s=0;s<f[a].length-d;s++)e(f[a][s],v,i,b),v++;"MultiLineString"===x&&b++}"Polygon"===x&&b++;break;case"MultiPolygon":for(a=0;a<f.length;a++){for(s=0;s<f[a].length;s++)for(u=0;u<f[a][s].length-d;u++)e(f[a][s][u],v,i,b),v++;b++}break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)r(c.geometries[a],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function i(t,e,n,i){var o=n;return r(t,function(t,r,i,a){o=0===r&&void 0===n?t:e(o,t,r,i,a)},i),o}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function a(t,e,n){var r=n;return o(t,function(t,i){r=0===i&&void 0===n?t:e(r,t,i)}),r}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function u(t,e,n){var r=n;return s(t,function(t,i){r=0===i&&void 0===n?t:e(r,t,i)}),r}function c(t){var e=[];return r(t,function(t){e.push(t)}),e}function l(t,e){var n,r,i,o,a,s,u,c,l=0,f="FeatureCollection"===t.type,h="Feature"===t.type,p=f?t.features.length:1;for(n=0;n<p;n++){for(s=f?t.features[n].geometry:h?t.geometry:t,c=f?t.features[n].properties:h?t.properties:{},a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,l,c);break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)e(o.geometries[r],l,c);break;default:throw new Error("Unknown Geometry Type")}else e(null,l,c);l++}}function f(t,e,n){var r=n;return l(t,function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)}),r}function h(t,e){l(t,function(t,n,r){var i,o=null===t?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return void e(g(t,r),n,0)}switch(o){case"MultiPoint":i="Point";break;case"MultiLineString":i="LineString";break;case"MultiPolygon":i="Polygon"}t.coordinates.forEach(function(t,o){e(g({type:i,coordinates:t},r),n,o)})})}function p(t,e,n){var r=n;return h(t,function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)}),r}function d(t,e){h(t,function(t,n,r){var o=0;if(t.geometry){var a=t.geometry.type;"Point"!==a&&"MultiPoint"!==a&&i(t,function(i,a){var s=m([i,a],t.properties);return e(s,n,r,o),o++,a})}})}function v(t,e,n){var r=n,i=!1;return d(t,function(t,o,a,s){r=!1===i&&void 0===n?t:e(r,t,o,a,s),i=!0}),r}function g(t,e){if(void 0===t)throw new Error("No geometry passed");return{type:"Feature",properties:e||{},geometry:t}}function m(t,e){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");return{type:"Feature",properties:e||{},geometry:{type:"LineString",coordinates:t}}}function y(t,e){if(!t)throw new Error("geojson is required");var n=t.geometry?t.geometry.type:t.type;if(!n)throw new Error("invalid geojson");if("FeatureCollection"===n)throw new Error("FeatureCollection is not supported");if("GeometryCollection"===n)throw new Error("GeometryCollection is not supported");var r=t.geometry?t.geometry.coordinates:t.coordinates;if(!r)throw new Error("geojson must contain coordinates");switch(n){case"LineString":return void e(r,0,0);case"Polygon":case"MultiLineString":for(var i=0,o=0;o<r.length;o++)"MultiLineString"===n&&(i=o),e(r[o],o,i);return;case"MultiPolygon":for(var a=0;a<r.length;a++)for(var s=0;s<r[a].length;s++)e(r[a][s],s,a);return;default:throw new Error(n+" geometry not supported")}}function _(t,e,n){var r=n;return y(t,function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)}),r}n.r(e),n.d(e,"coordEach",function(){return r}),n.d(e,"coordReduce",function(){return i}),n.d(e,"propEach",function(){return o}),n.d(e,"propReduce",function(){return a}),n.d(e,"featureEach",function(){return s}),n.d(e,"featureReduce",function(){return u}),n.d(e,"coordAll",function(){return c}),n.d(e,"geomEach",function(){return l}),n.d(e,"geomReduce",function(){return f}),n.d(e,"flattenEach",function(){return h}),n.d(e,"flattenReduce",function(){return p}),n.d(e,"segmentEach",function(){return d}),n.d(e,"segmentReduce",function(){return v}),n.d(e,"feature",function(){return g}),n.d(e,"lineString",function(){return m}),n.d(e,"lineEach",function(){return y}),n.d(e,"lineReduce",function(){return _})},function(t,e){function n(t,e,n,r){if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");if(n&&4!==n.length)throw new Error("bbox must be an Array of 4 numbers");if(r&&-1===["string","number"].indexOf(typeof r))throw new Error("id must be a number or a string");var i={type:"Feature"};return r&&(i.id=r),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function r(t,e,r,i){if(!t)throw new Error("No coordinates passed");if(void 0===t.length)throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("Coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r,i)}function i(t,e,r,i){if(!t)throw new Error("No coordinates passed");for(var o=0;o<t.length;o++){var a=t[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++){if(0===o&&0===s&&!d(a[0][0])||!d(a[0][1]))throw new Error("Coordinates must contain numbers");if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}}return n({type:"Polygon",coordinates:t},e,r,i)}function o(t,e,r,i){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");if(!d(t[0][1])||!d(t[0][1]))throw new Error("Coordinates must contain numbers");return n({type:"LineString",coordinates:t},e,r,i)}function a(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:t},e,r,i)}function s(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:t},e,r,i)}function u(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:t},e,r,i)}var c={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65},l={kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,centimetres:1e4,millimeter:1e6,acres:247105e-9,miles:3.86e-7,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function f(t,e){if(void 0===t||null===t)throw new Error("radians is required");var n=c[e||"kilometers"];if(!n)throw new Error("units is invalid");return t*n}function h(t,e){if(void 0===t||null===t)throw new Error("distance is required");var n=c[e||"kilometers"];if(!n)throw new Error("units is invalid");return t/n}function p(t){if(null===t||void 0===t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}t.exports={feature:n,geometry:function(t,e,n){if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(n&&4!==n.length)throw new Error("bbox must be an Array of 4 numbers");var c;switch(t){case"Point":c=r(e).geometry;break;case"LineString":c=o(e).geometry;break;case"Polygon":c=i(e).geometry;break;case"MultiPoint":c=s(e).geometry;break;case"MultiLineString":c=a(e).geometry;break;case"MultiPolygon":c=u(e).geometry;break;default:throw new Error(t+" is invalid")}return n&&(c.bbox=n),c},featureCollection:function(t,e,n){if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");if(e&&4!==e.length)throw new Error("bbox must be an Array of 4 numbers");if(n&&-1===["string","number"].indexOf(typeof n))throw new Error("id must be a number or a string");var r={type:"FeatureCollection"};return n&&(r.id=n),e&&(r.bbox=e),r.features=t,r},geometryCollection:function(t,e,r,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return n({type:"GeometryCollection",geometries:t},e,r,i)},point:r,multiPoint:s,lineString:o,multiLineString:a,polygon:i,multiPolygon:u,radiansToDistance:f,distanceToRadians:h,distanceToDegrees:function(t,e){return p(h(t,e))},radians2degrees:p,degrees2radians:function(t){if(null===t||void 0===t)throw new Error("degrees is required");return t%360*Math.PI/180},bearingToAngle:function(t){if(null===t||void 0===t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e},convertDistance:function(t,e,n){if(null===t||void 0===t)throw new Error("distance is required");if(!(t>=0))throw new Error("distance must be a positive number");return f(h(t,e),n||"kilometers")},convertArea:function(t,e,n){if(null===t||void 0===t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var r=l[e||"meters"];if(!r)throw new Error("invalid original units");var i=l[n||"kilometers"];if(!i)throw new Error("invalid final units");return t/r*i},round:function(t,e){if(void 0===t||null===t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},isNumber:d}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(15),a=n(82),s={position:"absolute",zIndex:10,display:"flex",flexDirection:"column",boxShadow:"0px 1px 4px rgba(0, 0, 0, .3)",border:"1px solid rgba(0, 0, 0, 0.1)"},u={"top-right":{top:62,right:10,bottom:"auto",left:"auto"},"top-left":{top:62,left:10,bottom:"auto",right:"auto"},"bottom-right":{bottom:63,right:10,top:"auto",left:"auto"},"bottom-left":{bottom:63,left:10,top:"auto",right:"auto"}},c={backgroundColor:"#f9f9f9",opacity:.95,transition:"background-color 0.16s ease-out",cursor:"pointer",border:0,height:26,width:26,outline:0,padding:3},l={backgroundColor:"#fff",opacity:1},f={borderBottom:"1px solid rgba(0, 0, 0, 0.1)",borderTopLeftRadius:2,borderTopRightRadius:2,borderBottomLeftRadius:2,borderBottomRightRadius:2},h=function(){return o.createElement("svg",{viewBox:"0 0 20 20"},o.createElement("polygon",{fill:"#333333",points:"6,9 10,1 14,9"}),o.createElement("polygon",{fill:"#CCCCCC",points:"6,11 10,19 14,11"}))},p={width:20,height:20,display:"inline-block"},d=0,v=Object.keys(u),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={hover:void 0},e.compassIcon=null,e.onMouseOut=function(){e.state.hover||e.setState({hover:void 0})},e.onMouseIn=function(){d!==e.state.hover&&e.setState({hover:d})},e.onClickCompass=function(){e.props.map.resetNorth()},e.onMapRotate=function(){var t="rotate("+e.props.map.transform.angle*(180/Math.PI)+"deg)";e.compassIcon&&(e.compassIcon.style.transform=t)},e.assignRef=function(t){e.compassIcon=t},e}return r(e,t),e.prototype.componentDidMount=function(){this.props.map.on("rotate",this.onMapRotate)},e.prototype.componentWillUnmount=function(){this.props.map.off("rotate",this.onMapRotate)},e.prototype.render=function(){var t=this.props,e=t.position,n=t.style,r=t.className,a=t.tabIndex,v=this.state.hover,g=i({},c,f,v===d?l:{});return o.createElement("div",{className:r,tabIndex:a,style:i({},s,u[e],n)},o.createElement("button",{style:g,onMouseOver:this.onMouseIn,onMouseOut:this.onMouseOut,onClick:this.onClickCompass},o.createElement("span",{ref:this.assignRef,style:p},o.createElement(h,null))))},e.defaultProps={position:v[0]},e}(o.Component);e.RotationControl=g,e.default=a.withMap(g)},function(t,e,n){"use strict";n.r(e);var r=n(15),i=n(4),o=n.n(i),a=o.a.shape({trySubscribe:o.a.func.isRequired,tryUnsubscribe:o.a.func.isRequired,notifyNestedSubs:o.a.func.isRequired,isSubscribed:o.a.func.isRequired}),s=o.a.shape({subscribe:o.a.func.isRequired,dispatch:o.a.func.isRequired,getState:o.a.func.isRequired});function u(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"store",n=arguments[1]||e+"Subscription",i=function(t){function i(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r));return o[e]=n.store,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,t),i.prototype.getChildContext=function(){var t;return(t={})[e]=this[e],t[n]=null,t},i.prototype.render=function(){return r.Children.only(this.props.children)},i}(r.Component);return i.propTypes={store:s.isRequired,children:o.a.element.isRequired},i.childContextTypes=((t={})[e]=s.isRequired,t[n]=a,t),i}var c=u(),l=n(241),f=n.n(l),h=n(150),p=n.n(h);var d=null,v={notify:function(){}};var g=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.parentSub=n,this.onStateChange=r,this.unsubscribe=null,this.listeners=v}return t.prototype.addNestedSub=function(t){return this.trySubscribe(),this.listeners.subscribe(t)},t.prototype.notifyNestedSubs=function(){this.listeners.notify()},t.prototype.isSubscribed=function(){return Boolean(this.unsubscribe)},t.prototype.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=function(){var t=[],e=[];return{clear:function(){e=d,t=d},notify:function(){for(var n=t=e,r=0;r<n.length;r++)n[r]()},get:function(){return e},subscribe:function(n){var r=!0;return e===t&&(e=t.slice()),e.push(n),function(){r&&t!==d&&(r=!1,e===t&&(e=t.slice()),e.splice(e.indexOf(n),1))}}}}())},t.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=v)},t}(),m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};var y=0,_={};function b(){}function x(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.getDisplayName,u=void 0===o?function(t){return"ConnectAdvanced("+t+")"}:o,c=i.methodName,l=void 0===c?"connectAdvanced":c,h=i.renderCountProp,d=void 0===h?void 0:h,v=i.shouldHandleStateChanges,x=void 0===v||v,w=i.storeKey,E=void 0===w?"store":w,S=i.withRef,P=void 0!==S&&S,T=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(i,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),A=E+"Subscription",k=y++,C=((e={})[E]=s,e[A]=a,e),O=((n={})[A]=a,n);return function(e){p()("function"==typeof e,"You must pass a component to the function returned by "+l+". Instead received "+JSON.stringify(e));var n=e.displayName||e.name||"Component",i=u(n),o=m({},T,{getDisplayName:u,methodName:l,renderCountProp:d,shouldHandleStateChanges:x,storeKey:E,withRef:P,displayName:i,wrappedComponentName:n,WrappedComponent:e}),a=function(n){function a(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,n.call(this,t,e));return r.version=k,r.state={},r.renderCount=0,r.store=t[E]||e[E],r.propsMode=Boolean(t[E]),r.setWrappedInstance=r.setWrappedInstance.bind(r),p()(r.store,'Could not find "'+E+'" in either the context or props of "'+i+'". Either wrap the root component in a <Provider>, or explicitly pass "'+E+'" as a prop to "'+i+'".'),r.initSelector(),r.initSubscription(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,n),a.prototype.getChildContext=function(){var t,e=this.propsMode?null:this.subscription;return(t={})[A]=e||this.context[A],t},a.prototype.componentDidMount=function(){x&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},a.prototype.componentWillReceiveProps=function(t){this.selector.run(t)},a.prototype.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},a.prototype.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=b,this.store=null,this.selector.run=b,this.selector.shouldComponentUpdate=!1},a.prototype.getWrappedInstance=function(){return p()(P,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+l+"() call."),this.wrappedInstance},a.prototype.setWrappedInstance=function(t){this.wrappedInstance=t},a.prototype.initSelector=function(){var e=t(this.store.dispatch,o);this.selector=function(t,e){var n={run:function(r){try{var i=t(e.getState(),r);(i!==n.props||n.error)&&(n.shouldComponentUpdate=!0,n.props=i,n.error=null)}catch(t){n.shouldComponentUpdate=!0,n.error=t}}};return n}(e,this.store),this.selector.run(this.props)},a.prototype.initSubscription=function(){if(x){var t=(this.propsMode?this.props:this.context)[A];this.subscription=new g(this.store,t,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},a.prototype.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(_)):this.notifyNestedSubs()},a.prototype.notifyNestedSubsOnComponentDidUpdate=function(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},a.prototype.isSubscribed=function(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},a.prototype.addExtraProps=function(t){if(!(P||d||this.propsMode&&this.subscription))return t;var e=m({},t);return P&&(e.ref=this.setWrappedInstance),d&&(e[d]=this.renderCount++),this.propsMode&&this.subscription&&(e[A]=this.subscription),e},a.prototype.render=function(){var t=this.selector;if(t.shouldComponentUpdate=!1,t.error)throw t.error;return Object(r.createElement)(e,this.addExtraProps(t.props))},a}(r.Component);return a.WrappedComponent=e,a.displayName=i,a.childContextTypes=O,a.contextTypes=C,a.propTypes=C,f()(a,e)}}var w=Object.prototype.hasOwnProperty;function E(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function S(t,e){if(E(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(!w.call(e,n[i])||!E(t[n[i]],e[n[i]]))return!1;return!0}var P=n(183),T=n(242),A="object"==typeof self&&self&&self.Object===Object&&self,k=(T.a||A||Function("return this")()).Symbol,C=Object.prototype;C.hasOwnProperty,C.toString,k&&k.toStringTag;Object.prototype.toString;k&&k.toStringTag;Object.getPrototypeOf,Object;var O=Function.prototype,M=Object.prototype,I=O.toString;M.hasOwnProperty,I.call(Object);function L(t){return function(e,n){var r=t(e,n);function i(){return r}return i.dependsOnOwnProps=!1,i}}function R(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function j(t,e){return function(e,n){n.displayName;var r=function(t,e){return r.dependsOnOwnProps?r.mapToProps(t,e):r.mapToProps(t)};return r.dependsOnOwnProps=!0,r.mapToProps=function(e,n){r.mapToProps=t,r.dependsOnOwnProps=R(t);var i=r(e,n);return"function"==typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=R(i),i=r(e,n)),i},r}}var z=[function(t){return"function"==typeof t?j(t):void 0},function(t){return t?void 0:L(function(t){return{dispatch:t}})},function(t){return t&&"object"==typeof t?L(function(e){return Object(P.bindActionCreators)(t,e)}):void 0}];var D=[function(t){return"function"==typeof t?j(t):void 0},function(t){return t?void 0:L(function(){return{}})}],F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function N(t,e,n){return F({},n,t,e)}var B=[function(t){return"function"==typeof t?function(t){return function(e,n){n.displayName;var r=n.pure,i=n.areMergedPropsEqual,o=!1,a=void 0;return function(e,n,s){var u=t(e,n,s);return o?r&&i(u,a)||(a=u):(o=!0,a=u),a}}}(t):void 0},function(t){return t?void 0:function(){return N}}];function U(t,e,n,r){return function(i,o){return n(t(i,o),e(r,o),o)}}function V(t,e,n,r,i){var o=i.areStatesEqual,a=i.areOwnPropsEqual,s=i.areStatePropsEqual,u=!1,c=void 0,l=void 0,f=void 0,h=void 0,p=void 0;function d(i,u){var d=!a(u,l),v=!o(i,c);return c=i,l=u,d&&v?(f=t(c,l),e.dependsOnOwnProps&&(h=e(r,l)),p=n(f,h,l)):d?(t.dependsOnOwnProps&&(f=t(c,l)),e.dependsOnOwnProps&&(h=e(r,l)),p=n(f,h,l)):v?function(){var e=t(c,l),r=!s(e,f);return f=e,r&&(p=n(f,h,l)),p}():p}return function(i,o){return u?d(i,o):function(i,o){return f=t(c=i,l=o),h=e(r,l),p=n(f,h,l),u=!0,p}(i,o)}}function G(t,e){var n=e.initMapStateToProps,r=e.initMapDispatchToProps,i=e.initMergeProps,o=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(e,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=n(t,o),s=r(t,o),u=i(t,o);return(o.pure?V:U)(a,s,u,t,o)}var q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function W(t,e,n){for(var r=e.length-1;r>=0;r--){var i=e[r](t);if(i)return i}return function(e,r){throw new Error("Invalid value of type "+typeof t+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function Z(t,e){return t===e}var X=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.connectHOC,n=void 0===e?x:e,r=t.mapStateToPropsFactories,i=void 0===r?D:r,o=t.mapDispatchToPropsFactories,a=void 0===o?z:o,s=t.mergePropsFactories,u=void 0===s?B:s,c=t.selectorFactory,l=void 0===c?G:c;return function(t,e,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=o.pure,c=void 0===s||s,f=o.areStatesEqual,h=void 0===f?Z:f,p=o.areOwnPropsEqual,d=void 0===p?S:p,v=o.areStatePropsEqual,g=void 0===v?S:v,m=o.areMergedPropsEqual,y=void 0===m?S:m,_=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(o,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),b=W(t,i,"mapStateToProps"),x=W(e,a,"mapDispatchToProps"),w=W(r,u,"mergeProps");return n(l,q({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:b,initMapDispatchToProps:x,initMergeProps:w,pure:c,areStatesEqual:h,areOwnPropsEqual:d,areStatePropsEqual:g,areMergedPropsEqual:y},_))}}();n.d(e,"Provider",function(){return c}),n.d(e,"createProvider",function(){return u}),n.d(e,"connectAdvanced",function(){return x}),n.d(e,"connect",function(){return X})},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(239),i=n(45),o=85.05113,a=-85.05113;function s(t){var e=t.width,n=t.height,s=t.longitude,u=t.latitude,c=t.zoom,l=t.pitch,f=void 0===l?0:l,h=t.bearing,p=void 0===h?0:h;(s<-180||s>180)&&(s=Object(i.c)(s+180,360)-180),(p<-180||p>180)&&(p=Object(i.c)(p+180,360)-180);var d=new r.a({width:e,height:n,longitude:s,latitude:u,zoom:c}),v=d.project([s,o])[1],g=d.project([s,a])[1],m=0;return g-v<n&&(c+=Math.log2(n/(g-v)),v=(d=new r.a({width:e,height:n,longitude:s,latitude:u,zoom:c})).project([s,o])[1],g=d.project([s,a])[1]),v>0?m=v:g<n&&(m=g-n),m&&(u=d.unproject([e/2,n/2+m])[1]),{width:e,height:n,longitude:s,latitude:u,zoom:c,pitch:f,bearing:p}}},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(500),i=n(45),o=n(178),a=.01,s=["longitude","latitude","zoom"];function u(t,e,n){var u={},c=t.zoom,l=[t.longitude,t.latitude],f=Object(o.l)(c),h=e.zoom,p=[e.longitude,e.latitude],d=Object(o.l)(h-c),v=new r.a(Object(o.g)(l,f)),g=new r.a(Object(o.g)(p,f)).subtract(v),m=Math.max(t.width,t.height),y=m/d,_=Math.sqrt(g.x*g.x+g.y*g.y);if(Math.abs(_)<a){for(var b=0;b<s.length;b++){var x=s[b],w=t[x],E=e[x];u[x]=Object(i.b)(w,E,n)}return u}var S=1.414*1.414,P=(y*y-m*m+S*S*_*_)/(2*m*S*_),T=(y*y-m*m-S*S*_*_)/(2*y*S*_),A=Math.log(Math.sqrt(P*P+1)-P),k=n*((Math.log(Math.sqrt(T*T+1)-T)-A)/1.414),C=Math.cosh(A)/Math.cosh(A+1.414*k),O=m*((Math.cosh(A)*Math.tanh(A+1.414*k)-Math.sinh(A))/S)/_,M=1/C,I=c+Object(o.i)(M),L=Object(o.j)(v.add(g.scale(O)).scale(M),Object(o.l)(I));return u.longitude=L[0],u.latitude=L[1],u.zoom=I,u}},function(t,e,n){"use strict";var r=n(18),i=n(22),o=n(1),a=n(2),s=n(9),u=n(8),c=n(10),l=n(146),f=n(104),h=n(500),p=n(221),d=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(o.a)(this,e),t=Object(s.a)(this,Object(u.a)(e).call(this)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i,a),t}return Object(c.a)(e,t),Object(a.a)(e,[{key:"applyMatrix4",value:function(t){return t.transformVector(this,this),this}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(f.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){return this[3]=Object(f.a)(t)}}]),e}(n(112).a),v=n(251),g=n.n(v),m=n(252),y=n.n(m),_=n(253),b=n.n(_),x=n(88),w=n.n(x),E=n(254),S=n.n(E),P=n(76),T=n.n(P),A=n(255),k=n.n(A),C=n(92),O=n.n(C),M=n(33),I=n.n(M),L=n(256),R=n.n(L),j=n(49),z=n.n(j),D=n(55),F=n.n(D),N=n(257),B=n.n(N),U=n(258),V=n.n(U),G=n(56),q=n.n(G),W=n(89),Z=n.n(W),X=n(113),H=n.n(X),Y=n(90),K=n.n(Y);n.d(e,"a",function(){return $});var J=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Q(t,e){return t.length===e&&t.every(Number.isFinite)}var $=function(t){function e(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Object(o.a)(this,e),t=Object(s.a)(this,Object(u.a)(e).call(this)),Array.isArray(r[0])&&1===arguments.length?t.copy(r[0]):t.identity(),t}return Object(c.a)(e,t),Object(a.a)(e,[{key:"setRowMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,d=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=i,this[2]=u,this[3]=h,this[4]=e,this[5]=o,this[6]=c,this[7]=p,this[8]=n,this[9]=a,this[10]=l,this[11]=d,this[12]=r,this[13]=s,this[14]=f,this[15]=v,this.check()}},{key:"setColumnMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,d=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=p,this[14]=d,this[15]=v,this.check()}},{key:"copy",value:function(t){return this.setColumnMajor.apply(this,Object(i.a)(t))}},{key:"set",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:"getElement",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this[t][e]:this[e][t]}},{key:"setElement",value:function(t,e,n){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?this[t][e]=Object(f.a)(n):this[e][t]=Object(f.a)(n),this}},{key:"determinant",value:function(){return g()(this)}},{key:"identity",value:function(){return this.copy(J)}},{key:"fromQuaternion",value:function(t){return y()(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=t.far;return b()(this,e,n,r,i,o,a),this.check()}},{key:"lookAt",value:function(t){var e=t.eye,n=t.center,r=void 0===n?[0,0,0]:n,i=t.up,o=void 0===i?[0,1,0]:i;return w()(this,e,r,o),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far,u=void 0===s?500:s;return S()(this,e,n,r,i,a,u),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.focalDistance,s=void 0===a?1:a,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var h=r/2,p=s*Math.tan(h),d=p*o;return(new e).ortho({left:-d,right:d,bottom:-p,top:p,near:c,far:f})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=t.fov,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.near,s=void 0===a?.1:a,u=t.far,c=void 0===u?500:u;if((e=e||r)>2*Math.PI)throw Error("radians");return T()(this,e,o,s,c),this.check()}},{key:"transpose",value:function(){return k()(this,this),this.check()}},{key:"invert",value:function(){return O()(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return I()(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return I()(this,this,t),this.check()}},{key:"rotateX",value:function(t){return Z()(this,this,t),this.check()}},{key:"rotateY",value:function(t){return H()(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return K()(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(r.a)(t,3),n=e[0],i=e[1],o=e[2];return this.rotateX(n).rotateY(i).rotateZ(o)}},{key:"rotateAxis",value:function(t,e){return R()(this,this,t,e),this.check()}},{key:"scale",value:function(t){return z()(this,this,t),this.check()}},{key:"translate",value:function(t){return F()(this,this,t),this.check()}},{key:"transformVector2",value:function(t,e){return e=e||new h.a,B()(e,t,this),Q(e,2),e}},{key:"transformVector3",value:function(t,e){return e=e||new p.a,V()(e,t,this),Q(e,3),e}},{key:"transformVector4",value:function(t,e){return e=e||new d,q()(e,t,this),Q(e,4),e.check()}},{key:"transformVector",value:function(t,e){switch(t.length){case 2:return this.transformVector2(t,e);case 3:return this.transformVector3(t,e);case 4:return this.transformVector4(t,e);default:throw new Error("Illegal vector")}}},{key:"transformDirection",value:function(t,e){return this._transformVector(t,e,0)}},{key:"transformPoint",value:function(t,e){return this._transformVector(t,e,1)}},{key:"_transformVector",value:function(t,e,n){switch(t.length){case 2:e=e||new h.a,q()(e,[t[0],t[1],0,n],this),e.length=2,Q(e,2);break;case 3:e=e||new p.a,q()(e,[t[0],t[1],t[2],n],this),e.length=3,Q(e,3);break;case 4:if(Boolean(n)!==Boolean(t[3]))throw new Error("math.gl: Matrix4.transformPoint - invalid vector");e=e||new d,q()(e,t,this),Q(e,4);break;default:throw new Error("Illegal vector")}return e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"ELEMENTS",get:function(){return 16}}]),e}(l.a)}]);
//# sourceMappingURL=bundle.js.map